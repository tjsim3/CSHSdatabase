import{a as BA,b as Lc,c as xn,d as Nc,e as mn,f as yz,g as Zg,h as qA,i as bz,j as _z,k as Tz,l as jA,m as HA,n as GA,o as VA,p as Sz,q as Ez,r as Ql,s as B0,u as Zf,v as ep,w as Az}from"./chunk-YKPTDBNT.js";import{a as Ni}from"./chunk-TXJ4RBZJ.js";import{a as xz,d as em,f as Cz}from"./chunk-SVFCMH6D.js";import"./chunk-DSH42G32.js";import{a as Zl}from"./chunk-TLARJE3Y.js";import{a as mz,b as Qg,d as Jl,g as vz,h as ui,i as wz}from"./chunk-FKUR7PQ2.js";import{a as Nr}from"./chunk-KIA7B244.js";import{a as gz,b as Cr}from"./chunk-HKDEPBJK.js";import{a as Yl,b as _i}from"./chunk-UCOMJDZM.js";import"./chunk-IL3C5JYY.js";import{b as FA,c as D,d as pz,f as hz}from"./chunk-DGJUBN33.js";var WA=D(zA=>{(function(){var t,e,r,n,i,a,s,o,c,l,f,g,m,y,A,k,I,F,J,pe,L,H,j,X,V,ie,fe,Re,ye,ze,Ue,de,Q,Fe,We,tt,Le,Tt,It,St=function(Ze,Z){return function(){return Ze.apply(Z,arguments)}},Zt=[].slice;t=jQuery,tt=0,Le=1,Tt=2,fe=13,Q=9,X=46,j=8,ye=37,de=39,Fe=38,V=40,Re=36,ie=35,Ue=33,ze=34,l="jqconsole-",i=l+"cursor",a=l+"header",f=l+"prompt",g=f+"-text",c=l+"old-prompt",s=l+"input",o=l+"old-input",n=l+"blurred",L="keypress",F="<span/>",k="<div/>",I=":empty",We=`
`,A=">>> ",y="... ",m=2,r=l+"ansi-",J="\x1B",pe=/\[(\d*)(?:;(\d*))*m/,e=function(){Ze.prototype.COLORS=["black","red","green","yellow","blue","magenta","cyan","white"];function Ze(){this.stylize=St(this.stylize,this),this._closeSpan=St(this._closeSpan,this),this._openSpan=St(this._openSpan,this),this.getClasses=St(this.getClasses,this),this._style=St(this._style,this),this._color=St(this._color,this),this._remove=St(this._remove,this),this._append=St(this._append,this),this.klasses=[]}return Ze.prototype._append=function(Z){if(Z=""+r+Z,this.klasses.indexOf(Z)===-1)return this.klasses.push(Z)},Ze.prototype._remove=function(){var Z,me,ke,we,st,bt;for(we=1<=arguments.length?Zt.call(arguments,0):[],bt=[],me=0,st=we.length;me<st;me++)ke=we[me],ke==="fonts"||ke==="color"||ke==="background-color"?bt.push(this.klasses=(function(){var vt,Ee,He,zt;for(He=this.klasses,zt=[],vt=0,Ee=He.length;vt<Ee;vt++)Z=He[vt],Z.indexOf(ke)!==r.length&&zt.push(Z);return zt}).call(this)):(ke=""+r+ke,bt.push(this.klasses=(function(){var vt,Ee,He,zt;for(He=this.klasses,zt=[],vt=0,Ee=He.length;vt<Ee;vt++)Z=He[vt],Z!==ke&&zt.push(Z);return zt}).call(this)));return bt},Ze.prototype._color=function(Z){return this.COLORS[Z]},Ze.prototype._style=function(Z){if(Z===""&&(Z=0),Z=parseInt(Z),!isNaN(Z))switch(Z){case 0:return this.klasses=[];case 1:return this._append("bold");case 2:return this._append("lighter");case 3:return this._append("italic");case 4:return this._append("underline");case 5:return this._append("blink");case 6:return this._append("blink-rapid");case 8:return this._append("hidden");case 9:return this._append("line-through");case 10:return this._remove("fonts");case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:return this._remove("fonts"),this._append("fonts-"+(Z-10));case 20:return this._append("fraktur");case 21:return this._remove("bold","lighter");case 22:return this._remove("bold","lighter");case 23:return this._remove("italic","fraktur");case 24:return this._remove("underline");case 25:return this._remove("blink","blink-rapid");case 28:return this._remove("hidden");case 29:return this._remove("line-through");case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:return this._remove("color"),this._append("color-"+this._color(Z-30));case 39:return this._remove("color");case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:return this._remove("background-color"),this._append("background-color-"+this._color(Z-40));case 49:return this._remove("background-color");case 51:return this._append("framed");case 53:return this._append("overline");case 54:return this._remove("framed");case 55:return this._remove("overline")}},Ze.prototype.getClasses=function(){return this.klasses.join(" ")},Ze.prototype._openSpan=function(Z){return'<span class="'+this.getClasses()+'">'+Z},Ze.prototype._closeSpan=function(Z){return Z+"</span>"},Ze.prototype.stylize=function(Z){var me,ke,we,st,bt,vt;for(Z=this._openSpan(Z),we=0;(we=Z.indexOf(J,we))&&we!==-1;)if(ke=Z.slice(we).match(pe)){for(vt=ke.slice(1),st=0,bt=vt.length;st<bt;st++)me=vt[st],this._style(me);Z=this._closeSpan(Z.slice(0,we))+this._openSpan(Z.slice(we+1+ke[0].length))}else we++;return this._closeSpan(Z)},Ze}(),It=function(Ze,Z){return'<span class="'+Ze+'">'+(Z||"")+"</span>"},H=function(){function Ze(Z,me,ke,we,st){st==null&&(st=!1),this._HideComposition=St(this._HideComposition,this),this._ShowComposition=St(this._ShowComposition,this),this._UpdateComposition=St(this._UpdateComposition,this),this._EndComposition=St(this._EndComposition,this),this._StartComposition=St(this._StartComposition,this),this._CheckComposition=St(this._CheckComposition,this),this._ProcessMatch=St(this._ProcessMatch,this),this._HandleKey=St(this._HandleKey,this),this._HandleChar=St(this._HandleChar,this),this.isMobile=!!navigator.userAgent.match(/iPhone|iPad|iPod|Android/i),this.isIos=!!navigator.userAgent.match(/iPhone|iPad|iPod/i),this.isAndroid=!!navigator.userAgent.match(/Android/i),this.auto_focus=!st,this.$window=t(window),this.header=me||"",this.prompt_label_main=typeof ke=="string"?ke:A,this.prompt_label_continue=we||y,this.indent_width=m,this.state=Le,this.input_queue=[],this.input_callback=null,this.multiline_callback=null,this.history=[],this.history_index=0,this.history_new="",this.history_active=!1,this.shortcuts={},this.$container=t("<div/>").appendTo(Z),this.$container.css({top:0,left:0,right:0,bottom:0,position:"absolute",overflow:"auto"}),this.$console=t('<pre class="jqconsole"/>').appendTo(this.$container),this.$console.css({margin:0,position:"relative","min-height":"100%","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"}),this.$console_focused=!0,this.$input_container=t(k).appendTo(this.$container),this.$input_container.css({position:"absolute",width:1,height:0,overflow:"hidden"}),this.$input_source=this.isAndroid?t("<input/>"):t("<textarea/>"),this.$input_source.attr({wrap:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false",autocomplete:"off"}),this.$input_source.css({position:"absolute",width:2}),this.$input_source.appendTo(this.$input_container),this.$composition=t(k),this.$composition.addClass(l+"composition"),this.$composition.css({display:"inline",position:"relative"}),this.matchings={openings:{},closings:{},clss:[]},this.ansi=new e,this._InitPrompt(),this._SetupEvents(),this.Write(this.header,a),t(Z).data("jqconsole",this)}return Ze.prototype.ResetHistory=function(){return this.SetHistory([])},Ze.prototype.ResetShortcuts=function(){return this.shortcuts={}},Ze.prototype.ResetMatchings=function(){return this.matchings={openings:{},closings:{},clss:[]}},Ze.prototype.Reset=function(){this.state!==Le&&this.ClearPromptText(!0),this.state=Le,this.input_queue=[],this.input_callback=null,this.multiline_callback=null,this.custom_control_key_handler=null,this.custom_keypress_handler=null,this.ResetHistory(),this.ResetShortcuts(),this.ResetMatchings(),this.$prompt.detach(),this.$input_container.detach(),this.$console.html(""),this.$prompt.appendTo(this.$console),this.$input_container.appendTo(this.$container),this.Write(this.header,a)},Ze.prototype.GetHistory=function(){return this.history},Ze.prototype.SetHistory=function(Z){return this.history=Z.slice(),this.history_index=this.history.length},Ze.prototype._CheckKeyCode=function(Z){if(isNaN(Z)?Z=Z.charCodeAt(0):Z=parseInt(Z,10),!(0<Z&&Z<256)||isNaN(Z))throw new Error("Key code must be a number between 0 and 256 exclusive.");return Z},Ze.prototype._LetterCaseHelper=function(Z,me){if(me(Z),65<=Z&&Z<=90&&me(Z+32),97<=Z&&Z<=122)return me(Z-32)},Ze.prototype.RegisterShortcut=function(Z,me){var ke;if(Z=this._CheckKeyCode(Z),typeof me!="function")throw new Error("Callback must be a function, not "+me+".");ke=function(we){return function(st){return st in we.shortcuts||(we.shortcuts[st]=[]),we.shortcuts[st].push(me)}}(this),this._LetterCaseHelper(Z,ke)},Ze.prototype.UnRegisterShortcut=function(Z,me){var ke;Z=this._CheckKeyCode(Z),ke=function(we){return function(st){if(st in we.shortcuts)return me?we.shortcuts[st].splice(we.shortcuts[st].indexOf(me),1):delete we.shortcuts[st]}}(this),this._LetterCaseHelper(Z,ke)},Ze.prototype.GetColumn=function(){var Z;return this.$prompt_right.detach(),this.$prompt_cursor.text(""),Z=this.$console.text().split(We),this.$prompt_cursor.html("&nbsp;"),this.$prompt_cursor.after(this.$prompt_right),Z[Z.length-1].length},Ze.prototype.GetLine=function(){return this.$console.text().split(We).length-1},Ze.prototype.ClearPromptText=function(Z){if(this.state===Le)throw new Error("ClearPromptText() is not allowed in output state.");this.$prompt_before.html(""),this.$prompt_after.html(""),this.$prompt_label.text(Z?"":this._SelectPromptLabel(!1)),this.$prompt_left.text(""),this.$prompt_right.text("")},Ze.prototype.GetPromptText=function(Z){var me,ke,we,st,bt;if(this.state===Le)throw new Error("GetPromptText() is not allowed in output state.");return Z?(this.$prompt_cursor.text(""),bt=this.$prompt.text(),this.$prompt_cursor.html("&nbsp;"),bt):(st=function(vt){var Ee;return Ee=[],vt.children().each(function(){return Ee.push(t(this).children().last().text())}),Ee.join(We)},ke=st(this.$prompt_before),ke&&(ke+=We),we=this.$prompt_left.text()+this.$prompt_right.text(),me=st(this.$prompt_after),me&&(me=We+me),ke+we+me)},Ze.prototype.SetPromptText=function(Z){if(this.state===Le)throw new Error("SetPromptText() is not allowed in output state.");this.ClearPromptText(!1),this._AppendPromptText(Z),this._ScrollToEnd()},Ze.prototype.SetPromptLabel=function(Z,me){this.prompt_label_main=Z,me!=null&&(this.prompt_label_continue=me)},Ze.prototype.UpdatePromptLabel=function(){var Z,me;return me=">span+span>span:first-child",Z="."+f+me,this.$console.find(Z).text(this.prompt_label_main)},Ze.prototype.Write=function(Z,me,ke){var we;return ke==null&&(ke=!0),ke&&(Z=this.ansi.stylize(t(F).text(Z).html())),we=t(F).html(Z),me!=null&&we.addClass(me),this.Append(we)},Ze.prototype.Append=function(Z){var me;return me=t(Z).insertBefore(this.$prompt),this._ScrollToEnd(),this.$prompt_cursor.detach().insertAfter(this.$prompt_left),me},Ze.prototype.Input=function(Z){var me,ke,we,st;if(this.state===Tt)we=this.input_callback,st=this.multiline_callback,ke=this.history_active,me=this.async_multiline,this.AbortPrompt(),this.input_queue.unshift(function(bt){return function(){return bt.Prompt(ke,we,st,me)}}(this));else if(this.state!==Le){this.input_queue.push(function(bt){return function(){return bt.Input(Z)}}(this));return}this.history_active=!1,this.input_callback=Z,this.multiline_callback=null,this.state=tt,this.$prompt.attr("class",s),this.$prompt_label.text(this._SelectPromptLabel(!1)),this.Focus(),this._ScrollToEnd()},Ze.prototype.Prompt=function(Z,me,ke,we){if(this.state!==Le){this.input_queue.push(function(st){return function(){return st.Prompt(Z,me,ke,we)}}(this));return}this.history_active=Z,this.input_callback=me,this.multiline_callback=ke,this.async_multiline=we,this.state=Tt,this.$prompt.attr("class",f+" "+this.ansi.getClasses()),this.$prompt_label.text(this._SelectPromptLabel(!1)),this.auto_focus&&this.Focus(),this._ScrollToEnd()},Ze.prototype.AbortPrompt=function(){var Z;if(this.state===Le)throw new Error("Cannot abort prompt when not in prompt or input state.");Z=this.GetPromptText(!0),this.state===tt?Z.trim().length!==0&&this.Write(Z+We,o):this.Write(Z+We,c),this.ClearPromptText(!0),this.state=Le,this.input_callback=this.multiline_callback=null,this._CheckInputQueue()},Ze.prototype.Focus=function(){this.IsDisabled()||this.$input_source.focus()},Ze.prototype.SetIndentWidth=function(Z){return this.indent_width=Z},Ze.prototype.GetIndentWidth=function(){return this.indent_width},Ze.prototype.RegisterMatching=function(Z,me,ke){var we;return we={opening_char:Z,closing_char:me,cls:ke},this.matchings.clss.push(ke),this.matchings.openings[Z]=we,this.matchings.closings[me]=we},Ze.prototype.UnRegisterMatching=function(Z,me){var ke;return ke=this.matchings.openings[Z].cls,delete this.matchings.openings[Z],delete this.matchings.closings[me],this.matchings.clss.splice(this.matchings.clss.indexOf(ke),1)},Ze.prototype.Dump=function(){var Z,me;return Z=this.$console.find("."+a).nextUntil("."+f).addBack(),function(){var ke,we,st;for(st=[],ke=0,we=Z.length;ke<we;ke++)me=Z[ke],t(me).is("."+c)?st.push(t(me).text().replace(/^\s+/,">>> ")):st.push(t(me).text());return st}().join("")},Ze.prototype.GetState=function(){return this.state===tt?"input":this.state===Le?"output":"prompt"},Ze.prototype.Disable=function(){return this.$input_source.attr("disabled",!0),this.$input_source.blur()},Ze.prototype.Enable=function(){return this.$input_source.attr("disabled",!1)},Ze.prototype.IsDisabled=function(){return!!this.$input_source.attr("disabled")},Ze.prototype.MoveToStart=function(Z){this._MoveTo(Z,!0)},Ze.prototype.MoveToEnd=function(Z){this._MoveTo(Z,!1)},Ze.prototype.Clear=function(){var Z;return Z=this.state===tt?s:f,this.$console.find("."+a).nextUntil("."+Z).addBack().text(""),this.$prompt_cursor.detach(),this.$prompt_right.before(this.$prompt_cursor)},Ze.prototype._CheckInputQueue=function(){if(this.input_queue.length)return this.input_queue.shift()()},Ze.prototype._InitPrompt=function(){if(this.$prompt=t(It(s)).appendTo(this.$console),this.$prompt_before=t(F).appendTo(this.$prompt),this.$prompt_current=t(F).appendTo(this.$prompt),this.$prompt_after=t(F).appendTo(this.$prompt),this.$prompt_label=t(F).appendTo(this.$prompt_current),this.$prompt_left=t(F).appendTo(this.$prompt_current),this.$prompt_right=t(F).appendTo(this.$prompt_current),this.$prompt_right.css({position:"relative"}),this.$prompt_left.addClass(g),this.$prompt_cursor=t(It(i,"&nbsp;")),this.$prompt_cursor.insertBefore(this.$prompt_right),this.$prompt_cursor.css({color:"transparent",display:"inline",zIndex:0}),!this.isMobile)return this.$prompt_cursor.css("position","absolute")},Ze.prototype._SetupEvents=function(){return this.isMobile?this.$console.click(function(Z){return function(me){return me.preventDefault(),Z.Focus()}}(this)):this.$console.mouseup(function(Z){return function(me){var ke;return me.which===2?Z.Focus():(ke=function(){if(!window.getSelection().toString())return me.preventDefault(),Z.Focus()},setTimeout(ke,0))}}(this)),this.$input_source.focus(function(Z){return function(){var me,ke;return Z._ScrollToEnd(),Z.$console_focused=!0,Z.$console.removeClass(n),ke=function(){if(Z.$console_focused)return Z.$console.removeClass(n)},setTimeout(ke,100),me=function(){if(Z.isIos&&Z.$console_focused)return Z.$input_source.hide()},setTimeout(me,500)}}(this)),this.$input_source.blur(function(Z){return function(){var me;return Z.$console_focused=!1,Z.isIos&&Z.$input_source.show(),me=function(){if(!Z.$console_focused)return Z.$console.addClass(n)},setTimeout(me,100)}}(this)),this.$input_source.bind("paste",function(Z){return function(){var me;return me=function(){if(!Z.in_composition)return Z._AppendPromptText(Z.$input_source.val()),Z.$input_source.val(""),Z.Focus()},setTimeout(me,0)}}(this)),this.$input_source.keypress(this._HandleChar),this.$input_source.keydown(this._HandleKey),this.$input_source.keydown(this._CheckComposition),this.$input_source.bind("compositionstart",this._StartComposition),this.$input_source.bind("compositionend",function(Z){return function(me){return setTimeout(function(){return Z._EndComposition(me)},0)}}(this)),this.isAndroid?(this.$input_source.bind("input",this._StartComposition),this.$input_source.bind("input",this._UpdateComposition)):this.$input_source.bind("text",this._UpdateComposition)},Ze.prototype.SetKeyPressHandler=function(Z){return this.custom_keypress_handler=Z},Ze.prototype.SetControlKeyHandler=function(Z){return this.custom_control_key_handler=Z},Ze.prototype._HandleChar=function(Z){var me;return this.state===Le||Z.metaKey||Z.ctrlKey?!0:(me=Z.which,me===8||me===9||me===13||this.custom_keypress_handler!=null&&this.custom_keypress_handler.call(this,Z)===!1||(this.$prompt_left.text(this.$prompt_left.text()+String.fromCharCode(me)),this._ScrollToEnd()),!1)},Ze.prototype._HandleKey=function(Z){var me;if(this.state===Le)return!0;if(me=Z.keyCode||Z.which,setTimeout(t.proxy(this._CheckMatchings,this),0),this.custom_control_key_handler!=null&&this.custom_control_key_handler.call(this,Z)===!1)return!1;if(Z.altKey)return!0;if(Z.ctrlKey||Z.metaKey)return this._HandleCtrlShortcut(me);if(Z.shiftKey){switch(me){case fe:this._HandleEnter(!0);break;case Q:this._Unindent();break;case Fe:this._MoveUp();break;case V:this._MoveDown();break;case Ue:this._ScrollPage("up");break;case ze:this._ScrollPage("down");break;default:return!0}return!1}else{switch(me){case fe:this._HandleEnter(!1);break;case Q:this._Indent();break;case X:this._Delete(!1);break;case j:this._Backspace(!1);break;case ye:this._MoveLeft(!1);break;case de:this._MoveRight(!1);break;case Fe:this._HistoryPrevious();break;case V:this._HistoryNext();break;case Re:this.MoveToStart(!1);break;case ie:this.MoveToEnd(!1);break;case Ue:this._ScrollPage("up");break;case ze:this._ScrollPage("down");break;default:return!0}return!1}},Ze.prototype._HandleCtrlShortcut=function(Z){var me,ke,we,st;switch(Z){case X:this._Delete(!0);break;case j:this._Backspace(!0);break;case ye:this._MoveLeft(!0);break;case de:this._MoveRight(!0);break;case Fe:this._MoveUp();break;case V:this._MoveDown();break;case ie:this.MoveToEnd(!0);break;case Re:this.MoveToStart(!0);break;default:if(Z in this.shortcuts){for(st=this.shortcuts[Z],ke=0,we=st.length;ke<we;ke++)me=st[ke],me.call(this);return!1}else return!0}return!1},Ze.prototype._HandleEnter=function(Z){var me,ke;return this._EndComposition(),Z?this._InsertNewLine(!0):(ke=this.GetPromptText(),me=function(we){return function(st){var bt,vt,Ee,He,zt,Ge;if(st!==!1){for(we.MoveToEnd(!0),we._InsertNewLine(!0),Ge=[],bt=He=0,zt=Math.abs(st);0<=zt?He<zt:He>zt;bt=0<=zt?++He:--He)st>0?Ge.push(we._Indent()):Ge.push(we._Unindent());return Ge}else return Ee=we.state===tt?"input":"prompt",we.Write(we.GetPromptText(!0)+We,l+"old-"+Ee),we.ClearPromptText(!0),we.history_active&&((!we.history.length||we.history[we.history.length-1]!==ke)&&we.history.push(ke),we.history_index=we.history.length),we.state=Le,vt=we.input_callback,we.input_callback=null,vt&&vt(ke),we._CheckInputQueue()}}(this),this.multiline_callback?this.async_multiline?this.multiline_callback(ke,me):me(this.multiline_callback(ke)):me(!1))},Ze.prototype._GetDirectionals=function(Z){var me,ke,we,st,bt,vt,Ee,He;return st=Z?this.$prompt_left:this.$prompt_right,me=Z?this.$prompt_right:this.$prompt_left,we=Z?this.$prompt_before:this.$prompt_after,ke=Z?this.$prompt_after:this.$prompt_before,vt=Z?t.proxy(this.MoveToStart,this):t.proxy(this.MoveToEnd,this),bt=Z?t.proxy(this._MoveLeft,this):t.proxy(this._MoveRight,this),He=Z?"last":"first",Ee=Z?"prependTo":"appendTo",{$prompt_which:st,$prompt_opposite:me,$prompt_relative:we,$prompt_rel_opposite:ke,MoveToLimit:vt,MoveDirection:bt,which_end:He,where_append:Ee}},Ze.prototype._VerticalMove=function(Z){var me,ke,we,st,bt,vt,Ee,He;if(Ee=this._GetDirectionals(Z),we=Ee.$prompt_which,me=Ee.$prompt_opposite,ke=Ee.$prompt_relative,bt=Ee.MoveToLimit,st=Ee.MoveDirection,!ke.is(I))return vt=this.$prompt_left.text().length,bt(),st(),He=we.text(),me.text(Z?He.slice(vt):He.slice(0,vt)),we.text(Z?He.slice(0,vt):He.slice(vt))},Ze.prototype._MoveUp=function(){return this._VerticalMove(!0)},Ze.prototype._MoveDown=function(){return this._VerticalMove()},Ze.prototype._HorizontalMove=function(Z,me){var ke,we,st,bt,vt,Ee,He,zt,Ge,at,Ve,Ae,lt,Bt;if(zt=this._GetDirectionals(me),vt=zt.$prompt_which,we=zt.$prompt_opposite,bt=zt.$prompt_relative,st=zt.$prompt_rel_opposite,lt=zt.which_end,Ae=zt.where_append,Ge=me?/\w*\W*$/:/^\w*\W*/,at=vt.text(),at)return Z?(Bt=at.match(Ge),Bt?(Bt=Bt[0],Ve=we.text(),we.text(me?Bt+Ve:Ve+Bt),He=Bt.length,vt.text(me?at.slice(0,-He):at.slice(He))):void 0):(Ve=we.text(),we.text(me?at.slice(-1)+Ve:Ve+at[0]),vt.text(me?at.slice(0,-1):at.slice(1)));if(!bt.is(I))return Ee=t(F)[Ae](st),Ee.append(t(F).text(this.$prompt_label.text())),Ee.append(t(F).text(we.text())),ke=bt.children()[lt]().detach(),this.$prompt_label.text(ke.children().first().text()),vt.text(ke.children().last().text()),we.text("")},Ze.prototype._MoveLeft=function(Z){return this._HorizontalMove(Z,!0)},Ze.prototype._MoveRight=function(Z){return this._HorizontalMove(Z)},Ze.prototype._MoveTo=function(Z,me){var ke,we,st,bt,vt,Ee,He;if(Ee=this._GetDirectionals(me),st=Ee.$prompt_which,ke=Ee.$prompt_opposite,we=Ee.$prompt_relative,vt=Ee.MoveToLimit,bt=Ee.MoveDirection,Z){for(He=[];!(we.is(I)&&st.text()==="");)vt(!1),He.push(bt(!1));return He}else return ke.text(this.$prompt_left.text()+this.$prompt_right.text()),st.text("")},Ze.prototype._Delete=function(Z){var me,ke,we;if(ke=this.$prompt_right.text(),ke)return Z?(we=ke.match(/^\w*\W*/),we?(we=we[0],this.$prompt_right.text(ke.slice(we.length))):void 0):this.$prompt_right.text(ke.slice(1));if(!this.$prompt_after.is(I))return me=this.$prompt_after.children().first().detach(),this.$prompt_right.text(me.children().last().text())},Ze.prototype._Backspace=function(Z){var me,ke,we;if(setTimeout(t.proxy(this._ScrollToEnd,this),0),ke=this.$prompt_left.text(),ke)return Z?(we=ke.match(/\w*\W*$/),we?(we=we[0],this.$prompt_left.text(ke.slice(0,-we.length))):void 0):this.$prompt_left.text(ke.slice(0,-1));if(!this.$prompt_before.is(I))return me=this.$prompt_before.children().last().detach(),this.$prompt_label.text(me.children().first().text()),this.$prompt_left.text(me.children().last().text())},Ze.prototype._Indent=function(){var Z;return this.$prompt_left.prepend((function(){var me,ke,we;for(we=[],Z=me=1,ke=this.indent_width;1<=ke?me<=ke:me>=ke;Z=1<=ke?++me:--me)we.push(" ");return we}).call(this).join(""))},Ze.prototype._Unindent=function(){var Z,me,ke,we,st;for(ke=this.$prompt_left.text()+this.$prompt_right.text(),st=[],Z=me=1,we=this.indent_width;(1<=we?me<=we:me>=we)&&/^ /.test(ke);Z=1<=we?++me:--me)this.$prompt_left.text()?this.$prompt_left.text(this.$prompt_left.text().slice(1)):this.$prompt_right.text(this.$prompt_right.text().slice(1)),st.push(ke=ke.slice(1));return st},Ze.prototype._InsertNewLine=function(Z){var me,ke,we;return Z==null&&(Z=!1),we=this._SelectPromptLabel(!this.$prompt_before.is(I)),me=t(F).appendTo(this.$prompt_before),me.append(t(F).text(we)),me.append(t(F).addClass(g).text(this.$prompt_left.text())),this.$prompt_label.text(this._SelectPromptLabel(!0)),Z&&(ke=this.$prompt_left.text().match(/^\s+/))?this.$prompt_left.text(ke[0]):this.$prompt_left.text(""),this._ScrollToEnd()},Ze.prototype._AppendPromptText=function(Z){var me,ke,we,st,bt,vt;for(st=Z.split(We),this.$prompt_left.text(this.$prompt_left.text()+st[0]),bt=st.slice(1),vt=[],me=0,ke=bt.length;me<ke;me++)we=bt[me],this._InsertNewLine(),vt.push(this.$prompt_left.text(we));return vt},Ze.prototype._ScrollPage=function(Z){var me;return me=this.$container[0].scrollTop,Z==="up"?me-=this.$container.height():me+=this.$container.height(),this.$container.stop().animate({scrollTop:me},"fast")},Ze.prototype._ScrollToEnd=function(){var Z;if(this.$container.scrollTop(this.$container[0].scrollHeight),Z=this.$prompt_cursor.position(),this.$input_container.css({left:Z.left,top:Z.top}),this.auto_focus)return setTimeout(this.ScrollWindowToPrompt.bind(this),50)},Ze.prototype.ScrollWindowToPrompt=function(){var Z,me,ke,we,st,bt;if(me=this.$prompt_cursor.height(),bt=this.$window.scrollTop(),st=this.$window.scrollLeft(),Z=document.documentElement.clientHeight,we=this.$prompt_cursor.offset(),ke=we.top-2*me,this.isMobile&&typeof orientation<"u"&&orientation!==null){if(bt<we.top||bt>we.top)return this.$window.scrollTop(ke)}else{if(bt+Z<we.top)return this.$window.scrollTop(we.top-Z+me);if(bt>ke)return this.$window.scrollTop(we.top)}},Ze.prototype._SelectPromptLabel=function(Z){return this.state===Tt?Z?` 
`+this.prompt_label_continue:this.prompt_label_main:Z?`
 `:" "},Ze.prototype._Wrap=function(Z,me,ke){var we,st;return st=Z.html(),we=st.slice(0,me)+It(ke,st[me])+st.slice(me+1),Z.html(we)},Ze.prototype._WalkCharacters=function(Z,me,ke,we,st){var bt,vt,Ee;for(vt=st?Z.length:0,Z=Z.split(""),Ee=function(){var He,zt,Ge,at;return st?(zt=Z,Z=2<=zt.length?Zt.call(zt,0,He=zt.length-1):(He=0,[]),at=zt[He++]):(Ge=Z,at=Ge[0],Z=2<=Ge.length?Zt.call(Ge,1):[]),at&&(vt=vt+(st?-1:1)),at};bt=Ee();)if(bt===me?we++:bt===ke&&we--,we===0)return{index:vt,current_count:we};return{index:-1,current_count:we}},Ze.prototype._ProcessMatch=function(Z,me,ke){var we,st,bt,vt,Ee,He,zt,Ge,at,Ve,Ae,lt;return at=me?[Z.closing_char,Z.opening_char]:[Z.opening_char,Z.closing_char],vt=at[0],Ge=at[1],Ve=this._GetDirectionals(me),bt=Ve.$prompt_which,st=Ve.$prompt_relative,Ee=1,He=!1,lt=bt.html(),me||(lt=lt.slice(1)),ke&&me&&(lt=lt.slice(0,-1)),Ae=this._WalkCharacters(lt,vt,Ge,Ee,me),zt=Ae.index,Ee=Ae.current_count,zt>-1?(this._Wrap(bt,zt,Z.cls),He=!0):(we=st.children(),we=me?Array.prototype.reverse.call(we):we,we.each(function(Bt){return function(ct,_t){var re,te;if(re=t(_t).children().last(),lt=re.html(),te=Bt._WalkCharacters(lt,vt,Ge,Ee,me),zt=te.index,Ee=te.current_count,zt>-1)return me||zt--,Bt._Wrap(re,zt,Z.cls),He=!0,!1}}(this))),He},Ze.prototype._CheckMatchings=function(Z){var me,ke,we,st,bt,vt,Ee;for(we=Z?this.$prompt_left.text().slice(this.$prompt_left.text().length-1):this.$prompt_right.text()[0],Ee=this.matchings.clss,bt=0,vt=Ee.length;bt<vt;bt++)me=Ee[bt],t("."+me,this.$console).contents().unwrap();if((ke=this.matchings.closings[we])?st=this._ProcessMatch(ke,!0,Z):(ke=this.matchings.openings[we])?st=this._ProcessMatch(ke,!1,Z):Z||this._CheckMatchings(!0),Z){if(st)return this._Wrap(this.$prompt_left,this.$prompt_left.html().length-1,ke.cls)}else if(st)return this._Wrap(this.$prompt_right,0,ke.cls)},Ze.prototype._HistoryPrevious=function(){if(this.history_active&&!(this.history_index<=0))return this.history_index===this.history.length&&(this.history_new=this.GetPromptText()),this.SetPromptText(this.history[--this.history_index])},Ze.prototype._HistoryNext=function(){if(this.history_active&&!(this.history_index>=this.history.length))return this.history_index===this.history.length-1?(this.history_index++,this.SetPromptText(this.history_new)):this.SetPromptText(this.history[++this.history_index])},Ze.prototype._CheckComposition=function(Z){var me;if(me=Z.keyCode||Z.which,me===229)return this.in_composition?this._UpdateComposition():this._StartComposition()},Ze.prototype._StartComposition=function(){if(!this.in_composition)return this.in_composition=!0,this._ShowComposition(),setTimeout(this._UpdateComposition,0)},Ze.prototype._EndComposition=function(){if(this.in_composition)return this._HideComposition(),this.$prompt_left.text(this.$prompt_left.text()+this.$composition.text()),this.$composition.text(""),this.$input_source.val(""),this.in_composition=!1},Ze.prototype._UpdateComposition=function(Z){var me;return me=function(ke){return function(){if(ke.in_composition)return ke.$composition.text(ke.$input_source.val())}}(this),setTimeout(me,0)},Ze.prototype._ShowComposition=function(){return this.$composition.css("height",this.$prompt_cursor.height()),this.$composition.empty(),this.$composition.appendTo(this.$prompt_left)},Ze.prototype._HideComposition=function(){return this.$composition.detach()},Ze}(),t.fn.jqconsole=function(Ze,Z,me,ke){return new H(this,Ze,Z,me,ke)},t.fn.jqconsole.JQConsole=H,t.fn.jqconsole.Ansi=e}).call(zA)});var KA=D(()=>{(function(t){"use strict";t(window.jQuery)})(function(t,e){"use strict";var r={beforeShow:y,move:y,change:y,show:y,hide:y,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},n=[],i=!!/msie/i.exec(window.navigator.userAgent),a=function(){function L(X,V){return!!~(""+X).indexOf(V)}var H=document.createElement("div"),j=H.style;return j.cssText="background-color:rgba(0,0,0,.5)",L(j.backgroundColor,"rgba")||L(j.backgroundColor,"hsla")}(),s=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),o=function(){var L="";if(i)for(var H=1;H<=6;H++)L+="<div class='sp-"+H+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",L,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function c(L,H,j,X){for(var V=[],ie=0;ie<L.length;ie++){var fe=L[ie];if(fe){var Re=tinycolor(fe),ye=Re.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";ye+=tinycolor.equals(H,fe)?" sp-thumb-active":"";var ze=Re.toString(X.preferredFormat||"rgb"),Ue=a?"background-color:"+Re.toRgbString():"filter:"+Re.toFilter();V.push('<span title="'+ze+'" data-color="'+Re.toRgbString()+'" class="'+ye+'"><span class="sp-thumb-inner" style="'+Ue+';" /></span>')}else{var de="sp-clear-display";V.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="'+de+'"></span>').attr("title",X.noColorSelectedText)).html())}}return"<div class='sp-cf "+j+"'>"+V.join("")+"</div>"}function l(){for(var L=0;L<n.length;L++)n[L]&&n[L].hide()}function f(L,H){var j=t.extend({},r,L);return j.callbacks={move:k(j.move,H),change:k(j.change,H),show:k(j.show,H),hide:k(j.hide,H),beforeShow:k(j.beforeShow,H)},j}function g(L,H){var j=f(H,L),X=j.flat,V=j.showSelectionPalette,ie=j.localStorageKey,fe=j.theme,Re=j.callbacks,ye=F(Wr,10),ze=!1,Ue=!1,de=0,Q=0,Fe=0,We=0,tt=0,Le=0,Tt=0,It=0,St=0,Zt=0,Ze=0,Z=1,me=[],ke=[],we={},st=j.selectionPalette.slice(0),bt=j.maxSelectionSize,vt="sp-dragging",Ee=null,He=L.ownerDocument,zt=He.body,Ge=t(L),at=!1,Ve=t(o,He).addClass(fe),Ae=Ve.find(".sp-picker-container"),lt=Ve.find(".sp-color"),Bt=Ve.find(".sp-dragger"),ct=Ve.find(".sp-hue"),_t=Ve.find(".sp-slider"),re=Ve.find(".sp-alpha-inner"),te=Ve.find(".sp-alpha"),be=Ve.find(".sp-alpha-handle"),De=Ve.find(".sp-input"),dt=Ve.find(".sp-palette"),K=Ve.find(".sp-initial"),le=Ve.find(".sp-cancel"),U=Ve.find(".sp-clear"),Ne=Ve.find(".sp-choose"),Ye=Ve.find(".sp-palette-toggle"),ft=Ge.is("input"),kt=ft&&Ge.attr("type")==="color"&&J(),Et=ft&&!X,Ie=Et?t(s).addClass(fe).addClass(j.className).addClass(j.replacerClassName):t([]),Jt=Et?Ie:Ge,Nt=Ie.find(".sp-preview-inner"),Ot=j.color||ft&&Ge.val(),qr=!1,er=j.preferredFormat,hi=!j.showButtons||j.clickoutFiresChange,mr=!Ot,zr=j.allowEmpty&&!kt;function Pi(){if(j.showPaletteOnly&&(j.showPalette=!0),Ye.text(j.showPaletteOnly?j.togglePaletteMoreText:j.togglePaletteLessText),j.palette){me=j.palette.slice(0),ke=t.isArray(me[0])?me:[me],we={};for(var Dt=0;Dt<ke.length;Dt++)for(var Ht=0;Ht<ke[Dt].length;Ht++){var fr=tinycolor(ke[Dt][Ht]).toRgbString();we[fr]=!0}}Ve.toggleClass("sp-flat",X),Ve.toggleClass("sp-input-disabled",!j.showInput),Ve.toggleClass("sp-alpha-enabled",j.showAlpha),Ve.toggleClass("sp-clear-enabled",zr),Ve.toggleClass("sp-buttons-disabled",!j.showButtons),Ve.toggleClass("sp-palette-buttons-disabled",!j.togglePaletteOnly),Ve.toggleClass("sp-palette-disabled",!j.showPalette),Ve.toggleClass("sp-palette-only",j.showPaletteOnly),Ve.toggleClass("sp-initial-disabled",!j.showInitial),Ve.addClass(j.className).addClass(j.containerClassName),Wr()}function jr(){if(i&&Ve.find("*:not(input)").attr("unselectable","on"),Pi(),Et&&Ge.after(Ie).hide(),zr||U.hide(),X)Ge.after(Ve).hide();else{var Dt=j.appendTo==="parent"?Ge.parent():t(j.appendTo);Dt.length!==1&&(Dt=t("body")),Dt.append(Ve)}rn(),Jt.on("click.spectrum touchstart.spectrum",function(Vt){at||Kt(),Vt.stopPropagation(),t(Vt.target).is("input")||Vt.preventDefault()}),(Ge.is(":disabled")||j.disabled===!0)&&Xa(),Ve.click(A),De.change(Hr),De.on("paste",function(){setTimeout(Hr,1)}),De.keydown(function(Vt){Vt.keyCode==13&&Hr()}),le.text(j.cancelText),le.on("click.spectrum",function(Vt){Vt.stopPropagation(),Vt.preventDefault(),pa(),dn()}),U.attr("title",j.clearText),U.on("click.spectrum",function(Vt){Vt.stopPropagation(),Vt.preventDefault(),mr=!0,ha(),X&&wn(!0)}),Ne.text(j.chooseText),Ne.on("click.spectrum",function(Vt){Vt.stopPropagation(),Vt.preventDefault(),i&&De.is(":focus")&&De.trigger("change"),vi()&&(wn(!0),dn())}),Ye.text(j.showPaletteOnly?j.togglePaletteMoreText:j.togglePaletteLessText),Ye.on("click.spectrum",function(Vt){Vt.stopPropagation(),Vt.preventDefault(),j.showPaletteOnly=!j.showPaletteOnly,!j.showPaletteOnly&&!X&&Ve.css("left","-="+(Ae.outerWidth(!0)+5)),Pi()}),I(te,function(Vt,Pr,nn){Z=Vt/Le,mr=!1,nn.shiftKey&&(Z=Math.round(Z*10)/10),ha()},tr,Jr),I(ct,function(Vt,Pr){St=parseFloat(Pr/We),mr=!1,j.showAlpha||(Z=1),ha()},tr,Jr),I(lt,function(Vt,Pr,nn){if(!nn.shiftKey)Ee=null;else if(!Ee){var Tn=Zt*de,Dn=Q-Ze*Q,Zr=Math.abs(Vt-Tn)>Math.abs(Pr-Dn);Ee=Zr?"x":"y"}var yi=!Ee||Ee==="x",Sn=!Ee||Ee==="y";yi&&(Zt=parseFloat(Vt/de)),Sn&&(Ze=parseFloat((Q-Pr)/Q)),mr=!1,j.showAlpha||(Z=1),ha()},tr,Jr),Ot?(gr(Ot),Ka(),er=j.preferredFormat||tinycolor(Ot).format,Yr(Ot)):Ka(),X&&Er();function Ht(Vt){return Vt.data&&Vt.data.ignore?(gr(t(Vt.target).closest(".sp-thumb-el").data("color")),ha()):(gr(t(Vt.target).closest(".sp-thumb-el").data("color")),ha(),j.hideAfterPaletteSelect?(wn(!0),dn()):wn()),!1}var fr=i?"mousedown.spectrum":"click.spectrum touchstart.spectrum";dt.on(fr,".sp-thumb-el",Ht),K.on(fr,".sp-thumb-el:nth-child(1)",{ignore:!0},Ht)}function rn(){if(ie&&window.localStorage){try{var Dt=window.localStorage[ie].split(",#");Dt.length>1&&(delete window.localStorage[ie],t.each(Dt,function(Ht,fr){Yr(fr)}))}catch{}try{st=window.localStorage[ie].split(";")}catch{}}}function Yr(Dt){if(V){var Ht=tinycolor(Dt).toRgbString();if(!we[Ht]&&t.inArray(Ht,st)===-1)for(st.push(Ht);st.length>bt;)st.shift();if(ie&&window.localStorage)try{window.localStorage[ie]=st.join(";")}catch{}}}function qt(){var Dt=[];if(j.showPalette)for(var Ht=0;Ht<st.length;Ht++){var fr=tinycolor(st[Ht]).toRgbString();we[fr]||Dt.push(st[Ht])}return Dt.reverse().slice(0,j.maxSelectionSize)}function gi(){var Dt=mi(),Ht=t.map(ke,function(fr,Vt){return c(fr,Dt,"sp-palette-row sp-palette-row-"+Vt,j)});rn(),st&&Ht.push(c(qt(),Dt,"sp-palette-row sp-palette-row-selection",j)),dt.html(Ht.join(""))}function Ai(){if(j.showInitial){var Dt=qr,Ht=mi();K.html(c([Dt,Ht],Ht,"sp-palette-row-initial",j))}}function tr(){(Q<=0||de<=0||We<=0)&&Wr(),Ue=!0,Ve.addClass(vt),Ee=null,Ge.trigger("dragstart.spectrum",[mi()])}function Jr(){Ue=!1,Ve.removeClass(vt),Ge.trigger("dragstop.spectrum",[mi()])}function Hr(){var Dt=De.val();if((Dt===null||Dt==="")&&zr)gr(null),ha(),wn();else{var Ht=tinycolor(Dt);Ht.isValid()?(gr(Ht),ha(),wn()):De.addClass("sp-validation-error")}}function Kt(){ze?dn():Er()}function Er(){var Dt=t.Event("beforeShow.spectrum");if(ze){Wr();return}Ge.trigger(Dt,[mi()]),!(Re.beforeShow(mi())===!1||Dt.isDefaultPrevented())&&(l(),ze=!0,t(He).on("keydown.spectrum",ln),t(He).on("click.spectrum",Pn),t(window).on("resize.spectrum",ye),Ie.addClass("sp-active"),Ve.removeClass("sp-hidden"),Wr(),Ka(),qr=mi(),Ai(),Re.show(qr),Ge.trigger("show.spectrum",[qr]))}function ln(Dt){Dt.keyCode===27&&dn()}function Pn(Dt){Dt.button!=2&&(Ue||(hi?wn(!0):pa(),dn()))}function dn(){!ze||X||(ze=!1,t(He).off("keydown.spectrum",ln),t(He).off("click.spectrum",Pn),t(window).off("resize.spectrum",ye),Ie.removeClass("sp-active"),Ve.addClass("sp-hidden"),Re.hide(mi()),Ge.trigger("hide.spectrum",[mi()]))}function pa(){gr(qr,!0),wn(!0)}function gr(Dt,Ht){if(tinycolor.equals(Dt,mi())){Ka();return}var fr,Vt;!Dt&&zr?mr=!0:(mr=!1,fr=tinycolor(Dt),Vt=fr.toHsv(),St=Vt.h%360/360,Zt=Vt.s,Ze=Vt.v,Z=Vt.a),Ka(),fr&&fr.isValid()&&!Ht&&(er=j.preferredFormat||fr.getFormat())}function mi(Dt){return Dt=Dt||{},zr&&mr?null:tinycolor.fromRatio({h:St,s:Zt,v:Ze,a:Math.round(Z*1e3)/1e3},{format:Dt.format||er})}function vi(){return!De.hasClass("sp-validation-error")}function ha(){Ka(),Re.move(mi()),Ge.trigger("move.spectrum",[mi()])}function Ka(){De.removeClass("sp-validation-error"),ro();var Dt=tinycolor.fromRatio({h:St,s:1,v:1});lt.css("background-color",Dt.toHexString());var Ht=er;Z<1&&!(Z===0&&Ht==="name")&&(Ht==="hex"||Ht==="hex3"||Ht==="hex6"||Ht==="name")&&(Ht="rgb");var fr=mi({format:Ht}),Vt="";if(Nt.removeClass("sp-clear-display"),Nt.css("background-color","transparent"),!fr&&zr)Nt.addClass("sp-clear-display");else{var Pr=fr.toHexString(),nn=fr.toRgbString();if(a||fr.alpha===1?Nt.css("background-color",nn):(Nt.css("background-color","transparent"),Nt.css("filter",fr.toFilter())),j.showAlpha){var Tn=fr.toRgb();Tn.a=0;var Dn=tinycolor(Tn).toRgbString(),Zr="linear-gradient(left, "+Dn+", "+Pr+")";i?re.css("filter",tinycolor(Dn).toFilter({gradientType:1},Pr)):(re.css("background","-webkit-"+Zr),re.css("background","-moz-"+Zr),re.css("background","-ms-"+Zr),re.css("background","linear-gradient(to right, "+Dn+", "+Pr+")"))}Vt=fr.toString(Ht)}j.showInput&&De.val(Vt),j.showPalette&&gi(),Ai()}function ro(){var Dt=Zt,Ht=Ze;if(zr&&mr)be.hide(),_t.hide(),Bt.hide();else{be.show(),_t.show(),Bt.show();var fr=Dt*de,Vt=Q-Ht*Q;fr=Math.max(-Fe,Math.min(de-Fe,fr-Fe)),Vt=Math.max(-Fe,Math.min(Q-Fe,Vt-Fe)),Bt.css({top:Vt+"px",left:fr+"px"});var Pr=Z*Le;be.css({left:Pr-Tt/2+"px"});var nn=St*We;_t.css({top:nn-It+"px"})}}function wn(Dt){var Ht=mi(),fr="",Vt=!tinycolor.equals(Ht,qr);Ht&&(fr=Ht.toString(er),Yr(Ht)),ft&&Ge.val(fr),Dt&&Vt&&(Re.change(Ht),Ge.trigger("change",[Ht]))}function Wr(){ze&&(de=lt.width(),Q=lt.height(),Fe=Bt.height(),tt=ct.width(),We=ct.height(),It=_t.height(),Le=te.width(),Tt=be.width(),X||(Ve.css("position","absolute"),j.offset?Ve.offset(j.offset):Ve.offset(m(Ve,Jt))),ro(),j.showPalette&&gi(),Ge.trigger("reflow.spectrum"))}function Qr(){Ge.show(),Jt.off("click.spectrum touchstart.spectrum"),Ve.remove(),Ie.remove(),n[Rn.id]=null}function Ii(Dt,Ht){if(Dt===e)return t.extend({},j);if(Ht===e)return j[Dt];j[Dt]=Ht,Dt==="preferredFormat"&&(er=j.preferredFormat),Pi()}function ps(){at=!1,Ge.attr("disabled",!1),Jt.removeClass("sp-disabled")}function Xa(){dn(),at=!0,Ge.attr("disabled",!0),Jt.addClass("sp-disabled")}function lr(Dt){j.offset=Dt,Wr()}jr();var Rn={show:Er,hide:dn,toggle:Kt,reflow:Wr,option:Ii,enable:ps,disable:Xa,offset:lr,set:function(Dt){gr(Dt),wn()},get:mi,destroy:Qr,container:Ve};return Rn.id=n.push(Rn)-1,Rn}function m(L,H){var j=0,X=L.outerWidth(),V=L.outerHeight(),ie=H.outerHeight(),fe=L[0].ownerDocument,Re=fe.documentElement,ye=Re.clientWidth+t(fe).scrollLeft(),ze=Re.clientHeight+t(fe).scrollTop(),Ue=H.offset(),de=Ue.left,Q=Ue.top;return Q+=ie,de-=Math.min(de,de+X>ye&&ye>X?Math.abs(de+X-ye):0),Q-=Math.min(Q,Q+V>ze&&ze>V?Math.abs(V+ie-j):j),{top:Q,bottom:Ue.bottom,left:de,right:Ue.right,width:Ue.width,height:Ue.height}}function y(){}function A(L){L.stopPropagation()}function k(L,H){var j=Array.prototype.slice,X=j.call(arguments,2);return function(){return L.apply(H,X.concat(j.call(arguments)))}}function I(L,H,j,X){H=H||function(){},j=j||function(){},X=X||function(){};var V=document,ie=!1,fe={},Re=0,ye=0,ze="ontouchstart"in window,Ue={};Ue.selectstart=de,Ue.dragstart=de,Ue["touchmove mousemove"]=Q,Ue["touchend mouseup"]=We;function de(tt){tt.stopPropagation&&tt.stopPropagation(),tt.preventDefault&&tt.preventDefault(),tt.returnValue=!1}function Q(tt){if(ie){if(i&&V.documentMode<9&&!tt.button)return We();var Le=tt.originalEvent&&tt.originalEvent.touches&&tt.originalEvent.touches[0],Tt=Le&&Le.pageX||tt.pageX,It=Le&&Le.pageY||tt.pageY,St=Math.max(0,Math.min(Tt-fe.left,ye)),Zt=Math.max(0,Math.min(It-fe.top,Re));ze&&de(tt),H.apply(L,[St,Zt,tt])}}function Fe(tt){var Le=tt.which?tt.which==3:tt.button==2;!Le&&!ie&&j.apply(L,arguments)!==!1&&(ie=!0,Re=t(L).height(),ye=t(L).width(),fe=t(L).offset(),t(V).on(Ue),t(V.body).addClass("sp-dragging"),Q(tt),de(tt))}function We(){ie&&(t(V).off(Ue),t(V.body).removeClass("sp-dragging"),setTimeout(function(){X.apply(L,arguments)},0)),ie=!1}t(L).on("touchstart mousedown",Fe)}function F(L,H,j){var X;return function(){var V=this,ie=arguments,fe=function(){X=null,L.apply(V,ie)};j&&clearTimeout(X),(j||!X)&&(X=setTimeout(fe,H))}}function J(){return t.fn.spectrum.inputTypeColorSupport()}var pe="spectrum.id";t.fn.spectrum=function(L,H){if(typeof L=="string"){var j=this,X=Array.prototype.slice.call(arguments,1);return this.each(function(){var V=n[t(this).data(pe)];if(V){var ie=V[L];if(!ie)throw new Error("Spectrum: no such method: '"+L+"'");L=="get"?j=V.get():L=="container"?j=V.container:L=="option"?j=V.option.apply(V,X):L=="destroy"?(V.destroy(),t(this).removeData(pe)):ie.apply(V,X)}}),j}return this.spectrum("destroy").each(function(){var V=t.extend({},t(this).data(),L),ie=g(this,V);t(this).data(pe,ie.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=I,t.fn.spectrum.defaults=r,t.fn.spectrum.inputTypeColorSupport=function L(){if(typeof L._cachedResult>"u"){var H=t("<input type='color'/>")[0];L._cachedResult=H.type==="color"&&H.value!==""}return L._cachedResult},t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){var L=t("input[type=color]");L.length&&!J()&&L.spectrum({preferredFormat:"hex6"})},function(){var L=/^[\s,#]+/,H=/\s+$/,j=0,X=Math,V=X.round,ie=X.min,fe=X.max,Re=X.random,ye=function(K,le){if(K=K||"",le=le||{},K instanceof ye)return K;if(!(this instanceof ye))return new ye(K,le);var U=ze(K);this._originalInput=K,this._r=U.r,this._g=U.g,this._b=U.b,this._a=U.a,this._roundA=V(1e3*this._a)/1e3,this._format=le.format||U.format,this._gradientType=le.gradientType,this._r<1&&(this._r=V(this._r)),this._g<1&&(this._g=V(this._g)),this._b<1&&(this._b=V(this._b)),this._ok=U.ok,this._tc_id=j++};ye.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var K=this.toRgb();return(K.r*299+K.g*587+K.b*114)/1e3},setAlpha:function(K){return this._a=at(K),this._roundA=V(1e3*this._a)/1e3,this},toHsv:function(){var K=Fe(this._r,this._g,this._b);return{h:K.h*360,s:K.s,v:K.v,a:this._a}},toHsvString:function(){var K=Fe(this._r,this._g,this._b),le=V(K.h*360),U=V(K.s*100),Ne=V(K.v*100);return this._a==1?"hsv("+le+", "+U+"%, "+Ne+"%)":"hsva("+le+", "+U+"%, "+Ne+"%, "+this._roundA+")"},toHsl:function(){var K=de(this._r,this._g,this._b);return{h:K.h*360,s:K.s,l:K.l,a:this._a}},toHslString:function(){var K=de(this._r,this._g,this._b),le=V(K.h*360),U=V(K.s*100),Ne=V(K.l*100);return this._a==1?"hsl("+le+", "+U+"%, "+Ne+"%)":"hsla("+le+", "+U+"%, "+Ne+"%, "+this._roundA+")"},toHex:function(K){return tt(this._r,this._g,this._b,K)},toHexString:function(K){return"#"+this.toHex(K)},toHex8:function(){return Le(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:V(this._r),g:V(this._g),b:V(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+V(this._r)+", "+V(this._g)+", "+V(this._b)+")":"rgba("+V(this._r)+", "+V(this._g)+", "+V(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:V(Ve(this._r,255)*100)+"%",g:V(Ve(this._g,255)*100)+"%",b:V(Ve(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+V(Ve(this._r,255)*100)+"%, "+V(Ve(this._g,255)*100)+"%, "+V(Ve(this._b,255)*100)+"%)":"rgba("+V(Ve(this._r,255)*100)+"%, "+V(Ve(this._g,255)*100)+"%, "+V(Ve(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:zt[tt(this._r,this._g,this._b,!0)]||!1},toFilter:function(K){var le="#"+Le(this._r,this._g,this._b,this._a),U=le,Ne=this._gradientType?"GradientType = 1, ":"";if(K){var Ye=ye(K);U=Ye.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+Ne+"startColorstr="+le+",endColorstr="+U+")"},toString:function(K){var le=!!K;K=K||this._format;var U=!1,Ne=this._a<1&&this._a>=0,Ye=!le&&Ne&&(K==="hex"||K==="hex6"||K==="hex3"||K==="name");return Ye?K==="name"&&this._a===0?this.toName():this.toRgbString():(K==="rgb"&&(U=this.toRgbString()),K==="prgb"&&(U=this.toPercentageRgbString()),(K==="hex"||K==="hex6")&&(U=this.toHexString()),K==="hex3"&&(U=this.toHexString(!0)),K==="hex8"&&(U=this.toHex8String()),K==="name"&&(U=this.toName()),K==="hsl"&&(U=this.toHslString()),K==="hsv"&&(U=this.toHsvString()),U||this.toHexString())},_applyModification:function(K,le){var U=K.apply(null,[this].concat([].slice.call(le)));return this._r=U._r,this._g=U._g,this._b=U._b,this.setAlpha(U._a),this},lighten:function(){return this._applyModification(Zt,arguments)},brighten:function(){return this._applyModification(Ze,arguments)},darken:function(){return this._applyModification(Z,arguments)},desaturate:function(){return this._applyModification(Tt,arguments)},saturate:function(){return this._applyModification(It,arguments)},greyscale:function(){return this._applyModification(St,arguments)},spin:function(){return this._applyModification(me,arguments)},_applyCombination:function(K,le){return K.apply(null,[this].concat([].slice.call(le)))},analogous:function(){return this._applyCombination(vt,arguments)},complement:function(){return this._applyCombination(ke,arguments)},monochromatic:function(){return this._applyCombination(Ee,arguments)},splitcomplement:function(){return this._applyCombination(bt,arguments)},triad:function(){return this._applyCombination(we,arguments)},tetrad:function(){return this._applyCombination(st,arguments)}},ye.fromRatio=function(K,le){if(typeof K=="object"){var U={};for(var Ne in K)K.hasOwnProperty(Ne)&&(Ne==="a"?U[Ne]=K[Ne]:U[Ne]=re(K[Ne]));K=U}return ye(K,le)};function ze(K){var le={r:0,g:0,b:0},U=1,Ne=!1,Ye=!1;return typeof K=="string"&&(K=dt(K)),typeof K=="object"&&(K.hasOwnProperty("r")&&K.hasOwnProperty("g")&&K.hasOwnProperty("b")?(le=Ue(K.r,K.g,K.b),Ne=!0,Ye=String(K.r).substr(-1)==="%"?"prgb":"rgb"):K.hasOwnProperty("h")&&K.hasOwnProperty("s")&&K.hasOwnProperty("v")?(K.s=re(K.s),K.v=re(K.v),le=We(K.h,K.s,K.v),Ne=!0,Ye="hsv"):K.hasOwnProperty("h")&&K.hasOwnProperty("s")&&K.hasOwnProperty("l")&&(K.s=re(K.s),K.l=re(K.l),le=Q(K.h,K.s,K.l),Ne=!0,Ye="hsl"),K.hasOwnProperty("a")&&(U=K.a)),U=at(U),{ok:Ne,format:K.format||Ye,r:ie(255,fe(le.r,0)),g:ie(255,fe(le.g,0)),b:ie(255,fe(le.b,0)),a:U}}function Ue(K,le,U){return{r:Ve(K,255)*255,g:Ve(le,255)*255,b:Ve(U,255)*255}}function de(K,le,U){K=Ve(K,255),le=Ve(le,255),U=Ve(U,255);var Ne=fe(K,le,U),Ye=ie(K,le,U),ft,kt,Et=(Ne+Ye)/2;if(Ne==Ye)ft=kt=0;else{var Ie=Ne-Ye;switch(kt=Et>.5?Ie/(2-Ne-Ye):Ie/(Ne+Ye),Ne){case K:ft=(le-U)/Ie+(le<U?6:0);break;case le:ft=(U-K)/Ie+2;break;case U:ft=(K-le)/Ie+4;break}ft/=6}return{h:ft,s:kt,l:Et}}function Q(K,le,U){var Ne,Ye,ft;K=Ve(K,360),le=Ve(le,100),U=Ve(U,100);function kt(Jt,Nt,Ot){return Ot<0&&(Ot+=1),Ot>1&&(Ot-=1),Ot<1/6?Jt+(Nt-Jt)*6*Ot:Ot<1/2?Nt:Ot<2/3?Jt+(Nt-Jt)*(2/3-Ot)*6:Jt}if(le===0)Ne=Ye=ft=U;else{var Et=U<.5?U*(1+le):U+le-U*le,Ie=2*U-Et;Ne=kt(Ie,Et,K+1/3),Ye=kt(Ie,Et,K),ft=kt(Ie,Et,K-1/3)}return{r:Ne*255,g:Ye*255,b:ft*255}}function Fe(K,le,U){K=Ve(K,255),le=Ve(le,255),U=Ve(U,255);var Ne=fe(K,le,U),Ye=ie(K,le,U),ft,kt,Et=Ne,Ie=Ne-Ye;if(kt=Ne===0?0:Ie/Ne,Ne==Ye)ft=0;else{switch(Ne){case K:ft=(le-U)/Ie+(le<U?6:0);break;case le:ft=(U-K)/Ie+2;break;case U:ft=(K-le)/Ie+4;break}ft/=6}return{h:ft,s:kt,v:Et}}function We(K,le,U){K=Ve(K,360)*6,le=Ve(le,100),U=Ve(U,100);var Ne=X.floor(K),Ye=K-Ne,ft=U*(1-le),kt=U*(1-Ye*le),Et=U*(1-(1-Ye)*le),Ie=Ne%6,Jt=[U,kt,ft,ft,Et,U][Ie],Nt=[Et,U,U,kt,ft,ft][Ie],Ot=[ft,ft,Et,U,U,kt][Ie];return{r:Jt*255,g:Nt*255,b:Ot*255}}function tt(K,le,U,Ne){var Ye=[_t(V(K).toString(16)),_t(V(le).toString(16)),_t(V(U).toString(16))];return Ne&&Ye[0].charAt(0)==Ye[0].charAt(1)&&Ye[1].charAt(0)==Ye[1].charAt(1)&&Ye[2].charAt(0)==Ye[2].charAt(1)?Ye[0].charAt(0)+Ye[1].charAt(0)+Ye[2].charAt(0):Ye.join("")}function Le(K,le,U,Ne){var Ye=[_t(te(Ne)),_t(V(K).toString(16)),_t(V(le).toString(16)),_t(V(U).toString(16))];return Ye.join("")}ye.equals=function(K,le){return!K||!le?!1:ye(K).toRgbString()==ye(le).toRgbString()},ye.random=function(){return ye.fromRatio({r:Re(),g:Re(),b:Re()})};function Tt(K,le){le=le===0?0:le||10;var U=ye(K).toHsl();return U.s-=le/100,U.s=Ae(U.s),ye(U)}function It(K,le){le=le===0?0:le||10;var U=ye(K).toHsl();return U.s+=le/100,U.s=Ae(U.s),ye(U)}function St(K){return ye(K).desaturate(100)}function Zt(K,le){le=le===0?0:le||10;var U=ye(K).toHsl();return U.l+=le/100,U.l=Ae(U.l),ye(U)}function Ze(K,le){le=le===0?0:le||10;var U=ye(K).toRgb();return U.r=fe(0,ie(255,U.r-V(255*-(le/100)))),U.g=fe(0,ie(255,U.g-V(255*-(le/100)))),U.b=fe(0,ie(255,U.b-V(255*-(le/100)))),ye(U)}function Z(K,le){le=le===0?0:le||10;var U=ye(K).toHsl();return U.l-=le/100,U.l=Ae(U.l),ye(U)}function me(K,le){var U=ye(K).toHsl(),Ne=(V(U.h)+le)%360;return U.h=Ne<0?360+Ne:Ne,ye(U)}function ke(K){var le=ye(K).toHsl();return le.h=(le.h+180)%360,ye(le)}function we(K){var le=ye(K).toHsl(),U=le.h;return[ye(K),ye({h:(U+120)%360,s:le.s,l:le.l}),ye({h:(U+240)%360,s:le.s,l:le.l})]}function st(K){var le=ye(K).toHsl(),U=le.h;return[ye(K),ye({h:(U+90)%360,s:le.s,l:le.l}),ye({h:(U+180)%360,s:le.s,l:le.l}),ye({h:(U+270)%360,s:le.s,l:le.l})]}function bt(K){var le=ye(K).toHsl(),U=le.h;return[ye(K),ye({h:(U+72)%360,s:le.s,l:le.l}),ye({h:(U+216)%360,s:le.s,l:le.l})]}function vt(K,le,U){le=le||6,U=U||30;var Ne=ye(K).toHsl(),Ye=360/U,ft=[ye(K)];for(Ne.h=(Ne.h-(Ye*le>>1)+720)%360;--le;)Ne.h=(Ne.h+Ye)%360,ft.push(ye(Ne));return ft}function Ee(K,le){le=le||6;for(var U=ye(K).toHsv(),Ne=U.h,Ye=U.s,ft=U.v,kt=[],Et=1/le;le--;)kt.push(ye({h:Ne,s:Ye,v:ft})),ft=(ft+Et)%1;return kt}ye.mix=function(K,le,U){U=U===0?0:U||50;var Ne=ye(K).toRgb(),Ye=ye(le).toRgb(),ft=U/100,kt=ft*2-1,Et=Ye.a-Ne.a,Ie;kt*Et==-1?Ie=kt:Ie=(kt+Et)/(1+kt*Et),Ie=(Ie+1)/2;var Jt=1-Ie,Nt={r:Ye.r*Ie+Ne.r*Jt,g:Ye.g*Ie+Ne.g*Jt,b:Ye.b*Ie+Ne.b*Jt,a:Ye.a*ft+Ne.a*(1-ft)};return ye(Nt)},ye.readability=function(K,le){var U=ye(K),Ne=ye(le),Ye=U.toRgb(),ft=Ne.toRgb(),kt=U.getBrightness(),Et=Ne.getBrightness(),Ie=Math.max(Ye.r,ft.r)-Math.min(Ye.r,ft.r)+Math.max(Ye.g,ft.g)-Math.min(Ye.g,ft.g)+Math.max(Ye.b,ft.b)-Math.min(Ye.b,ft.b);return{brightness:Math.abs(kt-Et),color:Ie}},ye.isReadable=function(K,le){var U=ye.readability(K,le);return U.brightness>125&&U.color>500},ye.mostReadable=function(K,le){for(var U=null,Ne=0,Ye=!1,ft=0;ft<le.length;ft++){var kt=ye.readability(K,le[ft]),Et=kt.brightness>125&&kt.color>500,Ie=3*(kt.brightness/125)+kt.color/500;(Et&&!Ye||Et&&Ye&&Ie>Ne||!Et&&!Ye&&Ie>Ne)&&(Ye=Et,Ne=Ie,U=ye(le[ft]))}return U};var He=ye.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},zt=ye.hexNames=Ge(He);function Ge(K){var le={};for(var U in K)K.hasOwnProperty(U)&&(le[K[U]]=U);return le}function at(K){return K=parseFloat(K),(isNaN(K)||K<0||K>1)&&(K=1),K}function Ve(K,le){Bt(K)&&(K="100%");var U=ct(K);return K=ie(le,fe(0,parseFloat(K))),U&&(K=parseInt(K*le,10)/100),X.abs(K-le)<1e-6?1:K%le/parseFloat(le)}function Ae(K){return ie(1,fe(0,K))}function lt(K){return parseInt(K,16)}function Bt(K){return typeof K=="string"&&K.indexOf(".")!=-1&&parseFloat(K)===1}function ct(K){return typeof K=="string"&&K.indexOf("%")!=-1}function _t(K){return K.length==1?"0"+K:""+K}function re(K){return K<=1&&(K=K*100+"%"),K}function te(K){return Math.round(parseFloat(K)*255).toString(16)}function be(K){return lt(K)/255}var De=function(){var K="[-\\+]?\\d+%?",le="[-\\+]?\\d*\\.\\d+%?",U="(?:"+le+")|(?:"+K+")",Ne="[\\s|\\(]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")\\s*\\)?",Ye="[\\s|\\(]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")[,|\\s]+("+U+")\\s*\\)?";return{rgb:new RegExp("rgb"+Ne),rgba:new RegExp("rgba"+Ye),hsl:new RegExp("hsl"+Ne),hsla:new RegExp("hsla"+Ye),hsv:new RegExp("hsv"+Ne),hsva:new RegExp("hsva"+Ye),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function dt(K){K=K.replace(L,"").replace(H,"").toLowerCase();var le=!1;if(He[K])K=He[K],le=!0;else if(K=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var U;return(U=De.rgb.exec(K))?{r:U[1],g:U[2],b:U[3]}:(U=De.rgba.exec(K))?{r:U[1],g:U[2],b:U[3],a:U[4]}:(U=De.hsl.exec(K))?{h:U[1],s:U[2],l:U[3]}:(U=De.hsla.exec(K))?{h:U[1],s:U[2],l:U[3],a:U[4]}:(U=De.hsv.exec(K))?{h:U[1],s:U[2],v:U[3]}:(U=De.hsva.exec(K))?{h:U[1],s:U[2],v:U[3],a:U[4]}:(U=De.hex8.exec(K))?{a:be(U[1]),r:lt(U[2]),g:lt(U[3]),b:lt(U[4]),format:le?"name":"hex8"}:(U=De.hex6.exec(K))?{r:lt(U[1]),g:lt(U[2]),b:lt(U[3]),format:le?"name":"hex"}:(U=De.hex3.exec(K))?{r:lt(U[1]+""+U[1]),g:lt(U[2]+""+U[2]),b:lt(U[3]+""+U[3]),format:le?"name":"hex"}:!1}window.tinycolor=ye}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})})});var XA=D(()=>{function tp(t){var e=t&&t.e?t.e:null,r=t?!!t.guess:!0,n=new tp.implementation,i=n.run(e);return r?n.guessFunctions(i):i}tp.implementation=function(){};tp.implementation.prototype={run:function(t){t=t||function(){try{var r=__undef__<<1}catch(n){return n}}();var e=this._mode||this.mode(t);return e==="other"?this.other(arguments.callee):this[e](t)},mode:function(t){return t.arguments?this._mode="chrome":window.opera&&t.stacktrace?this._mode="opera10":t.stack?this._mode="firefox":window.opera&&!("stacktrace"in t)?this._mode="opera":this._mode="other"},instrumentFunction:function(t,e,r){t=t||window,t["_old"+e]=t[e],t[e]=function(){return r.call(this,tp()),t["_old"+e].apply(this,arguments)},t[e]._instrumented=!0},deinstrumentFunction:function(t,e){t[e].constructor===Function&&t[e]._instrumented&&t["_old"+e].constructor===Function&&(t[e]=t["_old"+e])},chrome:function(t){return t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@").split(`
`)},firefox:function(t){return t.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split(`
`)},opera10:function(t){var e=t.stacktrace,r=e.split(`
`),n="{anonymous}",i=/.*line (\d+), column (\d+) in ((<anonymous function\:?\s*(\S+))|([^\(]+)\([^\)]*\))(?: in )?(.*)\s*$/i,a,s,o;for(a=2,s=0,o=r.length;a<o-2;a++)if(i.test(r[a])){var c=RegExp.$6+":"+RegExp.$1+":"+RegExp.$2,l=RegExp.$3;l=l.replace(/<anonymous function\:?\s?(\S+)?>/g,n),r[s++]=l+"@"+c}return r.splice(s,r.length-s),r},opera:function(t){var e=t.message.split(`
`),r="{anonymous}",n=/Line\s+(\d+).*script\s+(http\S+)(?:.*in\s+function\s+(\S+))?/i,i,a,s;for(i=4,a=0,s=e.length;i<s;i+=2)n.test(e[i])&&(e[a++]=(RegExp.$3?RegExp.$3+"()@"+RegExp.$2+RegExp.$1:r+"()@"+RegExp.$2+":"+RegExp.$1)+" -- "+e[i+1].replace(/^\s+/,""));return e.splice(a,e.length-a),e},other:function(t){for(var e="{anonymous}",r=/function\s*([\w\-$]+)?\s*\(/i,n=[],i=0,a,s,o=10;t&&n.length<o;)a=r.test(t.toString())&&RegExp.$1||e,s=Array.prototype.slice.call(t.arguments),n[i++]=a+"("+this.stringifyArguments(s)+")",t=t.caller;return n},stringifyArguments:function(t){for(var e=0;e<t.length;++e){var r=t[e];r===void 0?t[e]="undefined":r===null?t[e]="null":r.constructor&&(r.constructor===Array?r.length<3?t[e]="["+this.stringifyArguments(r)+"]":t[e]="["+this.stringifyArguments(Array.prototype.slice.call(r,0,1))+"..."+this.stringifyArguments(Array.prototype.slice.call(r,-1))+"]":r.constructor===Object?t[e]="#object":r.constructor===Function?t[e]="#function":r.constructor===String&&(t[e]='"'+r+'"'))}return t.join(",")},sourceCache:{},ajax:function(t){var e=this.createXMLHTTPObject();if(e)return e.open("GET",t,!1),e.setRequestHeader("User-Agent","XMLHTTP/1.0"),e.send(""),e.responseText},createXMLHTTPObject:function(){for(var t,e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],r=0;r<e.length;r++)try{return t=e[r](),this.createXMLHTTPObject=e[r],t}catch{}},isSameDomain:function(t){return t.indexOf(location.hostname)!==-1},getSource:function(t){return t in this.sourceCache||(this.sourceCache[t]=this.ajax(t).split(`
`)),this.sourceCache[t]},guessFunctions:function(t){for(var e=0;e<t.length;++e){var r=/\{anonymous\}\(.*\)@(\w+:\/\/([\-\w\.]+)+(:\d+)?[^:]+):(\d+):?(\d+)?/,n=t[e],i=r.exec(n);if(i){var a=i[1],s=i[4];if(a&&this.isSameDomain(a)&&s){var o=this.guessFunctionName(a,s);t[e]=n.replace("{anonymous}",o)}}}return t},guessFunctionName:function(t,e){try{return this.guessFunctionNameFromLines(e,this.getSource(t))}catch(r){return"getSource failed with url: "+t+", exception: "+r.toString()}},guessFunctionNameFromLines:function(t,e){for(var r=/function ([^(]*)\(([^)]*)\)/,n=/['"]?([0-9A-Za-z_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,i="",a=10,s=0;s<a;++s)if(i=e[t-s]+i,i!==void 0){var o=n.exec(i);if(o&&o[1])return o[1];if(o=r.exec(i),o&&o[1])return o[1]}return"(?)"}};window.printStackTrace=tp});var YA=D(()=>{window.jslint=function(){"use strict";function e(){return Object.create(null)}function r(O,q,ae){q.forEach(function($e){O[$e]=ae})}var n={bitwise:!0,browser:["Audio","clearInterval","clearTimeout","document","event","FormData","frames","history","Image","localStorage","location","name","navigator","Option","parent","screen","sessionStorage","setInterval","setTimeout","Storage","XMLHttpRequest"],couch:["emit","getRow","isArray","log","provides","registerType","require","send","start","sum","toJSON"],devel:["alert","confirm","console","Debug","opera","prompt","WSH"],es6:["ArrayBuffer","DataView","Float32Array","Float64Array","Generator","GeneratorFunction","Int8Array","Int16Array","Int32Array","Intl","Map","Promise","Proxy","Reflect","Set","Symbol","System","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","WeakSet"],eval:!0,for:!0,fudge:!0,maxerr:1e4,maxlen:1e4,node:["Buffer","clearImmediate","clearInterval","clearTimeout","console","exports","global","module","process","require","setImmediate","setInterval","setTimeout","__dirname","__filename"],this:!0,white:!0},i={"!=":!0,"!==":!0,"%":!0,"%=":!0,"^":!0,"^=":!0,"&":!0,"&=":!0,"&&":!0,"*":!0,"*=":!0,"-=":!0,"+=":!0,"=":!0,"=>":!0,"==":!0,"===":!0,"|":!0,"|=":!0,"||":!0,"<":!0,"<=":!0,"<<":!0,"<<=":!0,">":!0,">=":!0,">>":!0,">>=":!0,">>>":!0,">>>=":!0},a={"~":!0,"^":!0,"^=":!0,"&":!0,"&=":!0,"|":!0,"|=":!0,"<<":!0,"<<=":!0,">>":!0,">>=":!0,">>>":!0,">>>=":!0},s={"(":")","[":"]","{":"}","${":"}"},o={"!=":!0,"!==":!0,"==":!0,"===":!0,"<":!0,"<=":!0,">":!0,">=":!0},c=["Array","Boolean","Date","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","Error","EvalError","Function","isFinite","isNaN","JSON","Math","Number","Object","parseInt","parseFloat","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError"],l={and:"The '&&' subexpression should be wrapped in parens.",bad_assignment_a:"Bad assignment to '{a}'.",bad_character_number_a:"Bad character code: '{a}'",bad_get:"A get function takes no parameters.",bad_module_name_a:"Bad module name '{a}'.",bad_option_a:"Bad option '{a}'.",bad_property_a:"Bad property name '{a}'.",bad_set:"A set function takes one parameter.",duplicate_a:"Duplicate '{a}'.",empty_block:"Empty block.",es6:"Unexpected ES6 feature.",expected_a_at_b_c:"Expected '{a}' at column {b}, not column {c}.",expected_a_b:"Expected '{a}' and instead saw '{b}'.",expected_a_b_from_c_d:"Expected '{a}' to match '{b}' from line {c} and instead saw '{d}'.",expected_a_before_b:"Expected '{a}' before '{b}'.",expected_digits_after_a:"Expected digits after '{a}'.",expected_four_digits:"Expected four digits after '\\u'.",expected_identifier_a:"Expected an identifier and instead saw '{a}'.",expected_line_break_a_b:"Expected a line break between '{a}' and '{b}'.",expected_regexp_factor_a:"Expected a regexp factor and instead saw '{a}'.",expected_space_a_b:"Expected one space between '{a}' and '{b}'.",expected_string_a:"Expected a string and instead saw '{a}'.",expected_type_string_a:"Expected a type string and instead saw '{a}'.",function_in_loop:"Don't make functions within a loop.",infix_in:"Unexpected 'in'. Compare with undefined, or use the hasOwnProperty method instead.",isNaN:"Use the isNaN function to compare with NaN.",label_a:"'{a}' is a statement label.",misplaced_a:"Place '{a}' at the outermost level.",misplaced_directive_a:"Place the '/*{a}*/' directive before the first statement.",naked_block:"Naked block.",nested_comment:"Nested comment.",not_label_a:"'{a}' is not a label.",out_of_scope_a:"'{a}' is out of scope.",redefinition_a_b:"Redefinition of '{a}' from line {b}.",reserved_a:"Reserved name '{a}'.",slash_equal:"A regular expression literal can be confused with '/='.",stopping:"Stopping.",subscript_a:"['{a}'] is better written in dot notation.",todo_comment:"Unexpected TODO comment.",too_long:"Line too long.",too_many:"Too many warnings.",unclosed_comment:"Unclosed comment.",unclosed_mega:"Unclosed mega literal.",unclosed_string:"Unclosed string.",undeclared_a:"Undeclared '{a}'.",unexpected_a:"Unexpected '{a}'.",unexpected_a_after_b:"Unexpected '{a}' after '{b}'.",unexpected_at_top_level_a:"Unexpected '{a}' at top level.",unexpected_char_a:"Unexpected character '{a}'.",unexpected_comment:"Unexpected comment.",unexpected_directive_a:"When using modules, don't use directive '/*{a}'.",unexpected_expression_a:"Unexpected expression '{a}' in statement position.",unexpected_label_a:"Unexpected label '{a}'.",unexpected_quotes_a:"Quotes are not needed around '{a}'.",unexpected_parens:"Don't wrap function literals in parens.",unexpected_space_a_b:"Unexpected space between '{a}' and '{b}'.",unexpected_statement_a:"Unexpected statement '{a}' in expression position.",unexpected_trailing_space:"Unexpected trailing space.",unexpected_typeof_a:"Unexpected 'typeof'. Use '===' to compare directly with {a}.",uninitialized_a:"Uninitialized '{a}'.",unreachable_a:"Unreachable '{a}'.",unregistered_property_a:"Unregistered property name '{a}'.",unsafe:"Unsafe character '{a}'.",unused_a:"Unused '{a}'.",use_spaces:"Use spaces, not tabs.",var_loop:"Don't declare variables in a loop.",var_switch:"Don't declare variables in a switch.",weird_condition_a:"Weird condition '{a}'.",weird_expression_a:"Weird expression '{a}'.",weird_loop:"Weird loop.",weird_relation_a:"Weird relation '{a}'.",wrap_immediate:"Wrap an immediate function invocation in parentheses to assist the reader in understanding that the expression is the result of a function, and not the function itself.",wrap_regexp:"Wrap this regexp in parens to avoid confusion."},f=/\{([^{}]*)\}/g,g=/\n|\r\n?/,m=/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/,y=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/,A=/^_|\$|Sync$|_$/,k=/[a-zA-Z0-9]/,I=/\*\//,F=/\/\*/,J=/\/\*|\/$/,pe=/\b(?:todo|TO\s?DO|HACK)\b/,L=/\t/g,H=/^(jslint|property|global)\s*(.*)$/,j=/^([a-zA-Z$_][a-zA-Z0-9$_]*)\s*(?::\s*(true|false|[0-9]+)\s*)?(?:,\s*)?(.*)$/,X=/^((\s+)|([a-zA-Z_$][a-zA-Z0-9_$]*)|[(){}\[\]\?,:;'"~`]|=(?:==?|>)?|\.+|\/[=*\/]?|\*[\/=]?|\+(?:=|\++)?|-(?:=|-+)?|[\^%]=?|&[&=]?|\|[\|=]?|>{1,3}=?|<<?=?|!={0,2}|(0|[1-9][0-9]*))(.*)$/,V=/^([0-9]+)(.*)$/,ie=/^([0-9a-fA-F]+)(.*)$/,fe=/^([0-7]+)(.*)$/,Re=/^([01]+)(.*)$/,ye=/`|\$\{/,ze=/^(.*)\?([:.]*)$/,Ue=/\.$/,de=/^-?\d+(?:\.\d*)?(?:e[\-+]?\d+)?$/i;function Q(O){return O>="a"&&O<="z\uFFFF"||O>="A"&&O<="Z\uFFFF"}function Fe(O,q){return O.replace(f,function(ae,$e){var Ke=q[$e];return Ke!==void 0?Ke:ae})}var We="anonymous",tt,Le,Tt,It,St,Zt,Ze,Z,me,ke,we,st,bt,vt,Ee,He,zt,Ge,at,Ve,Ae,lt,Bt,ct,_t,re,te;function be(O){return O===void 0&&(O=Ee),O.id==="(string)"||O.id==="(number)"?String(O.value):O.id}function De(O){return O===void 0&&(O=Ee),O.line+Ze}function dt(O){return O===void 0&&(O=Ee),O.from+Ze}function K(O,q,ae,$e,Ke,pt,Wt){var Rr={name:"JSLintError",column:ae,line:q,code:O};return $e!==void 0&&(Rr.a=$e),Ke!==void 0&&(Rr.b=Ke),pt!==void 0&&(Rr.c=pt),Wt!==void 0&&(Rr.d=Wt),Rr.message=Fe(l[O]||O,Rr),te.push(Rr),typeof He.maxerr=="number"&&te.length===He.maxerr?le("too_many",q,ae):Rr}function le(O,q,ae,$e,Ke,pt,Wt){throw K(O,q,ae,$e,Ke,pt,Wt),K("stopping",q,ae)}function U(O,q,ae,$e,Ke,pt){if(q===void 0&&(q=Ee),q.warning===void 0)return q.warning=K(O,q.line,q.from,ae||be(q),$e,Ke,pt),q.warning}function Ne(O,q,ae,$e,Ke,pt){throw q===void 0&&(q=Ee),q.warning=void 0,U(O,q,ae,$e,Ke,pt),q.warning=void 0,U("stopping",q,ae,$e,Ke,pt)}function Ye(O){bt=Array.isArray(O)?O:O.split(g),Bt=[];var q,ae=0,$e,Ke=-1,pt=ke,Wt=ke,Rr,xt,Qt,Lt;function zn(){var jt;return ae=0,Ke+=1,Lt=bt[Ke],Lt!==void 0&&(jt=Lt.search(L),jt>=0&&(He.white||K("use_spaces",Ke,jt+1),Lt=Lt.replace(L," ")),jt=Lt.search(m),jt>=0&&K("unsafe",Ke,ae+jt,"U+"+Lt.charCodeAt(jt).toString(16)),He.maxlen&&He.maxlen<Lt.length?K("too_long",Ke,Lt.length):!He.white&&Lt.slice(-1)===" "&&K("unexpected_trailing_space",Ke,Lt.length-1)),Lt}function fn(){Qt=Qt.slice(0,-1)}function nr(jt){return jt!==void 0&&q!==jt?le("expected_a_b",Ke,ae,jt,q):(Lt?(q=Lt.charAt(0),Lt=Lt.slice(1),Qt+=q):(q="",Qt+=" "),ae+=1,q)}function Nn(){return Qt?(q=Qt.slice(-1),Lt=q+Lt,ae-=1,fn()):q="",q}function bi(jt,hr){var vr=Lt.match(jt);return vr?(q=vr[1],ae+=q.length,Lt=vr[2],Qt+=q):(q="",hr||K("expected_digits_after_a",Ke,ae,Qt)),q.length}function oi(jt){switch(nr("\\")){case"\\":case"'":case'"':case"/":case":":case"=":case"|":case"b":case"f":case"n":case"r":case"t":case" ":break;case"u":if(nr("u")==="{"){bi(ie)>5&&K("too_many_digits",Ke,ae-1),He.es6||K("es6",Ke,ae),nr()!=="}"&&le("expected_a_before_b",Ke,ae,"}",q);return}Nn(),bi(ie,!0)<4&&K("expected_four_digits",Ke,ae-1);break;case"":return le("unclosed_string",Ke,ae);default:jt&&jt.indexOf(q)<0&&K("unexpected_a_after_b",Ke,ae,q,"\\")}nr()}function Gr(jt,hr,vr){var ti={id:jt,identifier:!!vr,from:$e,thru:ae,line:Ke};return Bt.push(ti),jt!=="(comment)"&&(It=!1),hr!==void 0&&(ti.value=hr),pt.line===Ke&&pt.thru===$e&&(jt==="(comment)"||jt==="(regexp)"||jt==="/")&&(pt.id==="(comment)"||pt.id==="(regexp)")&&U("expected_space_a_b",ti,be(pt),be(ti)),pt.id==="."&&jt==="(number)"&&U("expected_a_before_b",pt,"0","."),Wt.id==="."&&ti.identifier&&(ti.dot=!0),pt=ti,pt.id!=="(comment)"&&(Wt=pt),ti}function Bi(jt,hr){var vr=hr.match(j);if(vr){var ti,xr=vr[1],Dr=vr[2];switch(jt.directive){case"jslint":switch(ti=n[xr],typeof ti){case"boolean":switch(Dr){case"true":case"":case void 0:He[xr]=!0;break;case"false":He[xr]=!1;break;default:U("bad_option_a",jt,xr+":"+Dr)}break;case"number":isFinite(+Dr)?He[xr]=+Dr:U("bad_option_a",jt,xr+":"+Dr);break;case"object":He[xr]=!0,r(Tt,ti,!1);break;default:U("bad_option_a",jt,xr)}break;case"property":ct===void 0&&(ct=e()),ct[xr]=!0;break;case"global":Dr&&U("bad_option_a",jt,xr+":"+Dr),Tt[xr]=!1,vt=jt;break}return Bi(jt,vr[3])}if(hr)return Ne("bad_directive_a",jt,hr)}function ki(jt){var hr=Gr("(comment)",jt);st&&U("unexpected_comment",hr),Array.isArray(jt)&&(jt=jt.join(" ")),!He.devel&&pe.test(jt)&&U("todo_comment",hr);var vr=jt.match(H);return vr&&(It?(hr.directive=vr[1],Bi(hr,vr[2])):K("misplaced_directive_a",Ke,$e,vr[1])),hr}function Xi(){var jt,hr=!1,vr;function ti(){switch(q){case"?":case"*":case"+":nr();break;case"{":bi(V,!0)===0&&K("expected_a",Ke,ae,"0"),nr()===","&&(bi(V,!0),nr()),nr("}");break;default:return}q==="?"&&nr("?")}function xr(){switch(q){case"\\":return oi(),!0;case"[":case"]":case"/":case"^":case"-":case"|":case"":return!1;case"`":return Ge&&K("unexpected_a",Ke,ae,"`"),nr(),!0;case" ":return K("expected_a_before_b",Ke,ae,"\\"," "),nr(),!0;default:return nr(),!0}}function Dr(){if(xr())return q==="-"&&(nr("-"),!xr())?le("unexpected_a",Ke,ae-1,"-"):Dr()}function Ra(){nr("["),q==="^"&&nr("^"),Dr(),nr("]")}function hn(){function Du(){if(nr("("),q==="?")switch(nr("?"),q){case":":case"=":case"!":nr();break;default:nr(":")}else q===":"&&K("expected_a_before_b",Ke,ae,"?",":");hn(),nr(")")}function Mo(){switch(q){case"[":return Ra(),!0;case"\\":return oi("BbDdSsWw^${}[]().|*+?"),!0;case"(":return Du(),!0;case"/":case"|":case"]":case")":case"}":case"{":case"?":case"+":case"*":case"":return!1;case"`":Ge&&K("unexpected_a",Ke,ae,"`");break;case" ":K("expected_a_before_b",Ke,ae,"\\"," ");break}return nr(),!0}function Lu(Uf){if(Mo())return ti(),Lu(!0);Uf||K("expected_regexp_factor_a",Ke,ae,q)}if(Lu(),q==="|")return nr("|"),hn()}Qt="",nr(),q==="="&&K("expected_a_before_b",Ke,ae,"\\","="),hn(),fn(),vr=Qt,nr("/");var No={g:!0,i:!0,m:!0,u:hr,y:He.es6},Ri=e();return function Du(){if(Q(q))return No[q]!==!0&&K("unexpected_a",Ke,ae,q),No[q]=!1,Ri[q]=!0,nr(),Du()}(),hr&&!Ri.u&&K("expected_a_before_b",Ke,ae,"u",q),Nn(),q==="/"||q==="*"?le("unexpected_a",Ke,$e,q):(jt=Gr("(regexp)",q),jt.flag=Ri,jt.value=vr,jt)}function ei(jt){var hr;return Qt="",nr(),function vr(){switch(q){case jt:return fn(),hr=Gr("(string)",Qt),hr.quote=jt,hr;case"\\":oi();break;case"":return le("unclosed_string",Ke,ae);case"`":Ge&&K("unexpected_a",Ke,ae,"`"),nr("`");break;default:nr()}return vr()}()}function pn(){q==="."&&(bi(V),nr()),(q==="E"||q==="e")&&(nr(),q!=="+"&&q!=="-"&&Nn(),bi(V),nr())}function Ac(){if(Qt==="0")switch(nr()){case".":pn();break;case"b":bi(Re),nr();break;case"o":bi(fe),nr();break;case"x":bi(ie),nr();break}else nr(),pn();return q>="0"&&q<="9"||q>="a"&&q<="z"||q>="A"&&q<="Z"?le("unexpected_a_after_b",Ke,ae-1,Qt.slice(-1),Qt.slice(0,-1)):(Nn(),Gr("(number)",Qt))}function Lo(){var jt,hr,vr,ti,xr,Dr;if(!Lt)return Lt=zn(),$e=0,Lt===void 0?Ge?le("unclosed_mega",xt,Rr):Gr("(end)"):Lo();if($e=ae,xr=Lt.match(X),!xr)return le("unexpected_char_a",Ke,ae,Lt.charAt(0));if(Qt=xr[1],ae+=Qt.length,Lt=xr[5],xr[2])return Lo();if(xr[3])return Gr(Qt,void 0,!0);if(xr[4])return Ac(Qt);switch(Qt){case"'":return st&&K("unexpected_a",Ke,ae,"'"),ei("'");case'"':return ei('"');case"`":return Ge?le("expected_a_b",Ke,ae,"}","`"):(Qt="",Rr=$e,xt=Ke,Ge=!0,Gr("`"),$e+=1,function Ra(){var hn=Lt.search(ye);if(hn<0)return Qt+=Lt+`
`,zn()===void 0?le("unclosed_mega",xt,Rr):Ra();if(Qt+=Lt.slice(0,hn),ae+=hn,Lt=Lt.slice(hn),Gr("(string)",Qt).quote="`",Qt="",Lt.charAt(0)==="$")return ae+=2,Gr("${"),Lt=Lt.slice(2),function No(){var Ri=Lo().id;if(Ri==="{")return le("expected_a_b",Ke,ae,"}","{");if(Ri!=="}")return No()}(),Ra()}(),Lt=Lt.slice(1),ae+=1,Ge=!1,Gr("`"));case"//":return Qt=Lt,Lt="",Dr=ki(Qt),Ge&&U("unexpected_comment",Dr,"`"),Dr;case"/*":return jt=[],Lt.charAt(0)==="/"&&K("unexpected_a",Ke,ae+hr,"/"),function Ra(){if(Lt>""){if(hr=Lt.search(I),hr>=0)return;vr=Lt.search(F),vr>=0&&K("nested_comment",Ke,ae+vr)}return jt.push(Lt),Lt=zn(),Lt===void 0?le("unclosed_comment",Ke,ae):Ra()}(),Qt=Lt.slice(0,hr),vr=Qt.search(J),vr>=0&&K("nested_comment",Ke,ae+vr),jt.push(Qt),ae+=hr+2,Lt=Lt.slice(hr+2),ki(jt);case"/":if(Wt.identifier){if(!Wt.dot)switch(Wt.id){case"return":return Xi();case"(begin)":case"case":case"delete":case"in":case"instanceof":case"new":case"typeof":case"void":case"yield":return Dr=Xi(),Ne("unexpected_a",Dr)}}else{if(ti=Wt.id.charAt(Wt.id.length-1),"(,=:?[".indexOf(ti)>=0)return Xi();if("!&|{};~+-*%/^<>".indexOf(ti)>=0)return Dr=Xi(),U("wrap_regexp",Dr),Dr}Lt.charAt(0)==="/"&&(ae+=1,Lt=Lt.slice(1),Qt="/=",K("unexpected_a",Ke,ae,"/="));break}return Gr(Qt)}for(;Lo().id!=="(end)";);}function ft(O){var q=O.id;if(q==="(string)"){if(q=O.value,!y.test(q))return q;if(k.test(q))U("unexpected_quotes_a",O);else return q}else if(!O.identifier)return Ne("expected_identifier_a",O);return typeof zt[q]=="number"?zt[q]+=1:(ct!==void 0?ct[q]!==!0&&U("unregistered_property_a",O):O.identifier&&A.test(q)&&U("bad_property_a",O),zt[q]=1),q}function kt(){var O=Bt[lt];return lt+=1,O.id==="(comment)"?kt():O}function Et(){var O=lt,q=kt(!0);return lt=O,q}function Ie(O,q){if(Ae.identifier&&Ae.id!=="function"?We=Ae.id:Ae.id==="(string)"&&y.test(Ae.value)&&(We=Ae.value),O!==void 0&&Ee.id!==O)return q===void 0?Ne("expected_a_b",Ee,O,be()):Ne("expected_a_b_from_c_d",Ee,O,be(q),De(q),be(Ee));Ae=Ee,Ee=kt(),Ee.id==="(end)"&&(lt-=1)}function Jt(){function O(){var ae=Ee,$e=e();Ie("{"),Ee.id!=="}"&&function Ke(){if(Ie("(string)"),$e[Ae.value]!==void 0?U("duplicate_a",Ae):Ae.value==="__proto__"?U("bad_property_name_a",Ae):$e[Ae.value]=Ae,Ie(":"),Jt(),Ee.id===",")return Ie(","),Ke()}(),Ie("}",ae)}function q(){var ae=Ee;Ie("["),Ee.id!=="]"&&function $e(){if(Jt(),Ee.id===",")return Ie(","),$e()}(),Ie("]",ae)}switch(Ee.id){case"{":O();break;case"[":q();break;case"true":case"false":case"null":Ie();break;case"(number)":de.test(Ee.value)||U("unexpected_a"),Ie();break;case"(string)":Ie();break;case"-":Ie("-"),Ie("(number)");break;default:Ne("unexpected_a")}}function Nt(O,q,ae){var $e=O.id;if(Ve[$e]!==void 0&&$e!=="ignore")U("reserved_a",O);else{var Ke=Z.context[$e];Ke?U("redefinition_a_b",O,O.id,Ke.line+Ze):(at.forEach(function(pt){var Wt=pt.context[$e];Wt!==void 0&&(Ke=Wt)}),Ke&&($e==="ignore"?Ke.role==="variable"&&U("unexpected_a",O):(q!=="exception"||Ke.role!=="exception")&&q!=="parameter"&&q!=="function"&&U("redefinition_a_b",O,O.id,Ke.line+Ze)),Z.context[$e]=O,O.dead=!0,O.function=Z,O.init=!1,O.role=q,O.used=0,O.writable=!ae)}}function Ot(O,q){var ae,$e;if(q||Ie(),$e=Ve[Ae.id],$e!==void 0&&$e.nud!==void 0)ae=$e.nud();else if(Ae.identifier)ae=Ae,ae.arity="variable";else return Ne("unexpected_a",Ae);return function Ke(){if($e=Ve[Ee.id],$e!==void 0&&$e.led!==void 0&&O<$e.lbp)return Ie(),ae=$e.led(ae),Ke()}(),ae}function qr(){var O=Ee,q;switch(O.free=!0,Ie("("),q=Ot(0),Ie(")"),q.wrapped===!0&&U("unexpected_a",O),q.id){case"?":case"~":case"&":case"|":case"^":case"<<":case">>":case">>>":case"+":case"-":case"*":case"/":case"%":case"typeof":case"(number)":case"(string)":U("unexpected_a",q);break}return q}function er(){Ee.id===";"?Ie(";"):K("expected_a_b",Ae.line,Ae.thru,";",be(Ee)),We="anonymous"}function hi(){var O,q,ae,$e;if(Ie(),Ae.identifier&&Ee.id===":")switch(q=Ae,q.id==="ignore"&&U("unexpected_a",q),Ie(":"),Ee.id){case"do":case"for":case"switch":case"while":return Nt(q,"label",!0),q.init=!0,q.dead=!1,ae=hi(),ae.label=q,ae.statement=!0,ae;default:Ie(),U("unexpected_label_a",q)}return O=Ae,O.statement=!0,$e=Ve[O.id],$e!==void 0&&$e.fud!==void 0?($e.disrupt=!1,$e.statement=!0,ae=$e.fud()):(ae=Ot(0,!0),ae.wrapped&&(ae.id!=="("||ae.expression[0].id!=="function")&&U("unexpected_a",O),er()),q!==void 0&&(q.dead=!0),ae}function mr(){var O=[];return function q(ae){var $e;switch(Ee.id){case"}":case"case":case"default":case"else":case"(end)":break;default:return $e=hi(),O.push($e),ae&&U("unreachable_a",$e),q($e.disrupt)}}(!1),O}function zr(O){Z===ke&&U("unexpected_at_top_level_a",O)}function Pi(O){tt!==ke&&U("misplaced_a",O)}function jr(O){var q,ae;return O!=="naked"&&Ie("{"),ae=Ae,ae.arity="statement",ae.body=O==="body",ae.body&&at.length<=1&&!ke.strict&&(Ee.id==="(string)"||Ee.value==="use strict"?(Ee.statement=!0,Z.strict=!0,Ie("(string)"),Ie(";")):U("expected_a_before_b",Ee,Ee.id==="`"?"'":"use strict",be(Ee))),q=mr(),ae.block=q,q.length===0?(!He.devel&&O!=="ignore"&&U("empty_block",ae),ae.disrupt=!1):ae.disrupt=q[q.length-1].disrupt,Ie("}"),ae}function rn(O){return O.id!=="."&&(O.id!=="["||O.arity!=="binary")&&O.arity!=="variable"?(U("bad_assignment_a",O),!1):!0}function Yr(O,q){var ae=O.id;return!O.identifier&&(O.arity!=="binary"||ae!=="."&&ae!=="("&&ae!=="[")?(U("unexpected_a",q),!1):!0}function qt(O,q){var ae=Ve[O];return ae===void 0&&(ae=e(),ae.id=O,ae.lbp=q||0,Ve[O]=ae),ae}function gi(O){var q=qt(O,20);return q.led=function(ae){var $e=Ae,Ke;switch($e.arity="assignment",Ke=Ot(19),O==="="&&ae.arity==="variable"?($e.names=ae,$e.expression=Ke):$e.expression=[ae,Ke],Ke.arity){case"assignment":case"pre":case"post":U("unexpected_a",Ke);break}return He.es6&&ae.arity==="unary"&&(ae.id==="["||ae.id==="{")?U("expected_a_before_b",ae,"const",ae.id):rn(ae),$e},q}function Ai(O,q,ae){var $e=qt(O);return $e.nud=typeof ae=="function"?ae:function(){return Ae.constant=!0,ae!==void 0&&(Ae.value=ae),Ae},$e.type=q,$e.value=ae,$e}function tr(O,q,ae){var $e=qt(O,q);return $e.led=function(Ke){var pt=Ae;return pt.arity="binary",ae!==void 0?ae(Ke):(pt.expression=[Ke,Ot(q)],pt)},$e}function Jr(O){var q=qt(O,150);return q.led=function(ae){return Ae.expression=ae,Ae.arity="post",rn(Ae.expression),Ae},q}function Hr(O){var q=qt(O);return q.nud=function(){var ae=Ae;return ae.arity="pre",ae.expression=Ot(150),rn(ae.expression),ae},q}function Kt(O,q){var ae=qt(O);return ae.nud=function(){var $e=Ae;return $e.arity="unary",typeof q=="function"?q():($e.expression=Ot(150),$e)},ae}function Er(O,q){var ae=qt(O);return ae.fud=function(){return Ae.arity="statement",q()},ae}function ln(O,q){var ae=qt(O,30);return ae.led=function($e){var Ke=Ae,pt=Ot(20);return Ie(q),Ae.arity="ternary",Ke.arity="ternary",Ke.expression=[$e,pt,Ot(10)],Ke},ae}Ve=e(),qt("}"),qt(")"),qt("]"),qt(","),qt(";"),qt(":"),qt("*/"),qt("await"),qt("case"),qt("catch"),qt("class"),qt("default"),qt("else"),qt("enum"),qt("finally"),qt("implements"),qt("interface"),qt("package"),qt("private"),qt("protected"),qt("public"),qt("static"),qt("super"),qt("void"),qt("with"),qt("yield"),Ai("(number)","number"),Ai("(regexp)","regexp"),Ai("(string)","string"),Ai("arguments","object",function(){return U("unexpected_a",Ae),Ae}),Ai("eval","function",function(){return He.eval?Ee.id!=="("&&U("expected_a_before_b",Ee,"(",be()):U("unexpected_a",Ae),Ae}),Ai("false","boolean",!1),Ai("ignore","undefined",function(){return U("unexpected_a",Ae),Ae}),Ai("Infinity","number",1/0),Ai("NaN","number",NaN),Ai("null","null",null),Ai("this","object",function(){return He.this||U("unexpected_a",Ae),Ae}),Ai("true","boolean",!0),Ai("undefined","undefined"),gi("="),gi("+="),gi("-="),gi("*="),gi("/="),gi("%="),gi("&="),gi("|="),gi("^="),gi("<<="),gi(">>="),gi(">>>="),tr("||",40),tr("&&",50),tr("|",70),tr("^",80),tr("&",90),tr("==",100),tr("===",100),tr("!=",100),tr("!==",100),tr("<",110),tr(">",110),tr("<=",110),tr(">=",110),tr("in",110),tr("instanceof",110),tr("<<",120),tr(">>",120),tr(">>>",120),tr("+",130),tr("-",130),tr("*",140),tr("/",140),tr("%",140),tr("(",160,function(O){var q=Ae,ae;return O.id!=="function"&&Yr(O,q),q.free=!1,q.expression=[O],O.identifier&&(O.new?O.id.charAt(0)>"Z"||O.id==="Boolean"||O.id==="Number"||O.id==="String"||O.id==="Symbol"&&He.es6?U("unexpected_a",O,"new"):O.id==="Function"?He.eval||U("unexpected_a",O,"new Function"):O.id==="Array"?U("expected_a_b",O,"[]","new Array"):O.id==="Object"&&U("expected_a_b",O,"Object.create(null)","new Object"):(O.id.charAt(0)>="A"&&O.id.charAt(0)<="Z"&&O.id!=="Boolean"&&O.id!=="Number"&&O.id!=="String"&&O.id!=="Symbol"&&U("expected_a_before_b",O,"new",be(O)),Z.arity==="statement"&&(Z.name.calls[O.id]=O))),Ee.id!==")"&&function $e(){if(ae=Ot(10),q.expression.push(ae),Ee.id===",")return Ie(","),$e()}(),Ie(")",q),q.expression.length===2&&(ae.wrapped===!0&&U("unexpected_a",q),ae.id==="("&&(ae.wrapped=!0)),q}),tr(".",170,function(O){var q=Ae,ae=Ee;return(O.id!=="(string)"||ae.id!=="indexOf")&&(O.id!=="["||ae.id!=="concat"&&ae.id!=="forEach")&&(O.id!=="+"||ae.id!=="slice")&&(O.id!=="(regexp)"||ae.id!=="exec"&&ae.id!=="test")&&Yr(O,q),ae.identifier||Ne("expected_identifier_a"),Ie(),ft(ae),q.name=ae,q.expression=O,q}),tr("[",170,function(O){var q=Ae,ae=Ot(0);return ae.id==="(string)"&&y.test(ae.value)?(U("subscript_a",ae),ft(ae)):ae.id==="`"&&U("unexpected_a",ae),Yr(O,q),q.expression=[O,ae],Ie("]"),q}),tr("=>",170,function(O){return Ne("expected_a_before_b",O,"(",be(O))});function Pn(){var O=Ae;return He.es6||U("es6",O),O.value=[],O.expression=[],Ee.id!=="`"&&function q(){if(Ie("(string)"),O.value.push(Ae),Ee.id==="${")return Ie("${"),O.expression.push(Ot(0)),Ie("}"),q()}(),Ie("`"),O}tr("`",160,function(O){var q=Pn();return Yr(O,q),q.expression=[O].concat(q.expression),q}),Jr("++"),Jr("--"),Hr("++"),Hr("--"),Kt("+"),Kt("-"),Kt("~"),Kt("!"),Kt("!!"),Kt("[",function(){var O=Ae;return O.expression=[],Ee.id!=="]"&&function q(){if(O.expression.push(Ot(10)),Ee.id===",")return Ie(","),q()}(),Ie("]"),O}),Kt("/=",function(){Ne("expected_a_b",Ae,"/\\=","/=")}),Kt("=>",function(){return Ne("expected_a_before_b",Ae,"()","=>")}),Kt("new",function(){var O=Ae;return Ee.new=!0,O.expression=Ot(150),O.expression.id!=="("&&U("expected_a_before_b",Ee,"()",be(Ee)),O}),Kt("typeof"),Kt("void",function(){var O=Ae;return U("unexpected_a",O),O.expression=Ot(0),O});function dn(O,q){var ae=!1,$e;if(Ee.id==="{"){if(He.es6||U("es6"),$e=Ee,$e.names=[],Ie("{"),q.push("{"),function Ke(){var pt=Ee;if(!pt.identifier||(ft(pt),Ie(),q.push(pt.id),Ee.id===":"&&(Ie(":"),Ie(),Ae.label=pt,pt=Ae,!pt.identifier)))return Ne("expected_identifier_a");if($e.names.push(pt),Ee.id===",")return Ie(","),q.push(", "),Ke()}(),O.push($e),Ie("}"),q.push("}"),Ee.id===",")return Ie(","),q.push(", "),dn(O,q)}else if(Ee.id==="["){if(He.es6||U("es6"),$e=Ee,$e.names=[],Ie("["),q.push("[]"),function Ke(){var pt=Ee;if(!pt.identifier)return Ne("expected_identifier_a");if(Ie(),$e.names.push(pt),Ee.id===",")return Ie(","),Ke()}(),O.push($e),Ie("]"),Ee.id===",")return Ie(","),q.push(", "),dn(O,q)}else{if(Ee.id==="..."&&(He.es6||U("es6"),ae=!0,q.push("..."),Ie("...")),!Ee.identifier)return Ne("expected_identifier_a");if($e=Ee,O.push($e),Ie(),q.push($e.id),ae)$e.ellipsis=!0;else if(Ee.id==="="&&(He.es6||U("es6"),Ie("="),$e.expression=Ot(0)),Ee.id===",")return Ie(","),q.push(", "),dn(O,q)}}function pa(){var O=[],q=["("];return Ee.id!==")"&&Ee.id!=="(end)"&&dn(O,q),Ie(")"),q.push(")"),[O,q.join("")]}function gr(O){var q;if(O===void 0)if(O=Ae,O.arity==="statement"){if(!Ee.identifier)return Ne("expected_identifier_a",Ee);q=Ee,Nt(q,"variable",!0),O.name=q,q.init=!0,q.calls=e(),Ie()}else q===void 0&&(Ee.identifier?(q=Ee,O.name=q,Ie()):O.name=We);else q=O.name;O.level=Z.level+1,Ge&&U("unexpected_a",O),Z.loop>0&&U("function_in_loop",O),O.context=e(),O.loop=0,O.switch=0,at.push(Z),me.push(O),Z=O,O.arity!=="statement"&&q&&(Nt(q,"function",!0),q.dead=!1,q.init=!0,q.used=1),Ie("("),Ae.free=!1,Ae.arity="function";var ae=pa();return Z.parameters=ae[0],Z.signature=ae[1],Z.parameters.forEach(function $e(Ke){Ke.identifier?Nt(Ke,"parameter",!1):Ke.names.forEach($e)}),O.block=jr("body"),O.arity==="statement"&&Ee.line===Ae.line?Ne("unexpected_a",Ee):((Ee.id==="."||Ee.id==="[")&&U("unexpected_a"),Z=at.pop(),O)}Kt("function",gr);function mi(O){Ie("=>");var q=Ae;return q.arity="binary",q.name="=>",q.level=Z.level+1,me.push(q),Z.loop>0&&U("function_in_loop",q),q.context=e(),q.loop=0,q.switch=0,at.push(Z),Z=q,q.parameters=O[0],q.signature=O[1],q.parameters.forEach(function(ae){Nt(ae,"parameter",!0)}),He.es6||U("es6",q),Ee.id==="{"?(U("expected_a_b",q,"function","=>"),q.block=jr("body")):q.expression=Ot(0),Z=at.pop(),q}Kt("(",function(){var O=Ae,q,ae=Et().id;return Ee.id===")"||Ee.id==="..."||Ee.identifier&&(ae===","||ae==="=")?(O.free=!1,mi(pa())):(O.free=!0,q=Ot(0),q.wrapped===!0&&U("unexpected_a",O),q.wrapped=!0,Ie(")",O),Ee.id==="=>"?q.arity!=="variable"?Ne("expected_identifier_a",q):(O.expression=[q],mi([O.expression,"("+q.id+")"])):q)}),Kt("`",Pn),Kt("{",function(){var O=Ae,q=e();return O.expression=[],Ee.id!=="}"&&function ae(){var $e=!0,Ke,pt=Ee,Wt;if(Ie(),(pt.id==="get"||pt.id==="set")&&Ee.identifier&&($e=pt.id,pt=Ee,Ie()),Ke=ft(pt),q[Ke]===!0?U("duplicate_a",pt):q[Ke]==="get"&&$e!=="set"&&U("expected_a_before_b",pt,"set",be(pt)),q[Ke]=$e==="get"?"get":!0,pt.identifier){switch(Ee.id){case"}":case",":He.es6?$e!==!0&&Ie(":"):U("es6"),pt.arity="variable",Wt=pt;break;case"(":He.es6||U("es6"),Wt=gr({arity:"unary",from:pt.from,id:"function",line:pt.line,name:pt,thru:pt.from},pt);break;default:Ie(":"),Wt=Ot(0)}Wt.label=pt,typeof $e=="string"&&(Wt.extra=$e),O.expression.push(Wt)}else Ie(":"),Wt=Ot(0),Wt.label=pt,O.expression.push(Wt);if(Ee.id===",")return Ie(","),ae()}(),Ie("}"),O}),Er(";",function(){return U("unexpected_a",Ae),Ae}),Er("{",function(){return U("naked_block",Ae),jr("naked")}),Er("break",function(){var O=Ae,q;return Z.loop<1&&Z.switch<1&&U("unexpected_a",O),O.disrupt=!0,Ee.identifier&&Ae.line===Ee.line&&(q=Z.context[Ee.id],q===void 0||q.role!=="label"||q.dead?U(q!==void 0&&q.dead?"out_of_scope_a":"not_label_a"):q.used+=1,O.label=Ee,Ie()),Ie(";"),O});function vi(){var O=Ae,q=O.id==="const";return O.names=[],q?He.es6||U("es6",O):re===void 0?(re=O.id,!He.es6&&re!=="var"&&U("es6",O)):O.id!==re&&U("expected_a_b",O,re,O.id),Z.switch>0&&U("var_switch",O),Z.loop>0&&O.id==="var"&&U("var_loop",O),function ae(){if(Ee.id==="{"&&O.id!=="var"){var $e=Ee;$e.names=[],Ie("{"),function Wt(){if(!Ee.identifier)return Ne("expected_identifier_a",Ee);var Rr=Ee;if(ft(Rr),Ie(),Ee.id===":"){if(Ie(":"),!Ee.identifier)return Ne("expected_identifier_a",Ee);Ee.label=Rr,$e.names.push(Ee),Nt(Ee,"variable",q),Ie()}else $e.names.push(Rr),Nt(Rr,"variable",q);if(Ee.id===",")return Ie(","),Wt()}(),Ie("}"),Ie("="),$e.expression=Ot(0),O.names.push($e)}else if(Ee.id==="["&&O.id!=="var"){var Ke=Ee;Ke.names=[],Ie("["),function Wt(){var Rr;if(Ee.id==="..."&&(Rr=!0,Ie("...")),!Ee.identifier)return Ne("expected_identifier_a",Ee);var xt=Ee;if(Ie(),Ke.names.push(xt),Nt(xt,"variable",O.id==="const"),Rr)xt.ellipsis=!0;else if(Ee.id===",")return Ie(","),Wt()}(),Ie("]"),Ie("="),Ke.expression=Ot(0),O.names.push(Ke)}else if(Ee.identifier){var pt=Ee;Ie(),pt.id==="ignore"&&U("unexpected_a",pt),Nt(pt,"variable",q),(Ee.id==="="||q)&&(Ie("="),pt.expression=Ot(0),pt.init=!0),O.names.push(pt)}else return Ne("expected_identifier_a",Ee);if(Ee.id===",")return Ie(","),ae()}(),O.open=O.names.length>1&&O.line!==O.names[1].line,er(),O}Er("const",vi),Er("continue",function(){var O=Ae;return Z.loop<1&&U("unexpected_a",O),zr(O),O.disrupt=!0,U("unexpected_a",O),Ie(";"),O}),Er("debugger",function(){var O=Ae;return He.devel||U("unexpected_a",O),er(),O}),Er("delete",function(){var O=Ae,q=Ot(0);return(q.id!=="."&&q.id!=="["||q.arity!=="binary")&&Ne("expected_a_b",q,".",be(q)),O.expression=q,er(),O}),Er("do",function(){var O=Ae;return zr(O),Z.loop+=1,O.block=jr(),Ie("while"),O.expression=qr(),er(),O.block.disrupt===!0&&U("weird_loop",O),Z.loop-=1,O}),Er("export",function(){var O=Ae;return Zt&&U("es6",O),He.es6||U("es6",O),typeof vt=="object"&&U("unexpected_directive_a",vt,vt.directive),vt=!0,Ie("default"),O.expression=Ot(0),er(),O}),Er("for",function(){var O,q=Ae;return He.for||U("unexpected_a",q),zr(q),Z.loop+=1,Ie("("),Ae.free=!0,Ee.id===";"?Ne("expected_a_b",q,"while (","for (;"):Ee.id==="var"||Ee.id==="let"||Ee.id==="const"?Ne("unexpected_a"):(O=Ot(0),O.id==="in"?(O.expression[0].arity!=="variable"&&U("bad_assignment_a",O.expression[0]),q.name=O.expression[0],q.expression=O.expression[1],U("expected_a_b",q,"Object.keys","for in")):(q.initial=O,Ie(";"),q.expression=Ot(0),Ie(";"),q.inc=Ot(0),q.inc.id==="++"&&U("expected_a_b",q.inc,"+= 1","++")),Ie(")"),q.block=jr(),q.block.disrupt===!0&&U("weird_loop",q),Z.loop-=1,q)}),Er("function",gr),Er("if",function(){var O,q=Ae;return q.expression=qr(),q.block=jr(),Ee.id==="else"&&(Ie("else"),O=Ae,q.else=Ee.id==="if"?hi():jr(),q.block.disrupt===!0&&(q.else.disrupt===!0?q.disrupt=!0:U("unexpected_a",O))),q}),Er("import",function(){var O=Ae;if(He.es6?typeof vt=="object"&&U("unexpected_directive_a",vt,vt.directive):U("es6",O),vt=!0,!Ee.identifier)return Ne("expected_identifier_a");var q=Ee;return Ie(),q.id==="ignore"&&U("unexpected_a",q),Nt(q,"variable",!0),Ie("from"),Ie("(string)"),O.import=Ae,O.name=q,y.test(Ae.value)||U("bad_module_name_a",Ae),we.push(Ae.value),er(),O}),Er("let",vi),Er("return",function(){var O=Ae;return zr(O),O.disrupt=!0,Ee.id!==";"&&O.line===Ee.line&&(O.expression=Ot(10)),Ie(";"),O}),Er("switch",function(){var O,q,ae=[],$e=!0,Ke=Ae;return zr(Ke),Z.switch+=1,Ie("("),Ae.free=!0,Ke.expression=Ot(0),Ke.block=ae,Ie(")"),Ie("{"),function pt(){var Wt=Ee;if(Wt.arity="statement",Wt.expression=[],function Rr(){if(Ie("case"),Ae.switch=!0,Wt.expression.push(Ot(0)),Ie(":"),Ee.id==="case")return Rr()}(),q=mr(),Wt.block=q,ae.push(Wt),O=q[q.length-1],O.disrupt?O.id==="break"&&O.label===void 0&&($e=!1):U("expected_a_before_b",Ee,"break;",be(Ee)),Ee.id==="case")return pt()}(),Ee.id==="default"?(Ie("default"),Ae.switch=!0,Ie(":"),Ke.else=mr(),Ke.else.length<1?(U("unexpected_a"),$e=!1):$e=$e&&Ke.else[Ke.else.length-1].disrupt):$e=!1,Ie("}",Ke),Z.switch-=1,Ke.disrupt=$e,Ke}),Er("throw",function(){var O=Ae;return O.disrupt=!0,O.expression=Ot(10),er(),O}),Er("try",function(){var O=!1,q,ae,$e=Ae;if($e.block=jr(),ae=$e.block.disrupt,Ee.id==="catch"){var Ke="ignore";if(O=!0,q=Ee,$e.catch=q,Ie("catch"),Ie("("),!Ee.identifier)return Ne("expected_identifier_a",Ee);Ee.id!=="ignore"&&(Ke=void 0,q.name=Ee,Nt(Ee,"exception",!0)),Ie(),Ie(")"),q.block=jr(Ke),q.block.disrupt!==!0&&(ae=!1)}return Ee.id==="finally"&&(O=!0,Ie("finally"),$e.else=jr(),ae=$e.else.disrupt),$e.disrupt=ae,O||U("expected_a_before_b",Ee,"catch",be(Ee)),$e}),Er("var",vi),Er("while",function(){var O=Ae;return zr(O),Z.loop+=1,O.expression=qr(),O.block=jr(),O.block.disrupt===!0&&U("weird_loop",O),Z.loop-=1,O}),ln("?",":");function ha(O){return function(q,ae,$e){var Ke=O[q],pt;typeof ae!="string"&&($e=ae,ae="(all)"),Ke===void 0&&(Ke=e(),O[q]=Ke),pt=Ke[ae],pt===void 0&&(pt=[],Ke[ae]=pt),pt.push($e)}}function Ka(O){return function(q){var ae=O[q.arity],$e;ae!==void 0&&($e=ae[q.id],$e!==void 0&&$e.forEach(function(Ke){return Ke(q)}),$e=ae["(all)"],$e!==void 0&&$e.forEach(function(Ke){return Ke(q)}))}}var ro=e(),wn=e(),Wr=ha(wn),Qr=ha(ro),Ii=Ka(wn),ps=Ka(ro);function Xa(O){if(O)if(Array.isArray(O))O.forEach(Xa);else{switch(Ii(O),Xa(O.expression),O.id==="function"&&lr(O.block),O.arity){case"post":case"pre":U("unexpected_a",O);break;case"statement":case"assignment":U("unexpected_statement_a",O);break}ps(O)}}function lr(O){if(O)if(Array.isArray(O))O.forEach(lr);else{switch(Ii(O),Xa(O.expression),O.arity){case"statement":case"assignment":break;case"binary":O.id!=="("&&U("unexpected_expression_a",O);break;default:U("unexpected_expression_a",O)}lr(O.block),lr(O.else),ps(O)}}function Rn(O){if(O.arity==="variable"){var q=Z.context[O.id];if(q===void 0){if(at.forEach(function(ae){var $e=ae.context[O.id];$e!==void 0&&$e.role!=="label"&&(q=$e)}),q===void 0){if(Tt[O.id]===void 0){U("undeclared_a",O);return}q={dead:!1,function:ke,id:O.id,init:!0,role:"variable",used:0,writable:!1},ke.context[O.id]=q}q.closure=!0,Z.context[O.id]=q}else q.role==="label"&&U("label_a",O);return q.dead&&q.function===Z&&U("out_of_scope_a",O),q}}function Dt(O){switch(O.arity==="statement"&&tt.body!==!0&&U("unexpected_a",O),at.push(Z),Le.push(tt),Z=O,tt=O,O.live=[],typeof O.name=="object"&&(O.name.dead=!1,O.name.init=!0),O.extra){case"get":O.parameters.length!==0&&U("bad_get",O);break;case"set":O.parameters.length!==1&&U("bad_set",O);break}O.parameters.forEach(function(q){Xa(q.expression),q.id==="{"||q.id==="["?q.names.forEach(Vt):(q.dead=!1,q.init=!0)})}function Ht(O){!He.bitwise&&a[O.id]===!0&&U("unexpected_a",O)}function fr(){tt.live.forEach(function(O){O.dead=!0}),delete tt.live,tt=Le.pop()}function Vt(O){O.init=!0,O.dead=!1,tt.live.push(O)}function Pr(O){O.expression!==void 0&&(Xa(O.expression),O.id==="{"||O.id==="["?O.names.forEach(Vt):O.init=!0),O.dead=!1,tt.live.push(O)}function nn(O){O.names.forEach(Pr)}Wr("assignment",Ht),Wr("binary",Ht),Wr("binary",function(O){if(o[O.id]===!0){if(O.expression[0].id==="NaN"||O.expression[1].id==="NaN")U("isNaN",O);else if(O.expression[0].id==="typeof")if(O.expression[1].id!=="(string)")O.expression[1].id!=="typeof"&&U("expected_string_a",Ot[1]);else{var q=O.expression[1].value;q==="symbol"?He.es6||U("es6",O.expression[1],q):q==="null"||q==="undefined"?U("unexpected_typeof_a",O.expression[1],q):q!=="boolean"&&q!=="function"&&q!=="number"&&q!=="object"&&q!=="string"&&U("expected_type_string_a",Ot[1],q)}}}),Wr("binary","==",function(O){U("expected_a_b",O,"===","==")}),Wr("binary","!=",function(O){U("expected_a_b",O,"!==","!=")}),Wr("binary","=>",Dt),Wr("binary","||",function(O){O.expression.forEach(function(q){q.id==="&&"&&!q.wrapped&&U("and",q)})}),Wr("binary","(",function(O){var q=O.expression[0];if(q.identifier&&Z.context[q.id]===void 0&&typeof Z.name=="object"){var ae=Z.name.function;if(ae){var $e=ae.context[q.id];$e!==void 0&&$e.dead&&$e.function===ae&&$e.calls!==void 0&&$e.calls[Z.name.id]!==void 0&&($e.dead=!1)}}}),Wr("binary","in",function(O){U("infix_in",O)}),Wr("statement","{",function(O){Le.push(tt),tt=O,O.live=[]}),Wr("statement","for",function(O){if(O.name!==void 0){var q=Rn(O.name);q!==void 0&&(q.init=!0,q.writable||U("bad_assignment_a",O.name))}lr(O.initial)}),Wr("statement","function",Dt),Wr("unary","~",Ht),Wr("unary","function",Dt),Wr("variable",function(O){var q=Rn(O);q!==void 0&&(O.variable=q,q.used+=1)});function Tn(O){var q=Rn(O);if(q!==void 0&&q.writable){q.init=!0;return}U("bad_assignment_a",O)}Qr("assignment",function(O){if(O.id==="=")O.names!==void 0&&(Array.isArray(O.names)?O.names.forEach(Tn):Tn(O.names));else{var q=O.expression[0];q.arity==="variable"&&(!q.variable||q.variable.writable!==!0)&&U("bad_assignment_a",q)}});function Dn(O){return delete Z.loop,delete Z.switch,Z=at.pop(),O.wrapped&&U("unexpected_parens",O),fr()}function Zr(O){return O.id==="(regexp)"||O.id==="{"||O.id==="=>"||O.id==="function"||O.id==="["&&O.arity==="unary"}function yi(O,q){if(O===q)return!0;if(Array.isArray(O))return Array.isArray(q)&&O.length===q.length&&O.every(function(Ke,pt){return yi(Ke,q[pt])});if(Array.isArray(q))return!1;if(O.id==="(number)"&&q.id==="(number)")return O.value===q.value;var ae,$e;if(O.id==="(string)"?ae=O.value:O.id==="`"&&O.constant&&(ae=O.value[0]),q.id==="(string)"?$e=q.value:q.id==="`"&&q.constant&&($e=q.value[0]),typeof ae=="string")return ae===$e;if(Zr(O)||Zr(q))return!1;if(O.arity===q.arity&&O.id===q.id){if(O.id===".")return yi(O.expression,q.expression)&&yi(O.name,q.name);switch(O.arity){case"unary":return yi(O.expression,q.expression);case"binary":return O.id!=="("&&yi(O.expression[0],q.expression[0])&&yi(O.expression[1],q.expression[1]);case"ternary":return yi(O.expression[0],q.expression[0])&&yi(O.expression[1],q.expression[1])&&yi(O.expression[2],q.expression[2]);case"function":case"regexp":return!1;default:return!0}}return!1}Qr("binary",function(O){switch(o[O.id]&&(Zr(O.expression[0])||Zr(O.expression[1])||yi(O.expression[0],O.expression[1])||O.expression[0].constant===!0&&O.expression[1].constant===!0)&&U("weird_relation_a",O),O.id){case"=>":case"(":case".":break;default:O.expression[0].constant===!0&&O.expression[1].constant===!0&&(O.constant=!0)}}),Qr("binary","&&",function(O){(Zr(O.expression[0])||yi(O.expression[0],O.expression[1])||O.expression[0].constant===!0||O.expression[1].constant===!0)&&U("weird_condition_a",O)}),Qr("binary","||",function(O){(Zr(O.expression[0])||yi(O.expression[0],O.expression[1])||O.expression[0].constant===!0)&&U("weird_condition_a",O)}),Qr("binary","=>",Dn),Qr("binary","(",function(O){!O.wrapped&&O.expression[0].id==="function"&&U("wrap_immediate",O)}),Qr("binary","[",function(O){Zr(O.expression[1])&&U("weird_expression_a",O.expression[1])}),Qr("statement","{",fr),Qr("statement","const",nn),Qr("statement","export",Pi),Qr("statement","for",function(O){lr(O.inc)}),Qr("statement","function",Dn),Qr("statement","import",function(O){var q=O.name;return q.init=!0,q.dead=!1,tt.live.push(q),Pi(O)}),Qr("statement","let",nn),Qr("statement","try",function(O){if(O.catch!==void 0){var q=O.catch.name;if(q!==void 0){var ae=Z.context[q.id];ae.dead=!1,ae.init=!0}lr(O.catch.block)}}),Qr("statement","var",nn),Qr("ternary",function(O){Zr(O.expression[0])||O.expression[0].constant===!0||yi(O.expression[1],O.expression[2])?U("unexpected_a",O):yi(O.expression[0],O.expression[1])?U("expected_a_b",O,"||","?"):yi(O.expression[0],O.expression[2])?U("expected_a_b",O,"&&","?"):O.expression[1].id==="true"&&O.expression[2].id==="false"?U("expected_a_b",O,"!!","?"):O.expression[1].id==="false"&&O.expression[2].id==="true"&&U("expected_a_b",O,"!","?")}),Qr("unary",function(O){switch(O.id){case"[":case"{":case"function":case"new":break;case"`":O.expression.every(function(q){return q.constant})&&(O.constant=!0);break;default:O.expression.constant===!0&&(O.constant=!0)}}),Qr("unary","function",Dn);function Sn(O){Object.keys(O.context).forEach(function(q){if(q!=="ignore"){var ae=O.context[q];ae.function===O&&(ae.used===0?U("unused_a",ae):ae.init||U("uninitialized_a",ae))}})}function Vn(){(vt===!0||He.node)&&Sn(ke),me.forEach(Sn)}function Ln(){var O="(end)",q=!1,ae=ke,$e=0,Ke=0,pt=!0,Wt="",Rr,xt;function Qt(oi){U("expected_a_at_b_c",xt,be(xt),Ze+oi,dt(xt))}function Lt(oi){var Gr=$e+oi;if(xt.from!==Gr)return Qt(Gr)}function zn(){(ae.line!==xt.line||ae.thru!==xt.from)&&U("unexpected_space_a_b",xt,be(ae),be(xt))}function fn(){if(ae.line===xt.line)ae.thru!==xt.from&&Ke===0&&U("unexpected_space_a_b",xt,be(ae),be(xt));else if(pt){var oi=q?$e:$e+8;xt.from<oi&&Qt(oi)}else xt.from!==$e+8&&Qt($e+8)}function nr(){(ae.line!==xt.line||ae.thru+1!==xt.from)&&U("expected_space_a_b",xt,be(ae),be(xt))}function Nn(){if(ae.line===xt.line)ae.thru+1!==xt.from&&Ke===0&&U("expected_space_a_b",xt,be(ae),be(xt));else if(pt){var oi=q?$e:$e+8;xt.from<oi&&Qt(oi)}else xt.from!==$e+8&&Qt($e+8)}function bi(){var oi=Wt.length;oi>0&&($e-=oi*4),Wt=""}at=[],Bt.forEach(function(oi){if(xt=oi,xt.id==="(comment)"||xt.id==="(end)")Ke+=1;else{var Gr=s[ae.id];if(typeof Gr=="string")Gr!==xt.id?(at.push({closer:O,free:q,margin:$e,open:pt,qmark:Wt}),Wt="",O=Gr,ae.line!==xt.line?(q=O===")"&&ae.free||O==="]",pt=!0,$e+=4,xt.role==="label"?xt.from!==0&&Qt(0):xt.switch?(bi(),Lt(-4)):Lt(0)):((xt.statement||xt.role==="label")&&U("expected_line_break_a_b",xt,be(ae),be(xt)),q=!1,pt=!1,zn())):ae.line===xt.line?fn():Lt(0);else if(xt.id===O){var Bi=at.pop();$e=Bi.margin,pt&&xt.id!==";"?Lt(0):zn(),O=Bi.closer,q=Bi.free,pt=Bi.open,Wt=Bi.qmark}else xt.switch?(bi(),Lt(-4)):xt.role==="label"?xt.from!==0&&Qt(0):ae.id===","?(bi(),!pt||q&&ae.line===xt.line?Nn():Lt(0)):xt.arity==="ternary"?(xt.id==="?"?($e+=4,Wt+="?"):(Rr=Wt.match(ze),Wt=Rr[1]+":",$e-=4*Rr[2].length),Lt(0)):ae.id==="..."||xt.id===","||xt.id===";"||xt.id===":"||xt.arity==="binary"&&(xt.id==="("||xt.id==="[")||xt.arity==="function"&&ae.id!=="function"?zn():ae.id==="."?fn():xt.id==="."?ae.line===xt.line?fn():(Ue.test(Wt)||(Wt+=".",$e+=4),Lt(0)):ae.id===";"?(bi(),pt?Lt(0):Nn()):ae.arity==="ternary"||ae.id==="case"||ae.id==="catch"||ae.id==="else"||ae.id==="finally"||ae.id==="while"||xt.id==="catch"||xt.id==="else"||xt.id==="finally"||xt.id==="while"&&!xt.statement||ae.id===")"&&xt.id==="{"?nr():xt.statement===!0?pt?Lt(0):Nn():ae.id==="var"||ae.id==="const"||ae.id==="let"?(at.push({closer:O,free:q,margin:$e,open:pt,qmark:Wt}),O=";",q=!1,pt=ae.open,Wt="",pt?($e=$e+4,Lt(0)):nr()):i[ae.id]===!0||i[xt.id]===!0||ae.arity==="binary"&&(ae.id==="+"||ae.id==="-")||xt.arity==="binary"&&(xt.id==="+"||xt.id==="-")||ae.id==="function"||ae.id===":"||(ae.identifier||ae.id==="(string)"||ae.id==="(number)")&&(xt.identifier||xt.id==="(string)"||xt.id==="(number)")||ae.arity==="statement"&&xt.id!==";"?Nn():ae.arity==="unary"&&zn();Ke=0,delete ae.calls,delete ae.dead,delete ae.free,delete ae.init,delete ae.open,delete ae.used,ae=xt}})}return function(q,ae,$e){try{te=[],He=ae||e(),We="anonymous",Le=[],Tt=e(),It=!0,St=!0,Zt=!0,Ze=He.fudge?1:0,me=[],ke={id:"(global)",body:!0,context:e(),from:0,level:0,line:0,live:[],loop:0,switch:0,thru:0},tt=ke,Z=ke,we=[],st=!1,Ge=!1,vt=!1,Ee=ke,zt=e(),at=[],ct=void 0,Ae=ke,lt=0,re=void 0,r(Tt,c,!1),$e!==void 0&&r(Tt,$e,!1),Object.keys(He).forEach(function(Ke){if(He[Ke]===!0){var pt=n[Ke];Array.isArray(pt)&&r(Tt,pt,!1)}}),Ye(q),Ie(),Bt[0].id==="{"||Bt[0].id==="["?(st=!0,_t=Jt(),Ie("(end)")):(He.browser?Ee.id===";"&&Ie(";"):Ee.id==="(string)"&&Ee.value==="use strict"&&(Ie("(string)"),Ie(";"),ke.strict=!0),_t=mr(),Ie("(end)"),Z=ke,lr(_t),Vn(),He.white||Ln()),St=!1}catch(Ke){Ke.name!=="JSLintError"&&te.push(Ke)}return{edition:"2015-06-22",functions:me,global:ke,id:"(JSLint)",imports:we,json:st,lines:bt,module:vt===!0,ok:te.length===0&&!St,option:He,property:zt,stop:St,tokens:Bt,tree:_t,warnings:te.sort(function(Ke,pt){return Ke.line-pt.line||Ke.column-pt.column})}}}()});var tI=D((yCe,eI)=>{var tm,rr,JA={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},q0,Bu=function(t){throw{name:"SyntaxError",message:t,at:tm,text:q0}},Ar=function(t){return t&&t!==rr&&Bu("Expected '"+t+"' instead of '"+rr+"'"),rr=q0.charAt(tm),tm+=1,rr},QA=function(){var t,e="";for(rr==="-"&&(e="-",Ar("-"));rr>="0"&&rr<="9";)e+=rr,Ar();if(rr===".")for(e+=".";Ar()&&rr>="0"&&rr<="9";)e+=rr;if(rr==="e"||rr==="E")for(e+=rr,Ar(),(rr==="-"||rr==="+")&&(e+=rr,Ar());rr>="0"&&rr<="9";)e+=rr,Ar();if(t=+e,!isFinite(t))Bu("Bad number");else return t},ZA=function(){var t,e,r="",n;if(rr==='"')for(;Ar();){if(rr==='"')return Ar(),r;if(rr==="\\")if(Ar(),rr==="u"){for(n=0,e=0;e<4&&(t=parseInt(Ar(),16),!!isFinite(t));e+=1)n=n*16+t;r+=String.fromCharCode(n)}else if(typeof JA[rr]=="string")r+=JA[rr];else break;else r+=rr}Bu("Bad string")},Vo=function(){for(;rr&&rr<=" ";)Ar()},Iz=function(){switch(rr){case"t":return Ar("t"),Ar("r"),Ar("u"),Ar("e"),!0;case"f":return Ar("f"),Ar("a"),Ar("l"),Ar("s"),Ar("e"),!1;case"n":return Ar("n"),Ar("u"),Ar("l"),Ar("l"),null}Bu("Unexpected '"+rr+"'")},rm,kz=function(){var t=[];if(rr==="["){if(Ar("["),Vo(),rr==="]")return Ar("]"),t;for(;rr;){if(t.push(rm()),Vo(),rr==="]")return Ar("]"),t;Ar(","),Vo()}}Bu("Bad array")},Oz=function(){var t,e={};if(rr==="{"){if(Ar("{"),Vo(),rr==="}")return Ar("}"),e;for(;rr;){if(t=ZA(),Vo(),Ar(":"),Object.hasOwnProperty.call(e,t)&&Bu('Duplicate key "'+t+'"'),e[t]=rm(),Vo(),rr==="}")return Ar("}"),e;Ar(","),Vo()}}Bu("Bad object")};rm=function(){switch(Vo(),rr){case"{":return Oz();case"[":return kz();case'"':return ZA();case"-":return QA();default:return rr>="0"&&rr<="9"?QA():Iz()}};eI.exports=function(t,e){var r;return q0=t,tm=0,rr=" ",r=rm(),Vo(),rr&&Bu("Syntax error"),typeof e=="function"?function n(i,a){var s,o,c=i[a];if(c&&typeof c=="object")for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(o=n(c,s),o!==void 0?c[s]=o:delete c[s]);return e.call(i,a,c)}({"":r},""):r}});var iI=D((bCe,rI)=>{var j0=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,Ja,im,Pz={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},Mc;function H0(t){return j0.lastIndex=0,j0.test(t)?'"'+t.replace(j0,function(e){var r=Pz[e];return typeof r=="string"?r:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function nm(t,e){var r,n,i,a,s=Ja,o,c=e[t];switch(c&&typeof c=="object"&&typeof c.toJSON=="function"&&(c=c.toJSON(t)),typeof Mc=="function"&&(c=Mc.call(e,t,c)),typeof c){case"string":return H0(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(Ja+=im,o=[],Object.prototype.toString.apply(c)==="[object Array]"){for(a=c.length,r=0;r<a;r+=1)o[r]=nm(r,c)||"null";return i=o.length===0?"[]":Ja?`[
`+Ja+o.join(`,
`+Ja)+`
`+s+"]":"["+o.join(",")+"]",Ja=s,i}if(Mc&&typeof Mc=="object")for(a=Mc.length,r=0;r<a;r+=1)n=Mc[r],typeof n=="string"&&(i=nm(n,c),i&&o.push(H0(n)+(Ja?": ":":")+i));else for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(i=nm(n,c),i&&o.push(H0(n)+(Ja?": ":":")+i));return i=o.length===0?"{}":Ja?`{
`+Ja+o.join(`,
`+Ja)+`
`+s+"}":"{"+o.join(",")+"}",Ja=s,i}}rI.exports=function(t,e,r){var n;if(Ja="",im="",typeof r=="number")for(n=0;n<r;n+=1)im+=" ";else typeof r=="string"&&(im=r);if(Mc=e,e&&typeof e!="function"&&(typeof e!="object"||typeof e.length!="number"))throw new Error("JSON.stringify");return nm("",{"":t})}});var nI=D(G0=>{G0.parse=tI();G0.stringify=iI()});var sI=D((wCe,aI)=>{var am=typeof JSON<"u"?JSON:nI();aI.exports=function(t,e){e||(e={}),typeof e=="function"&&(e={cmp:e});var r=e.space||"";typeof r=="number"&&(r=Array(r+1).join(" "));var n=typeof e.cycles=="boolean"?e.cycles:!1,i=e.replacer||function(o,c){return c},a=e.cmp&&function(o){return function(c){return function(l,f){var g={key:l,value:c[l]},m={key:f,value:c[f]};return o(g,m)}}}(e.cmp),s=[];return function o(c,l,f,g){var m=r?`
`+new Array(g+1).join(r):"",y=r?": ":":";if(f&&f.toJSON&&typeof f.toJSON=="function"&&(f=f.toJSON()),f=i.call(c,l,f),f!==void 0){if(typeof f!="object"||f===null)return am.stringify(f);if(Rz(f)){for(var A=[],k=0;k<f.length;k++){var I=o(f,k,f[k],g+1)||am.stringify(null);A.push(m+r+I)}return"["+A.join(",")+m+"]"}else{if(s.indexOf(f)!==-1){if(n)return am.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else s.push(f);for(var F=Dz(f).sort(a&&a(f)),A=[],k=0;k<F.length;k++){var l=F[k],J=o(f,l,f[l],g+1);if(J){var pe=am.stringify(l)+y+J;A.push(m+r+pe)}}return s.splice(s.indexOf(f),1),"{"+A.join(",")+m+"}"}}}({"":t},"",t,0)};var Rz=Array.isArray||function(t){return{}.toString.call(t)==="[object Array]"},Dz=Object.keys||function(t){var e=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in t)e.call(t,n)&&r.push(n);return r}});var fo=D((TCe,oI)=>{var rp;typeof window<"u"||typeof window<"u"?rp=window:typeof self<"u"?rp=self:rp={};oI.exports=rp});var uI=D(()=>{});var V0=D((xCe,lI)=>{var cI=typeof window<"u"||typeof window<"u"?window:{},Lz=uI(),ip;typeof document<"u"?ip=document:(ip=cI["__GLOBAL_DOCUMENT_CACHE@4"],ip||(ip=cI["__GLOBAL_DOCUMENT_CACHE@4"]=Lz));lI.exports=ip});var sm=D((CCe,zo)=>{function z0(){return zo.exports=z0=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zo.exports.default=zo.exports,zo.exports.__esModule=!0,z0.apply(this,arguments)}zo.exports=z0;zo.exports.default=zo.exports,zo.exports.__esModule=!0});var hI=D(($c,pI)=>{function dI(t){if(t&&typeof t=="object"){var e=t.which||t.keyCode||t.charCode;e&&(t=e)}if(typeof t=="number")return fI[t];var r=String(t),n=Wo[r.toLowerCase()];if(n)return n;var n=om[r.toLowerCase()];if(n)return n;if(r.length===1)return r.charCodeAt(0)}dI.isEventKey=function(e,r){if(e&&typeof e=="object"){var n=e.which||e.keyCode||e.charCode;if(n==null)return!1;if(typeof r=="string"){var i=Wo[r.toLowerCase()];if(i)return i===n;var i=om[r.toLowerCase()];if(i)return i===n}else if(typeof r=="number")return r===n;return!1}};$c=pI.exports=dI;var Wo=$c.code=$c.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},om=$c.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(Mi=97;Mi<123;Mi++)Wo[String.fromCharCode(Mi)]=Mi-32;for(Mi=48;Mi<58;Mi++)Wo[Mi-48]=Mi;var Mi;for(Mi=1;Mi<13;Mi++)Wo["f"+Mi]=Mi+111;for(Mi=0;Mi<10;Mi++)Wo["numpad "+Mi]=Mi+96;var fI=$c.names=$c.title={};for(Mi in Wo)fI[Wo[Mi]]=Mi;for(W0 in om)Wo[W0]=om[W0];var W0});var K0=D((ACe,np)=>{function Nz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}np.exports=Nz;np.exports.default=np.exports,np.exports.__esModule=!0});var um=D((ICe,Ko)=>{function X0(t,e){return Ko.exports=X0=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},Ko.exports.default=Ko.exports,Ko.exports.__esModule=!0,X0(t,e)}Ko.exports=X0;Ko.exports.default=Ko.exports,Ko.exports.__esModule=!0});var Y0=D((kCe,ap)=>{var Mz=um();function $z(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Mz(t,e)}ap.exports=$z;ap.exports.default=ap.exports,ap.exports.__esModule=!0});var mI=D((OCe,gI)=>{gI.exports=Uz;function Uz(t,e){var r,n=null;try{r=JSON.parse(t,e)}catch(i){n=i}return[n,r]}});var yI=D((PCe,vI)=>{vI.exports=Bz;var Fz=Object.prototype.toString;function Bz(t){if(!t)return!1;var e=Fz.call(t);return e==="[object Function]"||typeof t=="function"&&e!=="[object RegExp]"||typeof window<"u"&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}});var _I=D((RCe,bI)=>{"use strict";var qz=fo(),jz=function(e,r){return r===void 0&&(r=!1),function(n,i,a){if(n){e(n);return}if(i.statusCode>=400&&i.statusCode<=599){var s=a;if(r)if(qz.TextDecoder){var o=Hz(i.headers&&i.headers["content-type"]);try{s=new TextDecoder(o).decode(a)}catch{}}else s=String.fromCharCode.apply(null,new Uint8Array(a));e({cause:s});return}e(null,a)}};function Hz(t){return t===void 0&&(t=""),t.toLowerCase().split(";").reduce(function(e,r){var n=r.split("="),i=n[0],a=n[1];return i.trim()==="charset"?a.trim():e},"utf-8")}bI.exports=jz});var EI=D((DCe,J0)=>{"use strict";var wI=fo(),Gz=sm(),Vz=yI();po.httpHandler=_I();var zz=function(e){var r={};return e&&e.trim().split(`
`).forEach(function(n){var i=n.indexOf(":"),a=n.slice(0,i).trim().toLowerCase(),s=n.slice(i+1).trim();typeof r[a]>"u"?r[a]=s:Array.isArray(r[a])?r[a].push(s):r[a]=[r[a],s]}),r};J0.exports=po;J0.exports.default=po;po.XMLHttpRequest=wI.XMLHttpRequest||Yz;po.XDomainRequest="withCredentials"in new po.XMLHttpRequest?po.XMLHttpRequest:wI.XDomainRequest;Wz(["get","put","post","patch","head","delete"],function(t){po[t==="delete"?"del":t]=function(e,r,n){return r=TI(e,r,n),r.method=t.toUpperCase(),SI(r)}});function Wz(t,e){for(var r=0;r<t.length;r++)e(t[r])}function Kz(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function TI(t,e,r){var n=t;return Vz(e)?(r=e,typeof t=="string"&&(n={uri:t})):n=Gz({},e,{uri:t}),n.callback=r,n}function po(t,e,r){return e=TI(t,e,r),SI(e)}function SI(t){if(typeof t.callback>"u")throw new Error("callback argument missing");var e=!1,r=function(pe,L,H){e||(e=!0,t.callback(pe,L,H))};function n(){o.readyState===4&&setTimeout(s,0)}function i(){var J=void 0;if(o.response?J=o.response:J=o.responseText||Xz(o),k)try{J=JSON.parse(J)}catch{}return J}function a(J){return clearTimeout(I),J instanceof Error||(J=new Error(""+(J||"Unknown XMLHttpRequest Error"))),J.statusCode=0,r(J,F)}function s(){if(!l){var J;clearTimeout(I),t.useXDR&&o.status===void 0?J=200:J=o.status===1223?204:o.status;var pe=F,L=null;return J!==0?(pe={body:i(),statusCode:J,method:g,headers:{},url:f,rawRequest:o},o.getAllResponseHeaders&&(pe.headers=zz(o.getAllResponseHeaders()))):L=new Error("Internal XMLHttpRequest Error"),r(L,pe,pe.body)}}var o=t.xhr||null;o||(t.cors||t.useXDR?o=new po.XDomainRequest:o=new po.XMLHttpRequest);var c,l,f=o.url=t.uri||t.url,g=o.method=t.method||"GET",m=t.body||t.data,y=o.headers=t.headers||{},A=!!t.sync,k=!1,I,F={body:void 0,headers:{},statusCode:0,method:g,url:f,rawRequest:o};if("json"in t&&t.json!==!1&&(k=!0,y.accept||y.Accept||(y.Accept="application/json"),g!=="GET"&&g!=="HEAD"&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),m=JSON.stringify(t.json===!0?m:t.json))),o.onreadystatechange=n,o.onload=s,o.onerror=a,o.onprogress=function(){},o.onabort=function(){l=!0},o.ontimeout=a,o.open(g,f,!A,t.username,t.password),A||(o.withCredentials=!!t.withCredentials),!A&&t.timeout>0&&(I=setTimeout(function(){if(!l){l=!0,o.abort("timeout");var J=new Error("XMLHttpRequest timeout");J.code="ETIMEDOUT",a(J)}},t.timeout)),o.setRequestHeader)for(c in y)y.hasOwnProperty(c)&&o.setRequestHeader(c,y[c]);else if(t.headers&&!Kz(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(o.responseType=t.responseType),"beforeSend"in t&&typeof t.beforeSend=="function"&&t.beforeSend(o),o.send(m||null),o}function Xz(t){try{if(t.responseType==="document")return t.responseXML;var e=t.responseXML&&t.responseXML.documentElement.nodeName==="parsererror";if(t.responseType===""&&!e)return t.responseXML}catch{}return null}function Yz(){}});var PI=D((LCe,OI)=>{var xI=V0(),Z0=Object.create||function(){function t(){}return function(e){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();function Qa(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}Qa.prototype=Z0(Error.prototype);Qa.prototype.constructor=Qa;Qa.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function e_(t){function e(n,i,a,s){return(n|0)*3600+(i|0)*60+(a|0)+(s|0)/1e3}var r=t.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return r?r[3]?e(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?e(r[1],r[2],0,r[4]):e(0,r[1],r[2],r[4]):null}function op(){this.values=Z0(null)}op.prototype={set:function(t,e){!this.get(t)&&e!==""&&(this.values[t]=e)},get:function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,r){for(var n=0;n<r.length;++n)if(e===r[n]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){var r;return(r=e.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(e=parseFloat(e),e>=0&&e<=100)?(this.set(t,e),!0):!1}};function sp(t,e,r,n){var i=n?t.split(n):[t];for(var a in i)if(typeof i[a]=="string"){var s=i[a].split(r);if(s.length===2){var o=s[0],c=s[1];e(o,c)}}}function Jz(t,e,r){var n=t;function i(){var o=e_(t);if(o===null)throw new Qa(Qa.Errors.BadTimeStamp,"Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),o}function a(o,c){var l=new op;sp(o,function(f,g){switch(f){case"region":for(var m=r.length-1;m>=0;m--)if(r[m].id===g){l.set(f,r[m].region);break}break;case"vertical":l.alt(f,g,["rl","lr"]);break;case"line":var y=g.split(","),A=y[0];l.integer(f,A),l.percent(f,A)&&l.set("snapToLines",!1),l.alt(f,A,["auto"]),y.length===2&&l.alt("lineAlign",y[1],["start","center","end"]);break;case"position":y=g.split(","),l.percent(f,y[0]),y.length===2&&l.alt("positionAlign",y[1],["start","center","end"]);break;case"size":l.percent(f,g);break;case"align":l.alt(f,g,["start","center","end","left","right"]);break}},/:/,/\s/),c.region=l.get("region",null),c.vertical=l.get("vertical","");try{c.line=l.get("line","auto")}catch{}c.lineAlign=l.get("lineAlign","start"),c.snapToLines=l.get("snapToLines",!0),c.size=l.get("size",100);try{c.align=l.get("align","center")}catch{c.align=l.get("align","middle")}try{c.position=l.get("position","auto")}catch{c.position=l.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},c.align)}c.positionAlign=l.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},c.align)}function s(){t=t.replace(/^\s+/,"")}if(s(),e.startTime=i(),s(),t.substr(0,3)!=="-->")throw new Qa(Qa.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+n);t=t.substr(3),s(),e.endTime=i(),s(),a(t,e)}var Q0=xI.createElement&&xI.createElement("textarea"),Qz={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},CI={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},Zz={v:"title",lang:"lang"},AI={rt:"ruby"};function kI(t,e){function r(){if(!e)return null;function A(I){return e=e.substr(I.length),I}var k=e.match(/^([^<]*)(<[^>]*>?)?/);return A(k[1]?k[1]:k[2])}function n(A){return Q0.innerHTML=A,A=Q0.textContent,Q0.textContent="",A}function i(A,k){return!AI[k.localName]||AI[k.localName]===A.localName}function a(A,k){var I=Qz[A];if(!I)return null;var F=t.document.createElement(I),J=Zz[A];return J&&k&&(F[J]=k.trim()),F}for(var s=t.document.createElement("div"),o=s,c,l=[];(c=r())!==null;){if(c[0]==="<"){if(c[1]==="/"){l.length&&l[l.length-1]===c.substr(2).replace(">","")&&(l.pop(),o=o.parentNode);continue}var f=e_(c.substr(1,c.length-2)),g;if(f){g=t.document.createProcessingInstruction("timestamp",f),o.appendChild(g);continue}var m=c.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!m||(g=a(m[1],m[3]),!g)||!i(o,g))continue;if(m[2]){var y=m[2].split(".");y.forEach(function(A){var k=/^bg_/.test(A),I=k?A.slice(3):A;if(CI.hasOwnProperty(I)){var F=k?"background-color":"color",J=CI[I];g.style[F]=J}}),g.className=y.join(" ")}l.push(m[1]),o.appendChild(g),o=g;continue}o.appendChild(t.document.createTextNode(n(c)))}return s}var II=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function eW(t){for(var e=0;e<II.length;e++){var r=II[e];if(t>=r[0]&&t<=r[1])return!0}return!1}function tW(t){var e=[],r="",n;if(!t||!t.childNodes)return"ltr";function i(o,c){for(var l=c.childNodes.length-1;l>=0;l--)o.push(c.childNodes[l])}function a(o){if(!o||!o.length)return null;var c=o.pop(),l=c.textContent||c.innerText;if(l){var f=l.match(/^.*(\n|\r)/);return f?(o.length=0,f[0]):l}if(c.tagName==="ruby")return a(o);if(c.childNodes)return i(o,c),a(o)}for(i(e,t);r=a(e);)for(var s=0;s<r.length;s++)if(n=r.charCodeAt(s),eW(n))return"rtl";return"ltr"}function rW(t){if(typeof t.line=="number"&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,r=e.textTrackList,n=0,i=0;i<r.length&&r[i]!==e;i++)r[i].mode==="showing"&&n++;return++n*-1}function lm(){}lm.prototype.applyStyles=function(t,e){e=e||this.div;for(var r in t)t.hasOwnProperty(r)&&(e.style[r]=t[r])};lm.prototype.formatStyle=function(t,e){return t===0?0:t+e};function cm(t,e,r){lm.call(this),this.cue=e,this.cueDiv=kI(t,e.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv),this.div=t.document.createElement("div"),n={direction:tW(this.cueDiv),writingMode:e.vertical===""?"horizontal-tb":e.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:e.align==="middle"?"center":e.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(n),this.div.appendChild(this.cueDiv);var i=0;switch(e.positionAlign){case"start":i=e.position;break;case"center":i=e.position-e.size/2;break;case"end":i=e.position-e.size;break}e.vertical===""?this.applyStyles({left:this.formatStyle(i,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(i,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(a){this.applyStyles({top:this.formatStyle(a.top,"px"),bottom:this.formatStyle(a.bottom,"px"),left:this.formatStyle(a.left,"px"),right:this.formatStyle(a.right,"px"),height:this.formatStyle(a.height,"px"),width:this.formatStyle(a.width,"px")})}}cm.prototype=Z0(lm.prototype);cm.prototype.constructor=cm;function ga(t){var e,r,n,i;if(t.div){r=t.div.offsetHeight,n=t.div.offsetWidth,i=t.div.offsetTop;var a=(a=t.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();t=t.div.getBoundingClientRect(),e=a?Math.max(a[0]&&a[0].height||0,t.height/a.length):0}this.left=t.left,this.right=t.right,this.top=t.top||i,this.height=t.height||r,this.bottom=t.bottom||i+(t.height||r),this.width=t.width||n,this.lineHeight=e!==void 0?e:t.lineHeight}ga.prototype.move=function(t,e){switch(e=e!==void 0?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e;break}};ga.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top};ga.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1};ga.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right};ga.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}};ga.prototype.intersectPercentage=function(t){var e=Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left)),r=Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top)),n=e*r;return n/(this.height*this.width)};ga.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}};ga.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,r=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,n=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t;var i={left:t.left,right:t.right,top:t.top||n,height:t.height||e,bottom:t.bottom||n+(t.height||e),width:t.width||r};return i};function iW(t,e,r,n){function i(I,F){for(var J,pe=new ga(I),L=1,H=0;H<F.length;H++){for(;I.overlapsOppositeAxis(r,F[H])||I.within(r)&&I.overlapsAny(n);)I.move(F[H]);if(I.within(r))return I;var j=I.intersectPercentage(r);L>j&&(J=new ga(I),L=j),I=new ga(pe)}return J||pe}var a=new ga(e),s=e.cue,o=rW(s),c=[];if(s.snapToLines){var l;switch(s.vertical){case"":c=["+y","-y"],l="height";break;case"rl":c=["+x","-x"],l="width";break;case"lr":c=["-x","+x"],l="width";break}var f=a.lineHeight,g=f*Math.round(o),m=r[l]+f,y=c[0];Math.abs(g)>m&&(g=g<0?-1:1,g*=Math.ceil(m/f)*f),o<0&&(g+=s.vertical===""?r.height:r.width,c=c.reverse()),a.move(y,g)}else{var A=a.lineHeight/r.height*100;switch(s.lineAlign){case"center":o-=A/2;break;case"end":o-=A;break}switch(s.vertical){case"":e.applyStyles({top:e.formatStyle(o,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(o,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(o,"%")});break}c=["+y","-x","+x","-y"],a=new ga(e)}var k=i(a,c);e.move(k.toCSSCompatValues(r))}function ed(){}ed.StringDecoder=function(){return{decode:function(t){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};ed.convertCueToDOMTree=function(t,e){return!t||!e?null:kI(t,e)};var nW=.05,aW="sans-serif",sW="1.5%";ed.processCues=function(t,e,r){if(!t||!e||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var n=t.document.createElement("div");n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin=sW,r.appendChild(n);function i(f){for(var g=0;g<f.length;g++)if(f[g].hasBeenReset||!f[g].displayState)return!0;return!1}if(!i(e)){for(var a=0;a<e.length;a++)n.appendChild(e[a].displayState);return}var s=[],o=ga.getSimpleBoxPosition(n),c=Math.round(o.height*nW*100)/100,l={font:c+"px "+aW};(function(){for(var f,g,m=0;m<e.length;m++)g=e[m],f=new cm(t,g,l),n.appendChild(f.div),iW(t,f,o,s),g.displayState=f.div,s.push(ga.getSimpleBoxPosition(f))})()};ed.Parser=function(t,e,r){r||(r=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=r||new TextDecoder("utf8"),this.regionList=[]};ed.Parser.prototype={reportOrThrowError:function(t){if(t instanceof Qa)this.onparsingerror&&this.onparsingerror(t);else throw t},parse:function(t){var e=this;t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));function r(){for(var f=e.buffer,g=0;g<f.length&&f[g]!=="\r"&&f[g]!==`
`;)++g;var m=f.substr(0,g);return f[g]==="\r"&&++g,f[g]===`
`&&++g,e.buffer=f.substr(g),m}function n(f){var g=new op;if(sp(f,function(y,A){switch(y){case"id":g.set(y,A);break;case"width":g.percent(y,A);break;case"lines":g.integer(y,A);break;case"regionanchor":case"viewportanchor":var k=A.split(",");if(k.length!==2)break;var I=new op;if(I.percent("x",k[0]),I.percent("y",k[1]),!I.has("x")||!I.has("y"))break;g.set(y+"X",I.get("x")),g.set(y+"Y",I.get("y"));break;case"scroll":g.alt(y,A,["up"]);break}},/=/,/\s/),g.has("id")){var m=new(e.vttjs.VTTRegion||e.window.VTTRegion);m.width=g.get("width",100),m.lines=g.get("lines",3),m.regionAnchorX=g.get("regionanchorX",0),m.regionAnchorY=g.get("regionanchorY",100),m.viewportAnchorX=g.get("viewportanchorX",0),m.viewportAnchorY=g.get("viewportanchorY",100),m.scroll=g.get("scroll",""),e.onregion&&e.onregion(m),e.regionList.push({id:g.get("id"),region:m})}}function i(f){var g=new op;sp(f,function(m,y){switch(m){case"MPEGT":g.integer(m+"S",y);break;case"LOCA":g.set(m+"L",e_(y));break}},/[^\d]:/,/,/),e.ontimestampmap&&e.ontimestampmap({MPEGTS:g.get("MPEGTS"),LOCAL:g.get("LOCAL")})}function a(f){f.match(/X-TIMESTAMP-MAP/)?sp(f,function(g,m){switch(g){case"X-TIMESTAMP-MAP":i(m);break}},/=/):sp(f,function(g,m){switch(g){case"Region":n(m);break}},/:/)}try{var s;if(e.state==="INITIAL"){if(!/\r\n|\n/.test(e.buffer))return this;s=r();var o=s.match(/^WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Qa(Qa.Errors.BadSignature);e.state="HEADER"}for(var c=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(c?c=!1:s=r(),e.state){case"HEADER":/:/.test(s)?a(s):s||(e.state="ID");continue;case"NOTE":s||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){e.state="NOTE";break}if(!s)continue;e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,"");try{e.cue.align="center"}catch{e.cue.align="middle"}if(e.state="CUE",s.indexOf("-->")===-1){e.cue.id=s;continue}case"CUE":try{Jz(s,e.cue,e.regionList)}catch(f){e.reportOrThrowError(f),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var l=s.indexOf("-->")!==-1;if(!s||l&&(c=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+=`
`),e.cue.text+=s.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":s||(e.state="ID");continue}}}catch(f){e.reportOrThrowError(f),e.state==="CUETEXT"&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state=e.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),(t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL")throw new Qa(Qa.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};OI.exports=ed});var LI=D((NCe,DI)=>{var oW="auto",uW={"":1,lr:1,rl:1},cW={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function lW(t){if(typeof t!="string")return!1;var e=uW[t.toLowerCase()];return e?t.toLowerCase():!1}function t_(t){if(typeof t!="string")return!1;var e=cW[t.toLowerCase()];return e?t.toLowerCase():!1}function RI(t,e,r){this.hasBeenReset=!1;var n="",i=!1,a=t,s=e,o=r,c=null,l="",f=!0,g="auto",m="start",y="auto",A="auto",k=100,I="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return n},set:function(F){n=""+F}},pauseOnExit:{enumerable:!0,get:function(){return i},set:function(F){i=!!F}},startTime:{enumerable:!0,get:function(){return a},set:function(F){if(typeof F!="number")throw new TypeError("Start time must be set to a number.");a=F,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(F){if(typeof F!="number")throw new TypeError("End time must be set to a number.");s=F,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(F){o=""+F,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return c},set:function(F){c=F,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return l},set:function(F){var J=lW(F);if(J===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");l=J,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return f},set:function(F){f=!!F,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return g},set:function(F){if(typeof F!="number"&&F!==oW)throw new SyntaxError("Line: an invalid number or illegal string was specified.");g=F,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return m},set:function(F){var J=t_(F);J?(m=J,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return y},set:function(F){if(F<0||F>100)throw new Error("Position must be between 0 and 100.");y=F,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return A},set:function(F){var J=t_(F);J?(A=J,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return k},set:function(F){if(F<0||F>100)throw new Error("Size must be between 0 and 100.");k=F,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return I},set:function(F){var J=t_(F);if(!J)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");I=J,this.hasBeenReset=!0}}}),this.displayState=void 0}RI.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};DI.exports=RI});var MI=D((MCe,NI)=>{var dW={"":!0,up:!0};function fW(t){if(typeof t!="string")return!1;var e=dW[t.toLowerCase()];return e?t.toLowerCase():!1}function up(t){return typeof t=="number"&&t>=0&&t<=100}function pW(){var t=100,e=3,r=0,n=100,i=0,a=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(o){if(!up(o))throw new Error("Width must be between 0 and 100.");t=o}},lines:{enumerable:!0,get:function(){return e},set:function(o){if(typeof o!="number")throw new TypeError("Lines must be set to a number.");e=o}},regionAnchorY:{enumerable:!0,get:function(){return n},set:function(o){if(!up(o))throw new Error("RegionAnchorX must be between 0 and 100.");n=o}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(o){if(!up(o))throw new Error("RegionAnchorY must be between 0 and 100.");r=o}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(o){if(!up(o))throw new Error("ViewportAnchorY must be between 0 and 100.");a=o}},viewportAnchorX:{enumerable:!0,get:function(){return i},set:function(o){if(!up(o))throw new Error("ViewportAnchorX must be between 0 and 100.");i=o}},scroll:{enumerable:!0,get:function(){return s},set:function(o){var c=fW(o);c===!1?console.warn("Scroll: an invalid or illegal string was specified."):s=c}}})}NI.exports=pW});var UI=D(($Ce,$I)=>{var Xo=fo(),Uc=$I.exports={WebVTT:PI(),VTTCue:LI(),VTTRegion:MI()};Xo.vttjs=Uc;Xo.WebVTT=Uc.WebVTT;var hW=Uc.VTTCue,gW=Uc.VTTRegion,mW=Xo.VTTCue,vW=Xo.VTTRegion;Uc.shim=function(){Xo.VTTCue=hW,Xo.VTTRegion=gW};Uc.restore=function(){Xo.VTTCue=mW,Xo.VTTRegion=vW};Xo.VTTCue||Uc.shim()});var FI=D((UCe,cp)=>{function yW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}cp.exports=yW;cp.exports.default=cp.exports,cp.exports.__esModule=!0});var BI=D((FCe,Za)=>{var bW=um(),_W=FI();function dm(t,e,r){return _W()?(Za.exports=dm=Reflect.construct,Za.exports.default=Za.exports,Za.exports.__esModule=!0):(Za.exports=dm=function(i,a,s){var o=[null];o.push.apply(o,a);var c=Function.bind.apply(i,o),l=new c;return s&&bW(l,s.prototype),l},Za.exports.default=Za.exports,Za.exports.__esModule=!0),dm.apply(null,arguments)}Za.exports=dm;Za.exports.default=Za.exports,Za.exports.__esModule=!0});var qI=D((BCe,lp)=>{var wW=um();function TW(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wW(t,e)}lp.exports=TW;lp.exports.default=lp.exports,lp.exports.__esModule=!0});var fp=D((qCe,dp)=>{function SW(t){return t&&t.__esModule?t:{default:t}}dp.exports=SW;dp.exports.default=dp.exports,dp.exports.__esModule=!0});var jI=D((pp,r_)=>{(function(t){var e=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,n=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(s,o,c){if(c=c||{},s=s.trim(),o=o.trim(),!o){if(!c.alwaysNormalize)return s;var l=a.parseURL(s);if(!l)throw new Error("Error trying to parse base URL.");return l.path=a.normalizePath(l.path),a.buildURLFromParts(l)}var f=a.parseURL(o);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return c.alwaysNormalize?(f.path=a.normalizePath(f.path),a.buildURLFromParts(f)):o;var g=a.parseURL(s);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var m=r.exec(g.path);g.netLoc=m[1],g.path=m[2]}g.netLoc&&!g.path&&(g.path="/");var y={scheme:g.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(y.netLoc=g.netLoc,f.path[0]!=="/"))if(!f.path)y.path=g.path,f.params||(y.params=g.params,f.query||(y.query=g.query));else{var A=g.path,k=A.substring(0,A.lastIndexOf("/")+1)+f.path;y.path=a.normalizePath(k)}return y.path===null&&(y.path=c.alwaysNormalize?a.normalizePath(f.path):f.path),a.buildURLFromParts(y)},parseURL:function(s){var o=e.exec(s);return o?{scheme:o[1]||"",netLoc:o[2]||"",path:o[3]||"",params:o[4]||"",query:o[5]||"",fragment:o[6]||""}:null},normalizePath:function(s){for(s=s.split("").reverse().join("").replace(n,"");s.length!==(s=s.replace(i,"")).length;);return s.split("").reverse().join("")},buildURLFromParts:function(s){return s.scheme+s.netLoc+s.path+s.params+s.query+s.fragment}};typeof pp=="object"&&typeof r_=="object"?r_.exports=a:typeof define=="function"&&define.amd?define([],function(){return a}):typeof pp=="object"?pp.URLToolkit=a:t.URLToolkit=a})(pp)});var i_=D((hp,zI)=>{"use strict";var VI=fp();Object.defineProperty(hp,"__esModule",{value:!0});hp.default=void 0;var HI=VI(jI()),qu=VI(fo()),GI="http://example.com",EW=function(e,r){if(/^[a-z]+:/i.test(r))return r;/^data:/.test(e)&&(e=qu.default.location&&qu.default.location.href||"");var n=typeof qu.default.URL=="function",i=/^\/\//.test(e),a=!qu.default.location&&!/\/\//i.test(e);if(n?e=new qu.default.URL(e,qu.default.location||GI):/\/\//i.test(e)||(e=HI.default.buildAbsoluteURL(qu.default.location&&qu.default.location.href||"",e)),n){var s=new URL(r,e);return a?s.href.slice(GI.length):i?s.href.slice(s.protocol.length):s.href}return HI.default.buildAbsoluteURL(e,r)},xW=EW;hp.default=xW;zI.exports=hp.default});var KI=D((gp,WI)=>{"use strict";Object.defineProperty(gp,"__esModule",{value:!0});gp.default=void 0;var CW=function(){function t(){this.listeners={}}var e=t.prototype;return e.on=function(n,i){this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(i)},e.off=function(n,i){if(!this.listeners[n])return!1;var a=this.listeners[n].indexOf(i);return this.listeners[n]=this.listeners[n].slice(0),this.listeners[n].splice(a,1),a>-1},e.trigger=function(n){var i=this.listeners[n];if(i)if(arguments.length===2)for(var a=i.length,s=0;s<a;++s)i[s].call(this,arguments[1]);else for(var o=Array.prototype.slice.call(arguments,1),c=i.length,l=0;l<c;++l)i[l].apply(this,o)},e.dispose=function(){this.listeners={}},e.pipe=function(n){this.on("data",function(i){n.push(i)})},t}();gp.default=CW;WI.exports=gp.default});var n_=D((fm,YI)=>{"use strict";var AW=fp();Object.defineProperty(fm,"__esModule",{value:!0});fm.default=kW;var XI=AW(fo()),IW=function(e){return XI.default.atob?XI.default.atob(e):Buffer.from(e,"base64").toString("binary")};function kW(t){for(var e=IW(t),r=new Uint8Array(e.length),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r}YI.exports=fm.default});var ek=D(vp=>{"use strict";Object.defineProperty(vp,"__esModule",{value:!0});var OW=Y0(),PW=KI(),RW=sm(),DW=K0(),LW=n_();function mp(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var o_=mp(OW),u_=mp(PW),JI=mp(RW),NW=mp(DW),MW=mp(LW),QI=function(t){o_.default(e,t);function e(){var n;return n=t.call(this)||this,n.buffer="",n}var r=e.prototype;return r.push=function(i){var a;for(this.buffer+=i,a=this.buffer.indexOf(`
`);a>-1;a=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,a)),this.buffer=this.buffer.substring(a+1)},e}(u_.default),$W="	",a_=function(e){var r=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),n={};return r[1]&&(n.length=parseInt(r[1],10)),r[2]&&(n.offset=parseInt(r[2],10)),n},UW=function(){var e="[^=]*",r='"[^"]*"|[^,]*',n="(?:"+e+")=(?:"+r+")";return new RegExp("(?:^|,)("+n+")")},Ls=function(e){for(var r=e.split(UW()),n={},i=r.length,a;i--;)r[i]!==""&&(a=/([^=]*)=(.*)/.exec(r[i]).slice(1),a[0]=a[0].replace(/^\s+|\s+$/g,""),a[1]=a[1].replace(/^\s+|\s+$/g,""),a[1]=a[1].replace(/^['"](.*)['"]$/g,"$1"),n[a[0]]=a[1]);return n},ZI=function(t){o_.default(e,t);function e(){var n;return n=t.call(this)||this,n.customParsers=[],n.tagMappers=[],n}var r=e.prototype;return r.push=function(i){var a=this,s,o;if(i=i.trim(),i.length!==0){if(i[0]!=="#"){this.trigger("data",{type:"uri",uri:i});return}var c=this.tagMappers.reduce(function(l,f){var g=f(i);return g===i?l:l.concat([g])},[i]);c.forEach(function(l){for(var f=0;f<a.customParsers.length;f++)if(a.customParsers[f].call(a,l))return;if(l.indexOf("#EXT")!==0){a.trigger("data",{type:"comment",text:l.slice(1)});return}if(l=l.replace("\r",""),s=/^#EXTM3U/.exec(l),s){a.trigger("data",{type:"tag",tagType:"m3u"});return}if(s=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(l),s){o={type:"tag",tagType:"inf"},s[1]&&(o.duration=parseFloat(s[1])),s[2]&&(o.title=s[2]),a.trigger("data",o);return}if(s=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"targetduration"},s[1]&&(o.duration=parseInt(s[1],10)),a.trigger("data",o);return}if(s=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"version"},s[1]&&(o.version=parseInt(s[1],10)),a.trigger("data",o);return}if(s=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"media-sequence"},s[1]&&(o.number=parseInt(s[1],10)),a.trigger("data",o);return}if(s=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(l),s){o={type:"tag",tagType:"discontinuity-sequence"},s[1]&&(o.number=parseInt(s[1],10)),a.trigger("data",o);return}if(s=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"playlist-type"},s[1]&&(o.playlistType=s[1]),a.trigger("data",o);return}if(s=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(l),s){o=JI.default(a_(s[1]),{type:"tag",tagType:"byterange"}),a.trigger("data",o);return}if(s=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(l),s){o={type:"tag",tagType:"allow-cache"},s[1]&&(o.allowed=!/NO/.test(s[1])),a.trigger("data",o);return}if(s=/^#EXT-X-MAP:?(.*)$/.exec(l),s){if(o={type:"tag",tagType:"map"},s[1]){var g=Ls(s[1]);g.URI&&(o.uri=g.URI),g.BYTERANGE&&(o.byterange=a_(g.BYTERANGE))}a.trigger("data",o);return}if(s=/^#EXT-X-STREAM-INF:?(.*)$/.exec(l),s){if(o={type:"tag",tagType:"stream-inf"},s[1]){if(o.attributes=Ls(s[1]),o.attributes.RESOLUTION){var m=o.attributes.RESOLUTION.split("x"),y={};m[0]&&(y.width=parseInt(m[0],10)),m[1]&&(y.height=parseInt(m[1],10)),o.attributes.RESOLUTION=y}o.attributes.BANDWIDTH&&(o.attributes.BANDWIDTH=parseInt(o.attributes.BANDWIDTH,10)),o.attributes["PROGRAM-ID"]&&(o.attributes["PROGRAM-ID"]=parseInt(o.attributes["PROGRAM-ID"],10))}a.trigger("data",o);return}if(s=/^#EXT-X-MEDIA:?(.*)$/.exec(l),s){o={type:"tag",tagType:"media"},s[1]&&(o.attributes=Ls(s[1])),a.trigger("data",o);return}if(s=/^#EXT-X-ENDLIST/.exec(l),s){a.trigger("data",{type:"tag",tagType:"endlist"});return}if(s=/^#EXT-X-DISCONTINUITY/.exec(l),s){a.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(s=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(l),s){o={type:"tag",tagType:"program-date-time"},s[1]&&(o.dateTimeString=s[1],o.dateTimeObject=new Date(s[1])),a.trigger("data",o);return}if(s=/^#EXT-X-KEY:?(.*)$/.exec(l),s){o={type:"tag",tagType:"key"},s[1]&&(o.attributes=Ls(s[1]),o.attributes.IV&&(o.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(o.attributes.IV=o.attributes.IV.substring(2)),o.attributes.IV=o.attributes.IV.match(/.{8}/g),o.attributes.IV[0]=parseInt(o.attributes.IV[0],16),o.attributes.IV[1]=parseInt(o.attributes.IV[1],16),o.attributes.IV[2]=parseInt(o.attributes.IV[2],16),o.attributes.IV[3]=parseInt(o.attributes.IV[3],16),o.attributes.IV=new Uint32Array(o.attributes.IV))),a.trigger("data",o);return}if(s=/^#EXT-X-START:?(.*)$/.exec(l),s){o={type:"tag",tagType:"start"},s[1]&&(o.attributes=Ls(s[1]),o.attributes["TIME-OFFSET"]=parseFloat(o.attributes["TIME-OFFSET"]),o.attributes.PRECISE=/YES/.test(o.attributes.PRECISE)),a.trigger("data",o);return}if(s=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"cue-out-cont"},s[1]?o.data=s[1]:o.data="",a.trigger("data",o);return}if(s=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"cue-out"},s[1]?o.data=s[1]:o.data="",a.trigger("data",o);return}if(s=/^#EXT-X-CUE-IN:?(.*)?$/.exec(l),s){o={type:"tag",tagType:"cue-in"},s[1]?o.data=s[1]:o.data="",a.trigger("data",o);return}if(s=/^#EXT-X-SKIP:(.*)$/.exec(l),s&&s[1]){o={type:"tag",tagType:"skip"},o.attributes=Ls(s[1]),o.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(o.attributes["SKIPPED-SEGMENTS"]=parseInt(o.attributes["SKIPPED-SEGMENTS"],10)),o.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(o.attributes["RECENTLY-REMOVED-DATERANGES"]=o.attributes["RECENTLY-REMOVED-DATERANGES"].split($W)),a.trigger("data",o);return}if(s=/^#EXT-X-PART:(.*)$/.exec(l),s&&s[1]){o={type:"tag",tagType:"part"},o.attributes=Ls(s[1]),["DURATION"].forEach(function(A){o.attributes.hasOwnProperty(A)&&(o.attributes[A]=parseFloat(o.attributes[A]))}),["INDEPENDENT","GAP"].forEach(function(A){o.attributes.hasOwnProperty(A)&&(o.attributes[A]=/YES/.test(o.attributes[A]))}),o.attributes.hasOwnProperty("BYTERANGE")&&(o.attributes.byterange=a_(o.attributes.BYTERANGE)),a.trigger("data",o);return}if(s=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(l),s&&s[1]){o={type:"tag",tagType:"server-control"},o.attributes=Ls(s[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(A){o.attributes.hasOwnProperty(A)&&(o.attributes[A]=parseFloat(o.attributes[A]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(A){o.attributes.hasOwnProperty(A)&&(o.attributes[A]=/YES/.test(o.attributes[A]))}),a.trigger("data",o);return}if(s=/^#EXT-X-PART-INF:(.*)$/.exec(l),s&&s[1]){o={type:"tag",tagType:"part-inf"},o.attributes=Ls(s[1]),["PART-TARGET"].forEach(function(A){o.attributes.hasOwnProperty(A)&&(o.attributes[A]=parseFloat(o.attributes[A]))}),a.trigger("data",o);return}if(s=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(l),s&&s[1]){o={type:"tag",tagType:"preload-hint"},o.attributes=Ls(s[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(A){if(o.attributes.hasOwnProperty(A)){o.attributes[A]=parseInt(o.attributes[A],10);var k=A==="BYTERANGE-LENGTH"?"length":"offset";o.attributes.byterange=o.attributes.byterange||{},o.attributes.byterange[k]=o.attributes[A],delete o.attributes[A]}}),a.trigger("data",o);return}if(s=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(l),s&&s[1]){o={type:"tag",tagType:"rendition-report"},o.attributes=Ls(s[1]),["LAST-MSN","LAST-PART"].forEach(function(A){o.attributes.hasOwnProperty(A)&&(o.attributes[A]=parseInt(o.attributes[A],10))}),a.trigger("data",o);return}a.trigger("data",{type:"tag",data:l.slice(4)})})}},r.addParser=function(i){var a=this,s=i.expression,o=i.customType,c=i.dataParser,l=i.segment;typeof c!="function"&&(c=function(g){return g}),this.customParsers.push(function(f){var g=s.exec(f);if(g)return a.trigger("data",{type:"custom",data:c(f),customType:o,segment:l}),!0})},r.addTagMapper=function(i){var a=i.expression,s=i.map,o=function(l){return a.test(l)?s(l):l};this.tagMappers.push(o)},e}(u_.default),FW=function(e){return e.toLowerCase().replace(/-(\w)/g,function(r){return r[1].toUpperCase()})},td=function(e){var r={};return Object.keys(e).forEach(function(n){r[FW(n)]=e[n]}),r},s_=function(e){var r=e.serverControl,n=e.targetDuration,i=e.partTargetDuration;if(r){var a="#EXT-X-SERVER-CONTROL",s="holdBack",o="partHoldBack",c=n&&n*3,l=i&&i*2;n&&!r.hasOwnProperty(s)&&(r[s]=c,this.trigger("info",{message:a+" defaulting HOLD-BACK to targetDuration * 3 ("+c+")."})),c&&r[s]<c&&(this.trigger("warn",{message:a+" clamping HOLD-BACK ("+r[s]+") to targetDuration * 3 ("+c+")"}),r[s]=c),i&&!r.hasOwnProperty(o)&&(r[o]=i*3,this.trigger("info",{message:a+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+r[o]+")."})),i&&r[o]<l&&(this.trigger("warn",{message:a+" clamping PART-HOLD-BACK ("+r[o]+") to partTargetDuration * 2 ("+l+")."}),r[o]=l)}},BW=function(t){o_.default(e,t);function e(){var n;n=t.call(this)||this,n.lineStream=new QI,n.parseStream=new ZI,n.lineStream.pipe(n.parseStream);var i=NW.default(n),a=[],s={},o,c,l=!1,f=function(){},g={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},m="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",y=0;n.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var A=0,k=0;return n.on("end",function(){s.uri||!s.parts&&!s.preloadHints||(!s.map&&o&&(s.map=o),!s.key&&c&&(s.key=c),!s.timeline&&typeof y=="number"&&(s.timeline=y),n.manifest.preloadSegment=s)}),n.parseStream.on("data",function(I){var F,J;({tag:function(){({version:function(){I.version&&(this.manifest.version=I.version)},"allow-cache":function(){this.manifest.allowCache=I.allowed,"allowed"in I||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var H={};"length"in I&&(s.byterange=H,H.length=I.length,"offset"in I||(I.offset=A)),"offset"in I&&(s.byterange=H,H.offset=I.offset),A=H.offset+H.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),I.duration>0&&(s.duration=I.duration),I.duration===0&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(!I.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(I.attributes.METHOD==="NONE"){c=null;return}if(!I.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(I.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:I.attributes};return}if(I.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:I.attributes.URI};return}if(I.attributes.KEYFORMAT===m){var H=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];if(H.indexOf(I.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(I.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),I.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(I.attributes.KEYID&&I.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:I.attributes.KEYFORMAT,keyId:I.attributes.KEYID.substring(2)},pssh:MW.default(I.attributes.URI.split(",")[1])};return}I.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),c={method:I.attributes.METHOD||"AES-128",uri:I.attributes.URI},typeof I.attributes.IV<"u"&&(c.iv=I.attributes.IV)},"media-sequence":function(){if(!isFinite(I.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+I.number});return}this.manifest.mediaSequence=I.number},"discontinuity-sequence":function(){if(!isFinite(I.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+I.number});return}this.manifest.discontinuitySequence=I.number,y=I.number},"playlist-type":function(){if(!/VOD|EVENT/.test(I.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+I.playlist});return}this.manifest.playlistType=I.playlistType},map:function(){o={},I.uri&&(o.uri=I.uri),I.byterange&&(o.byterange=I.byterange),c&&(o.key=c)},"stream-inf":function(){if(this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||g,!I.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}s.attributes||(s.attributes={}),JI.default(s.attributes,I.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||g,!(I.attributes&&I.attributes.TYPE&&I.attributes["GROUP-ID"]&&I.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var H=this.manifest.mediaGroups[I.attributes.TYPE];H[I.attributes["GROUP-ID"]]=H[I.attributes["GROUP-ID"]]||{},F=H[I.attributes["GROUP-ID"]],J={default:/yes/i.test(I.attributes.DEFAULT)},J.default?J.autoselect=!0:J.autoselect=/yes/i.test(I.attributes.AUTOSELECT),I.attributes.LANGUAGE&&(J.language=I.attributes.LANGUAGE),I.attributes.URI&&(J.uri=I.attributes.URI),I.attributes["INSTREAM-ID"]&&(J.instreamId=I.attributes["INSTREAM-ID"]),I.attributes.CHARACTERISTICS&&(J.characteristics=I.attributes.CHARACTERISTICS),I.attributes.FORCED&&(J.forced=/yes/i.test(I.attributes.FORCED)),F[I.attributes.NAME]=J},discontinuity:function(){y+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=I.dateTimeString,this.manifest.dateTimeObject=I.dateTimeObject),s.dateTimeString=I.dateTimeString,s.dateTimeObject=I.dateTimeObject},targetduration:function(){if(!isFinite(I.duration)||I.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+I.duration});return}this.manifest.targetDuration=I.duration,s_.call(this,this.manifest)},start:function(){if(!I.attributes||isNaN(I.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:I.attributes["TIME-OFFSET"],precise:I.attributes.PRECISE}},"cue-out":function(){s.cueOut=I.data},"cue-out-cont":function(){s.cueOutCont=I.data},"cue-in":function(){s.cueIn=I.data},skip:function(){this.manifest.skip=td(I.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",I.attributes,["SKIPPED-SEGMENTS"])},part:function(){var H=this;l=!0;var j=this.manifest.segments.length,X=td(I.attributes);s.parts=s.parts||[],s.parts.push(X),X.byterange&&(X.byterange.hasOwnProperty("offset")||(X.byterange.offset=k),k=X.byterange.offset+X.byterange.length);var V=s.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+V+" for segment #"+j,I.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach(function(ie,fe){ie.hasOwnProperty("lastPart")||H.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+fe+" lacks required attribute(s): LAST-PART"})})},"server-control":function(){var H=this.manifest.serverControl=td(I.attributes);H.hasOwnProperty("canBlockReload")||(H.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),s_.call(this,this.manifest),H.canSkipDateranges&&!H.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var H=this.manifest.segments.length,j=td(I.attributes),X=j.type&&j.type==="PART";s.preloadHints=s.preloadHints||[],s.preloadHints.push(j),j.byterange&&(j.byterange.hasOwnProperty("offset")||(j.byterange.offset=X?k:0,X&&(k=j.byterange.offset+j.byterange.length)));var V=s.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+V+" for segment #"+H,I.attributes,["TYPE","URI"]),!!j.type)for(var ie=0;ie<s.preloadHints.length-1;ie++){var fe=s.preloadHints[ie];fe.type&&fe.type===j.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+V+" for segment #"+H+" has the same TYPE "+j.type+" as preload hint #"+ie})}},"rendition-report":function(){var H=td(I.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(H);var j=this.manifest.renditionReports.length-1,X=["LAST-MSN","URI"];l&&X.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+j,I.attributes,X)},"part-inf":function(){this.manifest.partInf=td(I.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",I.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),s_.call(this,this.manifest)}}[I.tagType]||f).call(i)},uri:function(){s.uri=I.uri,a.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),c&&(s.key=c),s.timeline=y,o&&(s.map=o),k=0,s={}},comment:function(){},custom:function(){I.segment?(s.custom=s.custom||{},s.custom[I.customType]=I.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[I.customType]=I.data)}})[I.type].call(i)}),n}var r=e.prototype;return r.warnOnMissingAttributes_=function(i,a,s){var o=[];s.forEach(function(c){a.hasOwnProperty(c)||o.push(c)}),o.length&&this.trigger("warn",{message:i+" lacks required attribute(s): "+o.join(", ")})},r.push=function(i){this.lineStream.push(i)},r.end=function(){this.lineStream.push(`
`),this.trigger("end")},r.addParser=function(i){this.parseStream.addParser(i)},r.addTagMapper=function(i){this.parseStream.addTagMapper(i)},e}(u_.default);vp.LineStream=QI;vp.ParseStream=ZI;vp.Parser=BW});var ok=D(Kr=>{"use strict";var qW=fp();Object.defineProperty(Kr,"__esModule",{value:!0});Kr.DEFAULT_VIDEO_CODEC=Kr.DEFAULT_AUDIO_CODEC=Kr.muxerSupportsCodec=Kr.browserSupportsCodec=Kr.getMimeForCodec=Kr.isTextCodec=Kr.isAudioCodec=Kr.isVideoCodec=Kr.codecsFromDefault=Kr.parseCodecs=Kr.mapLegacyAvcCodecs=Kr.translateLegacyCodecs=Kr.translateLegacyCodec=void 0;var c_=qW(fo()),ju={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},jW=["video","audio","text"],tk=["Video","Audio","Text"],l_=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(r,n,i){var a=("00"+Number(n).toString(16)).slice(-2),s=("00"+Number(i).toString(16)).slice(-2);return"avc1."+a+"00"+s})};Kr.translateLegacyCodec=l_;var rk=function(e){return e.map(l_)};Kr.translateLegacyCodecs=rk;var HW=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(r){return rk([r])[0]})};Kr.mapLegacyAvcCodecs=HW;var ik=function(e){e===void 0&&(e="");var r=e.split(","),n=[];return r.forEach(function(i){i=i.trim();var a;jW.forEach(function(s){var o=ju[s].exec(i.toLowerCase());if(!(!o||o.length<=1)){a=s;var c=i.substring(0,o[1].length),l=i.replace(c,"");n.push({type:c,details:l,mediaType:s})}}),a||n.push({type:i,details:"",mediaType:"unknown"})}),n};Kr.parseCodecs=ik;var GW=function(e,r){if(!e.mediaGroups.AUDIO||!r)return null;var n=e.mediaGroups.AUDIO[r];if(!n)return null;for(var i in n){var a=n[i];if(a.default&&a.playlists)return ik(a.playlists[0].attributes.CODECS)}return null};Kr.codecsFromDefault=GW;var VW=function(e){return e===void 0&&(e=""),ju.video.test(e.trim().toLowerCase())};Kr.isVideoCodec=VW;var nk=function(e){return e===void 0&&(e=""),ju.audio.test(e.trim().toLowerCase())};Kr.isAudioCodec=nk;var ak=function(e){return e===void 0&&(e=""),ju.text.test(e.trim().toLowerCase())};Kr.isTextCodec=ak;var sk=function(e){if(!(!e||typeof e!="string")){var r=e.toLowerCase().split(",").map(function(a){return l_(a.trim())}),n="video";r.length===1&&nk(r[0])?n="audio":r.length===1&&ak(r[0])&&(n="application");var i="mp4";return r.every(function(a){return ju.mp4.test(a)})?i="mp4":r.every(function(a){return ju.webm.test(a)})?i="webm":r.every(function(a){return ju.ogg.test(a)})&&(i="ogg"),n+"/"+i+';codecs="'+e+'"'}};Kr.getMimeForCodec=sk;var zW=function(e){return e===void 0&&(e=""),c_.default.MediaSource&&c_.default.MediaSource.isTypeSupported&&c_.default.MediaSource.isTypeSupported(sk(e))||!1};Kr.browserSupportsCodec=zW;var WW=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(r){r=r.trim();for(var n=0;n<tk.length;n++){var i=tk[n];if(ju["muxer"+i].test(r))return!0}return!1})};Kr.muxerSupportsCodec=WW;var KW="mp4a.40.2";Kr.DEFAULT_AUDIO_CODEC=KW;var XW="avc1.4d400d";Kr.DEFAULT_VIDEO_CODEC=XW});var uk=D(pm=>{"use strict";Object.defineProperty(pm,"__esModule",{value:!0});pm.simpleTypeFromSourceType=void 0;var YW=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,JW=/^application\/dash\+xml/i,QW=function(e){return YW.test(e)?"hls":JW.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null};pm.simpleTypeFromSourceType=QW});var Hu=D(dr=>{"use strict";var ZW=fp();Object.defineProperty(dr,"__esModule",{value:!0});dr.reverseBytes=dr.sliceBytes=dr.bytesMatch=dr.concatTypedArrays=dr.stringToBytes=dr.bytesToString=dr.numberToBytes=dr.bytesToNumber=dr.IS_LITTLE_ENDIAN=dr.IS_BIG_ENDIAN=dr.ENDIANNESS=dr.toBinaryString=dr.toHexString=dr.toUint8=dr.isTypedArray=dr.isArrayBufferView=dr.padStart=dr.countBytes=dr.countBits=void 0;var eK=ZW(fo()),tK=function(e,r){for(var n="";r--;)n+=e;return n},ck=function(e){return e.toString(2).length};dr.countBits=ck;var lk=function(e){return Math.ceil(ck(e)/8)};dr.countBytes=lk;var f_=function(e,r,n){return n===void 0&&(n=" "),(tK(n,r)+e.toString()).slice(-r)};dr.padStart=f_;var dk=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer};dr.isArrayBufferView=dk;var fk=function(e){return dk(e)};dr.isTypedArray=fk;var Yo=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!fk(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))};dr.toUint8=Yo;var rK=function(e){e=Yo(e);for(var r="",n=0;n<e.length;n++)r+=f_(e[n].toString(16),2,"0");return r};dr.toHexString=rK;var iK=function(e){e=Yo(e);for(var r="",n=0;n<e.length;n++)r+=f_(e[n].toString(2),8,"0");return r};dr.toBinaryString=iK;var $n=eK.default.BigInt||Number,d_=[$n("0x1"),$n("0x100"),$n("0x10000"),$n("0x1000000"),$n("0x100000000"),$n("0x10000000000"),$n("0x1000000000000"),$n("0x100000000000000"),$n("0x10000000000000000")],p_=function(){var t=new Uint16Array([65484]),e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"}();dr.ENDIANNESS=p_;var nK=p_==="big";dr.IS_BIG_ENDIAN=nK;var aK=p_==="little";dr.IS_LITTLE_ENDIAN=aK;var sK=function(e,r){var n=r===void 0?{}:r,i=n.signed,a=i===void 0?!1:i,s=n.le,o=s===void 0?!1:s;e=Yo(e);var c=o?"reduce":"reduceRight",l=e[c]?e[c]:Array.prototype[c],f=l.call(e,function(m,y,A){var k=o?A:Math.abs(A+1-e.length);return m+$n(y)*d_[k]},$n(0));if(a){var g=d_[e.length]/$n(2)-$n(1);f=$n(f),f>g&&(f-=g,f-=g,f-=$n(2))}return Number(f)};dr.bytesToNumber=sK;var oK=function(e,r){var n=r===void 0?{}:r,i=n.le,a=i===void 0?!1:i;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=$n(e);for(var s=lk(e),o=new Uint8Array(new ArrayBuffer(s)),c=0;c<s;c++){var l=a?c:Math.abs(c+1-o.length);o[l]=Number(e/d_[c]&$n(255)),e<0&&(o[l]=Math.abs(~o[l]),o[l]-=c===0?1:2)}return o};dr.numberToBytes=oK;var uK=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var r=String.fromCharCode.apply(null,Yo(e));try{return decodeURIComponent(escape(r))}catch{}return r};dr.bytesToString=uK;var cK=function(e,r){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;r||(e=unescape(encodeURIComponent(e)));for(var n=new Uint8Array(e.length),i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return n};dr.stringToBytes=cK;var lK=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];if(r=r.filter(function(o){return o&&(o.byteLength||o.length)&&typeof o!="string"}),r.length<=1)return Yo(r[0]);var i=r.reduce(function(o,c,l){return o+(c.byteLength||c.length)},0),a=new Uint8Array(i),s=0;return r.forEach(function(o){o=Yo(o),a.set(o,s),s+=o.byteLength}),a};dr.concatTypedArrays=lK;var dK=function(e,r,n){var i=n===void 0?{}:n,a=i.offset,s=a===void 0?0:a,o=i.mask,c=o===void 0?[]:o;e=Yo(e),r=Yo(r);var l=r.every?r.every:Array.prototype.every;return r.length&&e.length-s>=r.length&&l.call(r,function(f,g){var m=c[g]?c[g]&e[s+g]:e[s+g];return f===m})};dr.bytesMatch=dK;var fK=function(e,r,n){return Uint8Array.prototype.slice?Uint8Array.prototype.slice.call(e,r,n):new Uint8Array(Array.prototype.slice.call(e,r,n))};dr.sliceBytes=fK;var pK=function(e){return e.reverse?e.reverse():Array.prototype.reverse.call(e)};dr.reverseBytes=pK});var pk=D(hm=>{"use strict";Object.defineProperty(hm,"__esModule",{value:!0});hm.forEachMediaGroup=void 0;var hK=function(e,r,n){r.forEach(function(i){for(var a in e.mediaGroups[i])for(var s in e.mediaGroups[i][a]){var o=e.mediaGroups[i][a][s];n(o,i,a,s)}})};hm.forEachMediaGroup=hK});var yp=D(gm=>{"use strict";function h_(t,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(t):t}var hk=h_({HTML:"text/html",isHTML:function(t){return t===hk.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),gk=h_({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(t){return t===gk.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});gm.freeze=h_;gm.MIME_TYPE=hk;gm.NAMESPACE=gk});var E_=D(Gu=>{var gK=yp(),bp=gK.NAMESPACE;function mK(t){return t!==""}function vK(t){return t?t.split(/[\t\n\f\r ]+/).filter(mK):[]}function yK(t,e){return t.hasOwnProperty(e)||(t[e]=!0),t}function mk(t){if(!t)return[];var e=vK(t);return Object.keys(e.reduce(yK,{}))}function bK(t){return function(e){return t&&t.indexOf(e)!==-1}}function wp(t,e){for(var r in t)e[r]=t[r]}function Na(t,e){var r=t.prototype;if(!(r instanceof e)){let i=function(){};var n=i;i.prototype=e.prototype,i=new i,wp(r,i),t.prototype=r=i}r.constructor!=t&&(typeof t!="function"&&console.error("unknown Class:"+t),r.constructor=t)}var Ma={},Ns=Ma.ELEMENT_NODE=1,id=Ma.ATTRIBUTE_NODE=2,mm=Ma.TEXT_NODE=3,wk=Ma.CDATA_SECTION_NODE=4,Tk=Ma.ENTITY_REFERENCE_NODE=5,_K=Ma.ENTITY_NODE=6,Ek=Ma.PROCESSING_INSTRUCTION_NODE=7,xk=Ma.COMMENT_NODE=8,Ck=Ma.DOCUMENT_NODE=9,Ak=Ma.DOCUMENT_TYPE_NODE=10,Qo=Ma.DOCUMENT_FRAGMENT_NODE=11,wK=Ma.NOTATION_NODE=12,Xn={},Cn={},KCe=Xn.INDEX_SIZE_ERR=(Cn[1]="Index size error",1),XCe=Xn.DOMSTRING_SIZE_ERR=(Cn[2]="DOMString size error",2),TK=Xn.HIERARCHY_REQUEST_ERR=(Cn[3]="Hierarchy request error",3),YCe=Xn.WRONG_DOCUMENT_ERR=(Cn[4]="Wrong document",4),JCe=Xn.INVALID_CHARACTER_ERR=(Cn[5]="Invalid character",5),QCe=Xn.NO_DATA_ALLOWED_ERR=(Cn[6]="No data allowed",6),ZCe=Xn.NO_MODIFICATION_ALLOWED_ERR=(Cn[7]="No modification allowed",7),SK=Xn.NOT_FOUND_ERR=(Cn[8]="Not found",8),eAe=Xn.NOT_SUPPORTED_ERR=(Cn[9]="Not supported",9),vk=Xn.INUSE_ATTRIBUTE_ERR=(Cn[10]="Attribute in use",10),tAe=Xn.INVALID_STATE_ERR=(Cn[11]="Invalid state",11),rAe=Xn.SYNTAX_ERR=(Cn[12]="Syntax error",12),iAe=Xn.INVALID_MODIFICATION_ERR=(Cn[13]="Invalid modification",13),nAe=Xn.NAMESPACE_ERR=(Cn[14]="Invalid namespace",14),aAe=Xn.INVALID_ACCESS_ERR=(Cn[15]="Invalid access",15);function Fc(t,e){if(e instanceof Error)var r=e;else r=this,Error.call(this,Cn[t]),this.message=Cn[t],Error.captureStackTrace&&Error.captureStackTrace(this,Fc);return r.code=t,e&&(this.message=this.message+": "+e),r}Fc.prototype=Error.prototype;wp(Xn,Fc);function Jo(){}Jo.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var r=[],n=0;n<this.length;n++)rd(this[n],r,t,e);return r.join("")}};function nd(t,e){this._node=t,this._refresh=e,v_(this)}function v_(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var r=t._refresh(t._node);Fk(t,"length",r.length),wp(r,t),t._inc=e}}nd.prototype.item=function(t){return v_(this),this[t]};Na(nd,Jo);function vm(){}function Ik(t,e){for(var r=t.length;r--;)if(t[r]===e)return r}function yk(t,e,r,n){if(n?e[Ik(e,n)]=r:e[e.length++]=r,t){r.ownerElement=t;var i=t.ownerDocument;i&&(n&&Pk(i,t,n),EK(i,t,r))}}function bk(t,e,r){var n=Ik(e,r);if(n>=0){for(var i=e.length-1;n<i;)e[n]=e[++n];if(e.length=i,t){var a=t.ownerDocument;a&&(Pk(a,t,r),r.ownerElement=null)}}else throw Fc(SK,new Error(t.tagName+"@"+r))}vm.prototype={length:0,item:Jo.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var r=this[e];if(r.nodeName==t)return r}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new Fc(vk);var r=this.getNamedItem(t.nodeName);return yk(this._ownerElement,this,t,r),r},setNamedItemNS:function(t){var e=t.ownerElement,r;if(e&&e!=this._ownerElement)throw new Fc(vk);return r=this.getNamedItemNS(t.namespaceURI,t.localName),yk(this._ownerElement,this,t,r),r},removeNamedItem:function(t){var e=this.getNamedItem(t);return bk(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var r=this.getNamedItemNS(t,e);return bk(this._ownerElement,this,r),r},getNamedItemNS:function(t,e){for(var r=this.length;r--;){var n=this[r];if(n.localName==e&&n.namespaceURI==t)return n}return null}};function kk(){}kk.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,r){var n=new Tp;if(n.implementation=this,n.childNodes=new Jo,n.doctype=r||null,r&&n.appendChild(r),e){var i=n.createElementNS(t,e);n.appendChild(i)}return n},createDocumentType:function(t,e,r){var n=new bm;return n.name=t,n.nodeName=t,n.publicId=e||"",n.systemId=r||"",n}};function Yn(){}Yn.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return Dk(this,t,e)},replaceChild:function(t,e){this.insertBefore(t,e),e&&this.removeChild(e)},removeChild:function(t){return Rk(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(t){return m_(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==mm&&t.nodeType==mm?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var r=e._nsMap;if(r){for(var n in r)if(r[n]==t)return n}e=e.nodeType==id?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var r=e._nsMap;if(r&&t in r)return r[t];e=e.nodeType==id?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){var e=this.lookupPrefix(t);return e==null}};function Ok(t){return t=="<"&&"&lt;"||t==">"&&"&gt;"||t=="&"&&"&amp;"||t=='"'&&"&quot;"||"&#"+t.charCodeAt()+";"}wp(Ma,Yn);wp(Ma,Yn.prototype);function _p(t,e){if(e(t))return!0;if(t=t.firstChild)do if(_p(t,e))return!0;while(t=t.nextSibling)}function Tp(){}function EK(t,e,r){t&&t._inc++;var n=r.namespaceURI;n===bp.XMLNS&&(e._nsMap[r.prefix?r.localName:""]=r.value)}function Pk(t,e,r,n){t&&t._inc++;var i=r.namespaceURI;i===bp.XMLNS&&delete e._nsMap[r.prefix?r.localName:""]}function y_(t,e,r){if(t&&t._inc){t._inc++;var n=e.childNodes;if(r)n[n.length++]=r;else{for(var i=e.firstChild,a=0;i;)n[a++]=i,i=i.nextSibling;n.length=a}}}function Rk(t,e){var r=e.previousSibling,n=e.nextSibling;return r?r.nextSibling=n:t.firstChild=n,n?n.previousSibling=r:t.lastChild=r,y_(t.ownerDocument,t),e}function Dk(t,e,r){var n=e.parentNode;if(n&&n.removeChild(e),e.nodeType===Qo){var i=e.firstChild;if(i==null)return e;var a=e.lastChild}else i=a=e;var s=r?r.previousSibling:t.lastChild;i.previousSibling=s,a.nextSibling=r,s?s.nextSibling=i:t.firstChild=i,r==null?t.lastChild=a:r.previousSibling=a;do i.parentNode=t;while(i!==a&&(i=i.nextSibling));return y_(t.ownerDocument||t,t),e.nodeType==Qo&&(e.firstChild=e.lastChild=null),e}function xK(t,e){var r=e.parentNode;if(r){var n=t.lastChild;r.removeChild(e);var n=t.lastChild}var n=t.lastChild;return e.parentNode=t,e.previousSibling=n,e.nextSibling=null,n?n.nextSibling=e:t.firstChild=e,t.lastChild=e,y_(t.ownerDocument,t,e),e}Tp.prototype={nodeName:"#document",nodeType:Ck,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==Qo){for(var r=t.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,e),r=n}return t}return this.documentElement==null&&t.nodeType==Ns&&(this.documentElement=t),Dk(this,t,e),t.ownerDocument=this,t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),Rk(this,t)},importNode:function(t,e){return Uk(this,t,e)},getElementById:function(t){var e=null;return _p(this.documentElement,function(r){if(r.nodeType==Ns&&r.getAttribute("id")==t)return e=r,!0}),e},getElementsByClassName:function(t){var e=mk(t);return new nd(this,function(r){var n=[];return e.length>0&&_p(r.documentElement,function(i){if(i!==r&&i.nodeType===Ns){var a=i.getAttribute("class");if(a){var s=t===a;if(!s){var o=mk(a);s=e.every(bK(o))}s&&n.push(i)}}}),n})},createElement:function(t){var e=new Bc;e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new Jo;var r=e.attributes=new vm;return r._ownerElement=e,e},createDocumentFragment:function(){var t=new _m;return t.ownerDocument=this,t.childNodes=new Jo,t},createTextNode:function(t){var e=new b_;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new __;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new w_;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var r=new S_;return r.ownerDocument=this,r.tagName=r.target=t,r.nodeValue=r.data=e,r},createAttribute:function(t){var e=new ym;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new T_;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var r=new Bc,n=e.split(":"),i=r.attributes=new vm;return r.childNodes=new Jo,r.ownerDocument=this,r.nodeName=e,r.tagName=e,r.namespaceURI=t,n.length==2?(r.prefix=n[0],r.localName=n[1]):r.localName=e,i._ownerElement=r,r},createAttributeNS:function(t,e){var r=new ym,n=e.split(":");return r.ownerDocument=this,r.nodeName=e,r.name=e,r.namespaceURI=t,r.specified=!0,n.length==2?(r.prefix=n[0],r.localName=n[1]):r.localName=e,r}};Na(Tp,Yn);function Bc(){this._nsMap={}}Bc.prototype={nodeType:Ns,hasAttribute:function(t){return this.getAttributeNode(t)!=null},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var r=this.ownerDocument.createAttribute(t);r.value=r.nodeValue=""+e,this.setAttributeNode(r)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===Qo?this.insertBefore(t,null):xK(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var r=this.getAttributeNodeNS(t,e);r&&this.removeAttributeNode(r)},hasAttributeNS:function(t,e){return this.getAttributeNodeNS(t,e)!=null},getAttributeNS:function(t,e){var r=this.getAttributeNodeNS(t,e);return r&&r.value||""},setAttributeNS:function(t,e,r){var n=this.ownerDocument.createAttributeNS(t,e);n.value=n.nodeValue=""+r,this.setAttributeNode(n)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new nd(this,function(e){var r=[];return _p(e,function(n){n!==e&&n.nodeType==Ns&&(t==="*"||n.tagName==t)&&r.push(n)}),r})},getElementsByTagNameNS:function(t,e){return new nd(this,function(r){var n=[];return _p(r,function(i){i!==r&&i.nodeType===Ns&&(t==="*"||i.namespaceURI===t)&&(e==="*"||i.localName==e)&&n.push(i)}),n})}};Tp.prototype.getElementsByTagName=Bc.prototype.getElementsByTagName;Tp.prototype.getElementsByTagNameNS=Bc.prototype.getElementsByTagNameNS;Na(Bc,Yn);function ym(){}ym.prototype.nodeType=id;Na(ym,Yn);function Sp(){}Sp.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(Cn[TK])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,r){var n=this.data.substring(0,t),i=this.data.substring(t+e);r=n+r+i,this.nodeValue=this.data=r,this.length=r.length}};Na(Sp,Yn);function b_(){}b_.prototype={nodeName:"#text",nodeType:mm,splitText:function(t){var e=this.data,r=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};Na(b_,Sp);function __(){}__.prototype={nodeName:"#comment",nodeType:xk};Na(__,Sp);function w_(){}w_.prototype={nodeName:"#cdata-section",nodeType:wk};Na(w_,Sp);function bm(){}bm.prototype.nodeType=Ak;Na(bm,Yn);function Lk(){}Lk.prototype.nodeType=wK;Na(Lk,Yn);function Nk(){}Nk.prototype.nodeType=_K;Na(Nk,Yn);function T_(){}T_.prototype.nodeType=Tk;Na(T_,Yn);function _m(){}_m.prototype.nodeName="#document-fragment";_m.prototype.nodeType=Qo;Na(_m,Yn);function S_(){}S_.prototype.nodeType=Ek;Na(S_,Yn);function Mk(){}Mk.prototype.serializeToString=function(t,e,r){return $k.call(t,e,r)};Yn.prototype.toString=$k;function $k(t,e){var r=[],n=this.nodeType==9&&this.documentElement||this,i=n.prefix,a=n.namespaceURI;if(a&&i==null){var i=n.lookupPrefix(a);if(i==null)var s=[{namespace:a,prefix:null}]}return rd(this,r,t,e,s),r.join("")}function _k(t,e,r){var n=t.prefix||"",i=t.namespaceURI;if(!i||n==="xml"&&i===bp.XML||i===bp.XMLNS)return!1;for(var a=r.length;a--;){var s=r[a];if(s.prefix===n)return s.namespace!==i}return!0}function g_(t,e,r){t.push(" ",e,'="',r.replace(/[<&"]/g,Ok),'"')}function rd(t,e,r,n,i){if(i||(i=[]),n)if(t=n(t),t){if(typeof t=="string"){e.push(t);return}}else return;switch(t.nodeType){case Ns:var a=t.attributes,s=a.length,F=t.firstChild,o=t.tagName;r=bp.isHTML(t.namespaceURI)||r;var c=o;if(!r&&!t.prefix&&t.namespaceURI){for(var l,f=0;f<a.length;f++)if(a.item(f).name==="xmlns"){l=a.item(f).value;break}if(!l)for(var g=i.length-1;g>=0;g--){var m=i[g];if(m.prefix===""&&m.namespace===t.namespaceURI){l=m.namespace;break}}if(l!==t.namespaceURI)for(var g=i.length-1;g>=0;g--){var m=i[g];if(m.namespace===t.namespaceURI){m.prefix&&(c=m.prefix+":"+o);break}}}e.push("<",c);for(var y=0;y<s;y++){var A=a.item(y);A.prefix=="xmlns"?i.push({prefix:A.localName,namespace:A.value}):A.nodeName=="xmlns"&&i.push({prefix:"",namespace:A.value})}for(var y=0;y<s;y++){var A=a.item(y);if(_k(A,r,i)){var k=A.prefix||"",I=A.namespaceURI;g_(e,k?"xmlns:"+k:"xmlns",I),i.push({prefix:k,namespace:I})}rd(A,e,r,n,i)}if(o===c&&_k(t,r,i)){var k=t.prefix||"",I=t.namespaceURI;g_(e,k?"xmlns:"+k:"xmlns",I),i.push({prefix:k,namespace:I})}if(F||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(o)){if(e.push(">"),r&&/^script$/i.test(o))for(;F;)F.data?e.push(F.data):rd(F,e,r,n,i.slice()),F=F.nextSibling;else for(;F;)rd(F,e,r,n,i.slice()),F=F.nextSibling;e.push("</",c,">")}else e.push("/>");return;case Ck:case Qo:for(var F=t.firstChild;F;)rd(F,e,r,n,i.slice()),F=F.nextSibling;return;case id:return g_(e,t.name,t.value);case mm:return e.push(t.data.replace(/[<&]/g,Ok).replace(/]]>/g,"]]&gt;"));case wk:return e.push("<![CDATA[",t.data,"]]>");case xk:return e.push("<!--",t.data,"-->");case Ak:var J=t.publicId,pe=t.systemId;if(e.push("<!DOCTYPE ",t.name),J)e.push(" PUBLIC ",J),pe&&pe!="."&&e.push(" ",pe),e.push(">");else if(pe&&pe!=".")e.push(" SYSTEM ",pe,">");else{var L=t.internalSubset;L&&e.push(" [",L,"]"),e.push(">")}return;case Ek:return e.push("<?",t.target," ",t.data,"?>");case Tk:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function Uk(t,e,r){var n;switch(e.nodeType){case Ns:n=e.cloneNode(!1),n.ownerDocument=t;case Qo:break;case id:r=!0;break}if(n||(n=e.cloneNode(!1)),n.ownerDocument=t,n.parentNode=null,r)for(var i=e.firstChild;i;)n.appendChild(Uk(t,i,r)),i=i.nextSibling;return n}function m_(t,e,r){var n=new e.constructor;for(var i in e){var a=e[i];typeof a!="object"&&a!=n[i]&&(n[i]=a)}switch(e.childNodes&&(n.childNodes=new Jo),n.ownerDocument=t,n.nodeType){case Ns:var s=e.attributes,o=n.attributes=new vm,c=s.length;o._ownerElement=n;for(var l=0;l<c;l++)n.setAttributeNode(m_(t,s.item(l),!0));break;case id:r=!0}if(r)for(var f=e.firstChild;f;)n.appendChild(m_(t,f,r)),f=f.nextSibling;return n}function Fk(t,e,r){t[e]=r}try{if(Object.defineProperty){let t=function(e){switch(e.nodeType){case Ns:case Qo:var r=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&r.push(t(e)),e=e.nextSibling;return r.join("");default:return e.nodeValue}};CK=t,Object.defineProperty(nd.prototype,"length",{get:function(){return v_(this),this.$$length}}),Object.defineProperty(Yn.prototype,"textContent",{get:function(){return t(this)},set:function(e){switch(this.nodeType){case Ns:case Qo:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),Fk=function(e,r,n){e["$$"+r]=n}}}catch{}var CK;Gu.DocumentType=bm;Gu.DOMException=Fc;Gu.DOMImplementation=kk;Gu.Element=Bc;Gu.Node=Yn;Gu.NodeList=Jo;Gu.XMLSerializer=Mk});var qk=D(Ep=>{var Bk=yp().freeze;Ep.XML_ENTITIES=Bk({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'});Ep.HTML_ENTITIES=Bk({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"});Ep.entityMap=Ep.HTML_ENTITIES});var Xk=D(C_=>{var Ip=yp().NAMESPACE,x_=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,jk=new RegExp("[\\-\\.0-9"+x_.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Hk=new RegExp("^"+x_.source+jk.source+"*(?::"+x_.source+jk.source+"*)?$"),xp=0,Vu=1,ad=2,Cp=3,sd=4,od=5,Ap=6,wm=7;function ud(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,ud)}ud.prototype=new Error;ud.prototype.name=ud.name;function zk(){}zk.prototype={parse:function(t,e,r){var n=this.domBuilder;n.startDocument(),Wk(e,e={}),AK(t,e,r,n,this.errorHandler),n.endDocument()}};function AK(t,e,r,n,i){function a(Q){if(Q>65535){Q-=65536;var Fe=55296+(Q>>10),We=56320+(Q&1023);return String.fromCharCode(Fe,We)}else return String.fromCharCode(Q)}function s(Q){var Fe=Q.slice(1,-1);return Fe in r?r[Fe]:Fe.charAt(0)==="#"?a(parseInt(Fe.substr(1).replace("x","0x"))):(i.error("entity not found:"+Q),Q)}function o(Q){if(Q>k){var Fe=t.substring(k,Q).replace(/&#?\w+;/g,s);m&&c(k),n.characters(Fe,0,Q-k),k=Q}}function c(Q,Fe){for(;Q>=f&&(Fe=g.exec(t));)l=Fe.index,f=l+Fe[0].length,m.lineNumber++;m.columnNumber=Q-l+1}for(var l=0,f=0,g=/.*(?:\r\n?|\n)|.*$/g,m=n.locator,y=[{currentNSMap:e}],A={},k=0;;){try{var I=t.indexOf("<",k);if(I<0){if(!t.substr(k).match(/^\s*$/)){var F=n.doc,J=F.createTextNode(t.substr(k));F.appendChild(J),n.currentElement=J}return}switch(I>k&&o(I),t.charAt(I+1)){case"/":var Re=t.indexOf(">",I+3),pe=t.substring(I+2,Re).replace(/[ \t\n\r]+$/g,""),L=y.pop();Re<0?(pe=t.substring(I+2).replace(/[\s<].*/,""),i.error("end tag name: "+pe+" is not complete:"+L.tagName),Re=I+1+pe.length):pe.match(/\s</)&&(pe=pe.replace(/[\s<].*/,""),i.error("end tag name: "+pe+" maybe not complete"),Re=I+1+pe.length);var H=L.localNSMap,j=L.tagName==pe,X=j||L.tagName&&L.tagName.toLowerCase()==pe.toLowerCase();if(X){if(n.endElement(L.uri,L.localName,pe),H)for(var V in H)n.endPrefixMapping(V);j||i.fatalError("end tag name: "+pe+" is not match the current start tagName:"+L.tagName)}else y.push(L);Re++;break;case"?":m&&c(I),Re=RK(t,I,n);break;case"!":m&&c(I),Re=PK(t,I,n,i);break;default:m&&c(I);var ie=new Kk,fe=y[y.length-1].currentNSMap,Re=IK(t,I,ie,fe,s,i),ye=ie.length;if(!ie.closed&&OK(t,Re,ie.tagName,A)&&(ie.closed=!0,r.nbsp||i.warning("unclosed xml attribute")),m&&ye){for(var ze=Gk(m,{}),Ue=0;Ue<ye;Ue++){var de=ie[Ue];c(de.offset),de.locator=Gk(m,{})}n.locator=ze,Vk(ie,n,fe)&&y.push(ie),n.locator=m}else Vk(ie,n,fe)&&y.push(ie);Ip.isHTML(ie.uri)&&!ie.closed?Re=kK(t,Re,ie.tagName,s,n):Re++}}catch(Q){if(Q instanceof ud)throw Q;i.error("element parse error: "+Q),Re=-1}Re>k?k=Re:o(Math.max(I,k)+1)}}function Gk(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function IK(t,e,r,n,i,a){function s(y,A,k){r.attributeNames.hasOwnProperty(y)&&a.fatalError("Attribute "+y+" redefined"),r.addValue(y,A,k)}for(var o,c,l=++e,f=xp;;){var g=t.charAt(l);switch(g){case"=":if(f===Vu)o=t.slice(e,l),f=Cp;else if(f===ad)f=Cp;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(f===Cp||f===Vu)if(f===Vu&&(a.warning('attribute value must after "="'),o=t.slice(e,l)),e=l+1,l=t.indexOf(g,e),l>0)c=t.slice(e,l).replace(/&#?\w+;/g,i),s(o,c,e-1),f=od;else throw new Error("attribute value no end '"+g+"' match");else if(f==sd)c=t.slice(e,l).replace(/&#?\w+;/g,i),s(o,c,e),a.warning('attribute "'+o+'" missed start quot('+g+")!!"),e=l+1,f=od;else throw new Error('attribute value must after "="');break;case"/":switch(f){case xp:r.setTagName(t.slice(e,l));case od:case Ap:case wm:f=wm,r.closed=!0;case sd:case Vu:case ad:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),f==xp&&r.setTagName(t.slice(e,l)),l;case">":switch(f){case xp:r.setTagName(t.slice(e,l));case od:case Ap:case wm:break;case sd:case Vu:c=t.slice(e,l),c.slice(-1)==="/"&&(r.closed=!0,c=c.slice(0,-1));case ad:f===ad&&(c=o),f==sd?(a.warning('attribute "'+c+'" missed quot(")!'),s(o,c.replace(/&#?\w+;/g,i),e)):((!Ip.isHTML(n[""])||!c.match(/^(?:disabled|checked|selected)$/i))&&a.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),s(c,c,e));break;case Cp:throw new Error("attribute value missed!!")}return l;case"\x80":g=" ";default:if(g<=" ")switch(f){case xp:r.setTagName(t.slice(e,l)),f=Ap;break;case Vu:o=t.slice(e,l),f=ad;break;case sd:var c=t.slice(e,l).replace(/&#?\w+;/g,i);a.warning('attribute "'+c+'" missed quot(")!!'),s(o,c,e);case od:f=Ap;break}else switch(f){case ad:var m=r.tagName;(!Ip.isHTML(n[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&a.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),s(o,o,e),e=l,f=Vu;break;case od:a.warning('attribute space is required"'+o+'"!!');case Ap:f=Vu,e=l;break;case Cp:f=sd,e=l;break;case wm:throw new Error("elements closed character '/' and '>' must be connected to")}}l++}}function Vk(t,e,r){for(var n=t.tagName,i=null,g=t.length;g--;){var a=t[g],s=a.qName,o=a.value,m=s.indexOf(":");if(m>0)var c=a.prefix=s.slice(0,m),l=s.slice(m+1),f=c==="xmlns"&&l;else l=s,c=null,f=s==="xmlns"&&"";a.localName=l,f!==!1&&(i==null&&(i={},Wk(r,r={})),r[f]=i[f]=o,a.uri=Ip.XMLNS,e.startPrefixMapping(f,o))}for(var g=t.length;g--;){a=t[g];var c=a.prefix;c&&(c==="xml"&&(a.uri=Ip.XML),c!=="xmlns"&&(a.uri=r[c||""]))}var m=n.indexOf(":");m>0?(c=t.prefix=n.slice(0,m),l=t.localName=n.slice(m+1)):(c=null,l=t.localName=n);var y=t.uri=r[c||""];if(e.startElement(y,l,n,t),t.closed){if(e.endElement(y,l,n),i)for(c in i)e.endPrefixMapping(c)}else return t.currentNSMap=r,t.localNSMap=i,!0}function kK(t,e,r,n,i){if(/^(?:script|textarea)$/i.test(r)){var a=t.indexOf("</"+r+">",e),s=t.substring(e+1,a);if(/[&<]/.test(s))return/^script$/i.test(r)?(i.characters(s,0,s.length),a):(s=s.replace(/&#?\w+;/g,n),i.characters(s,0,s.length),a)}return e+1}function OK(t,e,r,n){var i=n[r];return i==null&&(i=t.lastIndexOf("</"+r+">"),i<e&&(i=t.lastIndexOf("</"+r)),n[r]=i),i<e}function Wk(t,e){for(var r in t)e[r]=t[r]}function PK(t,e,r,n){var i=t.charAt(e+2);switch(i){case"-":if(t.charAt(e+3)==="-"){var a=t.indexOf("-->",e+4);return a>e?(r.comment(t,e+4,a-e-4),a+3):(n.error("Unclosed comment"),-1)}else return-1;default:if(t.substr(e+3,6)=="CDATA["){var a=t.indexOf("]]>",e+9);return r.startCDATA(),r.characters(t,e+9,a-e-9),r.endCDATA(),a+3}var s=DK(t,e),o=s.length;if(o>1&&/!doctype/i.test(s[0][0])){var c=s[1][0],l=!1,f=!1;o>3&&(/^public$/i.test(s[2][0])?(l=s[3][0],f=o>4&&s[4][0]):/^system$/i.test(s[2][0])&&(f=s[3][0]));var g=s[o-1];return r.startDTD(c,l,f),r.endDTD(),g.index+g[0].length}}return-1}function RK(t,e,r){var n=t.indexOf("?>",e);if(n){var i=t.substring(e,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){var a=i[0].length;return r.processingInstruction(i[1],i[2]),n+2}else return-1}return-1}function Kk(){this.attributeNames={}}Kk.prototype={setTagName:function(t){if(!Hk.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,r){if(!Hk.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:r}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}};function DK(t,e){var r,n=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=e,i.exec(t);r=i.exec(t);)if(n.push(r),r[1])return n}C_.XMLReader=zk;C_.ParseError=ud});var tO=D(Op=>{var LK=yp(),I_=E_(),Yk=qk(),Zk=Xk(),NK=I_.DOMImplementation,Jk=LK.NAMESPACE,MK=Zk.ParseError,$K=Zk.XMLReader;function eO(t){this.options=t||{locator:{}}}eO.prototype.parseFromString=function(t,e){var r=this.options,n=new $K,i=r.domBuilder||new kp,a=r.errorHandler,s=r.locator,o=r.xmlns||{},c=/\/x?html?$/.test(e),l=c?Yk.HTML_ENTITIES:Yk.XML_ENTITIES;return s&&i.setDocumentLocator(s),n.errorHandler=UK(a,i,s),n.domBuilder=r.domBuilder||i,c&&(o[""]=Jk.HTML),o.xml=o.xml||Jk.XML,t&&typeof t=="string"?n.parse(t,o,l):n.errorHandler.error("invalid doc source"),i.doc};function UK(t,e,r){if(!t){if(e instanceof kp)return e;t=e}var n={},i=t instanceof Function;r=r||{};function a(s){var o=t[s];!o&&i&&(o=t.length==2?function(c){t(s,c)}:t),n[s]=o&&function(c){o("[xmldom "+s+"]	"+c+A_(r))}||function(){}}return a("warning"),a("error"),a("fatalError"),n}function kp(){this.cdata=!1}function cd(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}kp.prototype={startDocument:function(){this.doc=new NK().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,r,n){var i=this.doc,a=i.createElementNS(t,r||e),s=n.length;Tm(this,a),this.currentElement=a,this.locator&&cd(this.locator,a);for(var o=0;o<s;o++){var t=n.getURI(o),c=n.getValue(o),r=n.getQName(o),l=i.createAttributeNS(t,r);this.locator&&cd(n.getLocator(o),l),l.value=l.nodeValue=c,a.setAttributeNode(l)}},endElement:function(t,e,r){var n=this.currentElement,i=n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var r=this.doc.createProcessingInstruction(t,e);this.locator&&cd(this.locator,r),Tm(this,r)},ignorableWhitespace:function(t,e,r){},characters:function(t,e,r){if(t=Qk.apply(this,arguments),t){if(this.cdata)var n=this.doc.createCDATASection(t);else var n=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(t)&&this.doc.appendChild(n),this.locator&&cd(this.locator,n)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,r){t=Qk.apply(this,arguments);var n=this.doc.createComment(t);this.locator&&cd(this.locator,n),Tm(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var i=n.createDocumentType(t,e,r);this.locator&&cd(this.locator,i),Tm(this,i),this.doc.doctype=i}},warning:function(t){console.warn("[xmldom warning]	"+t,A_(this.locator))},error:function(t){console.error("[xmldom error]	"+t,A_(this.locator))},fatalError:function(t){throw new MK(t,this.locator)}};function A_(t){if(t)return`
@`+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function Qk(t,e,r){return typeof t=="string"?t.substr(e,r):t.length>=e+r||e?new java.lang.String(t,e,r)+"":t}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){kp.prototype[t]=function(){return null}});function Tm(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}Op.__DOMHandler=kp;Op.DOMParser=eO;Op.DOMImplementation=I_.DOMImplementation;Op.XMLSerializer=I_.XMLSerializer});var iO=D(Sm=>{var rO=E_();Sm.DOMImplementation=rO.DOMImplementation;Sm.XMLSerializer=rO.XMLSerializer;Sm.DOMParser=tO().DOMParser});var wO=D(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});var FK=i_(),BK=fo(),qK=pk(),jK=n_(),HK=iO();function P_(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var R_=P_(FK),$a=P_(BK),GK=P_(jK),VK="0.21.1",nO=function(e){return!!e&&typeof e=="object"},ma=function t(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.reduce(function(i,a){return typeof a!="object"||Object.keys(a).forEach(function(s){Array.isArray(i[s])&&Array.isArray(a[s])?i[s]=i[s].concat(a[s]):nO(i[s])&&nO(a[s])?i[s]=t(i[s],a[s]):i[s]=a[s]}),i},{})},dO=function(e){return Object.keys(e).map(function(r){return e[r]})},zK=function(e,r){for(var n=[],i=e;i<r;i++)n.push(i);return n},Em=function(e){return e.reduce(function(r,n){return r.concat(n)},[])},fO=function(e){if(!e.length)return[];for(var r=[],n=0;n<e.length;n++)r.push(e[n]);return r},WK=function(e,r){return e.reduce(function(n,i,a){return i[r]&&n.push(a),n},[])},O_=function(e,r){for(var n=0;n<e.length;n++)if(r(e[n]))return n;return-1},KK=function(e,r){return dO(e.reduce(function(n,i){return i.forEach(function(a){n[r(a)]=a}),n},{}))},dd={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},Pp=function(e){var r=e.baseUrl,n=r===void 0?"":r,i=e.source,a=i===void 0?"":i,s=e.range,o=s===void 0?"":s,c=e.indexRange,l=c===void 0?"":c,f={uri:a,resolvedUri:R_.default(n||"",a)};if(o||l){var g=o||l,m=g.split("-"),y=$a.default.BigInt?$a.default.BigInt(m[0]):parseInt(m[0],10),A=$a.default.BigInt?$a.default.BigInt(m[1]):parseInt(m[1],10);y<Number.MAX_SAFE_INTEGER&&typeof y=="bigint"&&(y=Number(y)),A<Number.MAX_SAFE_INTEGER&&typeof A=="bigint"&&(A=Number(A));var k;typeof A=="bigint"||typeof y=="bigint"?k=$a.default.BigInt(A)-$a.default.BigInt(y)+$a.default.BigInt(1):k=A-y+1,typeof k=="bigint"&&k<Number.MAX_SAFE_INTEGER&&(k=Number(k)),f.byterange={length:k,offset:y}}return f},XK=function(e){var r;return typeof e.offset=="bigint"||typeof e.length=="bigint"?r=$a.default.BigInt(e.offset)+$a.default.BigInt(e.length)-$a.default.BigInt(1):r=e.offset+e.length-1,e.offset+"-"+r},aO=function(e){return e&&typeof e!="number"&&(e=parseInt(e,10)),isNaN(e)?null:e},YK={static:function(e){var r=e.duration,n=e.timescale,i=n===void 0?1:n,a=e.sourceDuration,s=e.periodDuration,o=aO(e.endNumber),c=r/i;return typeof o=="number"?{start:0,end:o}:typeof s=="number"?{start:0,end:s/c}:{start:0,end:a/c}},dynamic:function(e){var r=e.NOW,n=e.clientOffset,i=e.availabilityStartTime,a=e.timescale,s=a===void 0?1:a,o=e.duration,c=e.periodStart,l=c===void 0?0:c,f=e.minimumUpdatePeriod,g=f===void 0?0:f,m=e.timeShiftBufferDepth,y=m===void 0?1/0:m,A=aO(e.endNumber),k=(r+n)/1e3,I=i+l,F=k+g,J=F-I,pe=Math.ceil(J*s/o),L=Math.floor((k-I-y)*s/o),H=Math.floor((k-I)*s/o);return{start:Math.max(0,L),end:typeof A=="number"?A:Math.min(pe,H)}}},JK=function(e){return function(r){var n=e.duration,i=e.timescale,a=i===void 0?1:i,s=e.periodStart,o=e.startNumber,c=o===void 0?1:o;return{number:c+r,duration:n/a,timeline:s,time:r*n}}},D_=function(e){var r=e.type,n=e.duration,i=e.timescale,a=i===void 0?1:i,s=e.periodDuration,o=e.sourceDuration,c=YK[r](e),l=c.start,f=c.end,g=zK(l,f).map(JK(e));if(r==="static"){var m=g.length-1,y=typeof s=="number"?s:o;g[m].duration=y-n/a*m}return g},pO=function(e){var r=e.baseUrl,n=e.initialization,i=n===void 0?{}:n,a=e.sourceDuration,s=e.indexRange,o=s===void 0?"":s,c=e.periodStart,l=e.presentationTime,f=e.number,g=f===void 0?0:f,m=e.duration;if(!r)throw new Error(dd.NO_BASE_URL);var y=Pp({baseUrl:r,source:i.sourceURL,range:i.range}),A=Pp({baseUrl:r,source:r,indexRange:o});if(A.map=y,m){var k=D_(e);k.length&&(A.duration=k[0].duration,A.timeline=k[0].timeline)}else a&&(A.duration=a,A.timeline=c);return A.presentationTime=l||c,A.number=g,[A]},hO=function(e,r,n){var i=e.sidx.map?e.sidx.map:null,a=e.sidx.duration,s=e.timeline||0,o=e.sidx.byterange,c=o.offset+o.length,l=r.timescale,f=r.references.filter(function(ie){return ie.referenceType!==1}),g=[],m=e.endList?"static":"dynamic",y=e.sidx.timeline,A=y,k=e.mediaSequence||0,I;typeof r.firstOffset=="bigint"?I=$a.default.BigInt(c)+r.firstOffset:I=c+r.firstOffset;for(var F=0;F<f.length;F++){var J=r.references[F],pe=J.referencedSize,L=J.subsegmentDuration,H=void 0;typeof I=="bigint"?H=I+$a.default.BigInt(pe)-$a.default.BigInt(1):H=I+pe-1;var j=I+"-"+H,X={baseUrl:n,timescale:l,timeline:s,periodStart:y,presentationTime:A,number:k,duration:L,sourceDuration:a,indexRange:j,type:m},V=pO(X)[0];i&&(V.map=i),g.push(V),typeof I=="bigint"?I+=$a.default.BigInt(pe):I+=pe,A+=L/l,k++}return e.segments=g,e},QK=["AUDIO","SUBTITLES"],ZK=1/60,gO=function(e){return KK(e,function(r){var n=r.timeline;return n}).sort(function(r,n){return r.timeline>n.timeline?1:-1})},e7=function(e,r){for(var n=0;n<e.length;n++)if(e[n].attributes.NAME===r)return e[n];return null},sO=function(e){var r=[];return qK.forEachMediaGroup(e,QK,function(n,i,a,s){r=r.concat(n.playlists||[])}),r},oO=function(e){var r=e.playlist,n=e.mediaSequence;r.mediaSequence=n,r.segments.forEach(function(i,a){i.number=r.mediaSequence+a})},t7=function(e){var r=e.oldPlaylists,n=e.newPlaylists,i=e.timelineStarts;n.forEach(function(a){a.discontinuitySequence=O_(i,function(f){var g=f.timeline;return g===a.timeline});var s=e7(r,a.attributes.NAME);if(s&&!a.sidx){var o=a.segments[0],c=O_(s.segments,function(f){return Math.abs(f.presentationTime-o.presentationTime)<ZK});if(c===-1){oO({playlist:a,mediaSequence:s.mediaSequence+s.segments.length}),a.segments[0].discontinuity=!0,a.discontinuityStarts.unshift(0),(!s.segments.length&&a.timeline>s.timeline||s.segments.length&&a.timeline>s.segments[s.segments.length-1].timeline)&&a.discontinuitySequence--;return}var l=s.segments[c];l.discontinuity&&!o.discontinuity&&(o.discontinuity=!0,a.discontinuityStarts.unshift(0),a.discontinuitySequence--),oO({playlist:a,mediaSequence:s.segments[c].number})}})},r7=function(e){var r=e.oldManifest,n=e.newManifest,i=r.playlists.concat(sO(r)),a=n.playlists.concat(sO(n));return n.timelineStarts=gO([r.timelineStarts,n.timelineStarts]),t7({oldPlaylists:i,newPlaylists:a,timelineStarts:n.timelineStarts}),n},mO=function(e){return e&&e.uri+"-"+XK(e.byterange)},k_=function(e){var r=dO(e.reduce(function(n,i){var a=i.attributes.id+(i.attributes.lang||"");if(!n[a])n[a]=i,n[a].attributes.timelineStarts=[];else{if(i.segments){var s;i.segments[0]&&(i.segments[0].discontinuity=!0),(s=n[a].segments).push.apply(s,i.segments)}i.attributes.contentProtection&&(n[a].attributes.contentProtection=i.attributes.contentProtection)}return n[a].attributes.timelineStarts.push({start:i.attributes.periodStart,timeline:i.attributes.periodStart}),n},{}));return r.map(function(n){return n.discontinuityStarts=WK(n.segments||[],"discontinuity"),n})},L_=function(e,r){var n=mO(e.sidx),i=n&&r[n]&&r[n].sidx;return i&&hO(e,i,e.sidx.resolvedUri),e},i7=function(e,r){if(r===void 0&&(r={}),!Object.keys(r).length)return e;for(var n in e)e[n]=L_(e[n],r);return e},n7=function(e,r){var n,i=e.attributes,a=e.segments,s=e.sidx,o=e.mediaSequence,c=e.discontinuitySequence,l=e.discontinuityStarts,f={attributes:(n={NAME:i.id,BANDWIDTH:i.bandwidth,CODECS:i.codecs},n["PROGRAM-ID"]=1,n),uri:"",endList:i.type==="static",timeline:i.periodStart,resolvedUri:"",targetDuration:i.duration,discontinuitySequence:c,discontinuityStarts:l,timelineStarts:i.timelineStarts,mediaSequence:o,segments:a};return i.contentProtection&&(f.contentProtection=i.contentProtection),s&&(f.sidx=s),r&&(f.attributes.AUDIO="audio",f.attributes.SUBTITLES="subs"),f},a7=function(e){var r,n=e.attributes,i=e.segments,a=e.mediaSequence,s=e.discontinuityStarts,o=e.discontinuitySequence;typeof i>"u"&&(i=[{uri:n.baseUrl,timeline:n.periodStart,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration);var c=(r={NAME:n.id,BANDWIDTH:n.bandwidth},r["PROGRAM-ID"]=1,r);return n.codecs&&(c.CODECS=n.codecs),{attributes:c,uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:n.baseUrl||"",targetDuration:n.duration,timelineStarts:n.timelineStarts,discontinuityStarts:s,discontinuitySequence:o,mediaSequence:a,segments:i}},s7=function(e,r,n){r===void 0&&(r={}),n===void 0&&(n=!1);var i,a=e.reduce(function(o,c){var l=c.attributes.role&&c.attributes.role.value||"",f=c.attributes.lang||"",g=c.attributes.label||"main";if(f&&!c.attributes.label){var m=l?" ("+l+")":"";g=""+c.attributes.lang+m}o[g]||(o[g]={language:f,autoselect:!0,default:l==="main",playlists:[],uri:""});var y=L_(n7(c,n),r);return o[g].playlists.push(y),typeof i>"u"&&l==="main"&&(i=c,i.default=!0),o},{});if(!i){var s=Object.keys(a)[0];a[s].default=!0}return a},o7=function(e,r){return r===void 0&&(r={}),e.reduce(function(n,i){var a=i.attributes.lang||"text";return n[a]||(n[a]={language:a,default:!1,autoselect:!1,playlists:[],uri:""}),n[a].playlists.push(L_(a7(i),r)),n},{})},u7=function(e){return e.reduce(function(r,n){return n&&n.forEach(function(i){var a=i.channel,s=i.language;r[s]={autoselect:!1,default:!1,instreamId:a,language:s},i.hasOwnProperty("aspectRatio")&&(r[s].aspectRatio=i.aspectRatio),i.hasOwnProperty("easyReader")&&(r[s].easyReader=i.easyReader),i.hasOwnProperty("3D")&&(r[s]["3D"]=i["3D"])}),r},{})},c7=function(e){var r,n=e.attributes,i=e.segments,a=e.sidx,s=e.discontinuityStarts,o={attributes:(r={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},r["PROGRAM-ID"]=1,r),uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuityStarts:s,timelineStarts:n.timelineStarts,segments:i};return n.contentProtection&&(o.contentProtection=n.contentProtection),a&&(o.sidx=a),o},l7=function(e){var r=e.attributes;return r.mimeType==="video/mp4"||r.mimeType==="video/webm"||r.contentType==="video"},d7=function(e){var r=e.attributes;return r.mimeType==="audio/mp4"||r.mimeType==="audio/webm"||r.contentType==="audio"},f7=function(e){var r=e.attributes;return r.mimeType==="text/vtt"||r.contentType==="text"},p7=function(e,r){e.forEach(function(n){n.mediaSequence=0,n.discontinuitySequence=O_(r,function(i){var a=i.timeline;return a===n.timeline}),n.segments&&n.segments.forEach(function(i,a){i.number=a})})},uO=function(e){return e?Object.keys(e).reduce(function(r,n){var i=e[n];return r.concat(i.playlists)},[]):[]},vO=function(e){var r,n=e.dashPlaylists,i=e.locations,a=e.sidxMapping,s=a===void 0?{}:a,o=e.previousManifest;if(!n.length)return{};var c=n[0].attributes,l=c.sourceDuration,f=c.type,g=c.suggestedPresentationDelay,m=c.minimumUpdatePeriod,y=k_(n.filter(l7)).map(c7),A=k_(n.filter(d7)),k=k_(n.filter(f7)),I=n.map(function(X){return X.attributes.captionServices}).filter(Boolean),F={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(r={AUDIO:{},VIDEO:{}},r["CLOSED-CAPTIONS"]={},r.SUBTITLES={},r),uri:"",duration:l,playlists:i7(y,s)};m>=0&&(F.minimumUpdatePeriod=m*1e3),i&&(F.locations=i),f==="dynamic"&&(F.suggestedPresentationDelay=g);var J=F.playlists.length===0,pe=A.length?s7(A,s,J):null,L=k.length?o7(k,s):null,H=y.concat(uO(pe),uO(L)),j=H.map(function(X){var V=X.timelineStarts;return V});return F.timelineStarts=gO(j),p7(H,F.timelineStarts),pe&&(F.mediaGroups.AUDIO.audio=pe),L&&(F.mediaGroups.SUBTITLES.subs=L),I.length&&(F.mediaGroups["CLOSED-CAPTIONS"].cc=u7(I)),o?r7({oldManifest:o,newManifest:F}):F},h7=function(e,r,n){var i=e.NOW,a=e.clientOffset,s=e.availabilityStartTime,o=e.timescale,c=o===void 0?1:o,l=e.periodStart,f=l===void 0?0:l,g=e.minimumUpdatePeriod,m=g===void 0?0:g,y=(i+a)/1e3,A=s+f,k=y+m,I=k-A;return Math.ceil((I*c-r)/n)},yO=function(e,r){for(var n=e.type,i=e.minimumUpdatePeriod,a=i===void 0?0:i,s=e.media,o=s===void 0?"":s,c=e.sourceDuration,l=e.timescale,f=l===void 0?1:l,g=e.startNumber,m=g===void 0?1:g,y=e.periodStart,A=[],k=-1,I=0;I<r.length;I++){var F=r[I],J=F.d,pe=F.r||0,L=F.t||0;k<0&&(k=L),L&&L>k&&(k=L);var H=void 0;if(pe<0){var j=I+1;j===r.length?n==="dynamic"&&a>0&&o.indexOf("$Number$")>0?H=h7(e,k,J):H=(c*f-k)/J:H=(r[j].t-k)/J}else H=pe+1;for(var X=m+A.length+H,V=m+A.length;V<X;)A.push({number:V,duration:J/f,time:k,timeline:y}),k+=J,V++}return A},g7=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,m7=function(e){return function(r,n,i,a){if(r==="$$")return"$";if(typeof e[n]>"u")return r;var s=""+e[n];return n==="RepresentationID"||(i?a=parseInt(a,10):a=1,s.length>=a)?s:""+new Array(a-s.length+1).join("0")+s}},cO=function(e,r){return e.replace(g7,m7(r))},v7=function(e,r){return!e.duration&&!r?[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodStart}]:e.duration?D_(e):yO(e,r)},y7=function(e,r){var n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},i=e.initialization,a=i===void 0?{sourceURL:"",range:""}:i,s=Pp({baseUrl:e.baseUrl,source:cO(a.sourceURL,n),range:a.range}),o=v7(e,r);return o.map(function(c){n.Number=c.number,n.Time=c.time;var l=cO(e.media||"",n),f=e.timescale||1,g=e.presentationTimeOffset||0,m=e.periodStart+(c.time-g)/f,y={uri:l,timeline:c.timeline,duration:c.duration,resolvedUri:R_.default(e.baseUrl||"",l),map:s,number:c.number,presentationTime:m};return y})},b7=function(e,r){var n=e.baseUrl,i=e.initialization,a=i===void 0?{}:i,s=Pp({baseUrl:n,source:a.sourceURL,range:a.range}),o=Pp({baseUrl:n,source:r.media,range:r.mediaRange});return o.map=s,o},_7=function(e,r){var n=e.duration,i=e.segmentUrls,a=i===void 0?[]:i,s=e.periodStart;if(!n&&!r||n&&r)throw new Error(dd.SEGMENT_TIME_UNSPECIFIED);var o=a.map(function(f){return b7(e,f)}),c;n&&(c=D_(e)),r&&(c=yO(e,r));var l=c.map(function(f,g){if(o[g]){var m=o[g],y=e.timescale||1,A=e.presentationTimeOffset||0;return m.timeline=f.timeline,m.duration=f.duration,m.number=f.number,m.presentationTime=s+(f.time-A)/y,m}}).filter(function(f){return f});return l},w7=function(e){var r=e.attributes,n=e.segmentInfo,i,a;n.template?(a=y7,i=ma(r,n.template)):n.base?(a=pO,i=ma(r,n.base)):n.list&&(a=_7,i=ma(r,n.list));var s={attributes:r};if(!a)return s;var o=a(i,n.segmentTimeline);if(i.duration){var c=i,l=c.duration,f=c.timescale,g=f===void 0?1:f;i.duration=l/g}else o.length?i.duration=o.reduce(function(m,y){return Math.max(m,Math.ceil(y.duration))},0):i.duration=0;return s.attributes=i,s.segments=o,n.base&&i.indexRange&&(s.sidx=o[0],s.segments=[]),s},bO=function(e){return e.map(w7)},Qi=function(e,r){return fO(e.childNodes).filter(function(n){var i=n.tagName;return i===r})},N_=function(e){return e.textContent.trim()},ld=function(e){var r=31536e3,n=30*24*60*60,i=24*60*60,a=60*60,s=60,o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/,c=o.exec(e);if(!c)return 0;var l=c.slice(1),f=l[0],g=l[1],m=l[2],y=l[3],A=l[4],k=l[5];return parseFloat(f||0)*r+parseFloat(g||0)*n+parseFloat(m||0)*i+parseFloat(y||0)*a+parseFloat(A||0)*s+parseFloat(k||0)},T7=function(e){var r=/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/;return r.test(e)&&(e+="Z"),Date.parse(e)},lO={mediaPresentationDuration:function(e){return ld(e)},availabilityStartTime:function(e){return T7(e)/1e3},minimumUpdatePeriod:function(e){return ld(e)},suggestedPresentationDelay:function(e){return ld(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return ld(e)},start:function(e){return ld(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},presentationTimeOffset:function(e){return parseInt(e,10)},duration:function(e){var r=parseInt(e,10);return isNaN(r)?ld(e):r},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},Jn=function(e){return e&&e.attributes?fO(e.attributes).reduce(function(r,n){var i=lO[n.name]||lO.DEFAULT;return r[n.name]=i(n.value),r},{}):{}},S7={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},xm=function(e,r){return r.length?Em(e.map(function(n){return r.map(function(i){return R_.default(n,N_(i))})})):e},M_=function(e){var r=Qi(e,"SegmentTemplate")[0],n=Qi(e,"SegmentList")[0],i=n&&Qi(n,"SegmentURL").map(function(m){return ma({tag:"SegmentURL"},Jn(m))}),a=Qi(e,"SegmentBase")[0],s=n||r,o=s&&Qi(s,"SegmentTimeline")[0],c=n||a||r,l=c&&Qi(c,"Initialization")[0],f=r&&Jn(r);f&&l?f.initialization=l&&Jn(l):f&&f.initialization&&(f.initialization={sourceURL:f.initialization});var g={template:f,segmentTimeline:o&&Qi(o,"S").map(function(m){return Jn(m)}),list:n&&ma(Jn(n),{segmentUrls:i,initialization:Jn(l)}),base:a&&ma(Jn(a),{initialization:Jn(l)})};return Object.keys(g).forEach(function(m){g[m]||delete g[m]}),g},E7=function(e,r,n){return function(i){var a=Qi(i,"BaseURL"),s=xm(r,a),o=ma(e,Jn(i)),c=M_(i);return s.map(function(l){return{segmentInfo:ma(n,c),attributes:ma(o,{baseUrl:l})}})}},x7=function(e){return e.reduce(function(r,n){var i=Jn(n);i.schemeIdUri&&(i.schemeIdUri=i.schemeIdUri.toLowerCase());var a=S7[i.schemeIdUri];if(a){r[a]={attributes:i};var s=Qi(n,"cenc:pssh")[0];if(s){var o=N_(s);r[a].pssh=o&&GK.default(o)}}return r},{})},C7=function(e){if(e.schemeIdUri==="urn:scte:dash:cc:cea-608:2015"){var r=typeof e.value!="string"?[]:e.value.split(";");return r.map(function(i){var a,s;if(s=i,/^CC\d=/.test(i)){var o=i.split("=");a=o[0],s=o[1]}else/^CC\d$/.test(i)&&(a=i);return{channel:a,language:s}})}else if(e.schemeIdUri==="urn:scte:dash:cc:cea-708:2015"){var n=typeof e.value!="string"?[]:e.value.split(";");return n.map(function(i){var a={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(i)){var s=i.split("="),o=s[0],c=s[1],l=c===void 0?"":c;a.channel=o,a.language=i,l.split(",").forEach(function(f){var g=f.split(":"),m=g[0],y=g[1];m==="lang"?a.language=y:m==="er"?a.easyReader=Number(y):m==="war"?a.aspectRatio=Number(y):m==="3D"&&(a["3D"]=Number(y))})}else a.language=i;return a.channel&&(a.channel="SERVICE"+a.channel),a})}},A7=function(e,r,n){return function(i){var a=Jn(i),s=xm(r,Qi(i,"BaseURL")),o=Qi(i,"Role")[0],c={role:Jn(o)},l=ma(e,a,c),f=Qi(i,"Accessibility")[0],g=C7(Jn(f));g&&(l=ma(l,{captionServices:g}));var m=Qi(i,"Label")[0];if(m&&m.childNodes.length){var y=m.childNodes[0].nodeValue.trim();l=ma(l,{label:y})}var A=x7(Qi(i,"ContentProtection"));Object.keys(A).length&&(l=ma(l,{contentProtection:A}));var k=M_(i),I=Qi(i,"Representation"),F=ma(n,k);return Em(I.map(E7(l,s,F)))}},I7=function(e,r){return function(n,i){var a=xm(r,Qi(n.node,"BaseURL")),s=ma(e,{periodStart:n.attributes.start});typeof n.attributes.duration=="number"&&(s.periodDuration=n.attributes.duration);var o=Qi(n.node,"AdaptationSet"),c=M_(n.node);return Em(o.map(A7(s,a,c)))}},k7=function(e){var r=e.attributes,n=e.priorPeriodAttributes,i=e.mpdType;return typeof r.start=="number"?r.start:n&&typeof n.start=="number"&&typeof n.duration=="number"?n.start+n.duration:!n&&i==="static"?0:null},_O=function(e,r){r===void 0&&(r={});var n=r,i=n.manifestUri,a=i===void 0?"":i,s=n.NOW,o=s===void 0?Date.now():s,c=n.clientOffset,l=c===void 0?0:c,f=Qi(e,"Period");if(!f.length)throw new Error(dd.INVALID_NUMBER_OF_PERIOD);var g=Qi(e,"Location"),m=Jn(e),y=xm([a],Qi(e,"BaseURL"));m.type=m.type||"static",m.sourceDuration=m.mediaPresentationDuration||0,m.NOW=o,m.clientOffset=l,g.length&&(m.locations=g.map(N_));var A=[];return f.forEach(function(k,I){var F=Jn(k),J=A[I-1];F.start=k7({attributes:F,priorPeriodAttributes:J?J.attributes:null,mpdType:m.type}),A.push({node:k,attributes:F})}),{locations:m.locations,representationInfo:Em(A.map(I7(m,y)))}},$_=function(e){if(e==="")throw new Error(dd.DASH_EMPTY_MANIFEST);var r=new HK.DOMParser,n,i;try{n=r.parseFromString(e,"application/xml"),i=n&&n.documentElement.tagName==="MPD"?n.documentElement:null}catch{}if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(dd.DASH_INVALID_XML);return i},O7=function(e){var r=Qi(e,"UTCTiming")[0];if(!r)return null;var n=Jn(r);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(dd.UNSUPPORTED_UTC_TIMING_SCHEME)}return n},P7=VK,R7=function(e,r){r===void 0&&(r={});var n=_O($_(e),r),i=bO(n.representationInfo);return vO({dashPlaylists:i,locations:n.locations,sidxMapping:r.sidxMapping,previousManifest:r.previousManifest})},D7=function(e){return O7($_(e))};Ms.VERSION=P7;Ms.addSidxSegmentsToPlaylist=hO;Ms.generateSidxKey=mO;Ms.inheritAttributes=_O;Ms.parse=R7;Ms.parseUTCTiming=D7;Ms.stringToMpdXml=$_;Ms.toM3u8=vO;Ms.toPlaylists=bO});var EO=D((fAe,SO)=>{var TO=Math.pow(2,32),L7=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),r;return e.getBigUint64?(r=e.getBigUint64(0),r<Number.MAX_SAFE_INTEGER?Number(r):r):e.getUint32(0)*TO+e.getUint32(4)};SO.exports={getUint64:L7,MAX_UINT32:TO}});var AO=D((pAe,CO)=>{var xO=EO().getUint64,N7=function(t){var e=new DataView(t.buffer,t.byteOffset,t.byteLength),r={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:e.getUint32(4),timescale:e.getUint32(8)},n=12;r.version===0?(r.earliestPresentationTime=e.getUint32(n),r.firstOffset=e.getUint32(n+4),n+=8):(r.earliestPresentationTime=xO(t.subarray(n)),r.firstOffset=xO(t.subarray(n+8)),n+=16),n+=2;var i=e.getUint16(n);for(n+=2;i>0;n+=12,i--)r.references.push({referenceType:(t[n]&128)>>>7,referencedSize:e.getUint32(n)&2147483647,subsegmentDuration:e.getUint32(n+4),startsWithSap:!!(t[n+8]&128),sapType:(t[n+8]&112)>>>4,sapDeltaTime:e.getUint32(n+8)&268435455});return r};CO.exports=N7});var U_=D(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});fd.getId3Offset=fd.getId3Size=void 0;var Cm=Hu(),M7=(0,Cm.toUint8)([73,68,51]),IO=function(e,r){r===void 0&&(r=0),e=(0,Cm.toUint8)(e);var n=e[r+5],i=e[r+6]<<21|e[r+7]<<14|e[r+8]<<7|e[r+9],a=(n&16)>>4;return a?i+20:i+10};fd.getId3Size=IO;var $7=function t(e,r){return r===void 0&&(r=0),e=(0,Cm.toUint8)(e),e.length-r<10||!(0,Cm.bytesMatch)(e,M7,{offset:r})?r:(r+=IO(e,r),t(e,r))};fd.getId3Offset=$7});var F_=D(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.getHvcCodec=zu.getAvcCodec=zu.getAv1Codec=void 0;var qc=Hu(),U7=function(e){var r="",n=e[1]>>>3,i=e[1]&31,a=e[2]>>>7,s=(e[2]&64)>>6,o=(e[2]&32)>>5,c=(e[2]&16)>>4,l=(e[2]&8)>>3,f=(e[2]&4)>>2,g=e[2]&3;r+=n+"."+(0,qc.padStart)(i,2,"0"),a===0?r+="M":a===1&&(r+="H");var m;return n===2&&s?m=o?12:10:m=s?10:8,r+="."+(0,qc.padStart)(m,2,"0"),r+="."+c,r+="."+l+f+g,r};zu.getAv1Codec=U7;var F7=function(e){var r=(0,qc.toHexString)(e[1]),n=(0,qc.toHexString)(e[2]&252),i=(0,qc.toHexString)(e[3]);return""+r+n+i};zu.getAvcCodec=F7;var B7=function(e){var r="",n=e[1]>>6,i=e[1]&31,a=(e[1]&32)>>5,s=e.subarray(2,6),o=e.subarray(6,12),c=e[12];n===1?r+="A":n===2?r+="B":n===3&&(r+="C"),r+=i+".";var l=parseInt((0,qc.toBinaryString)(s).split("").reverse().join(""),2);l>255&&(l=parseInt((0,qc.toBinaryString)(s),2)),r+=l.toString(16)+".",a===0?r+="L":r+="H",r+=c;for(var f="",g=0;g<o.length;g++){var m=o[g];m&&(f&&(f+="."),f+=m.toString(16))}return f&&(r+="."+f),r};zu.getHvcCodec=B7});var kO=D(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.setOpusHead=Wu.parseOpusHead=Wu.OPUS_HEAD=void 0;var q7=new Uint8Array([79,112,117,115,72,101,97,100]);Wu.OPUS_HEAD=q7;var j7=function(e){var r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=r.getUint8(0),i=n!==0,a={version:n,channels:r.getUint8(1),preSkip:r.getUint16(2,i),sampleRate:r.getUint32(4,i),outputGain:r.getUint16(8,i),channelMappingFamily:r.getUint8(10)};if(a.channelMappingFamily>0&&e.length>10){a.streamCount=r.getUint8(11),a.twoChannelStreamCount=r.getUint8(12),a.channelMapping=[];for(var s=0;s<a.channels;s++)a.channelMapping.push(r.getUint8(13+s))}return a};Wu.parseOpusHead=j7;var H7=function(e){var r=e.channelMappingFamily<=0?11:12+e.channels,n=new DataView(new ArrayBuffer(r)),i=e.version!==0;return n.setUint8(0,e.version),n.setUint8(1,e.channels),n.setUint16(2,e.preSkip,i),n.setUint32(4,e.sampleRate,i),n.setUint16(8,e.outputGain,i),n.setUint8(10,e.channelMappingFamily),e.channelMappingFamily>0&&(n.setUint8(11,e.streamCount),e.channelMapping.foreach(function(a,s){n.setUint8(12+s,a)})),new Uint8Array(n.buffer)};Wu.setOpusHead=H7});var RO=D(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.parseMediaInfo=Qn.parseTracks=Qn.addSampleDescription=Qn.buildFrameTable=Qn.findNamedBox=Qn.findBox=Qn.parseDescriptors=void 0;var Mr=Hu(),B_=F_(),G7=kO(),q_=function(e){return typeof e=="string"?(0,Mr.stringToBytes)(e):e},V7=function(e){return Array.isArray(e)?e.map(function(r){return q_(r)}):[q_(e)]},j_,Am=function(e){e=(0,Mr.toUint8)(e);for(var r=[],n=0;e.length>n;){var i=e[n],a=0,s=0;s++;var o=e[s];for(s++;o&128;)a=(o&127)<<7,o=e[s],s++;a+=o&127;for(var c=0;c<j_.length;c++){var l=j_[c],f=l.id,g=l.parser;if(i===f){r.push(g(e.subarray(s,s+a)));break}}n+=a+s}return r};Qn.parseDescriptors=Am;j_=[{id:3,parser:function(e){var r={tag:3,id:e[0]<<8|e[1],flags:e[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(r.flags&128&&(r.dependsOnEsId=e[r.size]<<8|e[r.size+1],r.size+=2),r.flags&64){var n=e[r.size];r.url=(0,Mr.bytesToString)(e.subarray(r.size+1,r.size+1+n)),r.size+=n}return r.flags&32&&(r.ocrEsId=e[r.size]<<8|e[r.size+1],r.size+=2),r.descriptors=Am(e.subarray(r.size))||[],r}},{id:4,parser:function(e){var r={tag:4,oti:e[0],streamType:e[1],bufferSize:e[2]<<16|e[3]<<8|e[4],maxBitrate:e[5]<<24|e[6]<<16|e[7]<<8|e[8],avgBitrate:e[9]<<24|e[10]<<16|e[11]<<8|e[12],descriptors:Am(e.subarray(13))};return r}},{id:5,parser:function(e){return{tag:5,bytes:e}}},{id:6,parser:function(e){return{tag:6,bytes:e}}}];var Ua=function t(e,r,n){n===void 0&&(n=!1),r=V7(r),e=(0,Mr.toUint8)(e);var i=[];if(!r.length)return i;for(var a=0;a<e.length;){var s=(e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3])>>>0,o=e.subarray(a+4,a+8);if(s===0)break;var c=a+s;if(c>e.length){if(n)break;c=e.length}var l=e.subarray(a+8,c);(0,Mr.bytesMatch)(o,r[0])&&(r.length===1?i.push(l):i.push.apply(i,t(l,r.slice(1),n))),a=c}return i};Qn.findBox=Ua;var jc=function(e,r){if(r=q_(r),!r.length)return e.subarray(e.length);for(var n=0;n<e.length;){if((0,Mr.bytesMatch)(e.subarray(n,n+r.length),r)){var i=(e[n-4]<<24|e[n-3]<<16|e[n-2]<<8|e[n-1])>>>0,a=i>1?n+i:e.byteLength;return e.subarray(n+4,a)}n++}return e.subarray(e.length)};Qn.findNamedBox=jc;var Rp=function(e,r,n){r===void 0&&(r=4),n===void 0&&(n=function(c){return(0,Mr.bytesToNumber)(c)});var i=[];if(!e||!e.length)return i;for(var a=(0,Mr.bytesToNumber)(e.subarray(4,8)),s=8;a;s+=r,a--)i.push(n(e.subarray(s,s+r)));return i},OO=function(e,r){for(var n=Rp(Ua(e,["stss"])[0]),i=Rp(Ua(e,["stco"])[0]),a=Rp(Ua(e,["stts"])[0],8,function(ie){return{sampleCount:(0,Mr.bytesToNumber)(ie.subarray(0,4)),sampleDelta:(0,Mr.bytesToNumber)(ie.subarray(4,8))}}),s=Rp(Ua(e,["stsc"])[0],12,function(ie){return{firstChunk:(0,Mr.bytesToNumber)(ie.subarray(0,4)),samplesPerChunk:(0,Mr.bytesToNumber)(ie.subarray(4,8)),sampleDescriptionIndex:(0,Mr.bytesToNumber)(ie.subarray(8,12))}}),o=Ua(e,["stsz"])[0],c=Rp(o&&o.length&&o.subarray(4)||null),l=[],f=0;f<i.length;f++){for(var g=void 0,m=0;m<s.length;m++){var y=s[m],A=f+1>=y.firstChunk&&(m+1>=s.length||f+1<s[m+1].firstChunk);if(A){g=y.samplesPerChunk;break}}for(var k=i[f],I=0;I<g;I++){var F=c[l.length],J=!n.length;n.length&&n.indexOf(l.length+1)!==-1&&(J=!0);for(var pe={keyframe:J,start:k,end:k+F},L=0;L<a.length;L++){var H=a[L],j=H.sampleCount,X=H.sampleDelta;if(l.length<=j){var V=l.length?l[l.length-1].timestamp:0;pe.timestamp=V+X/r*1e3,pe.duration=X;break}}l.push(pe),k+=F}}return l};Qn.buildFrameTable=OO;var PO=function(e,r){var n=(0,Mr.bytesToString)(r.subarray(0,4));if(e.type==="video"?(e.info=e.info||{},e.info.width=r[28]<<8|r[29],e.info.height=r[30]<<8|r[31]):e.type==="audio"&&(e.info=e.info||{},e.info.channels=r[20]<<8|r[21],e.info.bitDepth=r[22]<<8|r[23],e.info.sampleRate=r[28]<<8|r[29]),n==="avc1"){var i=jc(r,"avcC");n+="."+(0,B_.getAvcCodec)(i),e.info.avcC=i}else if(n==="hvc1"||n==="hev1")n+="."+(0,B_.getHvcCodec)(jc(r,"hvcC"));else if(n==="mp4a"||n==="mp4v"){var a=jc(r,"esds"),s=Am(a.subarray(4))[0],o=s&&s.descriptors.filter(function(J){var pe=J.tag;return pe===4})[0];o?(n+="."+(0,Mr.toHexString)(o.oti),o.oti===64?n+="."+(o.descriptors[0].bytes[0]>>3).toString():o.oti===32?n+="."+o.descriptors[0].bytes[4].toString():o.oti===221&&(n="vorbis")):e.type==="audio"?n+=".40.2":n+=".20.9"}else if(n==="av01")n+="."+(0,B_.getAv1Codec)(jc(r,"av1C"));else if(n==="vp09"){var c=jc(r,"vpcC"),l=c[0],f=c[1],g=c[2]>>4,m=(c[2]&15)>>1,y=(c[2]&15)>>3,A=c[3],k=c[4],I=c[5];n+="."+(0,Mr.padStart)(l,2,"0"),n+="."+(0,Mr.padStart)(f,2,"0"),n+="."+(0,Mr.padStart)(g,2,"0"),n+="."+(0,Mr.padStart)(m,2,"0"),n+="."+(0,Mr.padStart)(A,2,"0"),n+="."+(0,Mr.padStart)(k,2,"0"),n+="."+(0,Mr.padStart)(I,2,"0"),n+="."+(0,Mr.padStart)(y,2,"0")}else if(n==="theo")n="theora";else if(n==="spex")n="speex";else if(n===".mp3")n="mp4a.40.34";else if(n==="msVo")n="vorbis";else if(n==="Opus"){n="opus";var F=jc(r,"dOps");e.info.opus=(0,G7.parseOpusHead)(F),e.info.codecDelay=65e5}else n=n.toLowerCase();e.codec=n};Qn.addSampleDescription=PO;var z7=function(e,r){r===void 0&&(r=!0),e=(0,Mr.toUint8)(e);var n=Ua(e,["moov","trak"],!0),i=[];return n.forEach(function(a){var s={bytes:a},o=Ua(a,["mdia"])[0],c=Ua(o,["hdlr"])[0],l=(0,Mr.bytesToString)(c.subarray(8,12));l==="soun"?s.type="audio":l==="vide"?s.type="video":s.type=l;var f=Ua(a,["tkhd"])[0];if(f){var g=new DataView(f.buffer,f.byteOffset,f.byteLength),m=g.getUint8(0);s.number=m===0?g.getUint32(12):g.getUint32(20)}var y=Ua(o,["mdhd"])[0];if(y){var A=y[0],k=A===0?12:20;s.timescale=(y[k]<<24|y[k+1]<<16|y[k+2]<<8|y[k+3])>>>0}for(var I=Ua(o,["minf","stbl"])[0],F=Ua(I,["stsd"])[0],J=(0,Mr.bytesToNumber)(F.subarray(4,8)),pe=8;J--;){var L=(0,Mr.bytesToNumber)(F.subarray(pe,pe+4)),H=F.subarray(pe+4,pe+4+L);PO(s,H),pe+=4+L}r&&(s.frameTable=OO(I,s.timescale)),i.push(s)}),i};Qn.parseTracks=z7;var W7=function(e){var r=Ua(e,["moov","mvhd"],!0)[0];if(!(!r||!r.length)){var n={};return r[0]===1?(n.timestampScale=(0,Mr.bytesToNumber)(r.subarray(20,24)),n.duration=(0,Mr.bytesToNumber)(r.subarray(24,32))):(n.timestampScale=(0,Mr.bytesToNumber)(r.subarray(12,16)),n.duration=(0,Mr.bytesToNumber)(r.subarray(16,20))),n.bytes=r,n}};Qn.parseMediaInfo=W7});var MO=D(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.parseData=ms.parseTracks=ms.decodeBlock=ms.findEbml=ms.EBML_TAGS=void 0;var ur=Hu(),H_=F_(),Gi={EBML:(0,ur.toUint8)([26,69,223,163]),DocType:(0,ur.toUint8)([66,130]),Segment:(0,ur.toUint8)([24,83,128,103]),SegmentInfo:(0,ur.toUint8)([21,73,169,102]),Tracks:(0,ur.toUint8)([22,84,174,107]),Track:(0,ur.toUint8)([174]),TrackNumber:(0,ur.toUint8)([215]),DefaultDuration:(0,ur.toUint8)([35,227,131]),TrackEntry:(0,ur.toUint8)([174]),TrackType:(0,ur.toUint8)([131]),FlagDefault:(0,ur.toUint8)([136]),CodecID:(0,ur.toUint8)([134]),CodecPrivate:(0,ur.toUint8)([99,162]),VideoTrack:(0,ur.toUint8)([224]),AudioTrack:(0,ur.toUint8)([225]),Cluster:(0,ur.toUint8)([31,67,182,117]),Timestamp:(0,ur.toUint8)([231]),TimestampScale:(0,ur.toUint8)([42,215,177]),BlockGroup:(0,ur.toUint8)([160]),BlockDuration:(0,ur.toUint8)([155]),Block:(0,ur.toUint8)([161]),SimpleBlock:(0,ur.toUint8)([163])};ms.EBML_TAGS=Gi;var G_=[128,64,32,16,8,4,2,1],K7=function(e){for(var r=1,n=0;n<G_.length&&!(e&G_[n]);n++)r++;return r},Hc=function(e,r,n,i){n===void 0&&(n=!0),i===void 0&&(i=!1);var a=K7(e[r]),s=e.subarray(r,r+a);return n&&(s=Array.prototype.slice.call(e,r,r+a),s[0]^=G_[a-1]),{length:a,value:(0,ur.bytesToNumber)(s,{signed:i}),bytes:s}},DO=function t(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(r){return t(r)}):typeof e=="number"?(0,ur.numberToBytes)(e):e},X7=function(e){return Array.isArray(e)?e.map(function(r){return DO(r)}):[DO(e)]},Y7=function t(e,r,n){if(n>=r.length)return r.length;var i=Hc(r,n,!1);if((0,ur.bytesMatch)(e.bytes,i.bytes))return n;var a=Hc(r,n+i.length);return t(e,r,n+a.length+a.value+i.length)},Hi=function t(e,r){r=X7(r),e=(0,ur.toUint8)(e);var n=[];if(!r.length)return n;for(var i=0;i<e.length;){var a=Hc(e,i,!1),s=Hc(e,i+a.length),o=i+a.length+s.length;s.value===127&&(s.value=Y7(a,e,o),s.value!==e.length&&(s.value-=o));var c=o+s.value>e.length?e.length:o+s.value,l=e.subarray(o,c);(0,ur.bytesMatch)(r[0],a.bytes)&&(r.length===1?n.push(l):n=n.concat(t(l,r.slice(1))));var f=a.length+s.length+l.length;i+=f}return n};ms.findEbml=Hi;var LO=function(e,r,n,i){var a;r==="group"&&(a=Hi(e,[Gi.BlockDuration])[0],a&&(a=(0,ur.bytesToNumber)(a),a=1/n*a*n/1e3),e=Hi(e,[Gi.Block])[0],r="block");var s=new DataView(e.buffer,e.byteOffset,e.byteLength),o=Hc(e,0),c=s.getInt16(o.length,!1),l=e[o.length+2],f=e.subarray(o.length+3),g=1/n*(i+c)*n/1e3,m={duration:a,trackNumber:o.value,keyframe:r==="simple"&&l>>7===1,invisible:(l&8)>>3===1,lacing:(l&6)>>1,discardable:r==="simple"&&(l&1)===1,frames:[],pts:g,dts:g,timestamp:c};if(!m.lacing)return m.frames.push(f),m;var y=f[0]+1,A=[],k=1;if(m.lacing===2)for(var I=(f.length-k)/y,F=0;F<y;F++)A.push(I);if(m.lacing===1)for(var J=0;J<y-1;J++){var pe=0;do pe+=f[k],k++;while(f[k-1]===255);A.push(pe)}if(m.lacing===3)for(var L=0,H=0;H<y-1;H++){var j=H===0?Hc(f,k):Hc(f,k,!0,!0);L+=j.value,A.push(L),k+=j.length}return A.forEach(function(X){m.frames.push(f.subarray(k,k+X)),k+=X}),m};ms.decodeBlock=LO;var J7=function(e){for(var r=0,n={};r<e.length;){var i=e[r]&127,a=e[r+1],s=void 0;a===1?s=e[r+2]:s=e.subarray(r+2,r+2+a),i===1?n.profile=s:i===2?n.level=s:i===3?n.bitDepth=s:i===4?n.chromaSubsampling=s:n[i]=s,r+=2+a}return n},NO=function(e){e=(0,ur.toUint8)(e);var r=[],n=Hi(e,[Gi.Segment,Gi.Tracks,Gi.Track]);return n.length||(n=Hi(e,[Gi.Tracks,Gi.Track])),n.length||(n=Hi(e,[Gi.Track])),n.length?(n.forEach(function(i){var a=Hi(i,Gi.TrackType)[0];if(!(!a||!a.length)){if(a[0]===1)a="video";else if(a[0]===2)a="audio";else if(a[0]===17)a="subtitle";else return;var s={rawCodec:(0,ur.bytesToString)(Hi(i,[Gi.CodecID])[0]),type:a,codecPrivate:Hi(i,[Gi.CodecPrivate])[0],number:(0,ur.bytesToNumber)(Hi(i,[Gi.TrackNumber])[0]),defaultDuration:(0,ur.bytesToNumber)(Hi(i,[Gi.DefaultDuration])[0]),default:Hi(i,[Gi.FlagDefault])[0],rawData:i},o="";if(/V_MPEG4\/ISO\/AVC/.test(s.rawCodec))o="avc1."+(0,H_.getAvcCodec)(s.codecPrivate);else if(/V_MPEGH\/ISO\/HEVC/.test(s.rawCodec))o="hev1."+(0,H_.getHvcCodec)(s.codecPrivate);else if(/V_MPEG4\/ISO\/ASP/.test(s.rawCodec))s.codecPrivate?o="mp4v.20."+s.codecPrivate[4].toString():o="mp4v.20.9";else if(/^V_THEORA/.test(s.rawCodec))o="theora";else if(/^V_VP8/.test(s.rawCodec))o="vp8";else if(/^V_VP9/.test(s.rawCodec))if(s.codecPrivate){var c=J7(s.codecPrivate),l=c.profile,f=c.level,g=c.bitDepth,m=c.chromaSubsampling;o="vp09.",o+=(0,ur.padStart)(l,2,"0")+".",o+=(0,ur.padStart)(f,2,"0")+".",o+=(0,ur.padStart)(g,2,"0")+".",o+=""+(0,ur.padStart)(m,2,"0");var y=Hi(i,[224,[85,176],[85,177]])[0]||[],A=Hi(i,[224,[85,176],[85,185]])[0]||[],k=Hi(i,[224,[85,176],[85,186]])[0]||[],I=Hi(i,[224,[85,176],[85,187]])[0]||[];(y.length||A.length||k.length||I.length)&&(o+="."+(0,ur.padStart)(I[0],2,"0"),o+="."+(0,ur.padStart)(k[0],2,"0"),o+="."+(0,ur.padStart)(y[0],2,"0"),o+="."+(0,ur.padStart)(A[0],2,"0"))}else o="vp9";else/^V_AV1/.test(s.rawCodec)?o="av01."+(0,H_.getAv1Codec)(s.codecPrivate):/A_ALAC/.test(s.rawCodec)?o="alac":/A_MPEG\/L2/.test(s.rawCodec)?o="mp2":/A_MPEG\/L3/.test(s.rawCodec)?o="mp3":/^A_AAC/.test(s.rawCodec)?s.codecPrivate?o="mp4a.40."+(s.codecPrivate[0]>>>3).toString():o="mp4a.40.2":/^A_AC3/.test(s.rawCodec)?o="ac-3":/^A_PCM/.test(s.rawCodec)?o="pcm":/^A_MS\/ACM/.test(s.rawCodec)?o="speex":/^A_EAC3/.test(s.rawCodec)?o="ec-3":/^A_VORBIS/.test(s.rawCodec)?o="vorbis":/^A_FLAC/.test(s.rawCodec)?o="flac":/^A_OPUS/.test(s.rawCodec)&&(o="opus");s.codec=o,r.push(s)}}),r.sort(function(i,a){return i.number-a.number})):r};ms.parseTracks=NO;var Q7=function(e,r){var n=[],i=Hi(e,[Gi.Segment])[0],a=Hi(i,[Gi.SegmentInfo,Gi.TimestampScale])[0];a&&a.length?a=(0,ur.bytesToNumber)(a):a=1e6;var s=Hi(i,[Gi.Cluster]);return r||(r=NO(i)),s.forEach(function(o,c){var l=Hi(o,[Gi.SimpleBlock]).map(function(y){return{type:"simple",data:y}}),f=Hi(o,[Gi.BlockGroup]).map(function(y){return{type:"group",data:y}}),g=Hi(o,[Gi.Timestamp])[0]||0;g&&g.length&&(g=(0,ur.bytesToNumber)(g));var m=l.concat(f).sort(function(y,A){return y.data.byteOffset-A.data.byteOffset});m.forEach(function(y,A){var k=LO(y.data,y.type,a,g);n.push(k)})}),{tracks:r,blocks:n}};ms.parseData=Q7});var qO=D(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.findH265Nal=Zn.findH264Nal=Zn.findNal=Zn.discardEmulationPreventionBytes=Zn.EMULATION_PREVENTION=Zn.NAL_TYPE_TWO=Zn.NAL_TYPE_ONE=void 0;var Gc=Hu(),$O=(0,Gc.toUint8)([0,0,0,1]);Zn.NAL_TYPE_ONE=$O;var UO=(0,Gc.toUint8)([0,0,1]);Zn.NAL_TYPE_TWO=UO;var FO=(0,Gc.toUint8)([0,0,3]);Zn.EMULATION_PREVENTION=FO;var BO=function(e){for(var r=[],n=1;n<e.length-2;)(0,Gc.bytesMatch)(e.subarray(n,n+3),FO)&&(r.push(n+2),n++),n++;if(r.length===0)return e;var i=e.length-r.length,a=new Uint8Array(i),s=0;for(n=0;n<i;s++,n++)s===r[0]&&(s++,r.shift()),a[n]=e[s];return a};Zn.discardEmulationPreventionBytes=BO;var V_=function(e,r,n,i){i===void 0&&(i=1/0),e=(0,Gc.toUint8)(e),n=[].concat(n);for(var a=0,s,o=0;a<e.length&&(o<i||s);){var c=void 0;if((0,Gc.bytesMatch)(e.subarray(a),$O)?c=4:(0,Gc.bytesMatch)(e.subarray(a),UO)&&(c=3),!c){a++;continue}if(o++,s)return BO(e.subarray(s,a));var l=void 0;r==="h264"?l=e[a+c]&31:r==="h265"&&(l=e[a+c]>>1&63),n.indexOf(l)!==-1&&(s=a+c),a+=c+(r==="h264"?1:2)}return e.subarray(0,0)};Zn.findNal=V_;var Z7=function(e,r,n){return V_(e,"h264",r,n)};Zn.findH264Nal=Z7;var e9=function(e,r,n){return V_(e,"h265",r,n)};Zn.findH265Nal=e9});var GO=D(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.isLikelyFmp4MediaSegment=Ku.detectContainerForBytes=Ku.isLikely=void 0;var Ir=Hu(),t9=RO(),pd=MO(),Im=U_(),jO=qO(),va={webm:(0,Ir.toUint8)([119,101,98,109]),matroska:(0,Ir.toUint8)([109,97,116,114,111,115,107,97]),flac:(0,Ir.toUint8)([102,76,97,67]),ogg:(0,Ir.toUint8)([79,103,103,83]),ac3:(0,Ir.toUint8)([11,119]),riff:(0,Ir.toUint8)([82,73,70,70]),avi:(0,Ir.toUint8)([65,86,73]),wav:(0,Ir.toUint8)([87,65,86,69]),"3gp":(0,Ir.toUint8)([102,116,121,112,51,103]),mp4:(0,Ir.toUint8)([102,116,121,112]),fmp4:(0,Ir.toUint8)([115,116,121,112]),mov:(0,Ir.toUint8)([102,116,121,112,113,116]),moov:(0,Ir.toUint8)([109,111,111,118]),moof:(0,Ir.toUint8)([109,111,111,102])},hd={aac:function(e){var r=(0,Im.getId3Offset)(e);return(0,Ir.bytesMatch)(e,[255,16],{offset:r,mask:[255,22]})},mp3:function(e){var r=(0,Im.getId3Offset)(e);return(0,Ir.bytesMatch)(e,[255,2],{offset:r,mask:[255,6]})},webm:function(e){var r=(0,pd.findEbml)(e,[pd.EBML_TAGS.EBML,pd.EBML_TAGS.DocType])[0];return(0,Ir.bytesMatch)(r,va.webm)},mkv:function(e){var r=(0,pd.findEbml)(e,[pd.EBML_TAGS.EBML,pd.EBML_TAGS.DocType])[0];return(0,Ir.bytesMatch)(r,va.matroska)},mp4:function(e){if(hd["3gp"](e)||hd.mov(e))return!1;if((0,Ir.bytesMatch)(e,va.mp4,{offset:4})||(0,Ir.bytesMatch)(e,va.fmp4,{offset:4})||(0,Ir.bytesMatch)(e,va.moof,{offset:4})||(0,Ir.bytesMatch)(e,va.moov,{offset:4}))return!0},mov:function(e){return(0,Ir.bytesMatch)(e,va.mov,{offset:4})},"3gp":function(e){return(0,Ir.bytesMatch)(e,va["3gp"],{offset:4})},ac3:function(e){var r=(0,Im.getId3Offset)(e);return(0,Ir.bytesMatch)(e,va.ac3,{offset:r})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var r=0;r+188<e.length&&r<188;){if(e[r]===71&&e[r+188]===71)return!0;r+=1}return!1},flac:function(e){var r=(0,Im.getId3Offset)(e);return(0,Ir.bytesMatch)(e,va.flac,{offset:r})},ogg:function(e){return(0,Ir.bytesMatch)(e,va.ogg)},avi:function(e){return(0,Ir.bytesMatch)(e,va.riff)&&(0,Ir.bytesMatch)(e,va.avi,{offset:8})},wav:function(e){return(0,Ir.bytesMatch)(e,va.riff)&&(0,Ir.bytesMatch)(e,va.wav,{offset:8})},h264:function(e){return(0,jO.findH264Nal)(e,7,3).length},h265:function(e){return(0,jO.findH265Nal)(e,[32,33],3).length}},z_=Object.keys(hd).filter(function(t){return t!=="ts"&&t!=="h264"&&t!=="h265"}).concat(["ts","h264","h265"]);z_.forEach(function(t){var e=hd[t];hd[t]=function(r){return e((0,Ir.toUint8)(r))}});var HO=hd;Ku.isLikely=HO;var r9=function(e){e=(0,Ir.toUint8)(e);for(var r=0;r<z_.length;r++){var n=z_[r];if(HO[n](e))return n}return""};Ku.detectContainerForBytes=r9;var i9=function(e){return(0,t9.findBox)(e,["moof"]).length>0};Ku.isLikelyFmp4MediaSegment=i9});var XO=D((wAe,KO)=>{var W_=9e4,K_,X_,km,Y_,VO,zO,WO;K_=function(t){return t*W_};X_=function(t,e){return t*e};km=function(t){return t/W_};Y_=function(t,e){return t/e};VO=function(t,e){return K_(Y_(t,e))};zO=function(t,e){return X_(km(t),e)};WO=function(t,e,r){return km(r?t:t-e)};KO.exports={ONE_SECOND_IN_TS:W_,secondsToVideoTs:K_,secondsToAudioTs:X_,videoTsToSeconds:km,audioTsToSeconds:Y_,audioTsToVideoTs:VO,videoTsToAudioTs:zO,metadataTsToSeconds:WO}});var WR=D((TAe,zR)=>{"use strict";var n9=fo(),a9=V0(),s9=sm(),o9=hI(),u9=K0(),c9=Y0(),l9=mI(),d9=EI(),f9=UI(),p9=BI(),h9=qI(),g9=i_(),m9=ek(),ci=ok(),VP=uk(),Bm=Hu(),Yc=wO(),v9=AO(),y9=U_(),qm=GO(),jm=XO();function is(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var Se=is(n9),yt=is(a9),el=is(s9),ar=is(o9),ir=is(u9),Ct=is(c9),b9=is(l9),zP=is(d9),YO=is(f9),_9=is(p9),w9=is(h9),T9=is(g9),S9=is(v9),WP="7.19.2",tu={},Xu=function(e,r){return tu[e]=tu[e]||[],r&&(tu[e]=tu[e].concat(r)),tu[e]},E9=function(e,r){Xu(e,r)},KP=function(e,r){var n=Xu(e).indexOf(r);return n<=-1?!1:(tu[e]=tu[e].slice(),tu[e].splice(n,1),!0)},x9=function(e,r){Xu(e,[].concat(r).map(function(n){var i=function a(){return KP(e,a),n.apply(void 0,arguments)};return i}))},Hm={prefixed:!0},Mm=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],JO=Mm[0],Fp;for(Dp=0;Dp<Mm.length;Dp++)if(Mm[Dp][1]in yt.default){Fp=Mm[Dp];break}var Dp;if(Fp){for(Lp=0;Lp<Fp.length;Lp++)Hm[JO[Lp]]=Fp[Lp];Hm.prefixed=Fp[0]!==JO[0]}var Lp,Fa=[],C9=function(e,r){return function(n,i,a){var s=r.levels[i],o=new RegExp("^("+s+")$");if(n!=="log"&&a.unshift(n.toUpperCase()+":"),a.unshift(e+":"),Fa){Fa.push([].concat(a));var c=Fa.length-1e3;Fa.splice(0,c>0?c:0)}if(Se.default.console){var l=Se.default.console[n];!l&&n==="debug"&&(l=Se.default.console.info||Se.default.console.log),!(!l||!s||!o.test(n))&&l[Array.isArray(a)?"apply":"call"](Se.default.console,a)}}};function XP(t){var e="info",r,n=function(){for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];r("log",e,s)};return r=C9(t,n),n.createLogger=function(i){return XP(t+": "+i)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:e},n.level=function(i){if(typeof i=="string"){if(!n.levels.hasOwnProperty(i))throw new Error('"'+i+'" in not a valid log level');e=i}return e},n.history=function(){return Fa?[].concat(Fa):[]},n.history.filter=function(i){return(Fa||[]).filter(function(a){return new RegExp(".*"+i+".*").test(a[0])})},n.history.clear=function(){Fa&&(Fa.length=0)},n.history.disable=function(){Fa!==null&&(Fa.length=0,Fa=null)},n.history.enable=function(){Fa===null&&(Fa=[])},n.error=function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r("error",e,a)},n.warn=function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r("warn",e,a)},n.debug=function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return r("debug",e,a)},n}var pr=XP("VIDEOJS"),YP=pr.createLogger,A9=Object.prototype.toString,JP=function(e){return au(e)?Object.keys(e):[]};function bd(t,e){JP(t).forEach(function(r){return e(t[r],r)})}function I9(t,e,r){return r===void 0&&(r=0),JP(t).reduce(function(n,i){return e(n,t[i],i)},r)}function Vi(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Object.assign?el.default.apply(void 0,[t].concat(r)):(r.forEach(function(i){i&&bd(i,function(a,s){t[s]=a})}),t)}function au(t){return!!t&&typeof t=="object"}function Gp(t){return au(t)&&A9.call(t)==="[object Object]"&&t.constructor===Object}function Vp(t,e){if(!t||!e)return"";if(typeof Se.default.getComputedStyle=="function"){var r;try{r=Se.default.getComputedStyle(t)}catch{return""}return r?r.getPropertyValue(e)||r[e]:""}return""}var In=Se.default.navigator&&Se.default.navigator.userAgent||"",QO=/AppleWebKit\/([\d.]+)/i.exec(In),k9=QO?parseFloat(QO.pop()):null,QP=/iPod/i.test(In),O9=function(){var t=In.match(/OS (\d+)_/i);return t&&t[1]?t[1]:null}(),ou=/Android/i.test(In),Rw=function(){var t=In.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!t)return null;var e=t[1]&&parseFloat(t[1]),r=t[2]&&parseFloat(t[2]);return e&&r?parseFloat(t[1]+"."+t[2]):e||null}(),ZP=ou&&Rw<5&&k9<537,e1=/Firefox/i.test(In),Kp=/Edg/i.test(In),uu=!Kp&&(/Chrome/i.test(In)||/CriOS/i.test(In)),t1=function(){var t=In.match(/(Chrome|CriOS)\/(\d+)/);return t&&t[2]?parseFloat(t[2]):null}(),Xp=function(){var t=/MSIE\s(\d+)\.\d/.exec(In),e=t&&parseFloat(t[1]);return!e&&/Trident\/7.0/i.test(In)&&/rv:11.0/.test(In)&&(e=11),e}(),Dw=/Safari/i.test(In)&&!uu&&!ou&&!Kp,r1=/Windows/i.test(In),Td=!!(Id()&&("ontouchstart"in Se.default||Se.default.navigator.maxTouchPoints||Se.default.DocumentTouch&&Se.default.document instanceof Se.default.DocumentTouch)),Lw=/iPad/i.test(In)||Dw&&Td&&!/iPhone/i.test(In),Nw=/iPhone/i.test(In)&&!Lw,wa=Nw||Lw||QP,sv=(Dw||wa)&&!uu,P9=Object.freeze({__proto__:null,IS_IPOD:QP,IOS_VERSION:O9,IS_ANDROID:ou,ANDROID_VERSION:Rw,IS_NATIVE_ANDROID:ZP,IS_FIREFOX:e1,IS_EDGE:Kp,IS_CHROME:uu,CHROME_VERSION:t1,IE_VERSION:Xp,IS_SAFARI:Dw,IS_WINDOWS:r1,TOUCH_ENABLED:Td,IS_IPAD:Lw,IS_IPHONE:Nw,IS_IOS:wa,IS_ANY_SAFARI:sv});function ZO(t){return typeof t=="string"&&!!t.trim()}function i1(t){if(t.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function R9(t){return new RegExp("(^|\\s)"+t+"($|\\s)")}function Id(){return yt.default===Se.default.document}function kd(t){return au(t)&&t.nodeType===1}function n1(){try{return Se.default.parent!==Se.default.self}catch{return!0}}function a1(t){return function(e,r){if(!ZO(e))return yt.default[t](null);ZO(r)&&(r=yt.default.querySelector(r));var n=kd(r)?r:yt.default;return n[t]&&n[t](e)}}function Tr(t,e,r,n){t===void 0&&(t="div"),e===void 0&&(e={}),r===void 0&&(r={});var i=yt.default.createElement(t);return Object.getOwnPropertyNames(e).forEach(function(a){var s=e[a];a.indexOf("aria-")!==-1||a==="role"||a==="type"?(pr.warn(`Setting attributes in the second argument of createEl()
has been deprecated. Use the third argument instead.
`+("createEl(type, properties, attributes). Attempting to set "+a+" to "+s+".")),i.setAttribute(a,s)):a==="textContent"?tl(i,s):(i[a]!==s||a==="tabIndex")&&(i[a]=s)}),Object.getOwnPropertyNames(r).forEach(function(a){i.setAttribute(a,r[a])}),n&&$w(i,n),i}function tl(t,e){return typeof t.textContent>"u"?t.innerText=e:t.textContent=e,t}function fw(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function Jc(t,e){return i1(e),t.classList?t.classList.contains(e):R9(e).test(t.className)}function iu(t,e){return t.classList?t.classList.add(e):Jc(t,e)||(t.className=(t.className+" "+e).trim()),t}function Yp(t,e){return t?(t.classList?t.classList.remove(e):(i1(e),t.className=t.className.split(/\s+/).filter(function(r){return r!==e}).join(" ")),t):(pr.warn("removeClass was called with an element that doesn't exist"),null)}function s1(t,e,r){var n=Jc(t,e);if(typeof r=="function"&&(r=r(t,e)),typeof r!="boolean"&&(r=!n),r!==n)return r?iu(t,e):Yp(t,e),t}function o1(t,e){Object.getOwnPropertyNames(e).forEach(function(r){var n=e[r];n===null||typeof n>"u"||n===!1?t.removeAttribute(r):t.setAttribute(r,n===!0?"":n)})}function eu(t){var e={},r=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(t&&t.attributes&&t.attributes.length>0)for(var n=t.attributes,i=n.length-1;i>=0;i--){var a=n[i].name,s=n[i].value;(typeof t[a]=="boolean"||r.indexOf(","+a+",")!==-1)&&(s=s!==null),e[a]=s}return e}function u1(t,e){return t.getAttribute(e)}function Sd(t,e,r){t.setAttribute(e,r)}function ov(t,e){t.removeAttribute(e)}function c1(){yt.default.body.focus(),yt.default.onselectstart=function(){return!1}}function l1(){yt.default.onselectstart=function(){return!0}}function Ed(t){if(t&&t.getBoundingClientRect&&t.parentNode){var e=t.getBoundingClientRect(),r={};return["bottom","height","left","right","top","width"].forEach(function(n){e[n]!==void 0&&(r[n]=e[n])}),r.height||(r.height=parseFloat(Vp(t,"height"))),r.width||(r.width=parseFloat(Vp(t,"width"))),r}}function zp(t){if(!t||t&&!t.offsetParent)return{left:0,top:0,width:0,height:0};for(var e=t.offsetWidth,r=t.offsetHeight,n=0,i=0;t.offsetParent&&t!==yt.default[Hm.fullscreenElement];)n+=t.offsetLeft,i+=t.offsetTop,t=t.offsetParent;return{left:n,top:i,width:e,height:r}}function uv(t,e){var r={x:0,y:0};if(wa)for(var n=t;n&&n.nodeName.toLowerCase()!=="html";){var i=Vp(n,"transform");if(/^matrix/.test(i)){var a=i.slice(7,-1).split(/,\s/).map(Number);r.x+=a[4],r.y+=a[5]}else if(/^matrix3d/.test(i)){var s=i.slice(9,-1).split(/,\s/).map(Number);r.x+=s[12],r.y+=s[13]}n=n.parentNode}var o={},c=zp(e.target),l=zp(t),f=l.width,g=l.height,m=e.offsetY-(l.top-c.top),y=e.offsetX-(l.left-c.left);return e.changedTouches&&(y=e.changedTouches[0].pageX-l.left,m=e.changedTouches[0].pageY+l.top,wa&&(y-=r.x,m-=r.y)),o.y=1-Math.max(0,Math.min(1,m/g)),o.x=Math.max(0,Math.min(1,y/f)),o}function d1(t){return au(t)&&t.nodeType===3}function Mw(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function f1(t){return typeof t=="function"&&(t=t()),(Array.isArray(t)?t:[t]).map(function(e){if(typeof e=="function"&&(e=e()),kd(e)||d1(e))return e;if(typeof e=="string"&&/\S/.test(e))return yt.default.createTextNode(e)}).filter(function(e){return e})}function $w(t,e){return f1(e).forEach(function(r){return t.appendChild(r)}),t}function p1(t,e){return $w(Mw(t),e)}function Wp(t){return t.button===void 0&&t.buttons===void 0||t.button===0&&t.buttons===void 0||t.type==="mouseup"&&t.button===0&&t.buttons===0?!0:!(t.button!==0||t.buttons!==1)}var Yu=a1("querySelector"),h1=a1("querySelectorAll"),g1=Object.freeze({__proto__:null,isReal:Id,isEl:kd,isInFrame:n1,createEl:Tr,textContent:tl,prependTo:fw,hasClass:Jc,addClass:iu,removeClass:Yp,toggleClass:s1,setAttributes:o1,getAttributes:eu,getAttribute:u1,setAttribute:Sd,removeAttribute:ov,blockTextSelection:c1,unblockTextSelection:l1,getBoundingClientRect:Ed,findPosition:zp,getPointerPosition:uv,isTextNode:d1,emptyEl:Mw,normalizeContent:f1,appendContent:$w,insertContent:p1,isSingleLeftClick:Wp,$:Yu,$$:h1}),m1=!1,pw,D9=function(){if(pw.options.autoSetup!==!1){var e=Array.prototype.slice.call(yt.default.getElementsByTagName("video")),r=Array.prototype.slice.call(yt.default.getElementsByTagName("audio")),n=Array.prototype.slice.call(yt.default.getElementsByTagName("video-js")),i=e.concat(r,n);if(i&&i.length>0)for(var a=0,s=i.length;a<s;a++){var o=i[a];if(o&&o.getAttribute){if(o.player===void 0){var c=o.getAttribute("data-setup");c!==null&&pw(o)}}else{hw(1);break}}else m1||hw(1)}};function hw(t,e){Id()&&(e&&(pw=e),Se.default.setTimeout(D9,t))}function gw(){m1=!0,Se.default.removeEventListener("load",gw)}Id()&&(yt.default.readyState==="complete"?gw():Se.default.addEventListener("load",gw));var v1=function(e){var r=yt.default.createElement("style");return r.className=e,r},y1=function(e,r){e.styleSheet?e.styleSheet.cssText=r:e.textContent=r},L9=3,N9=L9;function cu(){return N9++}var b1;Se.default.WeakMap||(b1=function(){function t(){this.vdata="vdata"+Math.floor(Se.default.performance&&Se.default.performance.now()||Date.now()),this.data={}}var e=t.prototype;return e.set=function(n,i){var a=n[this.vdata]||cu();return n[this.vdata]||(n[this.vdata]=a),this.data[a]=i,this},e.get=function(n){var i=n[this.vdata];if(i)return this.data[i];pr("We have no data for this element",n)},e.has=function(n){var i=n[this.vdata];return i in this.data},e.delete=function(n){var i=n[this.vdata];i&&(delete this.data[i],delete n[this.vdata])},t}());var ba=Se.default.WeakMap?new WeakMap:new b1;function eP(t,e){if(ba.has(t)){var r=ba.get(t);r.handlers[e].length===0&&(delete r.handlers[e],t.removeEventListener?t.removeEventListener(e,r.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,r.dispatcher)),Object.getOwnPropertyNames(r.handlers).length<=0&&(delete r.handlers,delete r.dispatcher,delete r.disabled),Object.getOwnPropertyNames(r).length===0&&ba.delete(t)}}function Uw(t,e,r,n){r.forEach(function(i){t(e,i,n)})}function cv(t){if(t.fixed_)return t;function e(){return!0}function r(){return!1}if(!t||!t.isPropagationStopped||!t.isImmediatePropagationStopped){var n=t||Se.default.event;t={};for(var i in n)i!=="layerX"&&i!=="layerY"&&i!=="keyLocation"&&i!=="webkitMovementX"&&i!=="webkitMovementY"&&(i==="returnValue"&&n.preventDefault||(t[i]=n[i]));if(t.target||(t.target=t.srcElement||yt.default),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){n.preventDefault&&n.preventDefault(),t.returnValue=!1,n.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){n.stopPropagation&&n.stopPropagation(),t.cancelBubble=!0,n.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=r,t.stopImmediatePropagation=function(){n.stopImmediatePropagation&&n.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=r,t.clientX!==null&&t.clientX!==void 0){var a=yt.default.documentElement,s=yt.default.body;t.pageX=t.clientX+(a&&a.scrollLeft||s&&s.scrollLeft||0)-(a&&a.clientLeft||s&&s.clientLeft||0),t.pageY=t.clientY+(a&&a.scrollTop||s&&s.scrollTop||0)-(a&&a.clientTop||s&&s.clientTop||0)}t.which=t.charCode||t.keyCode,t.button!==null&&t.button!==void 0&&(t.button=t.button&1?0:t.button&4?1:t.button&2?2:0)}return t.fixed_=!0,t}var Om,M9=function(){if(typeof Om!="boolean"){Om=!1;try{var e=Object.defineProperty({},"passive",{get:function(){Om=!0}});Se.default.addEventListener("test",null,e),Se.default.removeEventListener("test",null,e)}catch{}}return Om},$9=["touchstart","touchmove"];function rs(t,e,r){if(Array.isArray(e))return Uw(rs,t,e,r);ba.has(t)||ba.set(t,{});var n=ba.get(t);if(n.handlers||(n.handlers={}),n.handlers[e]||(n.handlers[e]=[]),r.guid||(r.guid=cu()),n.handlers[e].push(r),n.dispatcher||(n.disabled=!1,n.dispatcher=function(a,s){if(!n.disabled){a=cv(a);var o=n.handlers[a.type];if(o)for(var c=o.slice(0),l=0,f=c.length;l<f&&!a.isImmediatePropagationStopped();l++)try{c[l].call(t,a,s)}catch(g){pr.error(g)}}}),n.handlers[e].length===1)if(t.addEventListener){var i=!1;M9()&&$9.indexOf(e)>-1&&(i={passive:!0}),t.addEventListener(e,n.dispatcher,i)}else t.attachEvent&&t.attachEvent("on"+e,n.dispatcher)}function ea(t,e,r){if(ba.has(t)){var n=ba.get(t);if(n.handlers){if(Array.isArray(e))return Uw(ea,t,e,r);var i=function(l,f){n.handlers[f]=[],eP(l,f)};if(e===void 0){for(var a in n.handlers)Object.prototype.hasOwnProperty.call(n.handlers||{},a)&&i(t,a);return}var s=n.handlers[e];if(s){if(!r){i(t,e);return}if(r.guid)for(var o=0;o<s.length;o++)s[o].guid===r.guid&&s.splice(o--,1);eP(t,e)}}}}function Od(t,e,r){var n=ba.has(t)?ba.get(t):{},i=t.parentNode||t.ownerDocument;if(typeof e=="string"?e={type:e,target:t}:e.target||(e.target=t),e=cv(e),n.dispatcher&&n.dispatcher.call(t,e,r),i&&!e.isPropagationStopped()&&e.bubbles===!0)Od.call(null,i,e,r);else if(!i&&!e.defaultPrevented&&e.target&&e.target[e.type]){ba.has(e.target)||ba.set(e.target,{});var a=ba.get(e.target);e.target[e.type]&&(a.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),a.disabled=!1)}return!e.defaultPrevented}function lv(t,e,r){if(Array.isArray(e))return Uw(lv,t,e,r);var n=function i(){ea(t,e,i),r.apply(this,arguments)};n.guid=r.guid=r.guid||cu(),rs(t,e,n)}function _1(t,e,r){var n=function i(){ea(t,e,i),r.apply(this,arguments)};n.guid=r.guid=r.guid||cu(),rs(t,e,n)}var U9=Object.freeze({__proto__:null,fixEvent:cv,on:rs,off:ea,trigger:Od,one:lv,any:_1}),Fs=30,Ti=function(e,r,n){r.guid||(r.guid=cu());var i=r.bind(e);return i.guid=n?n+"_"+r.guid:r.guid,i},su=function(e,r){var n=Se.default.performance.now(),i=function(){var s=Se.default.performance.now();s-n>=r&&(e.apply(void 0,arguments),n=s)};return i},F9=function(e,r,n,i){i===void 0&&(i=Se.default);var a,s=function(){i.clearTimeout(a),a=null},o=function(){var l=this,f=arguments,g=function(){a=null,g=null,n||e.apply(l,f)};!a&&n&&e.apply(l,f),i.clearTimeout(a),a=i.setTimeout(g,r)};return o.cancel=s,o},kn=function(){};kn.prototype.allowedEvents_={};kn.prototype.on=function(t,e){var r=this.addEventListener;this.addEventListener=function(){},rs(this,t,e),this.addEventListener=r};kn.prototype.addEventListener=kn.prototype.on;kn.prototype.off=function(t,e){ea(this,t,e)};kn.prototype.removeEventListener=kn.prototype.off;kn.prototype.one=function(t,e){var r=this.addEventListener;this.addEventListener=function(){},lv(this,t,e),this.addEventListener=r};kn.prototype.any=function(t,e){var r=this.addEventListener;this.addEventListener=function(){},_1(this,t,e),this.addEventListener=r};kn.prototype.trigger=function(t){var e=t.type||t;typeof t=="string"&&(t={type:e}),t=cv(t),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](t),Od(this,t)};kn.prototype.dispatchEvent=kn.prototype.trigger;var Np;kn.prototype.queueTrigger=function(t){var e=this;Np||(Np=new Map);var r=t.type||t,n=Np.get(this);n||(n=new Map,Np.set(this,n));var i=n.get(r);n.delete(r),Se.default.clearTimeout(i);var a=Se.default.setTimeout(function(){n.size===0&&(n=null,Np.delete(e)),e.trigger(t)},0);n.set(r,a)};var dv=function(e){return typeof e.name=="function"?e.name():typeof e.name=="string"?e.name:e.name_?e.name_:e.constructor&&e.constructor.name?e.constructor.name:typeof e},nu=function(e){return e instanceof kn||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(r){return typeof e[r]=="function"})},B9=function(e,r){nu(e)?r():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(r))},mw=function(e){return typeof e=="string"&&/\S/.test(e)||Array.isArray(e)&&!!e.length},Gm=function(e,r,n){if(!e||!e.nodeName&&!nu(e))throw new Error("Invalid target for "+dv(r)+"#"+n+"; must be a DOM node or evented object.")},w1=function(e,r,n){if(!mw(e))throw new Error("Invalid event type for "+dv(r)+"#"+n+"; must be a non-empty string or array.")},T1=function(e,r,n){if(typeof e!="function")throw new Error("Invalid listener for "+dv(r)+"#"+n+"; must be a function.")},J_=function(e,r,n){var i=r.length<3||r[0]===e||r[0]===e.eventBusEl_,a,s,o;return i?(a=e.eventBusEl_,r.length>=3&&r.shift(),s=r[0],o=r[1]):(a=r[0],s=r[1],o=r[2]),Gm(a,e,n),w1(s,e,n),T1(o,e,n),o=Ti(e,o),{isTargetingSelf:i,target:a,type:s,listener:o}},Vc=function(e,r,n,i){Gm(e,e,r),e.nodeName?U9[r](e,n,i):e[r](n,i)},q9={on:function(){for(var e=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=J_(this,n,"on"),s=a.isTargetingSelf,o=a.target,c=a.type,l=a.listener;if(Vc(o,"on",c,l),!s){var f=function(){return e.off(o,c,l)};f.guid=l.guid;var g=function(){return e.off("dispose",f)};g.guid=l.guid,Vc(this,"on","dispose",f),Vc(o,"on","dispose",g)}},one:function(){for(var e=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=J_(this,n,"one"),s=a.isTargetingSelf,o=a.target,c=a.type,l=a.listener;if(s)Vc(o,"one",c,l);else{var f=function g(){e.off(o,c,g);for(var m=arguments.length,y=new Array(m),A=0;A<m;A++)y[A]=arguments[A];l.apply(null,y)};f.guid=l.guid,Vc(o,"one",c,f)}},any:function(){for(var e=this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=J_(this,n,"any"),s=a.isTargetingSelf,o=a.target,c=a.type,l=a.listener;if(s)Vc(o,"any",c,l);else{var f=function g(){e.off(o,c,g);for(var m=arguments.length,y=new Array(m),A=0;A<m;A++)y[A]=arguments[A];l.apply(null,y)};f.guid=l.guid,Vc(o,"any",c,f)}},off:function(e,r,n){if(!e||mw(e))ea(this.eventBusEl_,e,r);else{var i=e,a=r;Gm(i,this,"off"),w1(a,this,"off"),T1(n,this,"off"),n=Ti(this,n),this.off("dispose",n),i.nodeName?(ea(i,a,n),ea(i,"dispose",n)):nu(i)&&(i.off(a,n),i.off("dispose",n))}},trigger:function(e,r){Gm(this.eventBusEl_,this,"trigger");var n=e&&typeof e!="string"?e.type:e;if(!mw(n)){var i="Invalid event type for "+dv(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(e)(this.log||pr).error(i);else throw new Error(i)}return Od(this.eventBusEl_,e,r)}};function Fw(t,e){e===void 0&&(e={});var r=e,n=r.eventBusKey;if(n){if(!t[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');t.eventBusEl_=t[n]}else t.eventBusEl_=Tr("span",{className:"vjs-event-bus"});return Vi(t,q9),t.eventedCallbacks&&t.eventedCallbacks.forEach(function(i){i()}),t.on("dispose",function(){t.off(),[t,t.el_,t.eventBusEl_].forEach(function(i){i&&ba.has(i)&&ba.delete(i)}),Se.default.setTimeout(function(){t.eventBusEl_=null},0)}),t}var j9={state:{},setState:function(e){var r=this;typeof e=="function"&&(e=e());var n;return bd(e,function(i,a){r.state[a]!==i&&(n=n||{},n[a]={from:r.state[a],to:i}),r.state[a]=i}),n&&nu(this)&&this.trigger({changes:n,type:"statechanged"}),n}};function S1(t,e){return Vi(t,j9),t.state=Vi({},t.state,e),typeof t.handleStateChanged=="function"&&nu(t)&&t.on("statechanged",t.handleStateChanged),t}var $m=function(e){return typeof e!="string"?e:e.replace(/./,function(r){return r.toLowerCase()})},Zi=function(e){return typeof e!="string"?e:e.replace(/./,function(r){return r.toUpperCase()})},H9=function(e,r){return Zi(e)===Zi(r)};function wi(){for(var t={},e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach(function(i){i&&bd(i,function(a,s){if(!Gp(a)){t[s]=a;return}Gp(t[s])||(t[s]={}),t[s]=wi(t[s],a)})}),t}var G9=function(){function t(){this.map_={}}var e=t.prototype;return e.has=function(n){return n in this.map_},e.delete=function(n){var i=this.has(n);return delete this.map_[n],i},e.set=function(n,i){return this.map_[n]=i,this},e.forEach=function(n,i){for(var a in this.map_)n.call(i,this.map_[a],a,this)},t}(),V9=Se.default.Map?Se.default.Map:G9,z9=function(){function t(){this.set_={}}var e=t.prototype;return e.has=function(n){return n in this.set_},e.delete=function(n){var i=this.has(n);return delete this.set_[n],i},e.add=function(n){return this.set_[n]=1,this},e.forEach=function(n,i){for(var a in this.set_)n.call(i,a,a,this)},t}(),Q_=Se.default.Set?Se.default.Set:z9,ht=function(){function t(r,n,i){var a=this;if(!r&&this.play?this.player_=r=this:this.player_=r,this.isDisposed_=!1,this.parentComponent_=null,this.options_=wi({},this.options_),n=this.options_=wi(this.options_,n),this.id_=n.id||n.el&&n.el.id,!this.id_){var s=r&&r.id&&r.id()||"no_player";this.id_=s+"_component_"+cu()}this.name_=n.name||null,n.el?this.el_=n.el:n.createEl!==!1&&(this.el_=this.createEl()),n.className&&this.el_&&n.className.split(" ").forEach(function(o){return a.addClass(o)}),n.evented!==!1&&(Fw(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),S1(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Q_,this.setIntervalIds_=new Q_,this.rafIds_=new Q_,this.namedRafs_=new V9,this.clearingTimersOnDispose_=!1,n.initChildren!==!1&&this.initChildren(),this.ready(i),n.reportTouchActivity!==!1&&this.enableTouchActivity()}var e=t.prototype;return e.dispose=function(){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var n=this.children_.length-1;n>=0;n--)this.children_[n].dispose&&this.children_[n].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),this.el_=null),this.player_=null}},e.isDisposed=function(){return!!this.isDisposed_},e.player=function(){return this.player_},e.options=function(n){return n?(this.options_=wi(this.options_,n),this.options_):this.options_},e.el=function(){return this.el_},e.createEl=function(n,i,a){return Tr(n,i,a)},e.localize=function(n,i,a){a===void 0&&(a=n);var s=this.player_.language&&this.player_.language(),o=this.player_.languages&&this.player_.languages(),c=o&&o[s],l=s&&s.split("-")[0],f=o&&o[l],g=a;return c&&c[n]?g=c[n]:f&&f[n]&&(g=f[n]),i&&(g=g.replace(/\{(\d+)\}/g,function(m,y){var A=i[y-1],k=A;return typeof A>"u"&&(k=m),k})),g},e.handleLanguagechange=function(){},e.contentEl=function(){return this.contentEl_||this.el_},e.id=function(){return this.id_},e.name=function(){return this.name_},e.children=function(){return this.children_},e.getChildById=function(n){return this.childIndex_[n]},e.getChild=function(n){if(n)return this.childNameIndex_[n]},e.getDescendant=function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];i=i.reduce(function(c,l){return c.concat(l)},[]);for(var s=this,o=0;o<i.length;o++)if(s=s.getChild(i[o]),!s||!s.getChild)return;return s},e.addChild=function(n,i,a){i===void 0&&(i={}),a===void 0&&(a=this.children_.length);var s,o;if(typeof n=="string"){o=Zi(n);var c=i.componentClass||o;i.name=o;var l=t.getComponent(c);if(!l)throw new Error("Component "+c+" does not exist");if(typeof l!="function")return null;s=new l(this.player_||this,i)}else s=n;if(s.parentComponent_&&s.parentComponent_.removeChild(s),this.children_.splice(a,0,s),s.parentComponent_=this,typeof s.id=="function"&&(this.childIndex_[s.id()]=s),o=o||s.name&&Zi(s.name()),o&&(this.childNameIndex_[o]=s,this.childNameIndex_[$m(o)]=s),typeof s.el=="function"&&s.el()){var f=null;this.children_[a+1]&&(this.children_[a+1].el_?f=this.children_[a+1].el_:kd(this.children_[a+1])&&(f=this.children_[a+1])),this.contentEl().insertBefore(s.el(),f)}return s},e.removeChild=function(n){if(typeof n=="string"&&(n=this.getChild(n)),!(!n||!this.children_)){for(var i=!1,a=this.children_.length-1;a>=0;a--)if(this.children_[a]===n){i=!0,this.children_.splice(a,1);break}if(i){n.parentComponent_=null,this.childIndex_[n.id()]=null,this.childNameIndex_[Zi(n.name())]=null,this.childNameIndex_[$m(n.name())]=null;var s=n.el();s&&s.parentNode===this.contentEl()&&this.contentEl().removeChild(n.el())}}},e.initChildren=function(){var n=this,i=this.options_.children;if(i){var a=this.options_,s=function(f){var g=f.name,m=f.opts;if(a[g]!==void 0&&(m=a[g]),m!==!1){m===!0&&(m={}),m.playerOptions=n.options_.playerOptions;var y=n.addChild(g,m);y&&(n[g]=y)}},o,c=t.getComponent("Tech");Array.isArray(i)?o=i:o=Object.keys(i),o.concat(Object.keys(this.options_).filter(function(l){return!o.some(function(f){return typeof f=="string"?l===f:l===f.name})})).map(function(l){var f,g;return typeof l=="string"?(f=l,g=i[f]||n.options_[f]||{}):(f=l.name,g=l),{name:f,opts:g}}).filter(function(l){var f=t.getComponent(l.opts.componentClass||Zi(l.name));return f&&!c.isTech(f)}).forEach(s)}},e.buildCSSClass=function(){return""},e.ready=function(n,i){if(i===void 0&&(i=!1),!!n){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(n);return}i?n.call(this):this.setTimeout(n,1)}},e.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var n=this.readyQueue_;this.readyQueue_=[],n&&n.length>0&&n.forEach(function(i){i.call(this)},this),this.trigger("ready")},1)},e.$=function(n,i){return Yu(n,i||this.contentEl())},e.$$=function(n,i){return h1(n,i||this.contentEl())},e.hasClass=function(n){return Jc(this.el_,n)},e.addClass=function(n){iu(this.el_,n)},e.removeClass=function(n){Yp(this.el_,n)},e.toggleClass=function(n,i){s1(this.el_,n,i)},e.show=function(){this.removeClass("vjs-hidden")},e.hide=function(){this.addClass("vjs-hidden")},e.lockShowing=function(){this.addClass("vjs-lock-showing")},e.unlockShowing=function(){this.removeClass("vjs-lock-showing")},e.getAttribute=function(n){return u1(this.el_,n)},e.setAttribute=function(n,i){Sd(this.el_,n,i)},e.removeAttribute=function(n){ov(this.el_,n)},e.width=function(n,i){return this.dimension("width",n,i)},e.height=function(n,i){return this.dimension("height",n,i)},e.dimensions=function(n,i){this.width(n,!0),this.height(i)},e.dimension=function(n,i,a){if(i!==void 0){(i===null||i!==i)&&(i=0),(""+i).indexOf("%")!==-1||(""+i).indexOf("px")!==-1?this.el_.style[n]=i:i==="auto"?this.el_.style[n]="":this.el_.style[n]=i+"px",a||this.trigger("componentresize");return}if(!this.el_)return 0;var s=this.el_.style[n],o=s.indexOf("px");return parseInt(o!==-1?s.slice(0,o):this.el_["offset"+Zi(n)],10)},e.currentDimension=function(n){var i=0;if(n!=="width"&&n!=="height")throw new Error("currentDimension only accepts width or height value");if(i=Vp(this.el_,n),i=parseFloat(i),i===0||isNaN(i)){var a="offset"+Zi(n);i=this.el_[a]}return i},e.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},e.currentWidth=function(){return this.currentDimension("width")},e.currentHeight=function(){return this.currentDimension("height")},e.focus=function(){this.el_.focus()},e.blur=function(){this.el_.blur()},e.handleKeyDown=function(n){this.player_&&(ar.default.isEventKey(n,"Tab")||n.stopPropagation(),this.player_.handleKeyDown(n))},e.handleKeyPress=function(n){this.handleKeyDown(n)},e.emitTapEvents=function(){var n=0,i=null,a=10,s=200,o;this.on("touchstart",function(l){l.touches.length===1&&(i={pageX:l.touches[0].pageX,pageY:l.touches[0].pageY},n=Se.default.performance.now(),o=!0)}),this.on("touchmove",function(l){if(l.touches.length>1)o=!1;else if(i){var f=l.touches[0].pageX-i.pageX,g=l.touches[0].pageY-i.pageY,m=Math.sqrt(f*f+g*g);m>a&&(o=!1)}});var c=function(){o=!1};this.on("touchleave",c),this.on("touchcancel",c),this.on("touchend",function(l){if(i=null,o===!0){var f=Se.default.performance.now()-n;f<s&&(l.preventDefault(),this.trigger("tap"))}})},e.enableTouchActivity=function(){if(!(!this.player()||!this.player().reportUserActivity)){var n=Ti(this.player(),this.player().reportUserActivity),i;this.on("touchstart",function(){n(),this.clearInterval(i),i=this.setInterval(n,250)});var a=function(o){n(),this.clearInterval(i)};this.on("touchmove",n),this.on("touchend",a),this.on("touchcancel",a)}},e.setTimeout=function(n,i){var a=this,s;return n=Ti(this,n),this.clearTimersOnDispose_(),s=Se.default.setTimeout(function(){a.setTimeoutIds_.has(s)&&a.setTimeoutIds_.delete(s),n()},i),this.setTimeoutIds_.add(s),s},e.clearTimeout=function(n){return this.setTimeoutIds_.has(n)&&(this.setTimeoutIds_.delete(n),Se.default.clearTimeout(n)),n},e.setInterval=function(n,i){n=Ti(this,n),this.clearTimersOnDispose_();var a=Se.default.setInterval(n,i);return this.setIntervalIds_.add(a),a},e.clearInterval=function(n){return this.setIntervalIds_.has(n)&&(this.setIntervalIds_.delete(n),Se.default.clearInterval(n)),n},e.requestAnimationFrame=function(n){var i=this;if(!this.supportsRaf_)return this.setTimeout(n,1e3/60);this.clearTimersOnDispose_();var a;return n=Ti(this,n),a=Se.default.requestAnimationFrame(function(){i.rafIds_.has(a)&&i.rafIds_.delete(a),n()}),this.rafIds_.add(a),a},e.requestNamedAnimationFrame=function(n,i){var a=this;if(!this.namedRafs_.has(n)){this.clearTimersOnDispose_(),i=Ti(this,i);var s=this.requestAnimationFrame(function(){i(),a.namedRafs_.has(n)&&a.namedRafs_.delete(n)});return this.namedRafs_.set(n,s),n}},e.cancelNamedAnimationFrame=function(n){this.namedRafs_.has(n)&&(this.cancelAnimationFrame(this.namedRafs_.get(n)),this.namedRafs_.delete(n))},e.cancelAnimationFrame=function(n){return this.supportsRaf_?(this.rafIds_.has(n)&&(this.rafIds_.delete(n),Se.default.cancelAnimationFrame(n)),n):this.clearTimeout(n)},e.clearTimersOnDispose_=function(){var n=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(i){var a=i[0],s=i[1];n[a].forEach(function(o,c){return n[s](c)})}),n.clearingTimersOnDispose_=!1}))},t.registerComponent=function(n,i){if(typeof n!="string"||!n)throw new Error('Illegal component name, "'+n+'"; must be a non-empty string.');var a=t.getComponent("Tech"),s=a&&a.isTech(i),o=t===i||t.prototype.isPrototypeOf(i.prototype);if(s||!o){var c;throw s?c="techs must be registered using Tech.registerTech()":c="must be a Component subclass",new Error('Illegal component, "'+n+'"; '+c+".")}n=Zi(n),t.components_||(t.components_={});var l=t.getComponent("Player");if(n==="Player"&&l&&l.players){var f=l.players,g=Object.keys(f);if(f&&g.length>0&&g.map(function(m){return f[m]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[n]=i,t.components_[$m(n)]=i,i},t.getComponent=function(n){if(!(!n||!t.components_))return t.components_[n]},t}();ht.prototype.supportsRaf_=typeof Se.default.requestAnimationFrame=="function"&&typeof Se.default.cancelAnimationFrame=="function";ht.registerComponent("Component",ht);function W9(t,e,r){if(typeof e!="number"||e<0||e>r)throw new Error("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+e+") is non-numeric or out of bounds (0-"+r+").")}function tP(t,e,r,n){return W9(t,n,r.length-1),r[n][e]}function Z_(t){var e;return t===void 0||t.length===0?e={length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:e={length:t.length,start:tP.bind(null,"start",0,t),end:tP.bind(null,"end",1,t)},Se.default.Symbol&&Se.default.Symbol.iterator&&(e[Se.default.Symbol.iterator]=function(){return(t||[]).values()}),e}function Qc(t,e){return Array.isArray(t)?Z_(t):t===void 0||e===void 0?Z_():Z_([[t,e]])}function E1(t,e){var r=0,n,i;if(!e)return 0;(!t||!t.length)&&(t=Qc(0,0));for(var a=0;a<t.length;a++)n=t.start(a),i=t.end(a),i>e&&(i=e),r+=i-n;return r/e}function _a(t){if(t instanceof _a)return t;typeof t=="number"?this.code=t:typeof t=="string"?this.message=t:au(t)&&(typeof t.code=="number"&&(this.code=t.code),Vi(this,t)),this.message||(this.message=_a.defaultMessages[this.code]||"")}_a.prototype.code=0;_a.prototype.message="";_a.prototype.status=null;_a.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];_a.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(zc=0;zc<_a.errorTypes.length;zc++)_a[_a.errorTypes[zc]]=zc,_a.prototype[_a.errorTypes[zc]]=zc;var zc;function qp(t){return t!=null&&typeof t.then=="function"}function go(t){qp(t)&&t.then(null,function(e){})}var vw=function(e){var r=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(n,i,a){return e[i]&&(n[i]=e[i]),n},{cues:e.cues&&Array.prototype.map.call(e.cues,function(n){return{startTime:n.startTime,endTime:n.endTime,text:n.text,id:n.id}})});return r},K9=function(e){var r=e.$$("track"),n=Array.prototype.map.call(r,function(a){return a.track}),i=Array.prototype.map.call(r,function(a){var s=vw(a.track);return a.src&&(s.src=a.src),s});return i.concat(Array.prototype.filter.call(e.textTracks(),function(a){return n.indexOf(a)===-1}).map(vw))},X9=function(e,r){return e.forEach(function(n){var i=r.addRemoteTextTrack(n).track;!n.src&&n.cues&&n.cues.forEach(function(a){return i.addCue(a)})}),r.textTracks()},rP={textTracksToJson:K9,jsonToTextTracks:X9,trackToJson_:vw},ew="vjs-modal-dialog",Pd=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.handleKeyDown_=function(s){return a.handleKeyDown(s)},a.close_=function(s){return a.close(s)},a.opened_=a.hasBeenOpened_=a.hasBeenFilled_=!1,a.closeable(!a.options_.uncloseable),a.content(a.options_.content),a.contentEl_=Tr("div",{className:ew+"-content"},{role:"document"}),a.descEl_=Tr("p",{className:ew+"-description vjs-control-text",id:a.el().getAttribute("aria-describedby")}),tl(a.descEl_,a.description()),a.el_.appendChild(a.descEl_),a.el_.appendChild(a.contentEl_),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},r.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,t.prototype.dispose.call(this)},r.buildCSSClass=function(){return ew+" vjs-hidden "+t.prototype.buildCSSClass.call(this)},r.label=function(){return this.localize(this.options_.label||"Modal Window")},r.description=function(){var i=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(i+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),i},r.open=function(){if(!this.opened_){var i=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!i.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&i.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=i.controls(),i.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},r.opened=function(i){return typeof i=="boolean"&&this[i?"open":"close"](),this.opened_},r.close=function(){if(this.opened_){var i=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&i.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&i.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},r.closeable=function(i){if(typeof i=="boolean"){var a=this.closeable_=!!i,s=this.getChild("closeButton");if(a&&!s){var o=this.contentEl_;this.contentEl_=this.el_,s=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=o,this.on(s,"close",this.close_)}!a&&s&&(this.off(s,"close",this.close_),this.removeChild(s),s.dispose())}return this.closeable_},r.fill=function(){this.fillWith(this.content())},r.fillWith=function(i){var a=this.contentEl(),s=a.parentNode,o=a.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,s.removeChild(a),this.empty(),p1(a,i),this.trigger("modalfill"),o?s.insertBefore(a,o):s.appendChild(a);var c=this.getChild("closeButton");c&&s.appendChild(c.el_)},r.empty=function(){this.trigger("beforemodalempty"),Mw(this.contentEl()),this.trigger("modalempty")},r.content=function(i){return typeof i<"u"&&(this.content_=i),this.content_},r.conditionalFocus_=function(){var i=yt.default.activeElement,a=this.player_.el_;this.previouslyActiveEl_=null,(a.contains(i)||a===i)&&(this.previouslyActiveEl_=i,this.focus())},r.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},r.handleKeyDown=function(i){if(i.stopPropagation(),ar.default.isEventKey(i,"Escape")&&this.closeable()){i.preventDefault(),this.close();return}if(ar.default.isEventKey(i,"Tab")){for(var a=this.focusableEls_(),s=this.el_.querySelector(":focus"),o,c=0;c<a.length;c++)if(s===a[c]){o=c;break}yt.default.activeElement===this.el_&&(o=0),i.shiftKey&&o===0?(a[a.length-1].focus(),i.preventDefault()):!i.shiftKey&&o===a.length-1&&(a[0].focus(),i.preventDefault())}},r.focusableEls_=function(){var i=this.el_.querySelectorAll("*");return Array.prototype.filter.call(i,function(a){return(a instanceof Se.default.HTMLAnchorElement||a instanceof Se.default.HTMLAreaElement)&&a.hasAttribute("href")||(a instanceof Se.default.HTMLInputElement||a instanceof Se.default.HTMLSelectElement||a instanceof Se.default.HTMLTextAreaElement||a instanceof Se.default.HTMLButtonElement)&&!a.hasAttribute("disabled")||a instanceof Se.default.HTMLIFrameElement||a instanceof Se.default.HTMLObjectElement||a instanceof Se.default.HTMLEmbedElement||a.hasAttribute("tabindex")&&a.getAttribute("tabindex")!==-1||a.hasAttribute("contenteditable")})},e}(ht);Pd.prototype.options_={pauseOnOpen:!0,temporary:!0};ht.registerComponent("ModalDialog",Pd);var xd=function(t){Ct.default(e,t);function e(n){var i;n===void 0&&(n=[]),i=t.call(this)||this,i.tracks_=[],Object.defineProperty(ir.default(i),"length",{get:function(){return this.tracks_.length}});for(var a=0;a<n.length;a++)i.addTrack(n[a]);return i}var r=e.prototype;return r.addTrack=function(i){var a=this,s=this.tracks_.length;""+s in this||Object.defineProperty(this,s,{get:function(){return this.tracks_[s]}}),this.tracks_.indexOf(i)===-1&&(this.tracks_.push(i),this.trigger({track:i,type:"addtrack",target:this})),i.labelchange_=function(){a.trigger({track:i,type:"labelchange",target:a})},nu(i)&&i.addEventListener("labelchange",i.labelchange_)},r.removeTrack=function(i){for(var a,s=0,o=this.length;s<o;s++)if(this[s]===i){a=this[s],a.off&&a.off(),this.tracks_.splice(s,1);break}a&&this.trigger({track:a,type:"removetrack",target:this})},r.getTrackById=function(i){for(var a=null,s=0,o=this.length;s<o;s++){var c=this[s];if(c.id===i){a=c;break}}return a},e}(kn);xd.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(iP in xd.prototype.allowedEvents_)xd.prototype["on"+iP]=null;var iP,tw=function(e,r){for(var n=0;n<e.length;n++)!Object.keys(e[n]).length||r.id===e[n].id||(e[n].enabled=!1)},Y9=function(t){Ct.default(e,t);function e(n){var i;n===void 0&&(n=[]);for(var a=n.length-1;a>=0;a--)if(n[a].enabled){tw(n,n[a]);break}return i=t.call(this,n)||this,i.changing_=!1,i}var r=e.prototype;return r.addTrack=function(i){var a=this;i.enabled&&tw(this,i),t.prototype.addTrack.call(this,i),i.addEventListener&&(i.enabledChange_=function(){a.changing_||(a.changing_=!0,tw(a,i),a.changing_=!1,a.trigger("change"))},i.addEventListener("enabledchange",i.enabledChange_))},r.removeTrack=function(i){t.prototype.removeTrack.call(this,i),i.removeEventListener&&i.enabledChange_&&(i.removeEventListener("enabledchange",i.enabledChange_),i.enabledChange_=null)},e}(xd),rw=function(e,r){for(var n=0;n<e.length;n++)!Object.keys(e[n]).length||r.id===e[n].id||(e[n].selected=!1)},J9=function(t){Ct.default(e,t);function e(n){var i;n===void 0&&(n=[]);for(var a=n.length-1;a>=0;a--)if(n[a].selected){rw(n,n[a]);break}return i=t.call(this,n)||this,i.changing_=!1,Object.defineProperty(ir.default(i),"selectedIndex",{get:function(){for(var o=0;o<this.length;o++)if(this[o].selected)return o;return-1},set:function(){}}),i}var r=e.prototype;return r.addTrack=function(i){var a=this;i.selected&&rw(this,i),t.prototype.addTrack.call(this,i),i.addEventListener&&(i.selectedChange_=function(){a.changing_||(a.changing_=!0,rw(a,i),a.changing_=!1,a.trigger("change"))},i.addEventListener("selectedchange",i.selectedChange_))},r.removeTrack=function(i){t.prototype.removeTrack.call(this,i),i.removeEventListener&&i.selectedChange_&&(i.removeEventListener("selectedchange",i.selectedChange_),i.selectedChange_=null)},e}(xd),x1=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.addTrack=function(i){var a=this;t.prototype.addTrack.call(this,i),this.queueChange_||(this.queueChange_=function(){return a.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return a.trigger("selectedlanguagechange")}),i.addEventListener("modechange",this.queueChange_);var s=["metadata","chapters"];s.indexOf(i.kind)===-1&&i.addEventListener("modechange",this.triggerSelectedlanguagechange_)},r.removeTrack=function(i){t.prototype.removeTrack.call(this,i),i.removeEventListener&&(this.queueChange_&&i.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&i.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},e}(xd),Q9=function(){function t(r){r===void 0&&(r=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var n=0,i=r.length;n<i;n++)this.addTrackElement_(r[n])}var e=t.prototype;return e.addTrackElement_=function(n){var i=this.trackElements_.length;""+i in this||Object.defineProperty(this,i,{get:function(){return this.trackElements_[i]}}),this.trackElements_.indexOf(n)===-1&&this.trackElements_.push(n)},e.getTrackElementByTrack_=function(n){for(var i,a=0,s=this.trackElements_.length;a<s;a++)if(n===this.trackElements_[a].track){i=this.trackElements_[a];break}return i},e.removeTrackElement_=function(n){for(var i=0,a=this.trackElements_.length;i<a;i++)if(n===this.trackElements_[i]){this.trackElements_[i].track&&typeof this.trackElements_[i].track.off=="function"&&this.trackElements_[i].track.off(),typeof this.trackElements_[i].off=="function"&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}},t}(),nP=function(){function t(r){t.prototype.setCues_.call(this,r),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var e=t.prototype;return e.setCues_=function(n){var i=this.length||0,a=0,s=n.length;this.cues_=n,this.length_=n.length;var o=function(l){""+l in this||Object.defineProperty(this,""+l,{get:function(){return this.cues_[l]}})};if(i<s)for(a=i;a<s;a++)o.call(this,a)},e.getCueById=function(n){for(var i=null,a=0,s=this.length;a<s;a++){var o=this[a];if(o.id===n){i=o;break}}return i},t}(),Z9={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},eX={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},tX={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},aP={disabled:"disabled",hidden:"hidden",showing:"showing"},Bw=function(t){Ct.default(e,t);function e(r){var n;r===void 0&&(r={}),n=t.call(this)||this;var i={id:r.id||"vjs_track_"+cu(),kind:r.kind||"",language:r.language||""},a=r.label||"",s=function(l){Object.defineProperty(ir.default(n),l,{get:function(){return i[l]},set:function(){}})};for(var o in i)s(o);return Object.defineProperty(ir.default(n),"label",{get:function(){return a},set:function(l){l!==a&&(a=l,this.trigger("labelchange"))}}),n}return e}(kn),qw=function(e){var r=["protocol","hostname","port","pathname","search","hash","host"],n=yt.default.createElement("a");n.href=e;for(var i={},a=0;a<r.length;a++)i[r[a]]=n[r[a]];return i.protocol==="http:"&&(i.host=i.host.replace(/:80$/,"")),i.protocol==="https:"&&(i.host=i.host.replace(/:443$/,"")),i.protocol||(i.protocol=Se.default.location.protocol),i.host||(i.host=Se.default.location.host),i},C1=function(e){if(!e.match(/^https?:\/\//)){var r=yt.default.createElement("a");r.href=e,e=r.href}return e},jw=function(e){if(typeof e=="string"){var r=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/,n=r.exec(e);if(n)return n.pop().toLowerCase()}return""},fv=function(e,r){r===void 0&&(r=Se.default.location);var n=qw(e),i=n.protocol===":"?r.protocol:n.protocol,a=i+n.host!==r.protocol+r.host;return a},rX=Object.freeze({__proto__:null,parseUrl:qw,getAbsoluteURL:C1,getFileExtension:jw,isCrossOrigin:fv}),sP=function(e,r){var n=new Se.default.WebVTT.Parser(Se.default,Se.default.vttjs,Se.default.WebVTT.StringDecoder()),i=[];n.oncue=function(a){r.addCue(a)},n.onparsingerror=function(a){i.push(a)},n.onflush=function(){r.trigger({type:"loadeddata",target:r})},n.parse(e),i.length>0&&(Se.default.console&&Se.default.console.groupCollapsed&&Se.default.console.groupCollapsed("Text Track parsing errors for "+r.src),i.forEach(function(a){return pr.error(a)}),Se.default.console&&Se.default.console.groupEnd&&Se.default.console.groupEnd()),n.flush()},oP=function(e,r){var n={uri:e},i=fv(e);i&&(n.cors=i);var a=r.tech_.crossOrigin()==="use-credentials";a&&(n.withCredentials=a),zP.default(n,Ti(this,function(s,o,c){if(s)return pr.error(s,o);r.loaded_=!0,typeof Se.default.WebVTT!="function"?r.tech_&&r.tech_.any(["vttjsloaded","vttjserror"],function(l){if(l.type==="vttjserror"){pr.error("vttjs failed to load, stopping trying to process "+r.src);return}return sP(c,r)}):sP(c,r)}))},Jp=function(t){Ct.default(e,t);function e(n){var i;if(n===void 0&&(n={}),!n.tech)throw new Error("A tech was not provided.");var a=wi(n,{kind:tX[n.kind]||"subtitles",language:n.language||n.srclang||""}),s=aP[a.mode]||"disabled",o=a.default;(a.kind==="metadata"||a.kind==="chapters")&&(s="hidden"),i=t.call(this,a)||this,i.tech_=a.tech,i.cues_=[],i.activeCues_=[],i.preload_=i.tech_.preloadTextTracks!==!1;var c=new nP(i.cues_),l=new nP(i.activeCues_),f=!1;i.timeupdateHandler=Ti(ir.default(i),function(){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler);return}this.activeCues=this.activeCues,f&&(this.trigger("cuechange"),f=!1),this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)}});var g=function(){i.stopTracking()};return i.tech_.one("dispose",g),s!=="disabled"&&i.startTracking(),Object.defineProperties(ir.default(i),{default:{get:function(){return o},set:function(){}},mode:{get:function(){return s},set:function(y){aP[y]&&s!==y&&(s=y,!this.preload_&&s!=="disabled"&&this.cues.length===0&&oP(this.src,this),this.stopTracking(),s!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?c:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(this.cues.length===0)return l;for(var y=this.tech_.currentTime(),A=[],k=0,I=this.cues.length;k<I;k++){var F=this.cues[k];(F.startTime<=y&&F.endTime>=y||F.startTime===F.endTime&&F.startTime<=y&&F.startTime+.5>=y)&&A.push(F)}if(f=!1,A.length!==this.activeCues_.length)f=!0;else for(var J=0;J<A.length;J++)this.activeCues_.indexOf(A[J])===-1&&(f=!0);return this.activeCues_=A,l.setCues_(this.activeCues_),l},set:function(){}}}),a.src?(i.src=a.src,i.preload_||(i.loaded_=!0),(i.preload_||a.kind!=="subtitles"&&a.kind!=="captions")&&oP(i.src,ir.default(i))):i.loaded_=!0,i}var r=e.prototype;return r.startTracking=function(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler)},r.stopTracking=function(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0)},r.addCue=function(i){var a=i;if(Se.default.vttjs&&!(i instanceof Se.default.vttjs.VTTCue)){a=new Se.default.vttjs.VTTCue(i.startTime,i.endTime,i.text);for(var s in i)s in a||(a[s]=i[s]);a.id=i.id,a.originalCue_=i}for(var o=this.tech_.textTracks(),c=0;c<o.length;c++)o[c]!==this&&o[c].removeCue(a);this.cues_.push(a),this.cues.setCues_(this.cues_)},r.removeCue=function(i){for(var a=this.cues_.length;a--;){var s=this.cues_[a];if(s===i||s.originalCue_&&s.originalCue_===i){this.cues_.splice(a,1),this.cues.setCues_(this.cues_);break}}},e}(Bw);Jp.prototype.allowedEvents_={cuechange:"cuechange"};var A1=function(t){Ct.default(e,t);function e(r){var n;r===void 0&&(r={});var i=wi(r,{kind:eX[r.kind]||""});n=t.call(this,i)||this;var a=!1;return Object.defineProperty(ir.default(n),"enabled",{get:function(){return a},set:function(o){typeof o!="boolean"||o===a||(a=o,this.trigger("enabledchange"))}}),i.enabled&&(n.enabled=i.enabled),n.loaded_=!0,n}return e}(Bw),I1=function(t){Ct.default(e,t);function e(r){var n;r===void 0&&(r={});var i=wi(r,{kind:Z9[r.kind]||""});n=t.call(this,i)||this;var a=!1;return Object.defineProperty(ir.default(n),"selected",{get:function(){return a},set:function(o){typeof o!="boolean"||o===a||(a=o,this.trigger("selectedchange"))}}),i.selected&&(n.selected=i.selected),n}return e}(Bw),k1=0,iX=1,O1=2,nX=3,Rd=function(t){Ct.default(e,t);function e(r){var n;r===void 0&&(r={}),n=t.call(this)||this;var i,a=new Jp(r);return n.kind=a.kind,n.src=a.src,n.srclang=a.language,n.label=a.label,n.default=a.default,Object.defineProperties(ir.default(n),{readyState:{get:function(){return i}},track:{get:function(){return a}}}),i=k1,a.addEventListener("loadeddata",function(){i=O1,n.trigger({type:"load",target:ir.default(n)})}),n}return e}(kn);Rd.prototype.allowedEvents_={load:"load"};Rd.NONE=k1;Rd.LOADING=iX;Rd.LOADED=O1;Rd.ERROR=nX;var ys={audio:{ListClass:Y9,TrackClass:A1,capitalName:"Audio"},video:{ListClass:J9,TrackClass:I1,capitalName:"Video"},text:{ListClass:x1,TrackClass:Jp,capitalName:"Text"}};Object.keys(ys).forEach(function(t){ys[t].getterName=t+"Tracks",ys[t].privateName=t+"Tracks_"});var Cd={remoteText:{ListClass:x1,TrackClass:Jp,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Q9,TrackClass:Rd,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},ya=el.default({},ys,Cd);Cd.names=Object.keys(Cd);ys.names=Object.keys(ys);ya.names=[].concat(Cd.names).concat(ys.names);function aX(t,e,r,n,i){i===void 0&&(i={});var a=t.textTracks();i.kind=e,r&&(i.label=r),n&&(i.language=n),i.tech=t;var s=new ya.text.TrackClass(i);return a.addTrack(s),s}var ii=function(t){Ct.default(e,t);function e(n,i){var a;return n===void 0&&(n={}),i===void 0&&(i=function(){}),n.reportTouchActivity=!1,a=t.call(this,null,n,i)||this,a.onDurationChange_=function(s){return a.onDurationChange(s)},a.trackProgress_=function(s){return a.trackProgress(s)},a.trackCurrentTime_=function(s){return a.trackCurrentTime(s)},a.stopTrackingCurrentTime_=function(s){return a.stopTrackingCurrentTime(s)},a.disposeSourceHandler_=function(s){return a.disposeSourceHandler(s)},a.queuedHanders_=new Set,a.hasStarted_=!1,a.on("playing",function(){this.hasStarted_=!0}),a.on("loadstart",function(){this.hasStarted_=!1}),ya.names.forEach(function(s){var o=ya[s];n&&n[o.getterName]&&(a[o.privateName]=n[o.getterName])}),a.featuresProgressEvents||a.manualProgressOn(),a.featuresTimeupdateEvents||a.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(s){n["native"+s+"Tracks"]===!1&&(a["featuresNative"+s+"Tracks"]=!1)}),n.nativeCaptions===!1||n.nativeTextTracks===!1?a.featuresNativeTextTracks=!1:(n.nativeCaptions===!0||n.nativeTextTracks===!0)&&(a.featuresNativeTextTracks=!0),a.featuresNativeTextTracks||a.emulateTextTracks(),a.preloadTextTracks=n.preloadTextTracks!==!1,a.autoRemoteTextTracks_=new ya.text.ListClass,a.initTrackListeners(),n.nativeControlsForTouch||a.emitTapEvents(),a.constructor&&(a.name_=a.constructor.name||"Unknown Tech"),a}var r=e.prototype;return r.triggerSourceset=function(i){var a=this;this.isReady_||this.one("ready",function(){return a.setTimeout(function(){return a.triggerSourceset(i)},1)}),this.trigger({src:i,type:"sourceset"})},r.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)},r.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)},r.trackProgress=function(i){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Ti(this,function(){var a=this.bufferedPercent();this.bufferedPercent_!==a&&this.trigger("progress"),this.bufferedPercent_=a,a===1&&this.stopTrackingProgress()}),500)},r.onDurationChange=function(i){this.duration_=this.duration()},r.buffered=function(){return Qc(0,0)},r.bufferedPercent=function(){return E1(this.buffered(),this.duration_)},r.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},r.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)},r.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)},r.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},r.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},r.dispose=function(){this.clearTracks(ys.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},r.clearTracks=function(i){var a=this;i=[].concat(i),i.forEach(function(s){for(var o=a[s+"Tracks"]()||[],c=o.length;c--;){var l=o[c];s==="text"&&a.removeRemoteTextTrack(l),o.removeTrack(l)}})},r.cleanupAutoTextTracks=function(){for(var i=this.autoRemoteTextTracks_||[],a=i.length;a--;){var s=i[a];this.removeRemoteTextTrack(s)}},r.reset=function(){},r.crossOrigin=function(){},r.setCrossOrigin=function(){},r.error=function(i){return i!==void 0&&(this.error_=new _a(i),this.trigger("error")),this.error_},r.played=function(){return this.hasStarted_?Qc(0,0):Qc()},r.play=function(){},r.setScrubbing=function(){},r.scrubbing=function(){},r.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},r.initTrackListeners=function(){var i=this;ys.names.forEach(function(a){var s=ys[a],o=function(){i.trigger(a+"trackchange")},c=i[s.getterName]();c.addEventListener("removetrack",o),c.addEventListener("addtrack",o),i.on("dispose",function(){c.removeEventListener("removetrack",o),c.removeEventListener("addtrack",o)})})},r.addWebVttScript_=function(){var i=this;if(!Se.default.WebVTT)if(yt.default.body.contains(this.el())){if(!this.options_["vtt.js"]&&Gp(YO.default)&&Object.keys(YO.default).length>0){this.trigger("vttjsloaded");return}var a=yt.default.createElement("script");a.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",a.onload=function(){i.trigger("vttjsloaded")},a.onerror=function(){i.trigger("vttjserror")},this.on("dispose",function(){a.onload=null,a.onerror=null}),Se.default.WebVTT=!0,this.el().parentNode.appendChild(a)}else this.ready(this.addWebVttScript_)},r.emulateTextTracks=function(){var i=this,a=this.textTracks(),s=this.remoteTextTracks(),o=function(m){return a.addTrack(m.track)},c=function(m){return a.removeTrack(m.track)};s.on("addtrack",o),s.on("removetrack",c),this.addWebVttScript_();var l=function(){return i.trigger("texttrackchange")},f=function(){l();for(var m=0;m<a.length;m++){var y=a[m];y.removeEventListener("cuechange",l),y.mode==="showing"&&y.addEventListener("cuechange",l)}};f(),a.addEventListener("change",f),a.addEventListener("addtrack",f),a.addEventListener("removetrack",f),this.on("dispose",function(){s.off("addtrack",o),s.off("removetrack",c),a.removeEventListener("change",f),a.removeEventListener("addtrack",f),a.removeEventListener("removetrack",f);for(var g=0;g<a.length;g++){var m=a[g];m.removeEventListener("cuechange",l)}})},r.addTextTrack=function(i,a,s){if(!i)throw new Error("TextTrack kind is required but was not provided");return aX(this,i,a,s)},r.createRemoteTextTrack=function(i){var a=wi(i,{tech:this});return new Cd.remoteTextEl.TrackClass(a)},r.addRemoteTextTrack=function(i,a){var s=this;i===void 0&&(i={});var o=this.createRemoteTextTrack(i);return a!==!0&&a!==!1&&(pr.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),a=!0),this.remoteTextTrackEls().addTrackElement_(o),this.remoteTextTracks().addTrack(o.track),a!==!0&&this.ready(function(){return s.autoRemoteTextTracks_.addTrack(o.track)}),o},r.removeRemoteTextTrack=function(i){var a=this.remoteTextTrackEls().getTrackElementByTrack_(i);this.remoteTextTrackEls().removeTrackElement_(a),this.remoteTextTracks().removeTrack(i),this.autoRemoteTextTracks_.removeTrack(i)},r.getVideoPlaybackQuality=function(){return{}},r.requestPictureInPicture=function(){var i=this.options_.Promise||Se.default.Promise;if(i)return i.reject()},r.disablePictureInPicture=function(){return!0},r.setDisablePictureInPicture=function(){},r.requestVideoFrameCallback=function(i){var a=this,s=cu();return this.paused()?(this.queuedHanders_.add(s),this.one("playing",function(){a.queuedHanders_.has(s)&&(a.queuedHanders_.delete(s),i())})):this.requestNamedAnimationFrame(s,i),s},r.cancelVideoFrameCallback=function(i){this.queuedHanders_.has(i)?this.queuedHanders_.delete(i):this.cancelNamedAnimationFrame(i)},r.setPoster=function(){},r.playsinline=function(){},r.setPlaysinline=function(){},r.overrideNativeAudioTracks=function(){},r.overrideNativeVideoTracks=function(){},r.canPlayType=function(){return""},e.canPlayType=function(){return""},e.canPlaySource=function(i,a){return e.canPlayType(i.type)},e.isTech=function(i){return i.prototype instanceof e||i instanceof e||i===e},e.registerTech=function(i,a){if(e.techs_||(e.techs_={}),!e.isTech(a))throw new Error("Tech "+i+" must be a Tech");if(!e.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!e.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return i=Zi(i),e.techs_[i]=a,e.techs_[$m(i)]=a,i!=="Tech"&&e.defaultTechOrder_.push(i),a},e.getTech=function(i){if(i){if(e.techs_&&e.techs_[i])return e.techs_[i];if(i=Zi(i),Se.default&&Se.default.videojs&&Se.default.videojs[i])return pr.warn("The "+i+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),Se.default.videojs[i]}},e}(ht);ya.names.forEach(function(t){var e=ya[t];ii.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});ii.prototype.featuresVolumeControl=!0;ii.prototype.featuresMuteControl=!0;ii.prototype.featuresFullscreenResize=!1;ii.prototype.featuresPlaybackRate=!1;ii.prototype.featuresProgressEvents=!1;ii.prototype.featuresSourceset=!1;ii.prototype.featuresTimeupdateEvents=!1;ii.prototype.featuresNativeTextTracks=!1;ii.prototype.featuresVideoFrameCallback=!1;ii.withSourceHandlers=function(t){t.registerSourceHandler=function(r,n){var i=t.sourceHandlers;i||(i=t.sourceHandlers=[]),n===void 0&&(n=i.length),i.splice(n,0,r)},t.canPlayType=function(r){for(var n=t.sourceHandlers||[],i,a=0;a<n.length;a++)if(i=n[a].canPlayType(r),i)return i;return""},t.selectSourceHandler=function(r,n){for(var i=t.sourceHandlers||[],a,s=0;s<i.length;s++)if(a=i[s].canHandleSource(r,n),a)return i[s];return null},t.canPlaySource=function(r,n){var i=t.selectSourceHandler(r,n);return i?i.canHandleSource(r,n):""};var e=["seekable","seeking","duration"];e.forEach(function(r){var n=this[r];typeof n=="function"&&(this[r]=function(){return this.sourceHandler_&&this.sourceHandler_[r]?this.sourceHandler_[r].apply(this.sourceHandler_,arguments):n.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(r){var n=t.selectSourceHandler(r,this.options_);n||(t.nativeSourceHandler?n=t.nativeSourceHandler:pr.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),n!==t.nativeSourceHandler&&(this.currentSource_=r),this.sourceHandler_=n.handleSource(r,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},t.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};ht.registerComponent("Tech",ii);ii.registerTech("Tech",ii);ii.defaultTechOrder_=[];var Zc={},yw={},Vm={};function sX(t,e){Zc[t]=Zc[t]||[],Zc[t].push(e)}function oX(t,e,r){t.setTimeout(function(){return Wc(e,Zc[e.type],r,t)},1)}function uX(t,e){t.forEach(function(r){return r.setTech&&r.setTech(e)})}function cX(t,e,r){return t.reduceRight(Hw(r),e[r]())}function lX(t,e,r,n){return e[r](t.reduce(Hw(r),n))}function uP(t,e,r,n){n===void 0&&(n=null);var i="call"+Zi(r),a=t.reduce(Hw(i),n),s=a===Vm,o=s?null:e[r](a);return pX(t,r,o,s),o}var dX={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},fX={setCurrentTime:1,setMuted:1,setVolume:1},cP={play:1,pause:1};function Hw(t){return function(e,r){return e===Vm?Vm:r[t]?r[t](e):e}}function pX(t,e,r,n){for(var i=t.length-1;i>=0;i--){var a=t[i];a[e]&&a[e](n,r)}}function hX(t){yw[t.id()]=null}function gX(t,e){var r=yw[t.id()],n=null;if(r==null)return n=e(t),yw[t.id()]=[[e,n]],n;for(var i=0;i<r.length;i++){var a=r[i],s=a[0],o=a[1];s===e&&(n=o)}return n===null&&(n=e(t),r.push([e,n])),n}function Wc(t,e,r,n,i,a){t===void 0&&(t={}),e===void 0&&(e=[]),i===void 0&&(i=[]),a===void 0&&(a=!1);var s=e,o=s[0],c=s.slice(1);if(typeof o=="string")Wc(t,Zc[o],r,n,i,a);else if(o){var l=gX(n,o);if(!l.setSource)return i.push(l),Wc(t,c,r,n,i,a);l.setSource(Vi({},t),function(f,g){if(f)return Wc(t,c,r,n,i,a);i.push(l),Wc(g,t.type===g.type?c:Zc[g.type],r,n,i,a)})}else c.length?Wc(t,c,r,n,i,a):a?r(t,i):Wc(t,Zc["*"],r,n,i,!0)}var mX={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},zm=function(e){e===void 0&&(e="");var r=jw(e),n=mX[r.toLowerCase()];return n||""},vX=function(e,r){if(!r)return"";if(e.cache_.source.src===r&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter(function(o){return o.src===r});if(n.length)return n[0].type;for(var i=e.$$("source"),a=0;a<i.length;a++){var s=i[a];if(s.type&&s.src&&s.src===r)return s.type}return zm(r)},yX=function t(e){if(Array.isArray(e)){var r=[];e.forEach(function(n){n=t(n),Array.isArray(n)?r=r.concat(n):au(n)&&r.push(n)}),e=r}else typeof e=="string"&&e.trim()?e=[lP({src:e})]:au(e)&&typeof e.src=="string"&&e.src&&e.src.trim()?e=[lP(e)]:e=[];return e};function lP(t){if(!t.type){var e=zm(t.src);e&&(t.type=e)}return t}var bX=function(t){Ct.default(e,t);function e(r,n,i){var a,s=wi({createEl:!1},n);if(a=t.call(this,r,s,i)||this,!n.playerOptions.sources||n.playerOptions.sources.length===0)for(var o=0,c=n.playerOptions.techOrder;o<c.length;o++){var l=Zi(c[o]),f=ii.getTech(l);if(l||(f=ht.getComponent(l)),f&&f.isSupported()){r.loadTech_(l);break}}else r.src(n.playerOptions.sources);return a}return e}(ht);ht.registerComponent("MediaLoader",bX);var pv=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.options_.controlText&&a.controlText(a.options_.controlText),a.handleMouseOver_=function(s){return a.handleMouseOver(s)},a.handleMouseOut_=function(s){return a.handleMouseOut(s)},a.handleClick_=function(s){return a.handleClick(s)},a.handleKeyDown_=function(s){return a.handleKeyDown(s)},a.emitTapEvents(),a.enable(),a}var r=e.prototype;return r.createEl=function(i,a,s){i===void 0&&(i="div"),a===void 0&&(a={}),s===void 0&&(s={}),a=Vi({className:this.buildCSSClass(),tabIndex:0},a),i==="button"&&pr.error("Creating a ClickableComponent with an HTML element of "+i+" is not supported; use a Button instead."),s=Vi({role:"button"},s),this.tabIndex_=a.tabIndex;var o=Tr(i,a,s);return o.appendChild(Tr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o},r.dispose=function(){this.controlTextEl_=null,t.prototype.dispose.call(this)},r.createControlTextEl=function(i){return this.controlTextEl_=Tr("span",{className:"vjs-control-text"},{"aria-live":"polite"}),i&&i.appendChild(this.controlTextEl_),this.controlText(this.controlText_,i),this.controlTextEl_},r.controlText=function(i,a){if(a===void 0&&(a=this.el()),i===void 0)return this.controlText_||"Need Text";var s=this.localize(i);this.controlText_=i,tl(this.controlTextEl_,s),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&a.setAttribute("title",s)},r.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},r.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))},r.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)},r.handleLanguagechange=function(){this.controlText(this.controlText_)},r.handleClick=function(i){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},r.handleKeyDown=function(i){ar.default.isEventKey(i,"Space")||ar.default.isEventKey(i,"Enter")?(i.preventDefault(),i.stopPropagation(),this.trigger("click")):t.prototype.handleKeyDown.call(this,i)},e}(ht);ht.registerComponent("ClickableComponent",pv);var _X=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.update(),a.update_=function(s){return a.update(s)},n.on("posterchange",a.update_),a}var r=e.prototype;return r.dispose=function(){this.player().off("posterchange",this.update_),t.prototype.dispose.call(this)},r.createEl=function(){var i=Tr("div",{className:"vjs-poster",tabIndex:-1});return i},r.update=function(i){var a=this.player().poster();this.setSrc(a),a?this.show():this.hide()},r.setSrc=function(i){var a="";i&&(a='url("'+i+'")'),this.el_.style.backgroundImage=a},r.handleClick=function(i){if(this.player_.controls()){var a=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;this.player_.tech(!0)&&!((Xp||Kp)&&a)&&this.player_.tech(!0).focus(),this.player_.paused()?go(this.player_.play()):this.player_.pause()}},e}(pv);ht.registerComponent("PosterImage",_X);var vs="#222",dP="#ccc",wX={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function iw(t,e){var r;if(t.length===4)r=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else if(t.length===7)r=t.slice(1);else throw new Error("Invalid color code provided, "+t+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+e+")"}function nw(t,e,r){try{t.style[e]=r}catch{return}}var TX=function(t){Ct.default(e,t);function e(n,i,a){var s;s=t.call(this,n,i,a)||this;var o=function(l){return s.updateDisplay(l)};return n.on("loadstart",function(c){return s.toggleDisplay(c)}),n.on("texttrackchange",o),n.on("loadedmetadata",function(c){return s.preselectTrack(c)}),n.ready(Ti(ir.default(s),function(){if(n.tech_&&n.tech_.featuresNativeTextTracks){this.hide();return}n.on("fullscreenchange",o),n.on("playerresize",o),Se.default.addEventListener("orientationchange",o),n.on("dispose",function(){return Se.default.removeEventListener("orientationchange",o)});for(var c=this.options_.playerOptions.tracks||[],l=0;l<c.length;l++)this.player_.addRemoteTextTrack(c[l],!0);this.preselectTrack()})),s}var r=e.prototype;return r.preselectTrack=function(){for(var i={captions:1,subtitles:1},a=this.player_.textTracks(),s=this.player_.cache_.selectedLanguage,o,c,l,f=0;f<a.length;f++){var g=a[f];s&&s.enabled&&s.language&&s.language===g.language&&g.kind in i?g.kind===s.kind?l=g:l||(l=g):s&&!s.enabled?(l=null,o=null,c=null):g.default&&(g.kind==="descriptions"&&!o?o=g:g.kind in i&&!c&&(c=g))}l?l.mode="showing":c?c.mode="showing":o&&(o.mode="showing")},r.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})},r.clearDisplay=function(){typeof Se.default.WebVTT=="function"&&Se.default.WebVTT.processCues(Se.default,[],this.el_)},r.updateDisplay=function(){var i=this.player_.textTracks(),a=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),a){for(var s=[],o=0;o<i.length;++o){var c=i[o];c.mode==="showing"&&s.push(c)}this.updateForTrack(s);return}for(var l=null,f=null,g=i.length;g--;){var m=i[g];m.mode==="showing"&&(m.kind==="descriptions"?l=m:f=m)}f?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(f)):l&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(l))},r.updateDisplayState=function(i){for(var a=this.player_.textTrackSettings.getValues(),s=i.activeCues,o=s.length;o--;){var c=s[o];if(c){var l=c.displayState;if(a.color&&(l.firstChild.style.color=a.color),a.textOpacity&&nw(l.firstChild,"color",iw(a.color||"#fff",a.textOpacity)),a.backgroundColor&&(l.firstChild.style.backgroundColor=a.backgroundColor),a.backgroundOpacity&&nw(l.firstChild,"backgroundColor",iw(a.backgroundColor||"#000",a.backgroundOpacity)),a.windowColor&&(a.windowOpacity?nw(l,"backgroundColor",iw(a.windowColor,a.windowOpacity)):l.style.backgroundColor=a.windowColor),a.edgeStyle&&(a.edgeStyle==="dropshadow"?l.firstChild.style.textShadow="2px 2px 3px "+vs+", 2px 2px 4px "+vs+", 2px 2px 5px "+vs:a.edgeStyle==="raised"?l.firstChild.style.textShadow="1px 1px "+vs+", 2px 2px "+vs+", 3px 3px "+vs:a.edgeStyle==="depressed"?l.firstChild.style.textShadow="1px 1px "+dP+", 0 1px "+dP+", -1px -1px "+vs+", 0 -1px "+vs:a.edgeStyle==="uniform"&&(l.firstChild.style.textShadow="0 0 4px "+vs+", 0 0 4px "+vs+", 0 0 4px "+vs+", 0 0 4px "+vs)),a.fontPercent&&a.fontPercent!==1){var f=Se.default.parseFloat(l.style.fontSize);l.style.fontSize=f*a.fontPercent+"px",l.style.height="auto",l.style.top="auto"}a.fontFamily&&a.fontFamily!=="default"&&(a.fontFamily==="small-caps"?l.firstChild.style.fontVariant="small-caps":l.firstChild.style.fontFamily=wX[a.fontFamily])}}},r.updateForTrack=function(i){if(Array.isArray(i)||(i=[i]),!(typeof Se.default.WebVTT!="function"||i.every(function(y){return!y.activeCues}))){for(var a=[],s=0;s<i.length;++s)for(var o=i[s],c=0;c<o.activeCues.length;++c)a.push(o.activeCues[c]);Se.default.WebVTT.processCues(Se.default,a,this.el_);for(var l=0;l<i.length;++l){for(var f=i[l],g=0;g<f.activeCues.length;++g){var m=f.activeCues[g].displayState;iu(m,"vjs-text-track-cue"),iu(m,"vjs-text-track-cue-"+(f.language?f.language:l)),f.language&&Sd(m,"lang",f.language)}this.player_.textTrackSettings&&this.updateDisplayState(f)}}},e}(ht);ht.registerComponent("TextTrackDisplay",TX);var SX=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.createEl=function(){var i=this.player_.isAudio(),a=this.localize(i?"Audio Player":"Video Player"),s=Tr("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[a])}),o=t.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return o.appendChild(s),o},e}(ht);ht.registerComponent("LoadingSpinner",SX);var Us=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.createEl=function(i,a,s){a===void 0&&(a={}),s===void 0&&(s={}),i="button",a=Vi({className:this.buildCSSClass()},a),s=Vi({type:"button"},s);var o=Tr(i,a,s);return o.appendChild(Tr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o},r.addChild=function(i,a){a===void 0&&(a={});var s=this.constructor.name;return pr.warn("Adding an actionable (user controllable) child to a Button ("+s+") is not supported; use a ClickableComponent instead."),ht.prototype.addChild.call(this,i,a)},r.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},r.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},r.handleKeyDown=function(i){if(ar.default.isEventKey(i,"Space")||ar.default.isEventKey(i,"Enter")){i.stopPropagation();return}t.prototype.handleKeyDown.call(this,i)},e}(pv);ht.registerComponent("Button",Us);var P1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.mouseused_=!1,a.on("mousedown",function(s){return a.handleMouseDown(s)}),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-big-play-button"},r.handleClick=function(i){var a=this.player_.play();if(this.mouseused_&&i.clientX&&i.clientY){var s=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;go(a),this.player_.tech(!0)&&!((Xp||Kp)&&s)&&this.player_.tech(!0).focus();return}var o=this.player_.getChild("controlBar"),c=o&&o.getChild("playToggle");if(!c){this.player_.tech(!0).focus();return}var l=function(){return c.focus()};qp(a)?a.then(l,function(){}):this.setTimeout(l,1)},r.handleKeyDown=function(i){this.mouseused_=!1,t.prototype.handleKeyDown.call(this,i)},r.handleMouseDown=function(i){this.mouseused_=!0},e}(Us);P1.prototype.controlText_="Play Video";ht.registerComponent("BigPlayButton",P1);var EX=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.controlText(i&&i.controlText||a.localize("Close")),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-close-button "+t.prototype.buildCSSClass.call(this)},r.handleClick=function(i){this.trigger({type:"close",bubbles:!1})},r.handleKeyDown=function(i){ar.default.isEventKey(i,"Esc")?(i.preventDefault(),i.stopPropagation(),this.trigger("click")):t.prototype.handleKeyDown.call(this,i)},e}(Us);ht.registerComponent("CloseButton",EX);var R1=function(t){Ct.default(e,t);function e(n,i){var a;return i===void 0&&(i={}),a=t.call(this,n,i)||this,i.replay=i.replay===void 0||i.replay,a.on(n,"play",function(s){return a.handlePlay(s)}),a.on(n,"pause",function(s){return a.handlePause(s)}),i.replay&&a.on(n,"ended",function(s){return a.handleEnded(s)}),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},r.handleClick=function(i){this.player_.paused()?go(this.player_.play()):this.player_.pause()},r.handleSeeked=function(i){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(i):this.handlePlay(i)},r.handlePlay=function(i){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},r.handlePause=function(i){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},r.handleEnded=function(i){var a=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",function(s){return a.handleSeeked(s)})},e}(Us);R1.prototype.controlText_="Play";ht.registerComponent("PlayToggle",R1);var D1=function(e,r){e=e<0?0:e;var n=Math.floor(e%60),i=Math.floor(e/60%60),a=Math.floor(e/3600),s=Math.floor(r/60%60),o=Math.floor(r/3600);return(isNaN(e)||e===1/0)&&(a=i=n="-"),a=a>0||o>0?a+":":"",i=((a||s>=10)&&i<10?"0"+i:i)+":",n=n<10?"0"+n:n,a+i+n},Gw=D1;function xX(t){Gw=t}function CX(){Gw=D1}function Ad(t,e){return e===void 0&&(e=t),Gw(t,e)}var Dd=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.on(n,["timeupdate","ended"],function(s){return a.updateContent(s)}),a.updateTextNode_(),a}var r=e.prototype;return r.createEl=function(){var i=this.buildCSSClass(),a=t.prototype.createEl.call(this,"div",{className:i+" vjs-time-control vjs-control"}),s=Tr("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+"\xA0"},{role:"presentation"});return a.appendChild(s),this.contentEl_=Tr("span",{className:i+"-display"},{"aria-live":"off",role:"presentation"}),a.appendChild(this.contentEl_),a},r.dispose=function(){this.contentEl_=null,this.textNode_=null,t.prototype.dispose.call(this)},r.updateTextNode_=function(i){var a=this;i===void 0&&(i=0),i=Ad(i),this.formattedTime_!==i&&(this.formattedTime_=i,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(a.contentEl_){var s=a.textNode_;s&&a.contentEl_.firstChild!==s&&(s=null,pr.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),a.textNode_=yt.default.createTextNode(a.formattedTime_),a.textNode_&&(s?a.contentEl_.replaceChild(a.textNode_,s):a.contentEl_.appendChild(a.textNode_))}}))},r.updateContent=function(i){},e}(ht);Dd.prototype.labelText_="Time";Dd.prototype.controlText_="Time";ht.registerComponent("TimeDisplay",Dd);var Vw=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-current-time"},r.updateContent=function(i){var a;this.player_.ended()?a=this.player_.duration():a=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(a)},e}(Dd);Vw.prototype.labelText_="Current Time";Vw.prototype.controlText_="Current Time";ht.registerComponent("CurrentTimeDisplay",Vw);var zw=function(t){Ct.default(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=function(c){return a.updateContent(c)};return a.on(n,"durationchange",s),a.on(n,"loadstart",s),a.on(n,"loadedmetadata",s),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-duration"},r.updateContent=function(i){var a=this.player_.duration();this.updateTextNode_(a)},e}(Dd);zw.prototype.labelText_="Duration";zw.prototype.controlText_="Duration";ht.registerComponent("DurationDisplay",zw);var AX=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.createEl=function(){var i=t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),a=t.prototype.createEl.call(this,"div"),s=t.prototype.createEl.call(this,"span",{textContent:"/"});return a.appendChild(s),i.appendChild(a),i},e}(ht);ht.registerComponent("TimeDivider",AX);var Ww=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.on(n,"durationchange",function(s){return a.updateContent(s)}),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-remaining-time"},r.createEl=function(){var i=t.prototype.createEl.call(this);return this.options_.displayNegative!==!1&&i.insertBefore(Tr("span",{},{"aria-hidden":!0},"-"),this.contentEl_),i},r.updateContent=function(i){if(typeof this.player_.duration()=="number"){var a;this.player_.ended()?a=0:this.player_.remainingTimeDisplay?a=this.player_.remainingTimeDisplay():a=this.player_.remainingTime(),this.updateTextNode_(a)}},e}(Dd);Ww.prototype.labelText_="Remaining Time";Ww.prototype.controlText_="Remaining Time";ht.registerComponent("RemainingTimeDisplay",Ww);var IX=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.updateShowing(),a.on(a.player(),"durationchange",function(s){return a.updateShowing(s)}),a}var r=e.prototype;return r.createEl=function(){var i=t.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Tr("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Tr("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+"\xA0"})),this.contentEl_.appendChild(yt.default.createTextNode(this.localize("LIVE"))),i.appendChild(this.contentEl_),i},r.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},r.updateShowing=function(i){this.player().duration()===1/0?this.show():this.hide()},e}(ht);ht.registerComponent("LiveDisplay",IX);var L1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.updateLiveEdgeStatus(),a.player_.liveTracker&&(a.updateLiveEdgeStatusHandler_=function(s){return a.updateLiveEdgeStatus(s)},a.on(a.player_.liveTracker,"liveedgechange",a.updateLiveEdgeStatusHandler_)),a}var r=e.prototype;return r.createEl=function(){var i=t.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=Tr("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),i.appendChild(this.textEl_),i},r.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},r.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},r.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,t.prototype.dispose.call(this)},e}(Us);L1.prototype.controlText_="Seek to live, currently playing live";ht.registerComponent("SeekToLive",L1);var hv=function(e,r,n){return e=Number(e),Math.min(n,Math.max(r,isNaN(e)?r:e))},Kw=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.handleMouseDown_=function(s){return a.handleMouseDown(s)},a.handleMouseUp_=function(s){return a.handleMouseUp(s)},a.handleKeyDown_=function(s){return a.handleKeyDown(s)},a.handleClick_=function(s){return a.handleClick(s)},a.handleMouseMove_=function(s){return a.handleMouseMove(s)},a.update_=function(s){return a.update(s)},a.bar=a.getChild(a.options_.barName),a.vertical(!!a.options_.vertical),a.enable(),a}var r=e.prototype;return r.enabled=function(){return this.enabled_},r.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},r.disable=function(){if(this.enabled()){var i=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},r.createEl=function(i,a,s){return a===void 0&&(a={}),s===void 0&&(s={}),a.className=a.className+" vjs-slider",a=Vi({tabIndex:0},a),s=Vi({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},s),t.prototype.createEl.call(this,i,a,s)},r.handleMouseDown=function(i){var a=this.bar.el_.ownerDocument;i.type==="mousedown"&&i.preventDefault(),i.type==="touchstart"&&!uu&&i.preventDefault(),c1(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(a,"mousemove",this.handleMouseMove_),this.on(a,"mouseup",this.handleMouseUp_),this.on(a,"touchmove",this.handleMouseMove_),this.on(a,"touchend",this.handleMouseUp_),this.handleMouseMove(i,!0)},r.handleMouseMove=function(i){},r.handleMouseUp=function(){var i=this.bar.el_.ownerDocument;l1(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.update()},r.update=function(){var i=this;if(!(!this.el_||!this.bar)){var a=this.getProgress();return a===this.progress_||(this.progress_=a,this.requestNamedAnimationFrame("Slider#update",function(){var s=i.vertical()?"height":"width";i.bar.el().style[s]=(a*100).toFixed(2)+"%"})),a}},r.getProgress=function(){return Number(hv(this.getPercent(),0,1).toFixed(4))},r.calculateDistance=function(i){var a=uv(this.el_,i);return this.vertical()?a.y:a.x},r.handleKeyDown=function(i){ar.default.isEventKey(i,"Left")||ar.default.isEventKey(i,"Down")?(i.preventDefault(),i.stopPropagation(),this.stepBack()):ar.default.isEventKey(i,"Right")||ar.default.isEventKey(i,"Up")?(i.preventDefault(),i.stopPropagation(),this.stepForward()):t.prototype.handleKeyDown.call(this,i)},r.handleClick=function(i){i.stopPropagation(),i.preventDefault()},r.vertical=function(i){if(i===void 0)return this.vertical_||!1;this.vertical_=!!i,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(ht);ht.registerComponent("Slider",Kw);var aw=function(e,r){return hv(e/r*100,0,100).toFixed(2)+"%"},kX=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.partEls_=[],a.on(n,"progress",function(s){return a.update(s)}),a}var r=e.prototype;return r.createEl=function(){var i=t.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),a=Tr("span",{className:"vjs-control-text"}),s=Tr("span",{textContent:this.localize("Loaded")}),o=yt.default.createTextNode(": ");return this.percentageEl_=Tr("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),i.appendChild(a),a.appendChild(s),a.appendChild(o),a.appendChild(this.percentageEl_),i},r.dispose=function(){this.partEls_=null,this.percentageEl_=null,t.prototype.dispose.call(this)},r.update=function(i){var a=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var s=a.player_.liveTracker,o=a.player_.buffered(),c=s&&s.isLive()?s.seekableEnd():a.player_.duration(),l=a.player_.bufferedEnd(),f=a.partEls_,g=aw(l,c);a.percent_!==g&&(a.el_.style.width=g,tl(a.percentageEl_,g),a.percent_=g);for(var m=0;m<o.length;m++){var y=o.start(m),A=o.end(m),k=f[m];k||(k=a.el_.appendChild(Tr()),f[m]=k),!(k.dataset.start===y&&k.dataset.end===A)&&(k.dataset.start=y,k.dataset.end=A,k.style.left=aw(y,l),k.style.width=aw(A-y,l))}for(var I=f.length;I>o.length;I--)a.el_.removeChild(f[I-1]);f.length=o.length})},e}(ht);ht.registerComponent("LoadProgressBar",kX);var OX=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.update=su(Ti(ir.default(a),a.update),Fs),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},r.update=function(i,a,s){var o=zp(this.el_),c=Ed(this.player_.el()),l=i.width*a;if(!(!c||!o)){var f=i.left-c.left+l,g=i.width-l+(c.right-i.right),m=o.width/2;f<m?m+=m-f:g<m&&(m=g),m<0?m=0:m>o.width&&(m=o.width),m=Math.round(m),this.el_.style.right="-"+m+"px",this.write(s)}},r.write=function(i){tl(this.el_,i)},r.updateTime=function(i,a,s,o){var c=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var l,f=c.player_.duration();if(c.player_.liveTracker&&c.player_.liveTracker.isLive()){var g=c.player_.liveTracker.liveWindow(),m=g-a*g;l=(m<1?"":"-")+Ad(m,g)}else l=Ad(s,f);c.update(i,a,l),o&&o()})},e}(ht);ht.registerComponent("TimeTooltip",OX);var Xw=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.update=su(Ti(ir.default(a),a.update),Fs),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},r.update=function(i,a){var s=this.getChild("timeTooltip");if(s){var o=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();s.updateTime(i,a,o)}},e}(ht);Xw.prototype.options_={children:[]};!wa&&!ou&&Xw.prototype.options_.children.push("timeTooltip");ht.registerComponent("PlayProgressBar",Xw);var N1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.update=su(Ti(ir.default(a),a.update),Fs),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},r.update=function(i,a){var s=this,o=a*this.player_.duration();this.getChild("timeTooltip").updateTime(i,a,o,function(){s.el_.style.left=i.width*a+"px"})},e}(ht);N1.prototype.options_={children:["timeTooltip"]};ht.registerComponent("MouseTimeDisplay",N1);var Pm=5,fP=12,Yw=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.setEventHandlers_(),a}var r=e.prototype;return r.setEventHandlers_=function(){var i=this;this.update_=Ti(this,this.update),this.update=su(this.update_,Fs),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(a){return i.enableInterval_(a)},this.disableIntervalHandler_=function(a){return i.disableInterval_(a)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in yt.default&&"visibilityState"in yt.default&&this.on(yt.default,"visibilitychange",this.toggleVisibility_)},r.toggleVisibility_=function(i){yt.default.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(i)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())},r.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Fs))},r.disableInterval_=function(i){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&i&&i.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},r.update=function(i){var a=this;if(yt.default.visibilityState!=="hidden"){var s=t.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var o=a.player_.ended()?a.player_.duration():a.getCurrentTime_(),c=a.player_.liveTracker,l=a.player_.duration();c&&c.isLive()&&(l=a.player_.liveTracker.liveCurrentTime()),a.percent_!==s&&(a.el_.setAttribute("aria-valuenow",(s*100).toFixed(2)),a.percent_=s),(a.currentTime_!==o||a.duration_!==l)&&(a.el_.setAttribute("aria-valuetext",a.localize("progress bar timing: currentTime={1} duration={2}",[Ad(o,l),Ad(l,l)],"{1} of {2}")),a.currentTime_=o,a.duration_=l),a.bar&&a.bar.update(Ed(a.el()),a.getProgress())}),s}},r.userSeek_=function(i){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(i)},r.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},r.getPercent=function(){var i=this.getCurrentTime_(),a,s=this.player_.liveTracker;return s&&s.isLive()?(a=(i-s.seekableStart())/s.liveWindow(),s.atLiveEdge()&&(a=1)):a=i/this.player_.duration(),a},r.handleMouseDown=function(i){Wp(i)&&(i.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),t.prototype.handleMouseDown.call(this,i))},r.handleMouseMove=function(i,a){if(a===void 0&&(a=!1),!!Wp(i)){!a&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);var s,o=this.calculateDistance(i),c=this.player_.liveTracker;if(!c||!c.isLive())s=o*this.player_.duration(),s===this.player_.duration()&&(s=s-.1);else{if(o>=.99){c.seekToLiveEdge();return}var l=c.seekableStart(),f=c.liveCurrentTime();if(s=l+o*c.liveWindow(),s>=f&&(s=f),s<=l&&(s=l+.1),s===1/0)return}this.userSeek_(s)}},r.enable=function(){t.prototype.enable.call(this);var i=this.getChild("mouseTimeDisplay");i&&i.show()},r.disable=function(){t.prototype.disable.call(this);var i=this.getChild("mouseTimeDisplay");i&&i.hide()},r.handleMouseUp=function(i){t.prototype.handleMouseUp.call(this,i),i&&i.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?go(this.player_.play()):this.update_()},r.stepForward=function(){this.userSeek_(this.player_.currentTime()+Pm)},r.stepBack=function(){this.userSeek_(this.player_.currentTime()-Pm)},r.handleAction=function(i){this.player_.paused()?this.player_.play():this.player_.pause()},r.handleKeyDown=function(i){var a=this.player_.liveTracker;if(ar.default.isEventKey(i,"Space")||ar.default.isEventKey(i,"Enter"))i.preventDefault(),i.stopPropagation(),this.handleAction(i);else if(ar.default.isEventKey(i,"Home"))i.preventDefault(),i.stopPropagation(),this.userSeek_(0);else if(ar.default.isEventKey(i,"End"))i.preventDefault(),i.stopPropagation(),a&&a.isLive()?this.userSeek_(a.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(ar.default(i))){i.preventDefault(),i.stopPropagation();var s=(ar.default.codes[ar.default(i)]-ar.default.codes[0])*10/100;a&&a.isLive()?this.userSeek_(a.seekableStart()+a.liveWindow()*s):this.userSeek_(this.player_.duration()*s)}else ar.default.isEventKey(i,"PgDn")?(i.preventDefault(),i.stopPropagation(),this.userSeek_(this.player_.currentTime()-Pm*fP)):ar.default.isEventKey(i,"PgUp")?(i.preventDefault(),i.stopPropagation(),this.userSeek_(this.player_.currentTime()+Pm*fP)):t.prototype.handleKeyDown.call(this,i)},r.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in yt.default&&"visibilityState"in yt.default&&this.off(yt.default,"visibilitychange",this.toggleVisibility_),t.prototype.dispose.call(this)},e}(Kw);Yw.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};!wa&&!ou&&Yw.prototype.options_.children.splice(1,0,"mouseTimeDisplay");ht.registerComponent("SeekBar",Yw);var M1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.handleMouseMove=su(Ti(ir.default(a),a.handleMouseMove),Fs),a.throttledHandleMouseSeek=su(Ti(ir.default(a),a.handleMouseSeek),Fs),a.handleMouseUpHandler_=function(s){return a.handleMouseUp(s)},a.handleMouseDownHandler_=function(s){return a.handleMouseDown(s)},a.enable(),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},r.handleMouseMove=function(i){var a=this.getChild("seekBar");if(a){var s=a.getChild("playProgressBar"),o=a.getChild("mouseTimeDisplay");if(!(!s&&!o)){var c=a.el(),l=zp(c),f=uv(c,i).x;f=hv(f,0,1),o&&o.update(l,f),s&&s.update(l,a.getProgress())}}},r.handleMouseSeek=function(i){var a=this.getChild("seekBar");a&&a.handleMouseMove(i)},r.enabled=function(){return this.enabled_},r.disable=function(){if(this.children().forEach(function(a){return a.disable&&a.disable()}),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var i=this.getChild("seekBar");this.player_.scrubbing(!1),i.videoWasPlaying&&go(this.player_.play())}},r.enable=function(){this.children().forEach(function(i){return i.enable&&i.enable()}),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},r.removeListenersAddedOnMousedownAndTouchstart=function(){var i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseSeek),this.off(i,"touchmove",this.throttledHandleMouseSeek),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)},r.handleMouseDown=function(i){var a=this.el_.ownerDocument,s=this.getChild("seekBar");s&&s.handleMouseDown(i),this.on(a,"mousemove",this.throttledHandleMouseSeek),this.on(a,"touchmove",this.throttledHandleMouseSeek),this.on(a,"mouseup",this.handleMouseUpHandler_),this.on(a,"touchend",this.handleMouseUpHandler_)},r.handleMouseUp=function(i){var a=this.getChild("seekBar");a&&a.handleMouseUp(i),this.removeListenersAddedOnMousedownAndTouchstart()},e}(ht);M1.prototype.options_={children:["seekBar"]};ht.registerComponent("ProgressControl",M1);var $1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.on(n,["enterpictureinpicture","leavepictureinpicture"],function(s){return a.handlePictureInPictureChange(s)}),a.on(n,["disablepictureinpicturechanged","loadedmetadata"],function(s){return a.handlePictureInPictureEnabledChange(s)}),a.on(n,["loadedmetadata","audioonlymodechange","audiopostermodechange"],function(){var s=n.currentType().substring(0,5)==="audio";s||n.audioPosterMode()||n.audioOnlyMode()?(n.isInPictureInPicture()&&n.exitPictureInPicture(),a.hide()):a.show()}),a.disable(),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-picture-in-picture-control "+t.prototype.buildCSSClass.call(this)},r.handlePictureInPictureEnabledChange=function(){yt.default.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1?this.enable():this.disable()},r.handlePictureInPictureChange=function(i){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},r.handleClick=function(i){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},e}(Us);$1.prototype.controlText_="Picture-in-Picture";ht.registerComponent("PictureInPictureToggle",$1);var U1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.on(n,"fullscreenchange",function(s){return a.handleFullscreenChange(s)}),yt.default[n.fsApi_.fullscreenEnabled]===!1&&a.disable(),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-fullscreen-control "+t.prototype.buildCSSClass.call(this)},r.handleFullscreenChange=function(i){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},r.handleClick=function(i){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(Us);U1.prototype.controlText_="Fullscreen";ht.registerComponent("FullscreenToggle",U1);var PX=function(e,r){r.tech_&&!r.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(r,"loadstart",function(){r.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},RX=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.createEl=function(){var i=t.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});return i.appendChild(t.prototype.createEl.call(this,"span",{className:"vjs-control-text"})),i},e}(ht);ht.registerComponent("VolumeLevel",RX);var DX=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.update=su(Ti(ir.default(a),a.update),Fs),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})},r.update=function(i,a,s,o){if(!s){var c=Ed(this.el_),l=Ed(this.player_.el()),f=i.width*a;if(!l||!c)return;var g=i.left-l.left+f,m=i.width-f+(l.right-i.right),y=c.width/2;g<y?y+=y-g:m<y&&(y=m),y<0?y=0:y>c.width&&(y=c.width),this.el_.style.right="-"+y+"px"}this.write(o+"%")},r.write=function(i){tl(this.el_,i)},r.updateVolume=function(i,a,s,o,c){var l=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",function(){l.update(i,a,s,o.toFixed(0)),c&&c()})},e}(ht);ht.registerComponent("VolumeLevelTooltip",DX);var F1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.update=su(Ti(ir.default(a),a.update),Fs),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},r.update=function(i,a,s){var o=this,c=100*a;this.getChild("volumeLevelTooltip").updateVolume(i,a,s,c,function(){s?o.el_.style.bottom=i.height*a+"px":o.el_.style.left=i.width*a+"px"})},e}(ht);F1.prototype.options_={children:["volumeLevelTooltip"]};ht.registerComponent("MouseVolumeLevelDisplay",F1);var gv=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.on("slideractive",function(s){return a.updateLastVolume_(s)}),a.on(n,"volumechange",function(s){return a.updateARIAAttributes(s)}),n.ready(function(){return a.updateARIAAttributes()}),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},r.handleMouseDown=function(i){Wp(i)&&t.prototype.handleMouseDown.call(this,i)},r.handleMouseMove=function(i){var a=this.getChild("mouseVolumeLevelDisplay");if(a){var s=this.el(),o=Ed(s),c=this.vertical(),l=uv(s,i);l=c?l.y:l.x,l=hv(l,0,1),a.update(o,l,c)}Wp(i)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(i)))},r.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},r.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},r.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},r.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},r.updateARIAAttributes=function(i){var a=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",a),this.el_.setAttribute("aria-valuetext",a+"%")},r.volumeAsPercentage_=function(){return Math.round(this.player_.volume()*100)},r.updateLastVolume_=function(){var i=this,a=this.player_.volume();this.one("sliderinactive",function(){i.player_.volume()===0&&i.player_.lastVolume_(a)})},e}(Kw);gv.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!wa&&!ou&&gv.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");gv.prototype.playerEvent="volumechange";ht.registerComponent("VolumeBar",gv);var B1=function(t){Ct.default(e,t);function e(n,i){var a;return i===void 0&&(i={}),i.vertical=i.vertical||!1,(typeof i.volumeBar>"u"||Gp(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),a=t.call(this,n,i)||this,PX(ir.default(a),n),a.throttledHandleMouseMove=su(Ti(ir.default(a),a.handleMouseMove),Fs),a.handleMouseUpHandler_=function(s){return a.handleMouseUp(s)},a.on("mousedown",function(s){return a.handleMouseDown(s)}),a.on("touchstart",function(s){return a.handleMouseDown(s)}),a.on("mousemove",function(s){return a.handleMouseMove(s)}),a.on(a.volumeBar,["focus","slideractive"],function(){a.volumeBar.addClass("vjs-slider-active"),a.addClass("vjs-slider-active"),a.trigger("slideractive")}),a.on(a.volumeBar,["blur","sliderinactive"],function(){a.volumeBar.removeClass("vjs-slider-active"),a.removeClass("vjs-slider-active"),a.trigger("sliderinactive")}),a}var r=e.prototype;return r.createEl=function(){var i="vjs-volume-horizontal";return this.options_.vertical&&(i="vjs-volume-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+i})},r.handleMouseDown=function(i){var a=this.el_.ownerDocument;this.on(a,"mousemove",this.throttledHandleMouseMove),this.on(a,"touchmove",this.throttledHandleMouseMove),this.on(a,"mouseup",this.handleMouseUpHandler_),this.on(a,"touchend",this.handleMouseUpHandler_)},r.handleMouseUp=function(i){var a=this.el_.ownerDocument;this.off(a,"mousemove",this.throttledHandleMouseMove),this.off(a,"touchmove",this.throttledHandleMouseMove),this.off(a,"mouseup",this.handleMouseUpHandler_),this.off(a,"touchend",this.handleMouseUpHandler_)},r.handleMouseMove=function(i){this.volumeBar.handleMouseMove(i)},e}(ht);B1.prototype.options_={children:["volumeBar"]};ht.registerComponent("VolumeControl",B1);var LX=function(e,r){r.tech_&&!r.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(r,"loadstart",function(){r.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})},q1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,LX(ir.default(a),n),a.on(n,["loadstart","volumechange"],function(s){return a.update(s)}),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-mute-control "+t.prototype.buildCSSClass.call(this)},r.handleClick=function(i){var a=this.player_.volume(),s=this.player_.lastVolume_();if(a===0){var o=s<.1?.1:s;this.player_.volume(o),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},r.update=function(i){this.updateIcon_(),this.updateControlText_()},r.updateIcon_=function(){var i=this.player_.volume(),a=3;wa&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),i===0||this.player_.muted()?a=0:i<.33?a=1:i<.67&&(a=2);for(var s=0;s<4;s++)Yp(this.el_,"vjs-vol-"+s);iu(this.el_,"vjs-vol-"+a)},r.updateControlText_=function(){var i=this.player_.muted()||this.player_.volume()===0,a=i?"Unmute":"Mute";this.controlText()!==a&&this.controlText(a)},e}(Us);q1.prototype.controlText_="Mute";ht.registerComponent("MuteToggle",q1);var j1=function(t){Ct.default(e,t);function e(n,i){var a;return i===void 0&&(i={}),typeof i.inline<"u"?i.inline=i.inline:i.inline=!0,(typeof i.volumeControl>"u"||Gp(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),a=t.call(this,n,i)||this,a.handleKeyPressHandler_=function(s){return a.handleKeyPress(s)},a.on(n,["loadstart"],function(s){return a.volumePanelState_(s)}),a.on(a.muteToggle,"keyup",function(s){return a.handleKeyPress(s)}),a.on(a.volumeControl,"keyup",function(s){return a.handleVolumeControlKeyUp(s)}),a.on("keydown",function(s){return a.handleKeyPress(s)}),a.on("mouseover",function(s){return a.handleMouseOver(s)}),a.on("mouseout",function(s){return a.handleMouseOut(s)}),a.on(a.volumeControl,["slideractive"],a.sliderActive_),a.on(a.volumeControl,["sliderinactive"],a.sliderInactive_),a}var r=e.prototype;return r.sliderActive_=function(){this.addClass("vjs-slider-active")},r.sliderInactive_=function(){this.removeClass("vjs-slider-active")},r.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},r.createEl=function(){var i="vjs-volume-panel-horizontal";return this.options_.inline||(i="vjs-volume-panel-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+i})},r.dispose=function(){this.handleMouseOut(),t.prototype.dispose.call(this)},r.handleVolumeControlKeyUp=function(i){ar.default.isEventKey(i,"Esc")&&this.muteToggle.focus()},r.handleMouseOver=function(i){this.addClass("vjs-hover"),rs(yt.default,"keyup",this.handleKeyPressHandler_)},r.handleMouseOut=function(i){this.removeClass("vjs-hover"),ea(yt.default,"keyup",this.handleKeyPressHandler_)},r.handleKeyPress=function(i){ar.default.isEventKey(i,"Esc")&&this.handleMouseOut()},e}(ht);j1.prototype.options_={children:["muteToggle","volumeControl"]};ht.registerComponent("VolumePanel",j1);var H1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,i&&(a.menuButton_=i.menuButton),a.focusedChild_=-1,a.on("keydown",function(s){return a.handleKeyDown(s)}),a.boundHandleBlur_=function(s){return a.handleBlur(s)},a.boundHandleTapClick_=function(s){return a.handleTapClick(s)},a}var r=e.prototype;return r.addEventListenerForItem=function(i){i instanceof ht&&(this.on(i,"blur",this.boundHandleBlur_),this.on(i,["tap","click"],this.boundHandleTapClick_))},r.removeEventListenerForItem=function(i){i instanceof ht&&(this.off(i,"blur",this.boundHandleBlur_),this.off(i,["tap","click"],this.boundHandleTapClick_))},r.removeChild=function(i){typeof i=="string"&&(i=this.getChild(i)),this.removeEventListenerForItem(i),t.prototype.removeChild.call(this,i)},r.addItem=function(i){var a=this.addChild(i);a&&this.addEventListenerForItem(a)},r.createEl=function(){var i=this.options_.contentElType||"ul";this.contentEl_=Tr(i,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var a=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return a.appendChild(this.contentEl_),rs(a,"click",function(s){s.preventDefault(),s.stopImmediatePropagation()}),a},r.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,t.prototype.dispose.call(this)},r.handleBlur=function(i){var a=i.relatedTarget||yt.default.activeElement;if(!this.children().some(function(o){return o.el()===a})){var s=this.menuButton_;s&&s.buttonPressed_&&a!==s.el().firstChild&&s.unpressButton()}},r.handleTapClick=function(i){if(this.menuButton_){this.menuButton_.unpressButton();var a=this.children();if(!Array.isArray(a))return;var s=a.filter(function(o){return o.el()===i.target})[0];if(!s)return;s.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}},r.handleKeyDown=function(i){ar.default.isEventKey(i,"Left")||ar.default.isEventKey(i,"Down")?(i.preventDefault(),i.stopPropagation(),this.stepForward()):(ar.default.isEventKey(i,"Right")||ar.default.isEventKey(i,"Up"))&&(i.preventDefault(),i.stopPropagation(),this.stepBack())},r.stepForward=function(){var i=0;this.focusedChild_!==void 0&&(i=this.focusedChild_+1),this.focus(i)},r.stepBack=function(){var i=0;this.focusedChild_!==void 0&&(i=this.focusedChild_-1),this.focus(i)},r.focus=function(i){i===void 0&&(i=0);var a=this.children().slice(),s=a.length&&a[0].hasClass("vjs-menu-title");s&&a.shift(),a.length>0&&(i<0?i=0:i>=a.length&&(i=a.length-1),this.focusedChild_=i,a[i].el_.focus())},e}(ht);ht.registerComponent("Menu",H1);var Jw=function(t){Ct.default(e,t);function e(n,i){var a;i===void 0&&(i={}),a=t.call(this,n,i)||this,a.menuButton_=new Us(n,i),a.menuButton_.controlText(a.controlText_),a.menuButton_.el_.setAttribute("aria-haspopup","true");var s=Us.prototype.buildCSSClass();a.menuButton_.el_.className=a.buildCSSClass()+" "+s,a.menuButton_.removeClass("vjs-control"),a.addChild(a.menuButton_),a.update(),a.enabled_=!0;var o=function(l){return a.handleClick(l)};return a.handleMenuKeyUp_=function(c){return a.handleMenuKeyUp(c)},a.on(a.menuButton_,"tap",o),a.on(a.menuButton_,"click",o),a.on(a.menuButton_,"keydown",function(c){return a.handleKeyDown(c)}),a.on(a.menuButton_,"mouseenter",function(){a.addClass("vjs-hover"),a.menu.show(),rs(yt.default,"keyup",a.handleMenuKeyUp_)}),a.on("mouseleave",function(c){return a.handleMouseLeave(c)}),a.on("keydown",function(c){return a.handleSubmenuKeyDown(c)}),a}var r=e.prototype;return r.update=function(){var i=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=i,this.addChild(i),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))},r.createMenu=function(){var i=new H1(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var a=Tr("li",{className:"vjs-menu-title",textContent:Zi(this.options_.title),tabIndex:-1}),s=new ht(this.player_,{el:a});i.addItem(s)}if(this.items=this.createItems(),this.items)for(var o=0;o<this.items.length;o++)i.addItem(this.items[o]);return i},r.createItems=function(){},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},r.buildWrapperCSSClass=function(){var i="vjs-menu-button";this.options_.inline===!0?i+="-inline":i+="-popup";var a=Us.prototype.buildCSSClass();return"vjs-menu-button "+i+" "+a+" "+t.prototype.buildCSSClass.call(this)},r.buildCSSClass=function(){var i="vjs-menu-button";return this.options_.inline===!0?i+="-inline":i+="-popup","vjs-menu-button "+i+" "+t.prototype.buildCSSClass.call(this)},r.controlText=function(i,a){return a===void 0&&(a=this.menuButton_.el()),this.menuButton_.controlText(i,a)},r.dispose=function(){this.handleMouseLeave(),t.prototype.dispose.call(this)},r.handleClick=function(i){this.buttonPressed_?this.unpressButton():this.pressButton()},r.handleMouseLeave=function(i){this.removeClass("vjs-hover"),ea(yt.default,"keyup",this.handleMenuKeyUp_)},r.focus=function(){this.menuButton_.focus()},r.blur=function(){this.menuButton_.blur()},r.handleKeyDown=function(i){ar.default.isEventKey(i,"Esc")||ar.default.isEventKey(i,"Tab")?(this.buttonPressed_&&this.unpressButton(),ar.default.isEventKey(i,"Tab")||(i.preventDefault(),this.menuButton_.focus())):(ar.default.isEventKey(i,"Up")||ar.default.isEventKey(i,"Down"))&&(this.buttonPressed_||(i.preventDefault(),this.pressButton()))},r.handleMenuKeyUp=function(i){(ar.default.isEventKey(i,"Esc")||ar.default.isEventKey(i,"Tab"))&&this.removeClass("vjs-hover")},r.handleSubmenuKeyPress=function(i){this.handleSubmenuKeyDown(i)},r.handleSubmenuKeyDown=function(i){(ar.default.isEventKey(i,"Esc")||ar.default.isEventKey(i,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),ar.default.isEventKey(i,"Tab")||(i.preventDefault(),this.menuButton_.focus()))},r.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),wa&&n1())return;this.menu.focus()}},r.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},r.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},r.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(ht);ht.registerComponent("MenuButton",Jw);var Qw=function(t){Ct.default(e,t);function e(r,n){var i,a=n.tracks;if(i=t.call(this,r,n)||this,i.items.length<=1&&i.hide(),!a)return ir.default(i);var s=Ti(ir.default(i),i.update);return a.addEventListener("removetrack",s),a.addEventListener("addtrack",s),a.addEventListener("labelchange",s),i.player_.on("ready",s),i.player_.on("dispose",function(){a.removeEventListener("removetrack",s),a.removeEventListener("addtrack",s),a.removeEventListener("labelchange",s)}),i}return e}(Jw);ht.registerComponent("TrackButton",Qw);var NX=["Tab","Esc","Up","Down","Right","Left"],Qp=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.selectable=i.selectable,a.isSelected_=i.selected||!1,a.multiSelectable=i.multiSelectable,a.selected(a.isSelected_),a.selectable?a.multiSelectable?a.el_.setAttribute("role","menuitemcheckbox"):a.el_.setAttribute("role","menuitemradio"):a.el_.setAttribute("role","menuitem"),a}var r=e.prototype;return r.createEl=function(i,a,s){this.nonIconControl=!0;var o=t.prototype.createEl.call(this,"li",Vi({className:"vjs-menu-item",tabIndex:-1},a),s);return o.replaceChild(Tr("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),o.querySelector(".vjs-icon-placeholder")),o},r.handleKeyDown=function(i){NX.some(function(a){return ar.default.isEventKey(i,a)})||t.prototype.handleKeyDown.call(this,i)},r.handleClick=function(i){this.selected(!0)},r.selected=function(i){this.selectable&&(i?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(pv);ht.registerComponent("MenuItem",Qp);var Zp=function(t){Ct.default(e,t);function e(n,i){var a,s=i.track,o=n.textTracks();i.label=s.label||s.language||"Unknown",i.selected=s.mode==="showing",a=t.call(this,n,i)||this,a.track=s,a.kinds=(i.kinds||[i.kind||a.track.kind]).filter(Boolean);var c=function(){for(var m=arguments.length,y=new Array(m),A=0;A<m;A++)y[A]=arguments[A];a.handleTracksChange.apply(ir.default(a),y)},l=function(){for(var m=arguments.length,y=new Array(m),A=0;A<m;A++)y[A]=arguments[A];a.handleSelectedLanguageChange.apply(ir.default(a),y)};if(n.on(["loadstart","texttrackchange"],c),o.addEventListener("change",c),o.addEventListener("selectedlanguagechange",l),a.on("dispose",function(){n.off(["loadstart","texttrackchange"],c),o.removeEventListener("change",c),o.removeEventListener("selectedlanguagechange",l)}),o.onchange===void 0){var f;a.on(["tap","click"],function(){if(typeof Se.default.Event!="object")try{f=new Se.default.Event("change")}catch{}f||(f=yt.default.createEvent("Event"),f.initEvent("change",!0,!0)),o.dispatchEvent(f)})}return a.handleTracksChange(),a}var r=e.prototype;return r.handleClick=function(i){var a=this.track,s=this.player_.textTracks();if(t.prototype.handleClick.call(this,i),!!s)for(var o=0;o<s.length;o++){var c=s[o];this.kinds.indexOf(c.kind)!==-1&&(c===a?c.mode!=="showing"&&(c.mode="showing"):c.mode!=="disabled"&&(c.mode="disabled"))}},r.handleTracksChange=function(i){var a=this.track.mode==="showing";a!==this.isSelected_&&this.selected(a)},r.handleSelectedLanguageChange=function(i){if(this.track.mode==="showing"){var a=this.player_.cache_.selectedLanguage;if(a&&a.enabled&&a.language===this.track.language&&a.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},r.dispose=function(){this.track=null,t.prototype.dispose.call(this)},e}(Qp);ht.registerComponent("TextTrackMenuItem",Zp);var G1=function(t){Ct.default(e,t);function e(n,i){return i.track={player:n,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,t.call(this,n,i)||this}var r=e.prototype;return r.handleTracksChange=function(i){for(var a=this.player().textTracks(),s=!0,o=0,c=a.length;o<c;o++){var l=a[o];if(this.options_.kinds.indexOf(l.kind)>-1&&l.mode==="showing"){s=!1;break}}s!==this.isSelected_&&this.selected(s)},r.handleSelectedLanguageChange=function(i){for(var a=this.player().textTracks(),s=!0,o=0,c=a.length;o<c;o++){var l=a[o];if(["captions","descriptions","subtitles"].indexOf(l.kind)>-1&&l.mode==="showing"){s=!1;break}}s&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(Zp);ht.registerComponent("OffTextTrackMenuItem",G1);var Ld=function(t){Ct.default(e,t);function e(n,i){return i===void 0&&(i={}),i.tracks=n.textTracks(),t.call(this,n,i)||this}var r=e.prototype;return r.createItems=function(i,a){i===void 0&&(i=[]),a===void 0&&(a=Zp);var s;this.label_&&(s=this.label_+" off"),i.push(new G1(this.player_,{kinds:this.kinds_,kind:this.kind_,label:s})),this.hideThreshold_+=1;var o=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var c=0;c<o.length;c++){var l=o[c];if(this.kinds_.indexOf(l.kind)>-1){var f=new a(this.player_,{track:l,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});f.addClass("vjs-"+l.kind+"-menu-item"),i.push(f)}}return i},e}(Qw);ht.registerComponent("TextTrackButton",Ld);var V1=function(t){Ct.default(e,t);function e(n,i){var a,s=i.track,o=i.cue,c=n.currentTime();return i.selectable=!0,i.multiSelectable=!1,i.label=o.text,i.selected=o.startTime<=c&&c<o.endTime,a=t.call(this,n,i)||this,a.track=s,a.cue=o,a}var r=e.prototype;return r.handleClick=function(i){t.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime)},e}(Qp);ht.registerComponent("ChaptersTrackMenuItem",V1);var Zw=function(t){Ct.default(e,t);function e(n,i,a){var s;return s=t.call(this,n,i,a)||this,s.selectCurrentItem_=function(){s.items.forEach(function(o){o.selected(s.track_.activeCues[0]===o.cue)})},s}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildWrapperCSSClass.call(this)},r.update=function(i){if(!(i&&i.track&&i.track.kind!=="chapters")){var a=this.findChaptersTrack();a!==this.track_?(this.setTrack(a),t.prototype.update.call(this)):(!this.items||a&&a.cues&&a.cues.length!==this.items.length)&&t.prototype.update.call(this)}},r.setTrack=function(i){if(this.track_!==i){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var a=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);a&&a.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=i,this.track_){this.track_.mode="hidden";var s=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);s&&s.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}},r.findChaptersTrack=function(){for(var i=this.player_.textTracks()||[],a=i.length-1;a>=0;a--){var s=i[a];if(s.kind===this.kind_)return s}},r.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Zi(this.kind_))},r.createMenu=function(){return this.options_.title=this.getMenuCaption(),t.prototype.createMenu.call(this)},r.createItems=function(){var i=[];if(!this.track_)return i;var a=this.track_.cues;if(!a)return i;for(var s=0,o=a.length;s<o;s++){var c=a[s],l=new V1(this.player_,{track:this.track_,cue:c});i.push(l)}return i},e}(Ld);Zw.prototype.kind_="chapters";Zw.prototype.controlText_="Chapters";ht.registerComponent("ChaptersButton",Zw);var eT=function(t){Ct.default(e,t);function e(n,i,a){var s;s=t.call(this,n,i,a)||this;var o=n.textTracks(),c=Ti(ir.default(s),s.handleTracksChange);return o.addEventListener("change",c),s.on("dispose",function(){o.removeEventListener("change",c)}),s}var r=e.prototype;return r.handleTracksChange=function(i){for(var a=this.player().textTracks(),s=!1,o=0,c=a.length;o<c;o++){var l=a[o];if(l.kind!==this.kind_&&l.mode==="showing"){s=!0;break}}s?this.disable():this.enable()},r.buildCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(Ld);eT.prototype.kind_="descriptions";eT.prototype.controlText_="Descriptions";ht.registerComponent("DescriptionsButton",eT);var tT=function(t){Ct.default(e,t);function e(n,i,a){return t.call(this,n,i,a)||this}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(Ld);tT.prototype.kind_="subtitles";tT.prototype.controlText_="Subtitles";ht.registerComponent("SubtitlesButton",tT);var rT=function(t){Ct.default(e,t);function e(n,i){var a;return i.track={player:n,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",a=t.call(this,n,i)||this,a.addClass("vjs-texttrack-settings"),a.controlText(", opens "+i.kind+" settings dialog"),a}var r=e.prototype;return r.handleClick=function(i){this.player().getChild("textTrackSettings").open()},e}(Zp);ht.registerComponent("CaptionSettingsMenuItem",rT);var iT=function(t){Ct.default(e,t);function e(n,i,a){return t.call(this,n,i,a)||this}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-captions-button "+t.prototype.buildWrapperCSSClass.call(this)},r.createItems=function(){var i=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(i.push(new rT(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),t.prototype.createItems.call(this,i)},e}(Ld);iT.prototype.kind_="captions";iT.prototype.controlText_="Captions";ht.registerComponent("CaptionsButton",iT);var z1=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.createEl=function(i,a,s){var o=t.prototype.createEl.call(this,i,a,s),c=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(c.appendChild(Tr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),c.appendChild(Tr("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),o},e}(Zp);ht.registerComponent("SubsCapsMenuItem",z1);var nT=function(t){Ct.default(e,t);function e(n,i){var a;return i===void 0&&(i={}),a=t.call(this,n,i)||this,a.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(a.player_.language_)>-1&&(a.label_="captions"),a.menuButton_.controlText(Zi(a.label_)),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildWrapperCSSClass.call(this)},r.createItems=function(){var i=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(i.push(new rT(this.player_,{kind:this.label_})),this.hideThreshold_+=1),i=t.prototype.createItems.call(this,i,z1),i},e}(Ld);nT.prototype.kinds_=["captions","subtitles"];nT.prototype.controlText_="Subtitles";ht.registerComponent("SubsCapsButton",nT);var W1=function(t){Ct.default(e,t);function e(n,i){var a,s=i.track,o=n.audioTracks();i.label=s.label||s.language||"Unknown",i.selected=s.enabled,a=t.call(this,n,i)||this,a.track=s,a.addClass("vjs-"+s.kind+"-menu-item");var c=function(){for(var f=arguments.length,g=new Array(f),m=0;m<f;m++)g[m]=arguments[m];a.handleTracksChange.apply(ir.default(a),g)};return o.addEventListener("change",c),a.on("dispose",function(){o.removeEventListener("change",c)}),a}var r=e.prototype;return r.createEl=function(i,a,s){var o=t.prototype.createEl.call(this,i,a,s),c=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="main-desc"&&(c.appendChild(Tr("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),c.appendChild(Tr("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),o},r.handleClick=function(i){if(t.prototype.handleClick.call(this,i),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks)for(var a=this.player_.audioTracks(),s=0;s<a.length;s++){var o=a[s];o!==this.track&&(o.enabled=o===this.track)}},r.handleTracksChange=function(i){this.selected(this.track.enabled)},e}(Qp);ht.registerComponent("AudioTrackMenuItem",W1);var K1=function(t){Ct.default(e,t);function e(n,i){return i===void 0&&(i={}),i.tracks=n.audioTracks(),t.call(this,n,i)||this}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-audio-button "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-audio-button "+t.prototype.buildWrapperCSSClass.call(this)},r.createItems=function(i){i===void 0&&(i=[]),this.hideThreshold_=1;for(var a=this.player_.audioTracks(),s=0;s<a.length;s++){var o=a[s];i.push(new W1(this.player_,{track:o,selectable:!0,multiSelectable:!1}))}return i},e}(Qw);K1.prototype.controlText_="Audio Track";ht.registerComponent("AudioTrackButton",K1);var aT=function(t){Ct.default(e,t);function e(n,i){var a,s=i.rate,o=parseFloat(s,10);return i.label=s,i.selected=o===n.playbackRate(),i.selectable=!0,i.multiSelectable=!1,a=t.call(this,n,i)||this,a.label=s,a.rate=o,a.on(n,"ratechange",function(c){return a.update(c)}),a}var r=e.prototype;return r.handleClick=function(i){t.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},r.update=function(i){this.selected(this.player().playbackRate()===this.rate)},e}(Qp);aT.prototype.contentElType="button";ht.registerComponent("PlaybackRateMenuItem",aT);var X1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.menuButton_.el_.setAttribute("aria-describedby",a.labelElId_),a.updateVisibility(),a.updateLabel(),a.on(n,"loadstart",function(s){return a.updateVisibility(s)}),a.on(n,"ratechange",function(s){return a.updateLabel(s)}),a.on(n,"playbackrateschange",function(s){return a.handlePlaybackRateschange(s)}),a}var r=e.prototype;return r.createEl=function(){var i=t.prototype.createEl.call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Tr("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),i.appendChild(this.labelEl_),i},r.dispose=function(){this.labelEl_=null,t.prototype.dispose.call(this)},r.buildCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildCSSClass.call(this)},r.buildWrapperCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildWrapperCSSClass.call(this)},r.createItems=function(){for(var i=this.playbackRates(),a=[],s=i.length-1;s>=0;s--)a.push(new aT(this.player(),{rate:i[s]+"x"}));return a},r.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},r.handleClick=function(i){var a=this.player().playbackRate(),s=this.playbackRates(),o=s.indexOf(a),c=(o+1)%s.length;this.player().playbackRate(s[c])},r.handlePlaybackRateschange=function(i){this.update()},r.playbackRates=function(){var i=this.player();return i.playbackRates&&i.playbackRates()||[]},r.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},r.updateVisibility=function(i){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},r.updateLabel=function(i){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")},e}(Jw);X1.prototype.controlText_="Playback Rate";ht.registerComponent("PlaybackRateMenuButton",X1);var Y1=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)},r.createEl=function(i,a,s){return i===void 0&&(i="div"),a===void 0&&(a={}),s===void 0&&(s={}),a.className||(a.className=this.buildCSSClass()),t.prototype.createEl.call(this,i,a,s)},e}(ht);ht.registerComponent("Spacer",Y1);var MX=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:"\xA0"})},e}(Y1);ht.registerComponent("CustomControlSpacer",MX);var Wm=function(t){Ct.default(e,t);function e(){return t.apply(this,arguments)||this}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},e}(ht);Wm.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};"exitPictureInPicture"in yt.default&&Wm.prototype.options_.children.splice(Wm.prototype.options_.children.length-1,0,"pictureInPictureToggle");ht.registerComponent("ControlBar",Wm);var J1=function(t){Ct.default(e,t);function e(n,i){var a;return a=t.call(this,n,i)||this,a.on(n,"error",function(s){return a.open(s)}),a}var r=e.prototype;return r.buildCSSClass=function(){return"vjs-error-display "+t.prototype.buildCSSClass.call(this)},r.content=function(){var i=this.player().error();return i?this.localize(i.message):""},e}(Pd);J1.prototype.options_=el.default({},Pd.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});ht.registerComponent("ErrorDisplay",J1);var sw="vjs-text-track-settings",pP=["#000","Black"],hP=["#00F","Blue"],gP=["#0FF","Cyan"],mP=["#0F0","Green"],vP=["#F0F","Magenta"],yP=["#F00","Red"],bP=["#FFF","White"],_P=["#FF0","Yellow"],ow=["1","Opaque"],uw=["0.5","Semi-Transparent"],wP=["0","Transparent"],Kc={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[pP,bP,yP,mP,hP,_P,vP,gP]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[ow,uw,wP]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[bP,pP,yP,mP,hP,_P,vP,gP]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return e==="1.00"?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[ow,uw]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[wP,uw,ow]}};Kc.windowColor.options=Kc.backgroundColor.options;function Q1(t,e){if(e&&(t=e(t)),t&&t!=="none")return t}function $X(t,e){var r=t.options[t.options.selectedIndex].value;return Q1(r,e)}function UX(t,e,r){if(e){for(var n=0;n<t.options.length;n++)if(Q1(t.options[n].value,r)===e){t.selectedIndex=n;break}}}var FX=function(t){Ct.default(e,t);function e(n,i){var a;return i.temporary=!1,a=t.call(this,n,i)||this,a.updateDisplay=a.updateDisplay.bind(ir.default(a)),a.fill(),a.hasBeenOpened_=a.hasBeenFilled_=!0,a.endDialog=Tr("p",{className:"vjs-control-text",textContent:a.localize("End of dialog window.")}),a.el().appendChild(a.endDialog),a.setDefaults(),i.persistTextTrackSettings===void 0&&(a.options_.persistTextTrackSettings=a.options_.playerOptions.persistTextTrackSettings),a.on(a.$(".vjs-done-button"),"click",function(){a.saveSettings(),a.close()}),a.on(a.$(".vjs-default-button"),"click",function(){a.setDefaults(),a.updateDisplay()}),bd(Kc,function(s){a.on(a.$(s.selector),"change",a.updateDisplay)}),a.options_.persistTextTrackSettings&&a.restoreSettings(),a}var r=e.prototype;return r.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},r.createElSelect_=function(i,a,s){var o=this;a===void 0&&(a=""),s===void 0&&(s="label");var c=Kc[i],l=c.id.replace("%s",this.id_),f=[a,l].join(" ").trim();return["<"+s+' id="'+l+'" class="'+(s==="label"?"vjs-label":"")+'">',this.localize(c.label),"</"+s+">",'<select aria-labelledby="'+f+'">'].concat(c.options.map(function(g){var m=l+"-"+g[1].replace(/\W+/g,"");return['<option id="'+m+'" value="'+g[0]+'" ','aria-labelledby="'+f+" "+m+'">',o.localize(g[1]),"</option>"].join("")})).concat("</select>").join("")},r.createElFgColor_=function(){var i="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+i+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",i),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",i),"</span>","</fieldset>"].join("")},r.createElBgColor_=function(){var i="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+i+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",i),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",i),"</span>","</fieldset>"].join("")},r.createElWinColor_=function(){var i="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+i+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",i),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",i),"</span>","</fieldset>"].join("")},r.createElColors_=function(){return Tr("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},r.createElFont_=function(){return Tr("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},r.createElControls_=function(){var i=this.localize("restore all settings to the default values");return Tr("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+i+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+i+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},r.label=function(){return this.localize("Caption Settings Dialog")},r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},r.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},r.getValues=function(){var i=this;return I9(Kc,function(a,s,o){var c=$X(i.$(s.selector),s.parser);return c!==void 0&&(a[o]=c),a},{})},r.setValues=function(i){var a=this;bd(Kc,function(s,o){UX(a.$(s.selector),i[o],s.parser)})},r.setDefaults=function(){var i=this;bd(Kc,function(a){var s=a.hasOwnProperty("default")?a.default:0;i.$(a.selector).selectedIndex=s})},r.restoreSettings=function(){var i;try{i=JSON.parse(Se.default.localStorage.getItem(sw))}catch(a){pr.warn(a)}i&&this.setValues(i)},r.saveSettings=function(){if(this.options_.persistTextTrackSettings){var i=this.getValues();try{Object.keys(i).length?Se.default.localStorage.setItem(sw,JSON.stringify(i)):Se.default.localStorage.removeItem(sw)}catch(a){pr.warn(a)}}},r.updateDisplay=function(){var i=this.player_.getChild("textTrackDisplay");i&&i.updateDisplay()},r.conditionalBlur_=function(){this.previouslyActiveEl_=null;var i=this.player_.controlBar,a=i&&i.subsCapsButton,s=i&&i.captionsButton;a?a.focus():s&&s.focus()},e}(Pd);ht.registerComponent("TextTrackSettings",FX);var BX=function(t){Ct.default(e,t);function e(n,i){var a,s=i.ResizeObserver||Se.default.ResizeObserver;i.ResizeObserver===null&&(s=!1);var o=wi({createEl:!s,reportTouchActivity:!1},i);return a=t.call(this,n,o)||this,a.ResizeObserver=i.ResizeObserver||Se.default.ResizeObserver,a.loadListener_=null,a.resizeObserver_=null,a.debouncedHandler_=F9(function(){a.resizeHandler()},100,!1,ir.default(a)),s?(a.resizeObserver_=new a.ResizeObserver(a.debouncedHandler_),a.resizeObserver_.observe(n.el())):(a.loadListener_=function(){if(!(!a.el_||!a.el_.contentWindow)){var c=a.debouncedHandler_,l=a.unloadListener_=function(){ea(this,"resize",c),ea(this,"unload",l),l=null};rs(a.el_.contentWindow,"unload",l),rs(a.el_.contentWindow,"resize",c)}},a.one("load",a.loadListener_)),a}var r=e.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},r.resizeHandler=function(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,t.prototype.dispose.call(this)},e}(ht);ht.registerComponent("ResizeManager",BX);var qX={trackingThreshold:20,liveTolerance:15},jX=function(t){Ct.default(e,t);function e(n,i){var a,s=wi(qX,i,{createEl:!1});return a=t.call(this,n,s)||this,a.handleVisibilityChange_=function(o){return a.handleVisibilityChange(o)},a.trackLiveHandler_=function(){return a.trackLive_()},a.handlePlay_=function(o){return a.handlePlay(o)},a.handleFirstTimeupdate_=function(o){return a.handleFirstTimeupdate(o)},a.handleSeeked_=function(o){return a.handleSeeked(o)},a.seekToLiveEdge_=function(o){return a.seekToLiveEdge(o)},a.reset_(),a.on(a.player_,"durationchange",function(o){return a.handleDurationchange(o)}),a.on(a.player_,"canplay",function(){return a.toggleTracking()}),Xp&&"hidden"in yt.default&&"visibilityState"in yt.default&&a.on(yt.default,"visibilitychange",a.handleVisibilityChange_),a}var r=e.prototype;return r.handleVisibilityChange=function(){this.player_.duration()===1/0&&(yt.default.hidden?this.stopTracking():this.startTracking())},r.trackLive_=function(){var i=this.player_.seekable();if(!(!i||!i.length)){var a=Number(Se.default.performance.now().toFixed(4)),s=this.lastTime_===-1?0:(a-this.lastTime_)/1e3;this.lastTime_=a,this.pastSeekEnd_=this.pastSeekEnd()+s;var o=this.liveCurrentTime(),c=this.player_.currentTime(),l=this.player_.paused()||this.seekedBehindLive_||Math.abs(o-c)>this.options_.liveTolerance;(!this.timeupdateSeen_||o===1/0)&&(l=!1),l!==this.behindLiveEdge_&&(this.behindLiveEdge_=l,this.trigger("liveedgechange"))}},r.handleDurationchange=function(){this.toggleTracking()},r.toggleTracking=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},r.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Fs),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))},r.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)},r.handleSeeked=function(){var i=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&i>2,this.nextSeekedFromUser_=!1,this.trackLive_()},r.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)},r.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)},r.nextSeekedFromUser=function(){this.nextSeekedFromUser_=!0},r.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},r.seekableEnd=function(){for(var i=this.player_.seekable(),a=[],s=i?i.length:0;s--;)a.push(i.end(s));return a.length?a.sort()[a.length-1]:1/0},r.seekableStart=function(){for(var i=this.player_.seekable(),a=[],s=i?i.length:0;s--;)a.push(i.start(s));return a.length?a.sort()[0]:0},r.liveWindow=function(){var i=this.liveCurrentTime();return i===1/0?0:i-this.seekableStart()},r.isLive=function(){return this.isTracking()},r.atLiveEdge=function(){return!this.behindLiveEdge()},r.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},r.pastSeekEnd=function(){var i=this.seekableEnd();return this.lastSeekEnd_!==-1&&i!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=i,this.pastSeekEnd_},r.behindLiveEdge=function(){return this.behindLiveEdge_},r.isTracking=function(){return typeof this.trackingInterval_=="number"},r.seekToLiveEdge=function(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))},r.dispose=function(){this.off(yt.default,"visibilitychange",this.handleVisibilityChange_),this.stopTracking(),t.prototype.dispose.call(this)},e}(ht);ht.registerComponent("LiveTracker",jX);var bw=function(e){var r=e.el();if(r.hasAttribute("src"))return e.triggerSourceset(r.src),!0;var n=e.$$("source"),i=[],a="";if(!n.length)return!1;for(var s=0;s<n.length;s++){var o=n[s].src;o&&i.indexOf(o)===-1&&i.push(o)}return i.length?(i.length===1&&(a=i[0]),e.triggerSourceset(a),!0):!1},HX=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var r=yt.default.createElement(this.nodeName.toLowerCase());r.innerHTML=e;for(var n=yt.default.createDocumentFragment();r.childNodes.length;)n.appendChild(r.childNodes[0]);return this.innerText="",Se.default.Element.prototype.appendChild.call(this,n),this.innerHTML}}),Z1=function(e,r){for(var n={},i=0;i<e.length&&(n=Object.getOwnPropertyDescriptor(e[i],r),!(n&&n.set&&n.get));i++);return n.enumerable=!0,n.configurable=!0,n},GX=function(e){return Z1([e.el(),Se.default.HTMLMediaElement.prototype,Se.default.Element.prototype,HX],"innerHTML")},TP=function(e){var r=e.el();if(!r.resetSourceWatch_){var n={},i=GX(e),a=function(o){return function(){for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];var g=o.apply(r,l);return bw(e),g}};["append","appendChild","insertAdjacentHTML"].forEach(function(s){r[s]&&(n[s]=r[s],r[s]=a(n[s]))}),Object.defineProperty(r,"innerHTML",wi(i,{set:a(i.set)})),r.resetSourceWatch_=function(){r.resetSourceWatch_=null,Object.keys(n).forEach(function(s){r[s]=n[s]}),Object.defineProperty(r,"innerHTML",i)},e.one("sourceset",r.resetSourceWatch_)}},VX=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?C1(Se.default.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return Se.default.Element.prototype.setAttribute.call(this,"src",e),e}}),zX=function(e){return Z1([e.el(),Se.default.HTMLMediaElement.prototype,VX],"src")},WX=function(e){if(e.featuresSourceset){var r=e.el();if(!r.resetSourceset_){var n=zX(e),i=r.setAttribute,a=r.load;Object.defineProperty(r,"src",wi(n,{set:function(o){var c=n.set.call(r,o);return e.triggerSourceset(r.src),c}})),r.setAttribute=function(s,o){var c=i.call(r,s,o);return/src/i.test(s)&&e.triggerSourceset(r.src),c},r.load=function(){var s=a.call(r);return bw(e)||(e.triggerSourceset(""),TP(e)),s},r.currentSrc?e.triggerSourceset(r.currentSrc):bw(e)||TP(e),r.resetSourceset_=function(){r.resetSourceset_=null,r.load=a,r.setAttribute=i,Object.defineProperty(r,"src",n),r.resetSourceWatch_&&r.resetSourceWatch_()}}}},sT=function(e,r,n,i){i===void 0&&(i=!0);var a=function(c){return Object.defineProperty(e,r,{value:c,enumerable:!0,writable:!0})},s={configurable:!0,enumerable:!0,get:function(){var c=n();return a(c),c}};return i&&(s.set=a),Object.defineProperty(e,r,s)},At=function(t){Ct.default(e,t);function e(n,i){var a;a=t.call(this,n,i)||this;var s=n.source,o=!1;if(s&&(a.el_.currentSrc!==s.src||n.tag&&n.tag.initNetworkState_===3)?a.setSource(s):a.handleLateInit_(a.el_),n.enableSourceset&&a.setupSourcesetHandling_(),a.isScrubbing_=!1,a.el_.hasChildNodes()){for(var c=a.el_.childNodes,l=c.length,f=[];l--;){var g=c[l],m=g.nodeName.toLowerCase();m==="track"&&(a.featuresNativeTextTracks?(a.remoteTextTrackEls().addTrackElement_(g),a.remoteTextTracks().addTrack(g.track),a.textTracks().addTrack(g.track),!o&&!a.el_.hasAttribute("crossorigin")&&fv(g.src)&&(o=!0)):f.push(g))}for(var y=0;y<f.length;y++)a.el_.removeChild(f[y])}return a.proxyNativeTracks_(),a.featuresNativeTextTracks&&o&&pr.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),a.restoreMetadataTracksInIOSNativePlayer_(),(Td||Nw||ZP)&&n.nativeControlsForTouch===!0&&a.setControls(!0),a.proxyWebkitFullscreen_(),a.triggerReady(),a}var r=e.prototype;return r.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),e.disposeMediaElement(this.el_),this.options_=null,t.prototype.dispose.call(this)},r.setupSourcesetHandling_=function(){WX(this)},r.restoreMetadataTracksInIOSNativePlayer_=function(){var i=this.textTracks(),a,s=function(){a=[];for(var l=0;l<i.length;l++){var f=i[l];f.kind==="metadata"&&a.push({track:f,storedMode:f.mode})}};s(),i.addEventListener("change",s),this.on("dispose",function(){return i.removeEventListener("change",s)});var o=function c(){for(var l=0;l<a.length;l++){var f=a[l];f.track.mode==="disabled"&&f.track.mode!==f.storedMode&&(f.track.mode=f.storedMode)}i.removeEventListener("change",c)};this.on("webkitbeginfullscreen",function(){i.removeEventListener("change",s),i.removeEventListener("change",o),i.addEventListener("change",o)}),this.on("webkitendfullscreen",function(){i.removeEventListener("change",s),i.addEventListener("change",s),i.removeEventListener("change",o)})},r.overrideNative_=function(i,a){var s=this;if(a===this["featuresNative"+i+"Tracks"]){var o=i.toLowerCase();this[o+"TracksListeners_"]&&Object.keys(this[o+"TracksListeners_"]).forEach(function(c){var l=s.el()[o+"Tracks"];l.removeEventListener(c,s[o+"TracksListeners_"][c])}),this["featuresNative"+i+"Tracks"]=!a,this[o+"TracksListeners_"]=null,this.proxyNativeTracksForType_(o)}},r.overrideNativeAudioTracks=function(i){this.overrideNative_("Audio",i)},r.overrideNativeVideoTracks=function(i){this.overrideNative_("Video",i)},r.proxyNativeTracksForType_=function(i){var a=this,s=ys[i],o=this.el()[s.getterName],c=this[s.getterName]();if(!(!this["featuresNative"+s.capitalName+"Tracks"]||!o||!o.addEventListener)){var l={change:function(m){var y={type:"change",target:c,currentTarget:c,srcElement:c};c.trigger(y),i==="text"&&a[Cd.remoteText.getterName]().trigger(y)},addtrack:function(m){c.addTrack(m.track)},removetrack:function(m){c.removeTrack(m.track)}},f=function(){for(var m=[],y=0;y<c.length;y++){for(var A=!1,k=0;k<o.length;k++)if(o[k]===c[y]){A=!0;break}A||m.push(c[y])}for(;m.length;)c.removeTrack(m.shift())};this[s.getterName+"Listeners_"]=l,Object.keys(l).forEach(function(g){var m=l[g];o.addEventListener(g,m),a.on("dispose",function(y){return o.removeEventListener(g,m)})}),this.on("loadstart",f),this.on("dispose",function(g){return a.off("loadstart",f)})}},r.proxyNativeTracks_=function(){var i=this;ys.names.forEach(function(a){i.proxyNativeTracksForType_(a)})},r.createEl=function(){var i=this.options_.tag;if(!i||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(i){var a=i.cloneNode(!0);i.parentNode&&i.parentNode.insertBefore(a,i),e.disposeMediaElement(i),i=a}else{i=yt.default.createElement("video");var s=this.options_.tag&&eu(this.options_.tag),o=wi({},s);(!Td||this.options_.nativeControlsForTouch!==!0)&&delete o.controls,o1(i,Vi(o,{id:this.options_.techId,class:"vjs-tech"}))}i.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&Sd(i,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(i.disablePictureInPicture=this.options_.disablePictureInPicture);for(var c=["loop","muted","playsinline","autoplay"],l=0;l<c.length;l++){var f=c[l],g=this.options_[f];typeof g<"u"&&(g?Sd(i,f,f):ov(i,f),i[f]=g)}return i},r.handleLateInit_=function(i){if(!(i.networkState===0||i.networkState===3)){if(i.readyState===0){var a=!1,s=function(){a=!0};this.on("loadstart",s);var o=function(){a||this.trigger("loadstart")};this.on("loadedmetadata",o),this.ready(function(){this.off("loadstart",s),this.off("loadedmetadata",o),a||this.trigger("loadstart")});return}var c=["loadstart"];c.push("loadedmetadata"),i.readyState>=2&&c.push("loadeddata"),i.readyState>=3&&c.push("canplay"),i.readyState>=4&&c.push("canplaythrough"),this.ready(function(){c.forEach(function(l){this.trigger(l)},this)})}},r.setScrubbing=function(i){this.isScrubbing_=i},r.scrubbing=function(){return this.isScrubbing_},r.setCurrentTime=function(i){try{this.isScrubbing_&&this.el_.fastSeek&&sv?this.el_.fastSeek(i):this.el_.currentTime=i}catch(a){pr(a,"Video is not ready. (Video.js)")}},r.duration=function(){var i=this;if(this.el_.duration===1/0&&ou&&uu&&this.el_.currentTime===0){var a=function s(){i.el_.currentTime>0&&(i.el_.duration===1/0&&i.trigger("durationchange"),i.off("timeupdate",s))};return this.on("timeupdate",a),NaN}return this.el_.duration||NaN},r.width=function(){return this.el_.offsetWidth},r.height=function(){return this.el_.offsetHeight},r.proxyWebkitFullscreen_=function(){var i=this;if("webkitDisplayingFullscreen"in this.el_){var a=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},s=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",a),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",s),this.on("dispose",function(){i.off("webkitbeginfullscreen",s),i.off("webkitendfullscreen",a)})}},r.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var i=Se.default.navigator&&Se.default.navigator.userAgent||"";if(/Android/.test(i)||!/Chrome|Mac OS X 10.5/.test(i))return!0}return!1},r.enterFullScreen=function(){var i=this.el_;if(i.paused&&i.networkState<=i.HAVE_METADATA)go(this.el_.play()),this.setTimeout(function(){i.pause();try{i.webkitEnterFullScreen()}catch(a){this.trigger("fullscreenerror",a)}},0);else try{i.webkitEnterFullScreen()}catch(a){this.trigger("fullscreenerror",a)}},r.exitFullScreen=function(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()},r.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},r.requestVideoFrameCallback=function(i){return this.featuresVideoFrameCallback?this.el_.requestVideoFrameCallback(i):t.prototype.requestVideoFrameCallback.call(this,i)},r.cancelVideoFrameCallback=function(i){this.featuresVideoFrameCallback?this.el_.cancelVideoFrameCallback(i):t.prototype.cancelVideoFrameCallback.call(this,i)},r.src=function(i){if(i===void 0)return this.el_.src;this.setSrc(i)},r.reset=function(){e.resetMediaElement(this.el_)},r.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},r.setControls=function(i){this.el_.controls=!!i},r.addTextTrack=function(i,a,s){return this.featuresNativeTextTracks?this.el_.addTextTrack(i,a,s):t.prototype.addTextTrack.call(this,i,a,s)},r.createRemoteTextTrack=function(i){if(!this.featuresNativeTextTracks)return t.prototype.createRemoteTextTrack.call(this,i);var a=yt.default.createElement("track");return i.kind&&(a.kind=i.kind),i.label&&(a.label=i.label),(i.language||i.srclang)&&(a.srclang=i.language||i.srclang),i.default&&(a.default=i.default),i.id&&(a.id=i.id),i.src&&(a.src=i.src),a},r.addRemoteTextTrack=function(i,a){var s=t.prototype.addRemoteTextTrack.call(this,i,a);return this.featuresNativeTextTracks&&this.el().appendChild(s),s},r.removeRemoteTextTrack=function(i){if(t.prototype.removeRemoteTextTrack.call(this,i),this.featuresNativeTextTracks)for(var a=this.$$("track"),s=a.length;s--;)(i===a[s]||i===a[s].track)&&this.el().removeChild(a[s])},r.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var i={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(i.droppedVideoFrames=this.el().webkitDroppedFrameCount,i.totalVideoFrames=this.el().webkitDecodedFrameCount),Se.default.performance&&typeof Se.default.performance.now=="function"?i.creationTime=Se.default.performance.now():Se.default.performance&&Se.default.performance.timing&&typeof Se.default.performance.timing.navigationStart=="number"&&(i.creationTime=Se.default.Date.now()-Se.default.performance.timing.navigationStart),i},e}(ii);sT(At,"TEST_VID",function(){if(Id()){var t=yt.default.createElement("video"),e=yt.default.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",t.appendChild(e),t}});At.isSupported=function(){try{At.TEST_VID.volume=.5}catch{return!1}return!!(At.TEST_VID&&At.TEST_VID.canPlayType)};At.canPlayType=function(t){return At.TEST_VID.canPlayType(t)};At.canPlaySource=function(t,e){return At.canPlayType(t.type)};At.canControlVolume=function(){try{var t=At.TEST_VID.volume;At.TEST_VID.volume=t/2+.1;var e=t!==At.TEST_VID.volume;return e&&wa?(Se.default.setTimeout(function(){At&&At.prototype&&(At.prototype.featuresVolumeControl=t!==At.TEST_VID.volume)}),!1):e}catch{return!1}};At.canMuteVolume=function(){try{var t=At.TEST_VID.muted;return At.TEST_VID.muted=!t,At.TEST_VID.muted?Sd(At.TEST_VID,"muted","muted"):ov(At.TEST_VID,"muted","muted"),t!==At.TEST_VID.muted}catch{return!1}};At.canControlPlaybackRate=function(){if(ou&&uu&&t1<58)return!1;try{var t=At.TEST_VID.playbackRate;return At.TEST_VID.playbackRate=t/2+.1,t!==At.TEST_VID.playbackRate}catch{return!1}};At.canOverrideAttributes=function(){try{var t=function(){};Object.defineProperty(yt.default.createElement("video"),"src",{get:t,set:t}),Object.defineProperty(yt.default.createElement("audio"),"src",{get:t,set:t}),Object.defineProperty(yt.default.createElement("video"),"innerHTML",{get:t,set:t}),Object.defineProperty(yt.default.createElement("audio"),"innerHTML",{get:t,set:t})}catch{return!1}return!0};At.supportsNativeTextTracks=function(){return sv||wa&&uu};At.supportsNativeVideoTracks=function(){return!!(At.TEST_VID&&At.TEST_VID.videoTracks)};At.supportsNativeAudioTracks=function(){return!!(At.TEST_VID&&At.TEST_VID.audioTracks)};At.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(t){var e=t[0],r=t[1];sT(At.prototype,e,function(){return At[r]()},!0)});At.prototype.featuresVolumeControl=At.canControlVolume();At.prototype.movingMediaElementInDOM=!wa;At.prototype.featuresFullscreenResize=!0;At.prototype.featuresProgressEvents=!0;At.prototype.featuresTimeupdateEvents=!0;At.prototype.featuresVideoFrameCallback=!!(At.TEST_VID&&At.TEST_VID.requestVideoFrameCallback);var Km;At.patchCanPlayType=function(){Rw>=4&&!e1&&!uu&&(Km=At.TEST_VID&&At.TEST_VID.constructor.prototype.canPlayType,At.TEST_VID.constructor.prototype.canPlayType=function(t){var e=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return t&&e.test(t)?"maybe":Km.call(this,t)})};At.unpatchCanPlayType=function(){var t=At.TEST_VID.constructor.prototype.canPlayType;return Km&&(At.TEST_VID.constructor.prototype.canPlayType=Km),t};At.patchCanPlayType();At.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()}};At.resetMediaElement=function(t){if(t){for(var e=t.querySelectorAll("source"),r=e.length;r--;)t.removeChild(e[r]);t.removeAttribute("src"),typeof t.load=="function"&&function(){try{t.load()}catch{}}()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(t){At.prototype[t]=function(){return this.el_[t]||this.el_.hasAttribute(t)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){At.prototype["set"+Zi(t)]=function(e){this.el_[t]=e,e?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(t){At.prototype[t]=function(){return this.el_[t]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(t){At.prototype["set"+Zi(t)]=function(e){this.el_[t]=e}});["pause","load","play"].forEach(function(t){At.prototype[t]=function(){return this.el_[t]()}});ii.withSourceHandlers(At);At.nativeSourceHandler={};At.nativeSourceHandler.canPlayType=function(t){try{return At.TEST_VID.canPlayType(t)}catch{return""}};At.nativeSourceHandler.canHandleSource=function(t,e){if(t.type)return At.nativeSourceHandler.canPlayType(t.type);if(t.src){var r=jw(t.src);return At.nativeSourceHandler.canPlayType("video/"+r)}return""};At.nativeSourceHandler.handleSource=function(t,e,r){e.setSrc(t.src)};At.nativeSourceHandler.dispose=function(){};At.registerSourceHandler(At.nativeSourceHandler);ii.registerTech("Html5",At);var eR=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],cw={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},_w=["tiny","xsmall","small","medium","large","xlarge","huge"],Um={};_w.forEach(function(t){var e=t.charAt(0)==="x"?"x-"+t.substring(1):t;Um[t]="vjs-layout-"+e});var KX={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},an=function(t){Ct.default(e,t);function e(n,i,a){var s;if(n.id=n.id||i.id||"vjs_video_"+cu(),i=Vi(e.getTagSettings(n),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language)if(typeof n.closest=="function"){var o=n.closest("[lang]");o&&o.getAttribute&&(i.language=o.getAttribute("lang"))}else for(var c=n;c&&c.nodeType===1;){if(eu(c).hasOwnProperty("lang")){i.language=c.getAttribute("lang");break}c=c.parentNode}if(s=t.call(this,null,i,a)||this,s.boundDocumentFullscreenChange_=function(m){return s.documentFullscreenChange_(m)},s.boundFullWindowOnEscKey_=function(m){return s.fullWindowOnEscKey(m)},s.boundUpdateStyleEl_=function(m){return s.updateStyleEl_(m)},s.boundApplyInitTime_=function(m){return s.applyInitTime_(m)},s.boundUpdateCurrentBreakpoint_=function(m){return s.updateCurrentBreakpoint_(m)},s.boundHandleTechClick_=function(m){return s.handleTechClick_(m)},s.boundHandleTechDoubleClick_=function(m){return s.handleTechDoubleClick_(m)},s.boundHandleTechTouchStart_=function(m){return s.handleTechTouchStart_(m)},s.boundHandleTechTouchMove_=function(m){return s.handleTechTouchMove_(m)},s.boundHandleTechTouchEnd_=function(m){return s.handleTechTouchEnd_(m)},s.boundHandleTechTap_=function(m){return s.handleTechTap_(m)},s.isFullscreen_=!1,s.log=YP(s.id_),s.fsApi_=Hm,s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,s.debugEnabled_=!1,s.audioOnlyMode_=!1,s.audioPosterMode_=!1,s.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=n,s.tagAttributes=n&&eu(n),s.language(s.options_.language),i.languages){var l={};Object.getOwnPropertyNames(i.languages).forEach(function(m){l[m.toLowerCase()]=i.languages[m]}),s.languages_=l}else s.languages_=e.prototype.options_.languages;s.resetCache_(),s.poster_=i.poster||"",s.controls_=!!i.controls,n.controls=!1,n.removeAttribute("controls"),s.changingSrc_=!1,s.playCallbacks_=[],s.playTerminatedQueue_=[],n.hasAttribute("autoplay")?s.autoplay(!0):s.autoplay(s.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(function(m){if(typeof s[m]!="function")throw new Error('plugin "'+m+'" does not exist')}),s.scrubbing_=!1,s.el_=s.createEl(),Fw(ir.default(s),{eventBusKey:"el_"}),s.fsApi_.requestFullscreen&&(rs(yt.default,s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_),s.on(s.fsApi_.fullscreenchange,s.boundDocumentFullscreenChange_)),s.fluid_&&s.on(["playerreset","resize"],s.boundUpdateStyleEl_);var f=wi(s.options_);i.plugins&&Object.keys(i.plugins).forEach(function(m){s[m](i.plugins[m])}),i.debug&&s.debug(!0),s.options_.playerOptions=f,s.middleware_=[],s.playbackRates(i.playbackRates),s.initChildren(),s.isAudio(n.nodeName.toLowerCase()==="audio"),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),Td&&s.addClass("vjs-touch-enabled"),wa||s.addClass("vjs-workinghover"),e.players[s.id_]=ir.default(s);var g=WP.split(".")[0];return s.addClass("vjs-v"+g),s.userActive(!0),s.reportUserActivity(),s.one("play",function(m){return s.listenForUserActivity_(m)}),s.on("stageclick",function(m){return s.handleStageClick_(m)}),s.on("keydown",function(m){return s.handleKeyDown(m)}),s.on("languagechange",function(m){return s.handleLanguagechange(m)}),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s.on("ready",function(){s.audioPosterMode(s.options_.audioPosterMode),s.audioOnlyMode(s.options_.audioOnlyMode)}),s}var r=e.prototype;return r.dispose=function(){var i=this;this.trigger("dispose"),this.off("dispose"),ea(yt.default,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),ea(yt.default,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),hX(this),ya.names.forEach(function(a){var s=ya[a],o=i[s.getterName]();o&&o.off&&o.off()}),t.prototype.dispose.call(this)},r.createEl=function(){var i=this.tag,a,s=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player"),o=this.tag.tagName.toLowerCase()==="video-js";s?a=this.el_=i.parentNode:o||(a=this.el_=t.prototype.createEl.call(this,"div"));var c=eu(i);if(o){for(a=this.el_=i,i=this.tag=yt.default.createElement("video");a.children.length;)i.appendChild(a.firstChild);Jc(a,"video-js")||iu(a,"video-js"),a.appendChild(i),s=this.playerElIngest_=a,Object.keys(a).forEach(function(A){try{i[A]=a[A]}catch{}})}if(i.setAttribute("tabindex","-1"),c.tabindex="-1",(Xp||uu&&r1)&&(i.setAttribute("role","application"),c.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),"width"in c&&delete c.width,"height"in c&&delete c.height,Object.getOwnPropertyNames(c).forEach(function(A){o&&A==="class"||a.setAttribute(A,c[A]),o&&i.setAttribute(A,c[A])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",i.player=a.player=this,this.addClass("vjs-paused"),Se.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=v1("vjs-styles-dimensions");var l=Yu(".vjs-styles-defaults"),f=Yu("head");f.insertBefore(this.styleEl_,l?l.nextSibling:f.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var g=i.getElementsByTagName("a"),m=0;m<g.length;m++){var y=g.item(m);iu(y,"vjs-hidden"),y.setAttribute("hidden","hidden")}return i.initNetworkState_=i.networkState,i.parentNode&&!s&&i.parentNode.insertBefore(a,i),fw(i,a),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=a,a},r.crossOrigin=function(i){if(!i)return this.techGet_("crossOrigin");if(i!=="anonymous"&&i!=="use-credentials"){pr.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+i+'"');return}this.techCall_("setCrossOrigin",i)},r.width=function(i){return this.dimension("width",i)},r.height=function(i){return this.dimension("height",i)},r.dimension=function(i,a){var s=i+"_";if(a===void 0)return this[s]||0;if(a===""||a==="auto"){this[s]=void 0,this.updateStyleEl_();return}var o=parseFloat(a);if(isNaN(o)){pr.error('Improper value "'+a+'" supplied for for '+i);return}this[s]=o,this.updateStyleEl_()},r.fluid=function(i){var a=this;if(i===void 0)return!!this.fluid_;this.fluid_=!!i,nu(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),i?(this.addClass("vjs-fluid"),this.fill(!1),B9(this,function(){a.on(["playerreset","resize"],a.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},r.fill=function(i){if(i===void 0)return!!this.fill_;this.fill_=!!i,i?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},r.aspectRatio=function(i){if(i===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(i))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=i,this.fluid(!0),this.updateStyleEl_()},r.updateStyleEl_=function(){if(Se.default.VIDEOJS_NO_DYNAMIC_STYLE===!0){var i=typeof this.width_=="number"?this.width_:this.options_.width,a=typeof this.height_=="number"?this.height_:this.options_.height,s=this.tech_&&this.tech_.el();s&&(i>=0&&(s.width=i),a>=0&&(s.height=a));return}var o,c,l,f;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?l=this.aspectRatio_:this.videoWidth()>0?l=this.videoWidth()+":"+this.videoHeight():l="16:9";var g=l.split(":"),m=g[1]/g[0];this.width_!==void 0?o=this.width_:this.height_!==void 0?o=this.height_/m:o=this.videoWidth()||300,this.height_!==void 0?c=this.height_:c=o*m,/^[^a-zA-Z]/.test(this.id())?f="dimensions-"+this.id():f=this.id()+"-dimensions",this.addClass(f),y1(this.styleEl_,`
      .`+f+` {
        width: `+o+`px;
        height: `+c+`px;
      }

      .`+f+`.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: `+m*100+`%;
      }
    `)},r.loadTech_=function(i,a){var s=this;this.tech_&&this.unloadTech_();var o=Zi(i),c=i.charAt(0).toLowerCase()+i.slice(1);o!=="Html5"&&this.tag&&(ii.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=o,this.isReady_=!1;var l=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(l=!1);var f={source:a,autoplay:l,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+c+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};ya.names.forEach(function(m){var y=ya[m];f[y.getterName]=s[y.privateName]}),Vi(f,this.options_[o]),Vi(f,this.options_[c]),Vi(f,this.options_[i.toLowerCase()]),this.tag&&(f.tag=this.tag),a&&a.src===this.cache_.src&&this.cache_.currentTime>0&&(f.startTime=this.cache_.currentTime);var g=ii.getTech(i);if(!g)throw new Error("No Tech named '"+o+"' exists! '"+o+"' should be registered using videojs.registerTech()'");this.tech_=new g(f),this.tech_.ready(Ti(this,this.handleTechReady_),!0),rP.jsonToTextTracks(this.textTracksJson_||[],this.tech_),eR.forEach(function(m){s.on(s.tech_,m,function(y){return s["handleTech"+Zi(m)+"_"](y)})}),Object.keys(cw).forEach(function(m){s.on(s.tech_,m,function(y){if(s.tech_.playbackRate()===0&&s.tech_.seeking()){s.queuedCallbacks_.push({callback:s["handleTech"+cw[m]+"_"].bind(s),event:y});return}s["handleTech"+cw[m]+"_"](y)})}),this.on(this.tech_,"loadstart",function(m){return s.handleTechLoadStart_(m)}),this.on(this.tech_,"sourceset",function(m){return s.handleTechSourceset_(m)}),this.on(this.tech_,"waiting",function(m){return s.handleTechWaiting_(m)}),this.on(this.tech_,"ended",function(m){return s.handleTechEnded_(m)}),this.on(this.tech_,"seeking",function(m){return s.handleTechSeeking_(m)}),this.on(this.tech_,"play",function(m){return s.handleTechPlay_(m)}),this.on(this.tech_,"firstplay",function(m){return s.handleTechFirstPlay_(m)}),this.on(this.tech_,"pause",function(m){return s.handleTechPause_(m)}),this.on(this.tech_,"durationchange",function(m){return s.handleTechDurationChange_(m)}),this.on(this.tech_,"fullscreenchange",function(m,y){return s.handleTechFullscreenChange_(m,y)}),this.on(this.tech_,"fullscreenerror",function(m,y){return s.handleTechFullscreenError_(m,y)}),this.on(this.tech_,"enterpictureinpicture",function(m){return s.handleTechEnterPictureInPicture_(m)}),this.on(this.tech_,"leavepictureinpicture",function(m){return s.handleTechLeavePictureInPicture_(m)}),this.on(this.tech_,"error",function(m){return s.handleTechError_(m)}),this.on(this.tech_,"posterchange",function(m){return s.handleTechPosterChange_(m)}),this.on(this.tech_,"textdata",function(m){return s.handleTechTextData_(m)}),this.on(this.tech_,"ratechange",function(m){return s.handleTechRateChange_(m)}),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(o!=="Html5"||!this.tag)&&fw(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},r.unloadTech_=function(){var i=this;ya.names.forEach(function(a){var s=ya[a];i[s.privateName]=i[s.getterName]()}),this.textTracksJson_=rP.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},r.tech=function(i){return i===void 0&&pr.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_},r.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)},r.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)},r.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},r.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())},r.manualAutoplay_=function(i){var a=this;if(!(!this.tech_||typeof i!="string")){var s=function(){var l=a.muted();a.muted(!0);var f=function(){a.muted(l)};a.playTerminatedQueue_.push(f);var g=a.play();if(qp(g))return g.catch(function(m){throw f(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(m||""))})},o;if(i==="any"&&!this.muted()?(o=this.play(),qp(o)&&(o=o.catch(s))):i==="muted"&&!this.muted()?o=s():o=this.play(),!!qp(o))return o.then(function(){a.trigger({type:"autoplay-success",autoplay:i})}).catch(function(){a.trigger({type:"autoplay-failure",autoplay:i})})}},r.updateSourceCaches_=function(i){i===void 0&&(i="");var a=i,s="";typeof a!="string"&&(a=i.src,s=i.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],a&&!s&&(s=vX(this,a)),this.cache_.source=wi({},i,{src:a,type:s});for(var o=this.cache_.sources.filter(function(y){return y.src&&y.src===a}),c=[],l=this.$$("source"),f=[],g=0;g<l.length;g++){var m=eu(l[g]);c.push(m),m.src&&m.src===a&&f.push(m.src)}f.length&&!o.length?this.cache_.sources=c:o.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=a},r.handleTechSourceset_=function(i){var a=this;if(!this.changingSrc_){var s=function(f){return a.updateSourceCaches_(f)},o=this.currentSource().src,c=i.src;o&&!/^blob:/.test(o)&&/^blob:/.test(c)&&(!this.lastSource_||this.lastSource_.tech!==c&&this.lastSource_.player!==o)&&(s=function(){}),s(c),i.src||this.tech_.any(["sourceset","loadstart"],function(l){if(l.type!=="sourceset"){var f=a.techGet("currentSrc");a.lastSource_.tech=f,a.updateSourceCaches_(f)}})}this.lastSource_={player:this.currentSource().src,tech:i.src},this.trigger({src:i.src,type:"sourceset"})},r.hasStarted=function(i){if(i===void 0)return this.hasStarted_;i!==this.hasStarted_&&(this.hasStarted_=i,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},r.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},r.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(i){return i.callback(i.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},r.handleTechWaiting_=function(){var i=this;this.addClass("vjs-waiting"),this.trigger("waiting");var a=this.currentTime(),s=function o(){a!==i.currentTime()&&(i.removeClass("vjs-waiting"),i.off("timeupdate",o))};this.on("timeupdate",s)},r.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},r.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},r.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},r.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},r.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},r.handleTechFirstPlay_=function(){this.options_.starttime&&(pr.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},r.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},r.handleTechEnded_=function(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},r.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},r.handleTechClick_=function(i){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,i):this.paused()?go(this.play()):this.pause())},r.handleTechDoubleClick_=function(i){if(this.controls_){var a=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(s){return s.contains(i.target)});a||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,i):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},r.handleTechTap_=function(){this.userActive(!this.userActive())},r.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},r.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},r.handleTechTouchEnd_=function(i){i.cancelable&&i.preventDefault()},r.handleStageClick_=function(){this.reportUserActivity()},r.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},r.documentFullscreenChange_=function(i){var a=i.target.player;if(!(a&&a!==this)){var s=this.el(),o=yt.default[this.fsApi_.fullscreenElement]===s;!o&&s.matches?o=s.matches(":"+this.fsApi_.fullscreen):!o&&s.msMatchesSelector&&(o=s.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(o)}},r.handleTechFullscreenChange_=function(i,a){var s=this;a&&(a.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",function(){s.removeClass("vjs-ios-native-fs")})),this.isFullscreen(a.isFullscreen))},r.handleTechFullscreenError_=function(i,a){this.trigger("fullscreenerror",a)},r.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},r.handleTechEnterPictureInPicture_=function(i){this.isInPictureInPicture(!0)},r.handleTechLeavePictureInPicture_=function(i){this.isInPictureInPicture(!1)},r.handleTechError_=function(){var i=this.tech_.error();this.error(i)},r.handleTechTextData_=function(){var i=null;arguments.length>1&&(i=arguments[1]),this.trigger("textdata",i)},r.getCache=function(){return this.cache_},r.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}},r.techCall_=function(i,a){this.ready(function(){if(i in fX)return lX(this.middleware_,this.tech_,i,a);if(i in cP)return uP(this.middleware_,this.tech_,i,a);try{this.tech_&&this.tech_[i](a)}catch(s){throw pr(s),s}},!0)},r.techGet_=function(i){if(!(!this.tech_||!this.tech_.isReady_)){if(i in dX)return cX(this.middleware_,this.tech_,i);if(i in cP)return uP(this.middleware_,this.tech_,i);try{return this.tech_[i]()}catch(a){throw this.tech_[i]===void 0?(pr("Video.js: "+i+" method not defined for "+this.techName_+" playback technology.",a),a):a.name==="TypeError"?(pr("Video.js: "+i+" unavailable on "+this.techName_+" playback technology element.",a),this.tech_.isReady_=!1,a):(pr(a),a)}}},r.play=function(){var i=this,a=this.options_.Promise||Se.default.Promise;return a?new a(function(s){i.play_(s)}):this.play_()},r.play_=function(i){var a=this;i===void 0&&(i=go),this.playCallbacks_.push(i);var s=!!(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!s){this.waitToPlay_=function(c){a.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!s&&(sv||wa)&&this.load();return}var o=this.techGet_("play");o===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(o)},r.runPlayTerminatedQueue_=function(){var i=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],i.forEach(function(a){a()})},r.runPlayCallbacks_=function(i){var a=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],a.forEach(function(s){s(i)})},r.pause=function(){this.techCall_("pause")},r.paused=function(){return this.techGet_("paused")!==!1},r.played=function(){return this.techGet_("played")||Qc(0,0)},r.scrubbing=function(i){if(typeof i>"u")return this.scrubbing_;this.scrubbing_=!!i,this.techCall_("setScrubbing",this.scrubbing_),i?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},r.currentTime=function(i){if(typeof i<"u"){if(i<0&&(i=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=i,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",i),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime},r.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},r.duration=function(i){if(i===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;i=parseFloat(i),i<0&&(i=1/0),i!==this.cache_.duration&&(this.cache_.duration=i,i===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(i)||this.trigger("durationchange"))},r.remainingTime=function(){return this.duration()-this.currentTime()},r.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},r.buffered=function(){var i=this.techGet_("buffered");return(!i||!i.length)&&(i=Qc(0,0)),i},r.bufferedPercent=function(){return E1(this.buffered(),this.duration())},r.bufferedEnd=function(){var i=this.buffered(),a=this.duration(),s=i.end(i.length-1);return s>a&&(s=a),s},r.volume=function(i){var a;if(i!==void 0){a=Math.max(0,Math.min(1,parseFloat(i))),this.cache_.volume=a,this.techCall_("setVolume",a),a>0&&this.lastVolume_(a);return}return a=parseFloat(this.techGet_("volume")),isNaN(a)?1:a},r.muted=function(i){if(i!==void 0){this.techCall_("setMuted",i);return}return this.techGet_("muted")||!1},r.defaultMuted=function(i){return i!==void 0?this.techCall_("setDefaultMuted",i):this.techGet_("defaultMuted")||!1},r.lastVolume_=function(i){if(i!==void 0&&i!==0){this.cache_.lastVolume=i;return}return this.cache_.lastVolume},r.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},r.isFullscreen=function(i){if(i!==void 0){var a=this.isFullscreen_;this.isFullscreen_=!!i,this.isFullscreen_!==a&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_},r.requestFullscreen=function(i){var a=this.options_.Promise||Se.default.Promise;if(a){var s=this;return new a(function(o,c){function l(){s.off("fullscreenerror",g),s.off("fullscreenchange",f)}function f(){l(),o()}function g(y,A){l(),c(A)}s.one("fullscreenchange",f),s.one("fullscreenerror",g);var m=s.requestFullscreenHelper_(i);m&&(m.then(l,l),m.then(o,c))})}return this.requestFullscreenHelper_()},r.requestFullscreenHelper_=function(i){var a=this,s;if(this.fsApi_.prefixed||(s=this.options_.fullscreen&&this.options_.fullscreen.options||{},i!==void 0&&(s=i)),this.fsApi_.requestFullscreen){var o=this.el_[this.fsApi_.requestFullscreen](s);return o&&o.then(function(){return a.isFullscreen(!0)},function(){return a.isFullscreen(!1)}),o}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()},r.exitFullscreen=function(){var i=this.options_.Promise||Se.default.Promise;if(i){var a=this;return new i(function(s,o){function c(){a.off("fullscreenerror",f),a.off("fullscreenchange",l)}function l(){c(),s()}function f(m,y){c(),o(y)}a.one("fullscreenchange",l),a.one("fullscreenerror",f);var g=a.exitFullscreenHelper_();g&&(g.then(c,c),g.then(s,o))})}return this.exitFullscreenHelper_()},r.exitFullscreenHelper_=function(){var i=this;if(this.fsApi_.requestFullscreen){var a=yt.default[this.fsApi_.exitFullscreen]();return a&&go(a.then(function(){return i.isFullscreen(!1)})),a}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},r.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=yt.default.documentElement.style.overflow,rs(yt.default,"keydown",this.boundFullWindowOnEscKey_),yt.default.documentElement.style.overflow="hidden",iu(yt.default.body,"vjs-full-window"),this.trigger("enterFullWindow")},r.fullWindowOnEscKey=function(i){ar.default.isEventKey(i,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())},r.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,ea(yt.default,"keydown",this.boundFullWindowOnEscKey_),yt.default.documentElement.style.overflow=this.docOrigOverflow,Yp(yt.default.body,"vjs-full-window"),this.trigger("exitFullWindow")},r.disablePictureInPicture=function(i){if(i===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",i),this.options_.disablePictureInPicture=i,this.trigger("disablepictureinpicturechanged")},r.isInPictureInPicture=function(i){if(i!==void 0){this.isInPictureInPicture_=!!i,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_},r.requestPictureInPicture=function(){if("pictureInPictureEnabled"in yt.default&&this.disablePictureInPicture()===!1)return this.techGet_("requestPictureInPicture")},r.exitPictureInPicture=function(){if("pictureInPictureEnabled"in yt.default)return yt.default.exitPictureInPicture()},r.handleKeyDown=function(i){var a=this.options_.userActions;if(!(!a||!a.hotkeys)){var s=function(c){var l=c.tagName.toLowerCase();if(c.isContentEditable)return!0;var f=["button","checkbox","hidden","radio","reset","submit"];if(l==="input")return f.indexOf(c.type)===-1;var g=["textarea"];return g.indexOf(l)!==-1};s(this.el_.ownerDocument.activeElement)||(typeof a.hotkeys=="function"?a.hotkeys.call(this,i):this.handleHotkeys(i))}},r.handleHotkeys=function(i){var a=this.options_.userActions?this.options_.userActions.hotkeys:{},s=a.fullscreenKey,o=s===void 0?function(k){return ar.default.isEventKey(k,"f")}:s,c=a.muteKey,l=c===void 0?function(k){return ar.default.isEventKey(k,"m")}:c,f=a.playPauseKey,g=f===void 0?function(k){return ar.default.isEventKey(k,"k")||ar.default.isEventKey(k,"Space")}:f;if(o.call(this,i)){i.preventDefault(),i.stopPropagation();var m=ht.getComponent("FullscreenToggle");yt.default[this.fsApi_.fullscreenEnabled]!==!1&&m.prototype.handleClick.call(this,i)}else if(l.call(this,i)){i.preventDefault(),i.stopPropagation();var y=ht.getComponent("MuteToggle");y.prototype.handleClick.call(this,i)}else if(g.call(this,i)){i.preventDefault(),i.stopPropagation();var A=ht.getComponent("PlayToggle");A.prototype.handleClick.call(this,i)}},r.canPlayType=function(i){for(var a,s=0,o=this.options_.techOrder;s<o.length;s++){var c=o[s],l=ii.getTech(c);if(l||(l=ht.getComponent(c)),!l){pr.error('The "'+c+'" tech is undefined. Skipped browser support check for that tech.');continue}if(l.isSupported()&&(a=l.canPlayType(i),a))return a}return""},r.selectSource=function(i){var a=this,s=this.options_.techOrder.map(function(g){return[g,ii.getTech(g)]}).filter(function(g){var m=g[0],y=g[1];return y?y.isSupported():(pr.error('The "'+m+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),o=function(m,y,A){var k;return m.some(function(I){return y.some(function(F){if(k=A(I,F),k)return!0})}),k},c,l=function(m){return function(y,A){return m(A,y)}},f=function(m,y){var A=m[0],k=m[1];if(k.canPlaySource(y,a.options_[A.toLowerCase()]))return{source:y,tech:A}};return this.options_.sourceOrder?c=o(i,s,l(f)):c=o(s,i,f),c||!1},r.handleSrc_=function(i,a){var s=this;if(typeof i>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var o=yX(i);if(!o.length){this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);return}if(this.changingSrc_=!0,a||(this.cache_.sources=o),this.updateSourceCaches_(o[0]),oX(this,o[0],function(f,g){s.middleware_=g,a||(s.cache_.sources=o),s.updateSourceCaches_(f);var m=s.src_(f);if(m){if(o.length>1)return s.handleSrc_(o.slice(1));s.changingSrc_=!1,s.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),s.triggerReady();return}uX(g,s.tech_)}),this.options_.retryOnError&&o.length>1){var c=function(){s.error(null),s.handleSrc_(o.slice(1),!0)},l=function(){s.off("error",c)};this.one("error",c),this.one("playing",l),this.resetRetryOnError_=function(){s.off("error",c),s.off("playing",l)}}},r.src=function(i){return this.handleSrc_(i,!1)},r.src_=function(i){var a=this,s=this.selectSource([i]);return s?H9(s.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",i):this.techCall_("src",i.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(s.tech,s.source),this.tech_.ready(function(){a.changingSrc_=!1}),!1):!0},r.load=function(){this.techCall_("load")},r.reset=function(){var i=this,a=this.options_.Promise||Se.default.Promise;if(this.paused()||!a)this.doReset_();else{var s=this.play();go(s.then(function(){return i.doReset_()}))}},r.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),nu(this)&&this.trigger("playerreset")},r.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},r.resetProgressBar_=function(){this.currentTime(0);var i=this.controlBar,a=i.durationDisplay,s=i.remainingTimeDisplay;a&&a.updateContent(),s&&s.updateContent()},r.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},r.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},r.currentSources=function(){var i=this.currentSource(),a=[];return Object.keys(i).length!==0&&a.push(i),this.cache_.sources||a},r.currentSource=function(){return this.cache_.source||{}},r.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},r.currentType=function(){return this.currentSource()&&this.currentSource().type||""},r.preload=function(i){if(i!==void 0){this.techCall_("setPreload",i),this.options_.preload=i;return}return this.techGet_("preload")},r.autoplay=function(i){if(i===void 0)return this.options_.autoplay||!1;var a;typeof i=="string"&&/(any|play|muted)/.test(i)||i===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=i,this.manualAutoplay_(typeof i=="string"?i:"play"),a=!1):i?this.options_.autoplay=!0:this.options_.autoplay=!1,a=typeof a>"u"?this.options_.autoplay:a,this.tech_&&this.techCall_("setAutoplay",a)},r.playsinline=function(i){return i!==void 0?(this.techCall_("setPlaysinline",i),this.options_.playsinline=i,this):this.techGet_("playsinline")},r.loop=function(i){if(i!==void 0){this.techCall_("setLoop",i),this.options_.loop=i;return}return this.techGet_("loop")},r.poster=function(i){if(i===void 0)return this.poster_;i||(i=""),i!==this.poster_&&(this.poster_=i,this.techCall_("setPoster",i),this.isPosterFromTech_=!1,this.trigger("posterchange"))},r.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var i=this.tech_.poster()||"";i!==this.poster_&&(this.poster_=i,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},r.controls=function(i){if(i===void 0)return!!this.controls_;i=!!i,this.controls_!==i&&(this.controls_=i,this.usingNativeControls()&&this.techCall_("setControls",i),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},r.usingNativeControls=function(i){if(i===void 0)return!!this.usingNativeControls_;i=!!i,this.usingNativeControls_!==i&&(this.usingNativeControls_=i,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},r.error=function(i){var a=this;if(i===void 0)return this.error_||null;if(Xu("beforeerror").forEach(function(o){var c=o(a,i);if(!(au(c)&&!Array.isArray(c)||typeof c=="string"||typeof c=="number"||c===null)){a.log.error("please return a value that MediaError expects in beforeerror hooks");return}i=c}),this.options_.suppressNotSupportedError&&i&&i.code===4){var s=function(){this.error(i)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],s),this.one("loadstart",function(){this.off(["click","touchstart"],s)});return}if(i===null){this.error_=i,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new _a(i),this.addClass("vjs-error"),pr.error("(CODE:"+this.error_.code+" "+_a.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),Xu("error").forEach(function(o){return o(a,a.error_)})},r.reportUserActivity=function(i){this.userActivity_=!0},r.userActive=function(i){if(i===void 0)return this.userActive_;if(i=!!i,i!==this.userActive_){if(this.userActive_=i,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(a){a.stopPropagation(),a.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},r.listenForUserActivity_=function(){var i,a,s,o=Ti(this,this.reportUserActivity),c=function(A){(A.screenX!==a||A.screenY!==s)&&(a=A.screenX,s=A.screenY,o())},l=function(){o(),this.clearInterval(i),i=this.setInterval(o,250)},f=function(A){o(),this.clearInterval(i)};this.on("mousedown",l),this.on("mousemove",c),this.on("mouseup",f),this.on("mouseleave",f);var g=this.getChild("controlBar");g&&!wa&&!ou&&(g.on("mouseenter",function(y){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),g.on("mouseleave",function(y){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",o),this.on("keyup",o);var m;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(m);var y=this.options_.inactivityTimeout;y<=0||(m=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},y))}},250)},r.playbackRate=function(i){if(i!==void 0){this.techCall_("setPlaybackRate",i);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1},r.defaultPlaybackRate=function(i){return i!==void 0?this.techCall_("setDefaultPlaybackRate",i):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},r.isAudio=function(i){if(i!==void 0){this.isAudio_=!!i;return}return!!this.isAudio_},r.enableAudioOnlyUI_=function(){var i=this;this.addClass("vjs-audio-only-mode");var a=this.children(),s=this.getChild("ControlBar"),o=s&&s.currentHeight();a.forEach(function(c){c!==s&&c.el_&&!c.hasClass("vjs-hidden")&&(c.hide(),i.audioOnlyCache_.hiddenChildren.push(c))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(o),this.trigger("audioonlymodechange")},r.disableAudioOnlyUI_=function(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(function(i){return i.show()}),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")},r.audioOnlyMode=function(i){var a=this;if(typeof i!="boolean"||i===this.audioOnlyMode_)return this.audioOnlyMode_;this.audioOnlyMode_=i;var s=this.options_.Promise||Se.default.Promise;if(s){if(i){var o=[];return this.isInPictureInPicture()&&o.push(this.exitPictureInPicture()),this.isFullscreen()&&o.push(this.exitFullscreen()),this.audioPosterMode()&&o.push(this.audioPosterMode(!1)),s.all(o).then(function(){return a.enableAudioOnlyUI_()})}return s.resolve().then(function(){return a.disableAudioOnlyUI_()})}i?(this.isInPictureInPicture()&&this.exitPictureInPicture(),this.isFullscreen()&&this.exitFullscreen(),this.enableAudioOnlyUI_()):this.disableAudioOnlyUI_()},r.enablePosterModeUI_=function(){var i=this.tech_&&this.tech_;i.hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},r.disablePosterModeUI_=function(){var i=this.tech_&&this.tech_;i.show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")},r.audioPosterMode=function(i){var a=this;if(typeof i!="boolean"||i===this.audioPosterMode_)return this.audioPosterMode_;this.audioPosterMode_=i;var s=this.options_.Promise||Se.default.Promise;if(s){if(i){if(this.audioOnlyMode()){var o=this.audioOnlyMode(!1);return o.then(function(){a.enablePosterModeUI_()})}return s.resolve().then(function(){a.enablePosterModeUI_()})}return s.resolve().then(function(){a.disablePosterModeUI_()})}if(i){this.audioOnlyMode()&&this.audioOnlyMode(!1),this.enablePosterModeUI_();return}this.disablePosterModeUI_()},r.addTextTrack=function(i,a,s){if(this.tech_)return this.tech_.addTextTrack(i,a,s)},r.addRemoteTextTrack=function(i,a){if(this.tech_)return this.tech_.addRemoteTextTrack(i,a)},r.removeRemoteTextTrack=function(i){i===void 0&&(i={});var a=i,s=a.track;if(s||(s=i),this.tech_)return this.tech_.removeRemoteTextTrack(s)},r.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},r.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},r.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},r.language=function(i){if(i===void 0)return this.language_;this.language_!==String(i).toLowerCase()&&(this.language_=String(i).toLowerCase(),nu(this)&&this.trigger("languagechange"))},r.languages=function(){return wi(e.prototype.options_.languages,this.languages_)},r.toJSON=function(){var i=wi(this.options_),a=i.tracks;i.tracks=[];for(var s=0;s<a.length;s++){var o=a[s];o=wi(o),o.player=void 0,i.tracks[s]=o}return i},r.createModal=function(i,a){var s=this;a=a||{},a.content=i||"";var o=new Pd(this,a);return this.addChild(o),o.on("dispose",function(){s.removeChild(o)}),o.open(),o},r.updateCurrentBreakpoint_=function(){if(this.responsive())for(var i=this.currentBreakpoint(),a=this.currentWidth(),s=0;s<_w.length;s++){var o=_w[s],c=this.breakpoints_[o];if(a<=c){if(i===o)return;i&&this.removeClass(Um[i]),this.addClass(Um[o]),this.breakpoint_=o;break}}},r.removeCurrentBreakpoint_=function(){var i=this.currentBreakpointClass();this.breakpoint_="",i&&this.removeClass(i)},r.breakpoints=function(i){return i===void 0?Vi(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Vi({},KX,i),this.updateCurrentBreakpoint_(),Vi(this.breakpoints_))},r.responsive=function(i){if(i===void 0)return this.responsive_;i=!!i;var a=this.responsive_;if(i!==a)return this.responsive_=i,i?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),i},r.currentBreakpoint=function(){return this.breakpoint_},r.currentBreakpointClass=function(){return Um[this.breakpoint_]||""},r.loadMedia=function(i,a){var s=this;if(!(!i||typeof i!="object")){this.reset(),this.cache_.media=wi(i);var o=this.cache_.media,c=o.artwork,l=o.poster,f=o.src,g=o.textTracks;!c&&l&&(this.cache_.media.artwork=[{src:l,type:zm(l)}]),f&&this.src(f),l&&this.poster(l),Array.isArray(g)&&g.forEach(function(m){return s.addRemoteTextTrack(m,!1)}),this.ready(a)}},r.getMedia=function(){if(!this.cache_.media){var i=this.poster(),a=this.currentSources(),s=Array.prototype.map.call(this.remoteTextTracks(),function(c){return{kind:c.kind,label:c.label,language:c.language,src:c.src}}),o={src:a,textTracks:s};return i&&(o.poster=i,o.artwork=[{src:o.poster,type:zm(o.poster)}]),o}return wi(this.cache_.media)},e.getTagSettings=function(i){var a={sources:[],tracks:[]},s=eu(i),o=s["data-setup"];if(Jc(i,"vjs-fill")&&(s.fill=!0),Jc(i,"vjs-fluid")&&(s.fluid=!0),o!==null){var c=b9.default(o||"{}"),l=c[0],f=c[1];l&&pr.error(l),Vi(s,f)}if(Vi(a,s),i.hasChildNodes())for(var g=i.childNodes,m=0,y=g.length;m<y;m++){var A=g[m],k=A.nodeName.toLowerCase();k==="source"?a.sources.push(eu(A)):k==="track"&&a.tracks.push(eu(A))}return a},r.flexNotSupported_=function(){var i=yt.default.createElement("i");return!("flexBasis"in i.style||"webkitFlexBasis"in i.style||"mozFlexBasis"in i.style||"msFlexBasis"in i.style||"msFlexOrder"in i.style)},r.debug=function(i){if(i===void 0)return this.debugEnabled_;i?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},r.playbackRates=function(i){if(i===void 0)return this.cache_.playbackRates;Array.isArray(i)&&i.every(function(a){return typeof a=="number"})&&(this.cache_.playbackRates=i,this.trigger("playbackrateschange"))},e}(ht);ya.names.forEach(function(t){var e=ya[t];an.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});an.prototype.crossorigin=an.prototype.crossOrigin;an.players={};var Mp=Se.default.navigator;an.prototype.options_={techOrder:ii.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Mp&&(Mp.languages&&Mp.languages[0]||Mp.userLanguage||Mp.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(t){an.prototype[t]=function(){return this.techGet_(t)}});eR.forEach(function(t){an.prototype["handleTech"+Zi(t)+"_"]=function(){return this.trigger(t)}});ht.registerComponent("Player",an);var Xm="plugin",_d="activePlugins_",md={},Ym=function(e){return md.hasOwnProperty(e)},Fm=function(e){return Ym(e)?md[e]:void 0},tR=function(e,r){e[_d]=e[_d]||{},e[_d][r]=!0},Jm=function(e,r,n){var i=(n?"before":"")+"pluginsetup";e.trigger(i,r),e.trigger(i+":"+r.name,r)},XX=function(e,r){var n=function(){Jm(this,{name:e,plugin:r,instance:null},!0);var a=r.apply(this,arguments);return tR(this,e),Jm(this,{name:e,plugin:r,instance:a}),a};return Object.keys(r).forEach(function(i){n[i]=r[i]}),n},SP=function(e,r){return r.prototype.name=e,function(){Jm(this,{name:e,plugin:r,instance:null},!0);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=_9.default(r,[this].concat(i));return this[e]=function(){return s},Jm(this,s.getEventHash()),s}},yo=function(){function t(r){if(this.constructor===t)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=r,this.log||(this.log=this.player.log.createLogger(this.name)),Fw(this),delete this.trigger,S1(this,this.constructor.defaultState),tR(r,this.name),this.dispose=this.dispose.bind(this),r.on("dispose",this.dispose)}var e=t.prototype;return e.version=function(){return this.constructor.VERSION},e.getEventHash=function(n){return n===void 0&&(n={}),n.name=this.name,n.plugin=this.constructor,n.instance=this,n},e.trigger=function(n,i){return i===void 0&&(i={}),Od(this.eventBusEl_,n,this.getEventHash(i))},e.handleStateChanged=function(n){},e.dispose=function(){var n=this.name,i=this.player;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i[_d][n]=!1,this.player=this.state=null,i[n]=SP(n,md[n])},t.isBasic=function(n){var i=typeof n=="string"?Fm(n):n;return typeof i=="function"&&!t.prototype.isPrototypeOf(i.prototype)},t.registerPlugin=function(n,i){if(typeof n!="string")throw new Error('Illegal plugin name, "'+n+'", must be a string, was '+typeof n+".");if(Ym(n))pr.warn('A plugin named "'+n+'" already exists. You may want to avoid re-registering plugins!');else if(an.prototype.hasOwnProperty(n))throw new Error('Illegal plugin name, "'+n+'", cannot share a name with an existing player method!');if(typeof i!="function")throw new Error('Illegal plugin for "'+n+'", must be a function, was '+typeof i+".");return md[n]=i,n!==Xm&&(t.isBasic(i)?an.prototype[n]=XX(n,i):an.prototype[n]=SP(n,i)),i},t.deregisterPlugin=function(n){if(n===Xm)throw new Error("Cannot de-register base plugin.");Ym(n)&&(delete md[n],delete an.prototype[n])},t.getPlugins=function(n){n===void 0&&(n=Object.keys(md));var i;return n.forEach(function(a){var s=Fm(a);s&&(i=i||{},i[a]=s)}),i},t.getPluginVersion=function(n){var i=Fm(n);return i&&i.VERSION||""},t}();yo.getPlugin=Fm;yo.BASE_PLUGIN_NAME=Xm;yo.registerPlugin(Xm,yo);an.prototype.usingPlugin=function(t){return!!this[_d]&&this[_d][t]===!0};an.prototype.hasPlugin=function(t){return!!Ym(t)};var YX=function(e,r){r===void 0&&(r={});var n=function(){e.apply(this,arguments)},i={};typeof r=="object"?(r.constructor!==Object.prototype.constructor&&(n=r.constructor),i=r):typeof r=="function"&&(n=r),w9.default(n,e),e&&(n.super_=e);for(var a in i)i.hasOwnProperty(a)&&(n.prototype[a]=i[a]);return n},rR=function(e){return e.indexOf("#")===0?e.slice(1):e};function Oe(t,e,r){var n=Oe.getPlayer(t);if(n)return e&&pr.warn('Player "'+t+'" is already initialised. Options will not be applied.'),r&&n.ready(r),n;var i=typeof t=="string"?Yu("#"+rR(t)):t;if(!kd(i))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!i.ownerDocument.defaultView||!i.ownerDocument.body.contains(i))&&pr.warn("The element supplied is not included in the DOM"),e=e||{},Xu("beforesetup").forEach(function(s){var o=s(i,wi(e));if(!au(o)||Array.isArray(o)){pr.error("please return an object in beforesetup hooks");return}e=wi(e,o)});var a=ht.getComponent("Player");return n=new a(i,e,r),Xu("setup").forEach(function(s){return s(n)}),n}Oe.hooks_=tu;Oe.hooks=Xu;Oe.hook=E9;Oe.hookOnce=x9;Oe.removeHook=KP;Se.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Id()&&($p=Yu(".vjs-styles-defaults"),$p||($p=v1("vjs-styles-defaults"),Rm=Yu("head"),Rm&&Rm.insertBefore($p,Rm.firstChild),y1($p,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)));var $p,Rm;hw(1,Oe);Oe.VERSION=WP;Oe.options=an.prototype.options_;Oe.getPlayers=function(){return an.players};Oe.getPlayer=function(t){var e=an.players,r;if(typeof t=="string"){var n=rR(t),i=e[n];if(i)return i;r=Yu("#"+n)}else r=t;if(kd(r)){var a=r,s=a.player,o=a.playerId;if(s||e[o])return s||e[o]}};Oe.getAllPlayers=function(){return Object.keys(an.players).map(function(t){return an.players[t]}).filter(Boolean)};Oe.players=an.players;Oe.getComponent=ht.getComponent;Oe.registerComponent=function(t,e){ii.isTech(e)&&pr.warn("The "+t+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),ht.registerComponent.call(ht,t,e)};Oe.getTech=ii.getTech;Oe.registerTech=ii.registerTech;Oe.use=sX;Object.defineProperty(Oe,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(Oe.middleware,"TERMINATOR",{value:Vm,writeable:!1,enumerable:!0});Oe.browser=P9;Oe.TOUCH_ENABLED=Td;Oe.extend=YX;Oe.mergeOptions=wi;Oe.bind=Ti;Oe.registerPlugin=yo.registerPlugin;Oe.deregisterPlugin=yo.deregisterPlugin;Oe.plugin=function(t,e){return pr.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),yo.registerPlugin(t,e)};Oe.getPlugins=yo.getPlugins;Oe.getPlugin=yo.getPlugin;Oe.getPluginVersion=yo.getPluginVersion;Oe.addLanguage=function(t,e){var r;return t=(""+t).toLowerCase(),Oe.options.languages=wi(Oe.options.languages,(r={},r[t]=e,r)),Oe.options.languages[t]};Oe.log=pr;Oe.createLogger=YP;Oe.createTimeRange=Oe.createTimeRanges=Qc;Oe.formatTime=Ad;Oe.setFormatTime=xX;Oe.resetFormatTime=CX;Oe.parseUrl=qw;Oe.isCrossOrigin=fv;Oe.EventTarget=kn;Oe.on=rs;Oe.one=lv;Oe.off=ea;Oe.trigger=Od;Oe.xhr=zP.default;Oe.TextTrack=Jp;Oe.AudioTrack=A1;Oe.VideoTrack=I1;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(t){Oe[t]=function(){return pr.warn("videojs."+t+"() is deprecated; use videojs.dom."+t+"() instead"),g1[t].apply(null,arguments)}});Oe.computedStyle=Vp;Oe.dom=g1;Oe.url=rX;Oe.defineLazyProperty=sT;Oe.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"});var $s=T9.default,Qm=function(e,r,n){return e&&n&&n.responseURL&&r!==n.responseURL?n.responseURL:r},Bs=function(e){return Oe.log.debug?Oe.log.debug.bind(Oe,"VHS:",e+" >"):function(){}},Ju=1/30,mo=Ju*3,iR=function(e,r){var n=[],i;if(e&&e.length)for(i=0;i<e.length;i++)r(e.start(i),e.end(i))&&n.push([e.start(i),e.end(i)]);return Oe.createTimeRanges(n)},vd=function(e,r){return iR(e,function(n,i){return n-mo<=r&&i+mo>=r})},Dm=function(e,r){return iR(e,function(n){return n-Ju>=r})},JX=function(e){if(e.length<2)return Oe.createTimeRanges();for(var r=[],n=1;n<e.length;n++){var i=e.end(n-1),a=e.start(n);r.push([i,a])}return Oe.createTimeRanges(r)},QX=function(e,r){var n=null,i=null,a=0,s=[],o=[];if(!e||!e.length||!r||!r.length)return Oe.createTimeRange();for(var c=e.length;c--;)s.push({time:e.start(c),type:"start"}),s.push({time:e.end(c),type:"end"});for(c=r.length;c--;)s.push({time:r.start(c),type:"start"}),s.push({time:r.end(c),type:"end"});for(s.sort(function(l,f){return l.time-f.time}),c=0;c<s.length;c++)s[c].type==="start"?(a++,a===2&&(n=s[c].time)):s[c].type==="end"&&(a--,a===1&&(i=s[c].time)),n!==null&&i!==null&&(o.push([n,i]),n=null,i=null);return Oe.createTimeRanges(o)},nR=function(e){var r=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)r.push(e.start(n)+" => "+e.end(n));return r.join(", ")},ZX=function(e,r,n){n===void 0&&(n=1);var i=e.length?e.end(e.length-1):0;return(i-r)/n},Xc=function(e){for(var r=[],n=0;n<e.length;n++)r.push({start:e.start(n),end:e.end(n)});return r},eY=function(e,r){if(e===r)return!1;if(!e&&r||!r&&e||e.length!==r.length)return!0;for(var n=0;n<e.length;n++)if(e.start(n)!==r.start(n)||e.end(n)!==r.end(n))return!0;return!1},EP=function(e){if(!(!e||!e.length||!e.end))return e.end(e.length-1)},oT=function(e,r){var n=0;if(!e||!e.length)return n;for(var i=0;i<e.length;i++){var a=e.start(i),s=e.end(i);if(!(r>s)){if(r>a&&r<=s){n+=s-r;continue}n+=s-a}}return n},xP=Oe.createTimeRange,uT=function(e,r){if(!r.preload)return r.duration;var n=0;return(r.parts||[]).forEach(function(i){n+=i.duration}),(r.preloadHints||[]).forEach(function(i){i.type==="PART"&&(n+=e.partTargetDuration)}),n},ww=function(e){return(e.segments||[]).reduce(function(r,n,i){return n.parts?n.parts.forEach(function(a,s){r.push({duration:a.duration,segmentIndex:i,partIndex:s,part:a,segment:n})}):r.push({duration:n.duration,segmentIndex:i,partIndex:null,segment:n,part:null}),r},[])},aR=function(e){var r=e.segments&&e.segments.length&&e.segments[e.segments.length-1];return r&&r.parts||[]},sR=function(e){var r=e.preloadSegment;if(r){var n=r.parts,i=r.preloadHints,a=(i||[]).reduce(function(s,o){return s+(o.type==="PART"?1:0)},0);return a+=n&&n.length?n.length:0,a}},oR=function(e,r){if(r.endList)return 0;if(e&&e.suggestedPresentationDelay)return e.suggestedPresentationDelay;var n=aR(r).length>0;return n&&r.serverControl&&r.serverControl.partHoldBack?r.serverControl.partHoldBack:n&&r.partTargetDuration?r.partTargetDuration*3:r.serverControl&&r.serverControl.holdBack?r.serverControl.holdBack:r.targetDuration?r.targetDuration*3:0},tY=function(e,r){var n=0,i=r-e.mediaSequence,a=e.segments[i];if(a){if(typeof a.start<"u")return{result:a.start,precise:!0};if(typeof a.end<"u")return{result:a.end-a.duration,precise:!0}}for(;i--;){if(a=e.segments[i],typeof a.end<"u")return{result:n+a.end,precise:!0};if(n+=uT(e,a),typeof a.start<"u")return{result:n+a.start,precise:!0}}return{result:n,precise:!1}},rY=function(e,r){for(var n=0,i,a=r-e.mediaSequence;a<e.segments.length;a++){if(i=e.segments[a],typeof i.start<"u")return{result:i.start-n,precise:!0};if(n+=uT(e,i),typeof i.end<"u")return{result:i.end-n,precise:!0}}return{result:-1,precise:!1}},uR=function(e,r,n){if(typeof r>"u"&&(r=e.mediaSequence+e.segments.length),r<e.mediaSequence)return 0;var i=tY(e,r);if(i.precise)return i.result;var a=rY(e,r);return a.precise?a.result:i.result+n},cR=function(e,r,n){if(!e)return 0;if(typeof n!="number"&&(n=0),typeof r>"u"){if(e.totalDuration)return e.totalDuration;if(!e.endList)return Se.default.Infinity}return uR(e,r,n)},jp=function(e){var r=e.defaultDuration,n=e.durationList,i=e.startIndex,a=e.endIndex,s=0;if(i>a){var o=[a,i];i=o[0],a=o[1]}if(i<0){for(var c=i;c<Math.min(0,a);c++)s+=r;i=0}for(var l=i;l<a;l++)s+=n[l].duration;return s},lR=function(e,r,n,i){if(!e||!e.segments)return null;if(e.endList)return cR(e);if(r===null)return null;r=r||0;var a=uR(e,e.mediaSequence+e.segments.length,r);return n&&(i=typeof i=="number"?i:oR(null,e),a-=i),Math.max(0,a)},iY=function(e,r,n){var i=!0,a=r||0,s=lR(e,r,i,n);return s===null?xP():xP(a,s)},nY=function(e){for(var r=e.playlist,n=e.currentTime,i=e.startingSegmentIndex,a=e.startingPartIndex,s=e.startTime,o=e.experimentalExactManifestTimings,c=n-s,l=ww(r),f=0,g=0;g<l.length;g++){var m=l[g];if(i===m.segmentIndex&&!(typeof a=="number"&&typeof m.partIndex=="number"&&a!==m.partIndex)){f=g;break}}if(c<0){if(f>0)for(var y=f-1;y>=0;y--){var A=l[y];if(c+=A.duration,o){if(c<0)continue}else if(c+Ju<=0)continue;return{partIndex:A.partIndex,segmentIndex:A.segmentIndex,startTime:s-jp({defaultDuration:r.targetDuration,durationList:l,startIndex:f,endIndex:y})}}return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:n}}if(f<0){for(var k=f;k<0;k++)if(c-=r.targetDuration,c<0)return{partIndex:l[0]&&l[0].partIndex||null,segmentIndex:l[0]&&l[0].segmentIndex||0,startTime:n};f=0}for(var I=f;I<l.length;I++){var F=l[I];if(c-=F.duration,o){if(c>0)continue}else if(c-Ju>=0)continue;return{partIndex:F.partIndex,segmentIndex:F.segmentIndex,startTime:s+jp({defaultDuration:r.targetDuration,durationList:l,startIndex:f,endIndex:I})}}return{segmentIndex:l[l.length-1].segmentIndex,partIndex:l[l.length-1].partIndex,startTime:n}},dR=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},cT=function(e){return e.excludeUntil&&e.excludeUntil===1/0},mv=function(e){var r=dR(e);return!e.disabled&&!r},aY=function(e){return e.disabled},sY=function(e){for(var r=0;r<e.segments.length;r++)if(e.segments[r].key)return!0;return!1},fR=function(e,r){return r.attributes&&r.attributes[e]},oY=function(e,r,n,i){if(i===void 0&&(i=0),!fR("BANDWIDTH",n))return NaN;var a=e*n.attributes.BANDWIDTH;return(a-i*8)/r},Tw=function(e,r){if(e.playlists.length===1)return!0;var n=r.attributes.BANDWIDTH||Number.MAX_VALUE;return e.playlists.filter(function(i){return mv(i)?(i.attributes.BANDWIDTH||0)<n:!1}).length===0},lT=function(e,r){return!e&&!r||!e&&r||e&&!r?!1:!!(e===r||e.id&&r.id&&e.id===r.id||e.resolvedUri&&r.resolvedUri&&e.resolvedUri===r.resolvedUri||e.uri&&r.uri&&e.uri===r.uri)},CP=function(e,r){var n=e&&e.mediaGroups&&e.mediaGroups.AUDIO||{},i=!1;for(var a in n){for(var s in n[a])if(i=r(n[a][s]),i)break;if(i)break}return!!i},eh=function(e){if(!e||!e.playlists||!e.playlists.length){var r=CP(e,function(s){return s.playlists&&s.playlists.length||s.uri});return r}for(var n=function(o){var c=e.playlists[o],l=c.attributes&&c.attributes.CODECS;if(l&&l.split(",").every(function(g){return ci.isAudioCodec(g)}))return"continue";var f=CP(e,function(g){return lT(c,g)});return f?"continue":{v:!1}},i=0;i<e.playlists.length;i++){var a=n(i);if(a!=="continue"&&typeof a=="object")return a.v}return!0},Ba={liveEdgeDelay:oR,duration:cR,seekable:iY,getMediaInfoForTime:nY,isEnabled:mv,isDisabled:aY,isBlacklisted:dR,isIncompatible:cT,playlistEnd:lR,isAes:sY,hasAttribute:fR,estimateSegmentRequestTime:oY,isLowestEnabledRendition:Tw,isAudioOnly:eh,playlistMatch:lT,segmentDurationWithParts:uT},pR=Oe.log,dT=function(e,r){return e+"-"+r},uY=function(e){var r=e.onwarn,n=e.oninfo,i=e.manifestString,a=e.customTagParsers,s=a===void 0?[]:a,o=e.customTagMappers,c=o===void 0?[]:o,l=e.experimentalLLHLS,f=new m9.Parser;r&&f.on("warn",r),n&&f.on("info",n),s.forEach(function(k){return f.addParser(k)}),c.forEach(function(k){return f.addTagMapper(k)}),f.push(i),f.end();var g=f.manifest;if(l||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(k){g.hasOwnProperty(k)&&delete g[k]}),g.segments&&g.segments.forEach(function(k){["parts","preloadHints"].forEach(function(I){k.hasOwnProperty(I)&&delete k[I]})})),!g.targetDuration){var m=10;g.segments&&g.segments.length&&(m=g.segments.reduce(function(k,I){return Math.max(k,I.duration)},0)),r&&r("manifest has no targetDuration defaulting to "+m),g.targetDuration=m}var y=aR(g);if(y.length&&!g.partTargetDuration){var A=y.reduce(function(k,I){return Math.max(k,I.duration)},0);r&&(r("manifest has no partTargetDuration defaulting to "+A),pR.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),g.partTargetDuration=A}return g},th=function(e,r){e.mediaGroups&&["AUDIO","SUBTITLES"].forEach(function(n){if(e.mediaGroups[n])for(var i in e.mediaGroups[n])for(var a in e.mediaGroups[n][i]){var s=e.mediaGroups[n][i][a];r(s,n,i,a)}})},hR=function(e){var r=e.playlist,n=e.uri,i=e.id;r.id=i,r.playlistErrors_=0,n&&(r.uri=n),r.attributes=r.attributes||{}},cY=function(e){for(var r=e.playlists.length;r--;){var n=e.playlists[r];hR({playlist:n,id:dT(r,n.uri)}),n.resolvedUri=$s(e.uri,n.uri),e.playlists[n.id]=n,e.playlists[n.uri]=n,n.attributes.BANDWIDTH||pR.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},lY=function(e){th(e,function(r){r.uri&&(r.resolvedUri=$s(e.uri,r.uri))})},dY=function(e,r){var n=dT(0,r),i={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:Se.default.location.href,resolvedUri:Se.default.location.href,playlists:[{uri:r,id:n,resolvedUri:r,attributes:{}}]};return i.playlists[n]=i.playlists[0],i.playlists[r]=i.playlists[0],i},gR=function(e,r){e.uri=r;for(var n=0;n<e.playlists.length;n++)if(!e.playlists[n].uri){var i="placeholder-uri-"+n;e.playlists[n].uri=i}var a=eh(e);th(e,function(s,o,c,l){var f="placeholder-uri-"+o+"-"+c+"-"+l;if(!s.playlists||!s.playlists.length){if(a&&o==="AUDIO"&&!s.uri)for(var g=0;g<e.playlists.length;g++){var m=e.playlists[g];if(m.attributes&&m.attributes.AUDIO&&m.attributes.AUDIO===c)return}s.playlists=[el.default({},s)]}s.playlists.forEach(function(y,A){var k=dT(A,f);y.uri?y.resolvedUri=y.resolvedUri||$s(e.uri,y.uri):(y.uri=A===0?f:k,y.resolvedUri=y.uri),y.id=y.id||k,y.attributes=y.attributes||{},e.playlists[y.id]=y,e.playlists[y.uri]=y})}),cY(e),lY(e)},Zm=Oe.mergeOptions,fY=Oe.EventTarget,pY=function(e,r){if(r.endList||!r.serverControl)return e;var n={};if(r.serverControl.canBlockReload){var i=r.preloadSegment,a=r.mediaSequence+r.segments.length;if(i){var s=i.parts||[],o=sR(r)-1;o>-1&&o!==s.length-1&&(n._HLS_part=o),(o>-1||s.length)&&a--}n._HLS_msn=a}if(r.serverControl&&r.serverControl.canSkipUntil&&(n._HLS_skip=r.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(n).length){var c=new Se.default.URL(e);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(l){n.hasOwnProperty(l)&&c.searchParams.set(l,n[l])}),e=c.toString()}return e},hY=function(e,r){if(!e)return r;var n=Zm(e,r);if(e.preloadHints&&!r.preloadHints&&delete n.preloadHints,e.parts&&!r.parts)delete n.parts;else if(e.parts&&r.parts)for(var i=0;i<r.parts.length;i++)e.parts&&e.parts[i]&&(n.parts[i]=Zm(e.parts[i],r.parts[i]));return!e.skipped&&r.skipped&&(n.skipped=!1),e.preload&&!r.preload&&(n.preload=!1),n},gY=function(e,r,n){var i=e.slice(),a=r.slice();n=n||0;for(var s=[],o,c=0;c<a.length;c++){var l=i[c+n],f=a[c];l?(o=l.map||o,s.push(hY(l,f))):(o&&!f.map&&(f.map=o),s.push(f))}return s},mR=function(e,r){!e.resolvedUri&&e.uri&&(e.resolvedUri=$s(r,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=$s(r,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=$s(r,e.map.uri)),e.map&&e.map.key&&!e.map.key.resolvedUri&&(e.map.key.resolvedUri=$s(r,e.map.key.uri)),e.parts&&e.parts.length&&e.parts.forEach(function(n){n.resolvedUri||(n.resolvedUri=$s(r,n.uri))}),e.preloadHints&&e.preloadHints.length&&e.preloadHints.forEach(function(n){n.resolvedUri||(n.resolvedUri=$s(r,n.uri))})},vR=function(e){var r=e.segments||[],n=e.preloadSegment;if(n&&n.parts&&n.parts.length){if(n.preloadHints){for(var i=0;i<n.preloadHints.length;i++)if(n.preloadHints[i].type==="MAP")return r}n.duration=e.targetDuration,n.preload=!0,r.push(n)}return r},yR=function(e,r){return e===r||e.segments&&r.segments&&e.segments.length===r.segments.length&&e.endList===r.endList&&e.mediaSequence===r.mediaSequence&&e.preloadSegment===r.preloadSegment},Sw=function(e,r,n){n===void 0&&(n=yR);var i=Zm(e,{}),a=i.playlists[r.id];if(!a||n(a,r))return null;r.segments=vR(r);var s=Zm(a,r);if(s.preloadSegment&&!r.preloadSegment&&delete s.preloadSegment,a.segments){if(r.skip){r.segments=r.segments||[];for(var o=0;o<r.skip.skippedSegments;o++)r.segments.unshift({skipped:!0})}s.segments=gY(a.segments,r.segments,r.mediaSequence-a.mediaSequence)}s.segments.forEach(function(l){mR(l,s.resolvedUri)});for(var c=0;c<i.playlists.length;c++)i.playlists[c].id===r.id&&(i.playlists[c]=s);return i.playlists[r.id]=s,i.playlists[r.uri]=s,th(e,function(l,f,g,m){if(l.playlists)for(var y=0;y<l.playlists.length;y++)r.id===l.playlists[y].id&&(l.playlists[y]=s)}),i},Ew=function(e,r){var n=e.segments||[],i=n[n.length-1],a=i&&i.parts&&i.parts[i.parts.length-1],s=a&&a.duration||i&&i.duration;return r&&s?s*1e3:(e.partTargetDuration||e.targetDuration||10)*500},yd=function(t){Ct.default(e,t);function e(n,i,a){var s;if(a===void 0&&(a={}),s=t.call(this)||this,!n)throw new Error("A non-empty playlist URL or object is required");s.logger_=Bs("PlaylistLoader");var o=a,c=o.withCredentials,l=c===void 0?!1:c,f=o.handleManifestRedirects,g=f===void 0?!1:f;s.src=n,s.vhs_=i,s.withCredentials=l,s.handleManifestRedirects=g;var m=i.options_;return s.customTagParsers=m&&m.customTagParsers||[],s.customTagMappers=m&&m.customTagMappers||[],s.experimentalLLHLS=m&&m.experimentalLLHLS||!1,Oe.browser.IE_VERSION&&(s.experimentalLLHLS=!1),s.state="HAVE_NOTHING",s.handleMediaupdatetimeout_=s.handleMediaupdatetimeout_.bind(ir.default(s)),s.on("mediaupdatetimeout",s.handleMediaupdatetimeout_),s}var r=e.prototype;return r.handleMediaupdatetimeout_=function(){var i=this;if(this.state==="HAVE_METADATA"){var a=this.media(),s=$s(this.master.uri,a.uri);this.experimentalLLHLS&&(s=pY(s,a)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:s,withCredentials:this.withCredentials},function(o,c){if(i.request){if(o)return i.playlistRequestError(i.request,i.media(),"HAVE_METADATA");i.haveMetadata({playlistString:i.request.responseText,url:i.media().uri,id:i.media().id})}})}},r.playlistRequestError=function(i,a,s){var o=a.uri,c=a.id;this.request=null,s&&(this.state=s),this.error={playlist:this.master.playlists[c],status:i.status,message:"HLS playlist request error at URL: "+o+".",responseText:i.responseText,code:i.status>=500?4:2},this.trigger("error")},r.parseManifest_=function(i){var a=this,s=i.url,o=i.manifestString;return uY({onwarn:function(l){var f=l.message;return a.logger_("m3u8-parser warn for "+s+": "+f)},oninfo:function(l){var f=l.message;return a.logger_("m3u8-parser info for "+s+": "+f)},manifestString:o,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,experimentalLLHLS:this.experimentalLLHLS})},r.haveMetadata=function(i){var a=i.playlistString,s=i.playlistObject,o=i.url,c=i.id;this.request=null,this.state="HAVE_METADATA";var l=s||this.parseManifest_({url:o,manifestString:a});l.lastRequest=Date.now(),hR({playlist:l,uri:o,id:c});var f=Sw(this.master,l);this.targetDuration=l.partTargetDuration||l.targetDuration,this.pendingMedia_=null,f?(this.master=f,this.media_=this.master.playlists[c]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(Ew(this.media(),!!f)),this.trigger("loadedplaylist")},r.dispose=function(){this.trigger("dispose"),this.stopRequest(),Se.default.clearTimeout(this.mediaUpdateTimeout),Se.default.clearTimeout(this.finalRenditionTimeout),this.off()},r.stopRequest=function(){if(this.request){var i=this.request;this.request=null,i.onreadystatechange=null,i.abort()}},r.media=function(i,a){var s=this;if(!i)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof i=="string"){if(!this.master.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.master.playlists[i]}if(Se.default.clearTimeout(this.finalRenditionTimeout),a){var o=(i.partTargetDuration||i.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=Se.default.setTimeout(this.media.bind(this,i,!1),o);return}var c=this.state,l=!this.media_||i.id!==this.media_.id,f=this.master.playlists[i.id];if(f&&f.endList||i.endList&&i.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=i,l&&(this.trigger("mediachanging"),c==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(Ew(i,!0)),!!l){if(this.state="SWITCHING_MEDIA",this.request){if(i.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=i,this.request=this.vhs_.xhr({uri:i.resolvedUri,withCredentials:this.withCredentials},function(g,m){if(s.request){if(i.lastRequest=Date.now(),i.resolvedUri=Qm(s.handleManifestRedirects,i.resolvedUri,m),g)return s.playlistRequestError(s.request,i,c);s.haveMetadata({playlistString:m.responseText,url:i.uri,id:i.id}),c==="HAVE_MASTER"?s.trigger("loadedmetadata"):s.trigger("mediachange")}})}},r.pause=function(){this.mediaUpdateTimeout&&(Se.default.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")},r.load=function(i){var a=this;this.mediaUpdateTimeout&&(Se.default.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);var s=this.media();if(i){var o=s?(s.partTargetDuration||s.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=Se.default.setTimeout(function(){a.mediaUpdateTimeout=null,a.load()},o);return}if(!this.started){this.start();return}s&&!s.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")},r.updateMediaUpdateTimeout_=function(i){var a=this;this.mediaUpdateTimeout&&(Se.default.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=Se.default.setTimeout(function(){a.mediaUpdateTimeout=null,a.trigger("mediaupdatetimeout"),a.updateMediaUpdateTimeout_(i)},i))},r.start=function(){var i=this;if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=Se.default.location.href),this.src.resolvedUri=this.src.uri,setTimeout(function(){i.setupInitialPlaylist(i.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(a,s){if(i.request){if(i.request=null,a)return i.error={status:s.status,message:"HLS playlist request error at URL: "+i.src+".",responseText:s.responseText,code:2},i.state==="HAVE_NOTHING"&&(i.started=!1),i.trigger("error");i.src=Qm(i.handleManifestRedirects,i.src,s);var o=i.parseManifest_({manifestString:s.responseText,url:i.src});i.setupInitialPlaylist(o)}})},r.srcUri=function(){return typeof this.src=="string"?this.src:this.src.uri},r.setupInitialPlaylist=function(i){if(this.state="HAVE_MASTER",i.playlists){this.master=i,gR(this.master,this.srcUri()),i.playlists.forEach(function(s){s.segments=vR(s),s.segments.forEach(function(o){mR(o,s.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.master.playlists[0]);return}var a=this.srcUri()||Se.default.location.href;this.master=dY(i,a),this.haveMetadata({playlistObject:i,url:a,id:this.master.playlists[0].id}),this.trigger("loadedmetadata")},e}(fY),mY=Oe.xhr,vY=Oe.mergeOptions,xw=function(e,r,n,i){var a=e.responseType==="arraybuffer"?e.response:e.responseText;!r&&a&&(e.responseTime=Date.now(),e.roundTripTime=e.responseTime-e.requestTime,e.bytesReceived=a.byteLength||a.length,e.bandwidth||(e.bandwidth=Math.floor(e.bytesReceived/e.roundTripTime*8*1e3))),n.headers&&(e.responseHeaders=n.headers),r&&r.code==="ETIMEDOUT"&&(e.timedout=!0),!r&&!e.aborted&&n.statusCode!==200&&n.statusCode!==206&&n.statusCode!==0&&(r=new Error("XHR Failed with a response of: "+(e&&(a||e.responseText)))),i(r,e)},bR=function(){var e=function r(n,i){n=vY({timeout:45e3},n);var a=r.beforeRequest||Oe.Vhs.xhr.beforeRequest;if(a&&typeof a=="function"){var s=a(n);s&&(n=s)}var o=Oe.Vhs.xhr.original===!0?mY:Oe.Vhs.xhr,c=o(n,function(f,g){return xw(c,f,g,i)}),l=c.abort;return c.abort=function(){return c.aborted=!0,l.apply(c,arguments)},c.uri=n.uri,c.requestTime=Date.now(),c};return e.original=!0,e},yY=function(e){var r,n=e.offset;return typeof e.offset=="bigint"||typeof e.length=="bigint"?r=Se.default.BigInt(e.offset)+Se.default.BigInt(e.length)-Se.default.BigInt(1):r=e.offset+e.length-1,"bytes="+n+"-"+r},Cw=function(e){var r={};return e.byterange&&(r.Range=yY(e.byterange)),r},bY=function(e,r){return e.start(r)+"-"+e.end(r)},_Y=function(e,r){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(r%2?" ":"")},wY=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},_R=function(e){var r={};return Object.keys(e).forEach(function(n){var i=e[n];Bm.isArrayBufferView(i)?r[n]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:r[n]=i}),r},ev=function(e){var r=e.byterange||{length:1/0,offset:0};return[r.length,r.offset,e.resolvedUri].join(",")},wR=function(e){return e.resolvedUri},TR=function(e){for(var r=Array.prototype.slice.call(e),n=16,i="",a,s,o=0;o<r.length/n;o++)a=r.slice(o*n,o*n+n).map(_Y).join(""),s=r.slice(o*n,o*n+n).map(wY).join(""),i+=a+" "+s+`
`;return i},TY=function(e){var r=e.bytes;return TR(r)},SY=function(e){var r="",n;for(n=0;n<e.length;n++)r+=bY(e,n)+" ";return r},EY=Object.freeze({__proto__:null,createTransferableMessage:_R,initSegmentId:ev,segmentKeyId:wR,hexDump:TR,tagDump:TY,textRanges:SY}),SR=.25,xY=function(e,r){if(!r.dateTimeObject)return null;var n=r.videoTimingInfo.transmuxerPrependedSeconds,i=r.videoTimingInfo.transmuxedPresentationStart,a=i+n,s=e-a;return new Date(r.dateTimeObject.getTime()+s*1e3)},CY=function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds},AY=function(e,r){var n;try{n=new Date(e)}catch{return null}if(!r||!r.segments||r.segments.length===0)return null;var i=r.segments[0];if(n<i.dateTimeObject)return null;for(var a=0;a<r.segments.length-1;a++){i=r.segments[a];var s=r.segments[a+1].dateTimeObject;if(n<s)break}var o=r.segments[r.segments.length-1],c=o.dateTimeObject,l=o.videoTimingInfo?CY(o.videoTimingInfo):o.duration+o.duration*SR,f=new Date(c.getTime()+l*1e3);return n>f?null:(n>c&&(i=o),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:Ba.duration(r,r.mediaSequence+r.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})},IY=function(e,r){if(!r||!r.segments||r.segments.length===0)return null;for(var n=0,i,a=0;a<r.segments.length&&(i=r.segments[a],n=i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:n+i.duration,!(e<=n));a++);var s=r.segments[r.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>n){if(e>n+s.duration*SR)return null;i=s}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:n-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}},kY=function(e,r){var n,i;try{n=new Date(e),i=new Date(r)}catch{}var a=n.getTime(),s=i.getTime();return(s-a)/1e3},OY=function(e){if(!e.segments||e.segments.length===0)return!1;for(var r=0;r<e.segments.length;r++){var n=e.segments[r];if(!n.dateTimeObject)return!1}return!0},PY=function(e){var r=e.playlist,n=e.time,i=n===void 0?void 0:n,a=e.callback;if(!a)throw new Error("getProgramTime: callback must be provided");if(!r||i===void 0)return a({message:"getProgramTime: playlist and time must be provided"});var s=IY(i,r);if(!s)return a({message:"valid programTime was not found"});if(s.type==="estimate")return a({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:s.estimatedStart});var o={mediaSeconds:i},c=xY(i,s.segment);return c&&(o.programDateTime=c.toISOString()),a(null,o)},RY=function t(e){var r=e.programTime,n=e.playlist,i=e.retryCount,a=i===void 0?2:i,s=e.seekTo,o=e.pauseAfterSeek,c=o===void 0?!0:o,l=e.tech,f=e.callback;if(!f)throw new Error("seekToProgramTime: callback must be provided");if(typeof r>"u"||!n||!s)return f({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!n.endList&&!l.hasStarted_)return f({message:"player must be playing a live stream to start buffering"});if(!OY(n))return f({message:"programDateTime tags must be provided in the manifest "+n.resolvedUri});var g=AY(r,n);if(!g)return f({message:r+" was not found in the stream"});var m=g.segment,y=kY(m.dateTimeObject,r);if(g.type==="estimate"){if(a===0)return f({message:r+" is not buffered yet. Try again"});s(g.estimatedStart+y),l.one("seeked",function(){t({programTime:r,playlist:n,retryCount:a-1,seekTo:s,pauseAfterSeek:c,tech:l,callback:f})});return}var A=m.start+y,k=function(){return f(null,l.currentTime())};l.one("seeked",k),c&&l.pause(),s(A)},lw=function(e,r){if(e.readyState===4)return r()},DY=function(e,r,n){var i=[],a,s=!1,o=function(m,y,A,k){return y.abort(),s=!0,n(m,y,A,k)},c=function(m,y){if(!s){if(m)return o(m,y,"",i);var A=y.responseText.substring(i&&i.byteLength||0,y.responseText.length);if(i=Bm.concatTypedArrays(i,Bm.stringToBytes(A,!0)),a=a||y9.getId3Offset(i),i.length<10||a&&i.length<a+2)return lw(y,function(){return o(m,y,"",i)});var k=qm.detectContainerForBytes(i);return k==="ts"&&i.length<188?lw(y,function(){return o(m,y,"",i)}):!k&&i.length<376?lw(y,function(){return o(m,y,"",i)}):o(null,y,k,i)}},l={uri:e,beforeSend:function(m){m.overrideMimeType("text/plain; charset=x-user-defined"),m.addEventListener("progress",function(y){return y.total,y.loaded,xw(m,null,{statusCode:m.status},c)})}},f=r(l,function(g,m){return xw(f,g,m,c)});return f},LY=Oe.EventTarget,ER=Oe.mergeOptions,AP=function(e,r){if(!yR(e,r)||e.sidx&&r.sidx&&(e.sidx.offset!==r.sidx.offset||e.sidx.length!==r.sidx.length))return!1;if(!e.sidx&&r.sidx||e.sidx&&!r.sidx||e.segments&&!r.segments||!e.segments&&r.segments)return!1;if(!e.segments&&!r.segments)return!0;for(var n=0;n<e.segments.length;n++){var i=e.segments[n],a=r.segments[n];if(i.uri!==a.uri)return!1;if(!(!i.byterange&&!a.byterange)){var s=i.byterange,o=a.byterange;if(s&&!o||!s&&o||s.offset!==o.offset||s.length!==o.length)return!1}}return!0},NY=function(e){var r=e.masterXml,n=e.srcUrl,i=e.clientOffset,a=e.sidxMapping,s=e.previousManifest,o=Yc.parse(r,{manifestUri:n,clientOffset:i,sidxMapping:a,previousManifest:s});return gR(o,n),o},MY=function(e,r,n){for(var i=!0,a=ER(e,{duration:r.duration,minimumUpdatePeriod:r.minimumUpdatePeriod,timelineStarts:r.timelineStarts}),s=0;s<r.playlists.length;s++){var o=r.playlists[s];if(o.sidx){var c=Yc.generateSidxKey(o.sidx);n&&n[c]&&n[c].sidx&&Yc.addSidxSegmentsToPlaylist(o,n[c].sidx,o.sidx.resolvedUri)}var l=Sw(a,o,AP);l&&(a=l,i=!1)}return th(r,function(f,g,m,y){if(f.playlists&&f.playlists.length){var A=f.playlists[0].id,k=Sw(a,f.playlists[0],AP);k&&(a=k,a.mediaGroups[g][m][y].playlists[0]=a.playlists[A],i=!1)}}),r.minimumUpdatePeriod!==e.minimumUpdatePeriod&&(i=!1),i?null:a},$Y=function(e,r){var n=!e.map&&!r.map,i=n||!!(e.map&&r.map&&e.map.byterange.offset===r.map.byterange.offset&&e.map.byterange.length===r.map.byterange.length);return i&&e.uri===r.uri&&e.byterange.offset===r.byterange.offset&&e.byterange.length===r.byterange.length},IP=function(e,r){var n={};for(var i in e){var a=e[i],s=a.sidx;if(s){var o=Yc.generateSidxKey(s);if(!r[o])break;var c=r[o].sidxInfo;$Y(c,s)&&(n[o]=r[o])}}return n},UY=function(e,r){var n=IP(e.playlists,r),i=n;return th(e,function(a,s,o,c){if(a.playlists&&a.playlists.length){var l=a.playlists;i=ER(i,IP(l,r))}}),i},Aw=function(t){Ct.default(e,t);function e(n,i,a,s){var o;a===void 0&&(a={}),o=t.call(this)||this,o.masterPlaylistLoader_=s||ir.default(o),s||(o.isMaster_=!0);var c=a,l=c.withCredentials,f=l===void 0?!1:l,g=c.handleManifestRedirects,m=g===void 0?!1:g;if(o.vhs_=i,o.withCredentials=f,o.handleManifestRedirects=m,!n)throw new Error("A non-empty playlist URL or object is required");return o.on("minimumUpdatePeriod",function(){o.refreshXml_()}),o.on("mediaupdatetimeout",function(){o.refreshMedia_(o.media().id)}),o.state="HAVE_NOTHING",o.loadedPlaylists_={},o.logger_=Bs("DashPlaylistLoader"),o.isMaster_?(o.masterPlaylistLoader_.srcUrl=n,o.masterPlaylistLoader_.sidxMapping_={}):o.childPlaylist_=n,o}var r=e.prototype;return r.requestErrored_=function(i,a,s){if(!this.request)return!0;if(this.request=null,i)return this.error=typeof i=="object"&&!(i instanceof Error)?i:{status:a.status,message:"DASH request error at URL: "+a.uri,response:a.response,code:2},s&&(this.state=s),this.trigger("error"),!0},r.addSidxSegments_=function(i,a,s){var o=this,c=i.sidx&&Yc.generateSidxKey(i.sidx);if(!i.sidx||!c||this.masterPlaylistLoader_.sidxMapping_[c]){this.mediaRequest_=Se.default.setTimeout(function(){return s(!1)},0);return}var l=Qm(this.handleManifestRedirects,i.sidx.resolvedUri),f=function(m,y){if(!o.requestErrored_(m,y,a)){var A=o.masterPlaylistLoader_.sidxMapping_,k;try{k=S9.default(Bm.toUint8(y.response).subarray(8))}catch(I){o.requestErrored_(I,y,a);return}return A[c]={sidxInfo:i.sidx,sidx:k},Yc.addSidxSegmentsToPlaylist(i,k,i.sidx.resolvedUri),s(!0)}};this.request=DY(l,this.vhs_.xhr,function(g,m,y,A){if(g)return f(g,m);if(!y||y!=="mp4")return f({status:m.status,message:"Unsupported "+(y||"unknown")+" container type for sidx segment at URL: "+l,response:"",playlist:i,internal:!0,blacklistDuration:1/0,code:2},m);var k=i.sidx.byterange,I=k.offset,F=k.length;if(A.length>=F+I)return f(g,{response:A.subarray(I,I+F),status:m.status,uri:m.uri});o.request=o.vhs_.xhr({uri:l,responseType:"arraybuffer",headers:Cw({byterange:i.sidx.byterange})},f)})},r.dispose=function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},Se.default.clearTimeout(this.minimumUpdatePeriodTimeout_),Se.default.clearTimeout(this.mediaRequest_),Se.default.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.off()},r.hasPendingRequest=function(){return this.request||this.mediaRequest_},r.stopRequest=function(){if(this.request){var i=this.request;this.request=null,i.onreadystatechange=null,i.abort()}},r.media=function(i){var a=this;if(!i)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);var s=this.state;if(typeof i=="string"){if(!this.masterPlaylistLoader_.master.playlists[i])throw new Error("Unknown playlist URI: "+i);i=this.masterPlaylistLoader_.master.playlists[i]}var o=!this.media_||i.id!==this.media_.id;if(o&&this.loadedPlaylists_[i.id]&&this.loadedPlaylists_[i.id].endList){this.state="HAVE_METADATA",this.media_=i,o&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}o&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(i,s,function(c){a.haveMetadata({startingState:s,playlist:i})}))},r.haveMetadata=function(i){var a=i.startingState,s=i.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[s.id]=s,this.mediaRequest_=null,this.refreshMedia_(s.id),a==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange")},r.pause=function(){this.masterPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.masterPlaylistLoader_.createMupOnMedia_),this.masterPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),Se.default.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMaster_&&(Se.default.clearTimeout(this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_),this.masterPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)},r.load=function(i){var a=this;Se.default.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;var s=this.media();if(i){var o=s?s.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=Se.default.setTimeout(function(){return a.load()},o);return}if(!this.started){this.start();return}s&&!s.endList?(this.isMaster_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")},r.start=function(){var i=this;if(this.started=!0,!this.isMaster_){this.mediaRequest_=Se.default.setTimeout(function(){return i.haveMaster_()},0);return}this.requestMaster_(function(a,s){i.haveMaster_(),!i.hasPendingRequest()&&!i.media_&&i.media(i.masterPlaylistLoader_.master.playlists[0])})},r.requestMaster_=function(i){var a=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},function(s,o){if(a.requestErrored_(s,o)){a.state==="HAVE_NOTHING"&&(a.started=!1);return}var c=o.responseText!==a.masterPlaylistLoader_.masterXml_;if(a.masterPlaylistLoader_.masterXml_=o.responseText,o.responseHeaders&&o.responseHeaders.date?a.masterLoaded_=Date.parse(o.responseHeaders.date):a.masterLoaded_=Date.now(),a.masterPlaylistLoader_.srcUrl=Qm(a.handleManifestRedirects,a.masterPlaylistLoader_.srcUrl,o),c){a.handleMaster_(),a.syncClientServerClock_(function(){return i(o,c)});return}return i(o,c)})},r.syncClientServerClock_=function(i){var a=this,s=Yc.parseUTCTiming(this.masterPlaylistLoader_.masterXml_);if(s===null)return this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),i();if(s.method==="DIRECT")return this.masterPlaylistLoader_.clientOffset_=s.value-Date.now(),i();this.request=this.vhs_.xhr({uri:$s(this.masterPlaylistLoader_.srcUrl,s.value),method:s.method,withCredentials:this.withCredentials},function(o,c){if(a.request){if(o)return a.masterPlaylistLoader_.clientOffset_=a.masterLoaded_-Date.now(),i();var l;s.method==="HEAD"?!c.responseHeaders||!c.responseHeaders.date?l=a.masterLoaded_:l=Date.parse(c.responseHeaders.date):l=Date.parse(c.responseText),a.masterPlaylistLoader_.clientOffset_=l-Date.now(),i()}})},r.haveMaster_=function(){this.state="HAVE_MASTER",this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},r.handleMaster_=function(){this.mediaRequest_=null;var i=this.masterPlaylistLoader_.master,a=NY({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_,previousManifest:i});i&&(a=MY(i,a,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=a||i;var s=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0];return s&&s!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=s),(!i||a&&a.minimumUpdatePeriod!==i.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),!!a},r.updateMinimumUpdatePeriodTimeout_=function(){var i=this.masterPlaylistLoader_;i.createMupOnMedia_&&(i.off("loadedmetadata",i.createMupOnMedia_),i.createMupOnMedia_=null),i.minimumUpdatePeriodTimeout_&&(Se.default.clearTimeout(i.minimumUpdatePeriodTimeout_),i.minimumUpdatePeriodTimeout_=null);var a=i.master&&i.master.minimumUpdatePeriod;if(a===0&&(i.media()?a=i.media().targetDuration*1e3:(i.createMupOnMedia_=i.updateMinimumUpdatePeriodTimeout_,i.one("loadedmetadata",i.createMupOnMedia_))),typeof a!="number"||a<=0){a<0&&this.logger_("found invalid minimumUpdatePeriod of "+a+", not setting a timeout");return}this.createMUPTimeout_(a)},r.createMUPTimeout_=function(i){var a=this.masterPlaylistLoader_;a.minimumUpdatePeriodTimeout_=Se.default.setTimeout(function(){a.minimumUpdatePeriodTimeout_=null,a.trigger("minimumUpdatePeriod"),a.createMUPTimeout_(i)},i)},r.refreshXml_=function(){var i=this;this.requestMaster_(function(a,s){s&&(i.media_&&(i.media_=i.masterPlaylistLoader_.master.playlists[i.media_.id]),i.masterPlaylistLoader_.sidxMapping_=UY(i.masterPlaylistLoader_.master,i.masterPlaylistLoader_.sidxMapping_),i.addSidxSegments_(i.media(),i.state,function(o){i.refreshMedia_(i.media().id)}))})},r.refreshMedia_=function(i){var a=this;if(!i)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();var s=this.masterPlaylistLoader_.master.playlists,o=!this.media_||this.media_!==s[i];if(o?this.media_=s[i]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){var c=function l(){a.media().endList||(a.mediaUpdateTimeout=Se.default.setTimeout(function(){a.trigger("mediaupdatetimeout"),l()},Ew(a.media(),!!o)))};c()}this.trigger("loadedplaylist")},e}(LY),An={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},FY=function(e){for(var r=new Uint8Array(new ArrayBuffer(e.length)),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return r.buffer},xR=function(e){return e.on=e.addEventListener,e.off=e.removeEventListener,e},BY=function(e){try{return URL.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch{var r=new BlobBuilder;return r.append(e),URL.createObjectURL(r.getBlob())}},CR=function(e){return function(){var r=BY(e),n=xR(new Worker(r));n.objURL=r;var i=n.terminate;return n.on=n.addEventListener,n.off=n.removeEventListener,n.terminate=function(){return URL.revokeObjectURL(r),i.call(this)},n}},AR=function(e){return"var browserWorkerPolyFill = "+xR.toString()+`;
browserWorkerPolyFill(self);
`+e},IR=function(e){return e.toString().replace(/^function.+?{/,"").slice(0,-1)},qY=AR(IR(function(){var t=function(){this.init=function(){var b={};this.on=function(E,S){b[E]||(b[E]=[]),b[E]=b[E].concat(S)},this.off=function(E,S){var x;return b[E]?(x=b[E].indexOf(S),b[E]=b[E].slice(),b[E].splice(x,1),x>-1):!1},this.trigger=function(E){var S,x,R,N;if(S=b[E],!!S)if(arguments.length===2)for(R=S.length,x=0;x<R;++x)S[x].call(this,arguments[1]);else{for(N=[],x=arguments.length,x=1;x<arguments.length;++x)N.push(arguments[x]);for(R=S.length,x=0;x<R;++x)S[x].apply(this,N)}},this.dispose=function(){b={}}}};t.prototype.pipe=function(W){return this.on("data",function(b){W.push(b)}),this.on("done",function(b){W.flush(b)}),this.on("partialdone",function(b){W.partialFlush(b)}),this.on("endedtimeline",function(b){W.endTimeline(b)}),this.on("reset",function(b){W.reset(b)}),W},t.prototype.push=function(W){this.trigger("data",W)},t.prototype.flush=function(W){this.trigger("done",W)},t.prototype.partialFlush=function(W){this.trigger("partialdone",W)},t.prototype.endTimeline=function(W){this.trigger("endedtimeline",W)},t.prototype.reset=function(W){this.trigger("reset",W)};var e=t,r=Math.pow(2,32),n=function(b){var E=new DataView(b.buffer,b.byteOffset,b.byteLength),S;return E.getBigUint64?(S=E.getBigUint64(0),S<Number.MAX_SAFE_INTEGER?Number(S):S):E.getUint32(0)*r+E.getUint32(4)},i={getUint64:n,MAX_UINT32:r},a=i.MAX_UINT32,s,o,c,l,f,g,m,y,A,k,I,F,J,pe,L,H,j,X,V,ie,fe,Re,ye,ze,Ue,de,Q,Fe,We,tt,Le,Tt,It,St,Zt,Ze;(function(){var W;if(ye={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(W in ye)ye.hasOwnProperty(W)&&(ye[W]=[W.charCodeAt(0),W.charCodeAt(1),W.charCodeAt(2),W.charCodeAt(3)]);ze=new Uint8Array([105,115,111,109]),de=new Uint8Array([97,118,99,49]),Ue=new Uint8Array([0,0,0,1]),Q=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Fe=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),We={video:Q,audio:Fe},Tt=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Le=new Uint8Array([0,0,0,0,0,0,0,0]),It=new Uint8Array([0,0,0,0,0,0,0,0]),St=It,Zt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ze=It,tt=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),s=function(b){var E=[],S=0,x,R,N;for(x=1;x<arguments.length;x++)E.push(arguments[x]);for(x=E.length;x--;)S+=E[x].byteLength;for(R=new Uint8Array(S+8),N=new DataView(R.buffer,R.byteOffset,R.byteLength),N.setUint32(0,R.byteLength),R.set(b,4),x=0,S=8;x<E.length;x++)R.set(E[x],S),S+=E[x].byteLength;return R},o=function(){return s(ye.dinf,s(ye.dref,Tt))},c=function(b){return s(ye.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,b.audioobjecttype<<3|b.samplingfrequencyindex>>>1,b.samplingfrequencyindex<<7|b.channelcount<<3,6,1,2]))},l=function(){return s(ye.ftyp,ze,Ue,ze,de)},H=function(b){return s(ye.hdlr,We[b])},f=function(b){return s(ye.mdat,b)},L=function(b){var E=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,b.duration>>>24&255,b.duration>>>16&255,b.duration>>>8&255,b.duration&255,85,196,0,0]);return b.samplerate&&(E[12]=b.samplerate>>>24&255,E[13]=b.samplerate>>>16&255,E[14]=b.samplerate>>>8&255,E[15]=b.samplerate&255),s(ye.mdhd,E)},pe=function(b){return s(ye.mdia,L(b),H(b.type),m(b))},g=function(b){return s(ye.mfhd,new Uint8Array([0,0,0,0,(b&4278190080)>>24,(b&16711680)>>16,(b&65280)>>8,b&255]))},m=function(b){return s(ye.minf,b.type==="video"?s(ye.vmhd,tt):s(ye.smhd,Le),o(),X(b))},y=function(b,E){for(var S=[],x=E.length;x--;)S[x]=ie(E[x]);return s.apply(null,[ye.moof,g(b)].concat(S))},A=function(b){for(var E=b.length,S=[];E--;)S[E]=F(b[E]);return s.apply(null,[ye.moov,I(4294967295)].concat(S).concat(k(b)))},k=function(b){for(var E=b.length,S=[];E--;)S[E]=fe(b[E]);return s.apply(null,[ye.mvex].concat(S))},I=function(b){var E=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(b&4278190080)>>24,(b&16711680)>>16,(b&65280)>>8,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return s(ye.mvhd,E)},j=function(b){var E=b.samples||[],S=new Uint8Array(4+E.length),x,R;for(R=0;R<E.length;R++)x=E[R].flags,S[R+4]=x.dependsOn<<4|x.isDependedOn<<2|x.hasRedundancy;return s(ye.sdtp,S)},X=function(b){return s(ye.stbl,V(b),s(ye.stts,Ze),s(ye.stsc,St),s(ye.stsz,Zt),s(ye.stco,It))},function(){var W,b;V=function(S){return s(ye.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),S.type==="video"?W(S):b(S))},W=function(S){var x=S.sps||[],R=S.pps||[],N=[],ee=[],ce,Te;for(ce=0;ce<x.length;ce++)N.push((x[ce].byteLength&65280)>>>8),N.push(x[ce].byteLength&255),N=N.concat(Array.prototype.slice.call(x[ce]));for(ce=0;ce<R.length;ce++)ee.push((R[ce].byteLength&65280)>>>8),ee.push(R[ce].byteLength&255),ee=ee.concat(Array.prototype.slice.call(R[ce]));if(Te=[ye.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(S.width&65280)>>8,S.width&255,(S.height&65280)>>8,S.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s(ye.avcC,new Uint8Array([1,S.profileIdc,S.profileCompatibility,S.levelIdc,255].concat([x.length],N,[R.length],ee))),s(ye.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],S.sarRatio){var _e=S.sarRatio[0],xe=S.sarRatio[1];Te.push(s(ye.pasp,new Uint8Array([(_e&4278190080)>>24,(_e&16711680)>>16,(_e&65280)>>8,_e&255,(xe&4278190080)>>24,(xe&16711680)>>16,(xe&65280)>>8,xe&255])))}return s.apply(null,Te)},b=function(S){return s(ye.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(S.channelcount&65280)>>8,S.channelcount&255,(S.samplesize&65280)>>8,S.samplesize&255,0,0,0,0,(S.samplerate&65280)>>8,S.samplerate&255,0,0]),c(S))}}(),J=function(b){var E=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(b.id&4278190080)>>24,(b.id&16711680)>>16,(b.id&65280)>>8,b.id&255,0,0,0,0,(b.duration&4278190080)>>24,(b.duration&16711680)>>16,(b.duration&65280)>>8,b.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(b.width&65280)>>8,b.width&255,0,0,(b.height&65280)>>8,b.height&255,0,0]);return s(ye.tkhd,E)},ie=function(b){var E,S,x,R,N,ee,ce;return E=s(ye.tfhd,new Uint8Array([0,0,0,58,(b.id&4278190080)>>24,(b.id&16711680)>>16,(b.id&65280)>>8,b.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),ee=Math.floor(b.baseMediaDecodeTime/a),ce=Math.floor(b.baseMediaDecodeTime%a),S=s(ye.tfdt,new Uint8Array([1,0,0,0,ee>>>24&255,ee>>>16&255,ee>>>8&255,ee&255,ce>>>24&255,ce>>>16&255,ce>>>8&255,ce&255])),N=92,b.type==="audio"?(x=Re(b,N),s(ye.traf,E,S,x)):(R=j(b),x=Re(b,R.length+N),s(ye.traf,E,S,x,R))},F=function(b){return b.duration=b.duration||4294967295,s(ye.trak,J(b),pe(b))},fe=function(b){var E=new Uint8Array([0,0,0,0,(b.id&4278190080)>>24,(b.id&16711680)>>16,(b.id&65280)>>8,b.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return b.type!=="video"&&(E[E.length-1]=0),s(ye.trex,E)},function(){var W,b,E;E=function(x,R){var N=0,ee=0,ce=0,Te=0;return x.length&&(x[0].duration!==void 0&&(N=1),x[0].size!==void 0&&(ee=2),x[0].flags!==void 0&&(ce=4),x[0].compositionTimeOffset!==void 0&&(Te=8)),[0,0,N|ee|ce|Te,1,(x.length&4278190080)>>>24,(x.length&16711680)>>>16,(x.length&65280)>>>8,x.length&255,(R&4278190080)>>>24,(R&16711680)>>>16,(R&65280)>>>8,R&255]},b=function(x,R){var N,ee,ce,Te,_e,xe;for(Te=x.samples||[],R+=20+16*Te.length,ce=E(Te,R),ee=new Uint8Array(ce.length+Te.length*16),ee.set(ce),N=ce.length,xe=0;xe<Te.length;xe++)_e=Te[xe],ee[N++]=(_e.duration&4278190080)>>>24,ee[N++]=(_e.duration&16711680)>>>16,ee[N++]=(_e.duration&65280)>>>8,ee[N++]=_e.duration&255,ee[N++]=(_e.size&4278190080)>>>24,ee[N++]=(_e.size&16711680)>>>16,ee[N++]=(_e.size&65280)>>>8,ee[N++]=_e.size&255,ee[N++]=_e.flags.isLeading<<2|_e.flags.dependsOn,ee[N++]=_e.flags.isDependedOn<<6|_e.flags.hasRedundancy<<4|_e.flags.paddingValue<<1|_e.flags.isNonSyncSample,ee[N++]=_e.flags.degradationPriority&61440,ee[N++]=_e.flags.degradationPriority&15,ee[N++]=(_e.compositionTimeOffset&4278190080)>>>24,ee[N++]=(_e.compositionTimeOffset&16711680)>>>16,ee[N++]=(_e.compositionTimeOffset&65280)>>>8,ee[N++]=_e.compositionTimeOffset&255;return s(ye.trun,ee)},W=function(x,R){var N,ee,ce,Te,_e,xe;for(Te=x.samples||[],R+=20+8*Te.length,ce=E(Te,R),N=new Uint8Array(ce.length+Te.length*8),N.set(ce),ee=ce.length,xe=0;xe<Te.length;xe++)_e=Te[xe],N[ee++]=(_e.duration&4278190080)>>>24,N[ee++]=(_e.duration&16711680)>>>16,N[ee++]=(_e.duration&65280)>>>8,N[ee++]=_e.duration&255,N[ee++]=(_e.size&4278190080)>>>24,N[ee++]=(_e.size&16711680)>>>16,N[ee++]=(_e.size&65280)>>>8,N[ee++]=_e.size&255;return s(ye.trun,N)},Re=function(x,R){return x.type==="audio"?W(x,R):b(x,R)}}();var Z={ftyp:l,mdat:f,moof:y,moov:A,initSegment:function(b){var E=l(),S=A(b),x;return x=new Uint8Array(E.byteLength+S.byteLength),x.set(E),x.set(S,E.byteLength),x}},me=function(b){var E,S,x=[],R=[];for(R.byteLength=0,R.nalCount=0,R.duration=0,x.byteLength=0,E=0;E<b.length;E++)S=b[E],S.nalUnitType==="access_unit_delimiter_rbsp"?(x.length&&(x.duration=S.dts-x.dts,R.byteLength+=x.byteLength,R.nalCount+=x.length,R.duration+=x.duration,R.push(x)),x=[S],x.byteLength=S.data.byteLength,x.pts=S.pts,x.dts=S.dts):(S.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(x.keyFrame=!0),x.duration=S.dts-x.dts,x.byteLength+=S.data.byteLength,x.push(S));return R.length&&(!x.duration||x.duration<=0)&&(x.duration=R[R.length-1].duration),R.byteLength+=x.byteLength,R.nalCount+=x.length,R.duration+=x.duration,R.push(x),R},ke=function(b){var E,S,x=[],R=[];for(x.byteLength=0,x.nalCount=0,x.duration=0,x.pts=b[0].pts,x.dts=b[0].dts,R.byteLength=0,R.nalCount=0,R.duration=0,R.pts=b[0].pts,R.dts=b[0].dts,E=0;E<b.length;E++)S=b[E],S.keyFrame?(x.length&&(R.push(x),R.byteLength+=x.byteLength,R.nalCount+=x.nalCount,R.duration+=x.duration),x=[S],x.nalCount=S.length,x.byteLength=S.byteLength,x.pts=S.pts,x.dts=S.dts,x.duration=S.duration):(x.duration+=S.duration,x.nalCount+=S.length,x.byteLength+=S.byteLength,x.push(S));return R.length&&x.duration<=0&&(x.duration=R[R.length-1].duration),R.byteLength+=x.byteLength,R.nalCount+=x.nalCount,R.duration+=x.duration,R.push(x),R},we=function(b){var E;return!b[0][0].keyFrame&&b.length>1&&(E=b.shift(),b.byteLength-=E.byteLength,b.nalCount-=E.nalCount,b[0][0].dts=E.dts,b[0][0].pts=E.pts,b[0][0].duration+=E.duration),b},st=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},bt=function(b,E){var S=st();return S.dataOffset=E,S.compositionTimeOffset=b.pts-b.dts,S.duration=b.duration,S.size=4*b.length,S.size+=b.byteLength,b.keyFrame&&(S.flags.dependsOn=2,S.flags.isNonSyncSample=0),S},vt=function(b,E){var S,x,R,N,ee,ce=E||0,Te=[];for(S=0;S<b.length;S++)for(N=b[S],x=0;x<N.length;x++)ee=N[x],R=bt(ee,ce),ce+=R.size,Te.push(R);return Te},Ee=function(b){var E,S,x,R,N,ee,ce=0,Te=b.byteLength,_e=b.nalCount,xe=Te+4*_e,Qe=new Uint8Array(xe),wt=new DataView(Qe.buffer);for(E=0;E<b.length;E++)for(R=b[E],S=0;S<R.length;S++)for(N=R[S],x=0;x<N.length;x++)ee=N[x],wt.setUint32(ce,ee.data.byteLength),ce+=4,Qe.set(ee.data,ce),ce+=ee.data.byteLength;return Qe},He=function(b,E){var S,x=E||0,R=[];return S=bt(b,x),R.push(S),R},zt=function(b){var E,S,x=0,R=b.byteLength,N=b.length,ee=R+4*N,ce=new Uint8Array(ee),Te=new DataView(ce.buffer);for(E=0;E<b.length;E++)S=b[E],Te.setUint32(x,S.data.byteLength),x+=4,ce.set(S.data,x),x+=S.data.byteLength;return ce},Ge={groupNalsIntoFrames:me,groupFramesIntoGops:ke,extendFirstKeyFrame:we,generateSampleTable:vt,concatenateNalData:Ee,generateSampleTableForFrame:He,concatenateNalDataForFrame:zt},at=[33,16,5,32,164,27],Ve=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Ae=function(b){for(var E=[];b--;)E.push(0);return E},lt=function(b){return Object.keys(b).reduce(function(E,S){return E[S]=new Uint8Array(b[S].reduce(function(x,R){return x.concat(R)},[])),E},{})},Bt,ct=function(){if(!Bt){var b={96e3:[at,[227,64],Ae(154),[56]],88200:[at,[231],Ae(170),[56]],64e3:[at,[248,192],Ae(240),[56]],48e3:[at,[255,192],Ae(268),[55,148,128],Ae(54),[112]],44100:[at,[255,192],Ae(268),[55,163,128],Ae(84),[112]],32e3:[at,[255,192],Ae(268),[55,234],Ae(226),[112]],24e3:[at,[255,192],Ae(268),[55,255,128],Ae(268),[111,112],Ae(126),[224]],16e3:[at,[255,192],Ae(268),[55,255,128],Ae(268),[111,255],Ae(269),[223,108],Ae(195),[1,192]],12e3:[Ve,Ae(268),[3,127,248],Ae(268),[6,255,240],Ae(268),[13,255,224],Ae(268),[27,253,128],Ae(259),[56]],11025:[Ve,Ae(268),[3,127,248],Ae(268),[6,255,240],Ae(268),[13,255,224],Ae(268),[27,255,192],Ae(268),[55,175,128],Ae(108),[112]],8e3:[Ve,Ae(268),[3,121,16],Ae(47),[7]]};Bt=lt(b)}return Bt},_t=9e4,re,te,be,De,dt,K,le;re=function(b){return b*_t},te=function(b,E){return b*E},be=function(b){return b/_t},De=function(b,E){return b/E},dt=function(b,E){return re(De(b,E))},K=function(b,E){return te(be(b),E)},le=function(b,E,S){return be(S?b:b-E)};var U={ONE_SECOND_IN_TS:_t,secondsToVideoTs:re,secondsToAudioTs:te,videoTsToSeconds:be,audioTsToSeconds:De,audioTsToVideoTs:dt,videoTsToAudioTs:K,metadataTsToSeconds:le},Ne=function(b){var E,S,x=0;for(E=0;E<b.length;E++)S=b[E],x+=S.data.byteLength;return x},Ye=function(b,E,S,x){var R,N=0,ee=0,ce=0,Te=0,_e,xe,Qe;if(E.length&&(R=U.audioTsToVideoTs(b.baseMediaDecodeTime,b.samplerate),N=Math.ceil(U.ONE_SECOND_IN_TS/(b.samplerate/1024)),S&&x&&(ee=R-Math.max(S,x),ce=Math.floor(ee/N),Te=ce*N),!(ce<1||Te>U.ONE_SECOND_IN_TS/2))){for(_e=ct()[b.samplerate],_e||(_e=E[0].data),xe=0;xe<ce;xe++)Qe=E[0],E.splice(0,0,{data:_e,dts:Qe.dts-N,pts:Qe.pts-N});return b.baseMediaDecodeTime-=Math.floor(U.videoTsToAudioTs(Te,b.samplerate)),Te}},ft=function(b,E,S){return E.minSegmentDts>=S?b:(E.minSegmentDts=1/0,b.filter(function(x){return x.dts>=S?(E.minSegmentDts=Math.min(E.minSegmentDts,x.dts),E.minSegmentPts=E.minSegmentDts,!0):!1}))},kt=function(b){var E,S,x=[];for(E=0;E<b.length;E++)S=b[E],x.push({size:S.data.byteLength,duration:1024});return x},Et=function(b){var E,S,x=0,R=new Uint8Array(Ne(b));for(E=0;E<b.length;E++)S=b[E],R.set(S.data,x),x+=S.data.byteLength;return R},Ie={prefixWithSilence:Ye,trimAdtsFramesByEarliestDts:ft,generateSampleTable:kt,concatenateFrameData:Et},Jt=U.ONE_SECOND_IN_TS,Nt=function(b,E){typeof E.pts=="number"&&(b.timelineStartInfo.pts===void 0&&(b.timelineStartInfo.pts=E.pts),b.minSegmentPts===void 0?b.minSegmentPts=E.pts:b.minSegmentPts=Math.min(b.minSegmentPts,E.pts),b.maxSegmentPts===void 0?b.maxSegmentPts=E.pts:b.maxSegmentPts=Math.max(b.maxSegmentPts,E.pts)),typeof E.dts=="number"&&(b.timelineStartInfo.dts===void 0&&(b.timelineStartInfo.dts=E.dts),b.minSegmentDts===void 0?b.minSegmentDts=E.dts:b.minSegmentDts=Math.min(b.minSegmentDts,E.dts),b.maxSegmentDts===void 0?b.maxSegmentDts=E.dts:b.maxSegmentDts=Math.max(b.maxSegmentDts,E.dts))},Ot=function(b){delete b.minSegmentDts,delete b.maxSegmentDts,delete b.minSegmentPts,delete b.maxSegmentPts},qr=function(b,E){var S,x,R=b.minSegmentDts;return E||(R-=b.timelineStartInfo.dts),S=b.timelineStartInfo.baseMediaDecodeTime,S+=R,S=Math.max(0,S),b.type==="audio"&&(x=b.samplerate/Jt,S*=x,S=Math.floor(S)),S},er={clearDtsInfo:Ot,calculateTrackBaseMediaDecodeTime:qr,collectDtsInfo:Nt},hi=4,mr=128,zr=function(b){for(var E=0,S={payloadType:-1,payloadSize:0},x=0,R=0;E<b.byteLength&&b[E]!==mr;){for(;b[E]===255;)x+=255,E++;for(x+=b[E++];b[E]===255;)R+=255,E++;if(R+=b[E++],!S.payload&&x===hi){var N=String.fromCharCode(b[E+3],b[E+4],b[E+5],b[E+6]);if(N==="GA94"){S.payloadType=x,S.payloadSize=R,S.payload=b.subarray(E,E+R);break}else S.payload=void 0}E+=R,x=0,R=0}return S},Pi=function(b){return b.payload[0]!==181||(b.payload[1]<<8|b.payload[2])!==49||String.fromCharCode(b.payload[3],b.payload[4],b.payload[5],b.payload[6])!=="GA94"||b.payload[7]!==3?null:b.payload.subarray(8,b.payload.length-1)},jr=function(b,E){var S=[],x,R,N,ee;if(!(E[0]&64))return S;for(R=E[0]&31,x=0;x<R;x++)N=x*3,ee={type:E[N+2]&3,pts:b},E[N+2]&4&&(ee.ccData=E[N+3]<<8|E[N+4],S.push(ee));return S},rn=function(b){for(var E=b.byteLength,S=[],x=1,R,N;x<E-2;)b[x]===0&&b[x+1]===0&&b[x+2]===3?(S.push(x+2),x+=2):x++;if(S.length===0)return b;R=E-S.length,N=new Uint8Array(R);var ee=0;for(x=0;x<R;ee++,x++)ee===S[0]&&(ee++,S.shift()),N[x]=b[ee];return N},Yr={parseSei:zr,parseUserData:Pi,parseCaptionPackets:jr,discardEmulationPreventionBytes:rn,USER_DATA_REGISTERED_ITU_T_T35:hi},qt=function W(b){b=b||{},W.prototype.init.call(this),this.parse708captions_=typeof b.parse708captions=="boolean"?b.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new gr(0,0),new gr(0,1),new gr(1,0),new gr(1,1)],this.parse708captions_&&(this.cc708Stream_=new Kt({captionServices:b.captionServices})),this.reset(),this.ccStreams_.forEach(function(E){E.on("data",this.trigger.bind(this,"data")),E.on("partialdone",this.trigger.bind(this,"partialdone")),E.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};qt.prototype=new e,qt.prototype.push=function(W){var b,E,S;if(W.nalUnitType==="sei_rbsp"&&(b=Yr.parseSei(W.escapedRBSP),!!b.payload&&b.payloadType===Yr.USER_DATA_REGISTERED_ITU_T_T35&&(E=Yr.parseUserData(b),!!E))){if(W.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(W.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}S=Yr.parseCaptionPackets(W.pts,E),this.captionPackets_=this.captionPackets_.concat(S),this.latestDts_!==W.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=W.dts}},qt.prototype.flushCCStreams=function(W){this.ccStreams_.forEach(function(b){return W==="flush"?b.flush():b.partialFlush()},this)},qt.prototype.flushStream=function(W){if(!this.captionPackets_.length){this.flushCCStreams(W);return}this.captionPackets_.forEach(function(b,E){b.presortIndex=E}),this.captionPackets_.sort(function(b,E){return b.pts===E.pts?b.presortIndex-E.presortIndex:b.pts-E.pts}),this.captionPackets_.forEach(function(b){b.type<2?this.dispatchCea608Packet(b):this.dispatchCea708Packet(b)},this),this.captionPackets_.length=0,this.flushCCStreams(W)},qt.prototype.flush=function(){return this.flushStream("flush")},qt.prototype.partialFlush=function(){return this.flushStream("partialFlush")},qt.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(W){W.reset()})},qt.prototype.dispatchCea608Packet=function(W){this.setsTextOrXDSActive(W)?this.activeCea608Channel_[W.type]=null:this.setsChannel1Active(W)?this.activeCea608Channel_[W.type]=0:this.setsChannel2Active(W)&&(this.activeCea608Channel_[W.type]=1),this.activeCea608Channel_[W.type]!==null&&this.ccStreams_[(W.type<<1)+this.activeCea608Channel_[W.type]].push(W)},qt.prototype.setsChannel1Active=function(W){return(W.ccData&30720)===4096},qt.prototype.setsChannel2Active=function(W){return(W.ccData&30720)===6144},qt.prototype.setsTextOrXDSActive=function(W){return(W.ccData&28928)===256||(W.ccData&30974)===4138||(W.ccData&30974)===6186},qt.prototype.dispatchCea708Packet=function(W){this.parse708captions_&&this.cc708Stream_.push(W)};var gi={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Ai=function(b){var E=gi[b]||b;return b&4096&&b===E?"":String.fromCharCode(E)},tr=function(b){return 32<=b&&b<=127||160<=b&&b<=255},Jr=function(b){this.windowNum=b,this.reset()};Jr.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Jr.prototype.getText=function(){return this.rows.join(`
`)},Jr.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Jr.prototype.newLine=function(W){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(W),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Jr.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Jr.prototype.addText=function(W){this.rows[this.rowIdx]+=W},Jr.prototype.backspace=function(){if(!this.isEmpty()){var W=this.rows[this.rowIdx];this.rows[this.rowIdx]=W.substr(0,W.length-1)}};var Hr=function(b,E,S){this.serviceNum=b,this.text="",this.currentWindow=new Jr(-1),this.windows=[],this.stream=S,typeof E=="string"&&this.createTextDecoder(E)};Hr.prototype.init=function(W,b){this.startPts=W;for(var E=0;E<8;E++)this.windows[E]=new Jr(E),typeof b=="function"&&(this.windows[E].beforeRowOverflow=b)},Hr.prototype.setCurrentWindow=function(W){this.currentWindow=this.windows[W]},Hr.prototype.createTextDecoder=function(W){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(W)}catch(b){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+W+" encoding. "+b})}};var Kt=function W(b){b=b||{},W.prototype.init.call(this);var E=this,S=b.captionServices||{},x={},R;Object.keys(S).forEach(function(N){R=S[N],/^SERVICE/.test(N)&&(x[N]=R.encoding)}),this.serviceEncodings=x,this.current708Packet=null,this.services={},this.push=function(N){N.type===3?(E.new708Packet(),E.add708Bytes(N)):(E.current708Packet===null&&E.new708Packet(),E.add708Bytes(N))}};Kt.prototype=new e,Kt.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Kt.prototype.add708Bytes=function(W){var b=W.ccData,E=b>>>8,S=b&255;this.current708Packet.ptsVals.push(W.pts),this.current708Packet.data.push(E),this.current708Packet.data.push(S)},Kt.prototype.push708Packet=function(){var W=this.current708Packet,b=W.data,E=null,S=null,x=0,R=b[x++];for(W.seq=R>>6,W.sizeCode=R&63;x<b.length;x++)R=b[x++],E=R>>5,S=R&31,E===7&&S>0&&(R=b[x++],E=R),this.pushServiceBlock(E,x,S),S>0&&(x+=S-1)},Kt.prototype.pushServiceBlock=function(W,b,E){var S,x=b,R=this.current708Packet.data,N=this.services[W];for(N||(N=this.initService(W,x));x<b+E&&x<R.length;x++)S=R[x],tr(S)?x=this.handleText(x,N):S===24?x=this.multiByteCharacter(x,N):S===16?x=this.extendedCommands(x,N):128<=S&&S<=135?x=this.setCurrentWindow(x,N):152<=S&&S<=159?x=this.defineWindow(x,N):S===136?x=this.clearWindows(x,N):S===140?x=this.deleteWindows(x,N):S===137?x=this.displayWindows(x,N):S===138?x=this.hideWindows(x,N):S===139?x=this.toggleWindows(x,N):S===151?x=this.setWindowAttributes(x,N):S===144?x=this.setPenAttributes(x,N):S===145?x=this.setPenColor(x,N):S===146?x=this.setPenLocation(x,N):S===143?N=this.reset(x,N):S===8?N.currentWindow.backspace():S===12?N.currentWindow.clearText():S===13?N.currentWindow.pendingNewLine=!0:S===14?N.currentWindow.clearText():S===141&&x++},Kt.prototype.extendedCommands=function(W,b){var E=this.current708Packet.data,S=E[++W];return tr(S)&&(W=this.handleText(W,b,{isExtended:!0})),W},Kt.prototype.getPts=function(W){return this.current708Packet.ptsVals[Math.floor(W/2)]},Kt.prototype.initService=function(W,b){var S="SERVICE"+W,E=this,S,x;return S in this.serviceEncodings&&(x=this.serviceEncodings[S]),this.services[W]=new Hr(W,x,E),this.services[W].init(this.getPts(b),function(R){E.flushDisplayed(R,E.services[W])}),this.services[W]},Kt.prototype.handleText=function(W,b,E){var S=E&&E.isExtended,x=E&&E.isMultiByte,R=this.current708Packet.data,N=S?4096:0,ee=R[W],ce=R[W+1],Te=b.currentWindow,_e,xe;return b.textDecoder_&&!S?(x?(xe=[ee,ce],W++):xe=[ee],_e=b.textDecoder_.decode(new Uint8Array(xe))):_e=Ai(N|ee),Te.pendingNewLine&&!Te.isEmpty()&&Te.newLine(this.getPts(W)),Te.pendingNewLine=!1,Te.addText(_e),W},Kt.prototype.multiByteCharacter=function(W,b){var E=this.current708Packet.data,S=E[W+1],x=E[W+2];return tr(S)&&tr(x)&&(W=this.handleText(++W,b,{isMultiByte:!0})),W},Kt.prototype.setCurrentWindow=function(W,b){var E=this.current708Packet.data,S=E[W],x=S&7;return b.setCurrentWindow(x),W},Kt.prototype.defineWindow=function(W,b){var E=this.current708Packet.data,S=E[W],x=S&7;b.setCurrentWindow(x);var R=b.currentWindow;return S=E[++W],R.visible=(S&32)>>5,R.rowLock=(S&16)>>4,R.columnLock=(S&8)>>3,R.priority=S&7,S=E[++W],R.relativePositioning=(S&128)>>7,R.anchorVertical=S&127,S=E[++W],R.anchorHorizontal=S,S=E[++W],R.anchorPoint=(S&240)>>4,R.rowCount=S&15,S=E[++W],R.columnCount=S&63,S=E[++W],R.windowStyle=(S&56)>>3,R.penStyle=S&7,R.virtualRowCount=R.rowCount+1,W},Kt.prototype.setWindowAttributes=function(W,b){var E=this.current708Packet.data,S=E[W],x=b.currentWindow.winAttr;return S=E[++W],x.fillOpacity=(S&192)>>6,x.fillRed=(S&48)>>4,x.fillGreen=(S&12)>>2,x.fillBlue=S&3,S=E[++W],x.borderType=(S&192)>>6,x.borderRed=(S&48)>>4,x.borderGreen=(S&12)>>2,x.borderBlue=S&3,S=E[++W],x.borderType+=(S&128)>>5,x.wordWrap=(S&64)>>6,x.printDirection=(S&48)>>4,x.scrollDirection=(S&12)>>2,x.justify=S&3,S=E[++W],x.effectSpeed=(S&240)>>4,x.effectDirection=(S&12)>>2,x.displayEffect=S&3,W},Kt.prototype.flushDisplayed=function(W,b){for(var E=[],S=0;S<8;S++)b.windows[S].visible&&!b.windows[S].isEmpty()&&E.push(b.windows[S].getText());b.endPts=W,b.text=E.join(`

`),this.pushCaption(b),b.startPts=W},Kt.prototype.pushCaption=function(W){W.text!==""&&(this.trigger("data",{startPts:W.startPts,endPts:W.endPts,text:W.text,stream:"cc708_"+W.serviceNum}),W.text="",W.startPts=W.endPts)},Kt.prototype.displayWindows=function(W,b){var E=this.current708Packet.data,S=E[++W],x=this.getPts(W);this.flushDisplayed(x,b);for(var R=0;R<8;R++)S&1<<R&&(b.windows[R].visible=1);return W},Kt.prototype.hideWindows=function(W,b){var E=this.current708Packet.data,S=E[++W],x=this.getPts(W);this.flushDisplayed(x,b);for(var R=0;R<8;R++)S&1<<R&&(b.windows[R].visible=0);return W},Kt.prototype.toggleWindows=function(W,b){var E=this.current708Packet.data,S=E[++W],x=this.getPts(W);this.flushDisplayed(x,b);for(var R=0;R<8;R++)S&1<<R&&(b.windows[R].visible^=1);return W},Kt.prototype.clearWindows=function(W,b){var E=this.current708Packet.data,S=E[++W],x=this.getPts(W);this.flushDisplayed(x,b);for(var R=0;R<8;R++)S&1<<R&&b.windows[R].clearText();return W},Kt.prototype.deleteWindows=function(W,b){var E=this.current708Packet.data,S=E[++W],x=this.getPts(W);this.flushDisplayed(x,b);for(var R=0;R<8;R++)S&1<<R&&b.windows[R].reset();return W},Kt.prototype.setPenAttributes=function(W,b){var E=this.current708Packet.data,S=E[W],x=b.currentWindow.penAttr;return S=E[++W],x.textTag=(S&240)>>4,x.offset=(S&12)>>2,x.penSize=S&3,S=E[++W],x.italics=(S&128)>>7,x.underline=(S&64)>>6,x.edgeType=(S&56)>>3,x.fontStyle=S&7,W},Kt.prototype.setPenColor=function(W,b){var E=this.current708Packet.data,S=E[W],x=b.currentWindow.penColor;return S=E[++W],x.fgOpacity=(S&192)>>6,x.fgRed=(S&48)>>4,x.fgGreen=(S&12)>>2,x.fgBlue=S&3,S=E[++W],x.bgOpacity=(S&192)>>6,x.bgRed=(S&48)>>4,x.bgGreen=(S&12)>>2,x.bgBlue=S&3,S=E[++W],x.edgeRed=(S&48)>>4,x.edgeGreen=(S&12)>>2,x.edgeBlue=S&3,W},Kt.prototype.setPenLocation=function(W,b){var E=this.current708Packet.data,S=E[W],x=b.currentWindow.penLoc;return b.currentWindow.pendingNewLine=!0,S=E[++W],x.row=S&15,S=E[++W],x.column=S&63,W},Kt.prototype.reset=function(W,b){var E=this.getPts(W);return this.flushDisplayed(E,b),this.initService(b.serviceNum,W)};var Er={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ln=function(b){return b===null?"":(b=Er[b]||b,String.fromCharCode(b))},Pn=14,dn=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],pa=function(){for(var b=[],E=Pn+1;E--;)b.push("");return b},gr=function W(b,E){W.prototype.init.call(this),this.field_=b||0,this.dataChannel_=E||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(S){var x,R,N,ee,ce;if(x=S.ccData&32639,x===this.lastControlCode_){this.lastControlCode_=null;return}if((x&61440)===4096?this.lastControlCode_=x:x!==this.PADDING_&&(this.lastControlCode_=null),N=x>>>8,ee=x&255,x!==this.PADDING_)if(x===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(x===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(S.pts),this.flushDisplayed(S.pts),R=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=R,this.startPts_=S.pts;else if(x===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(S.pts);else if(x===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(S.pts);else if(x===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(S.pts);else if(x===this.CARRIAGE_RETURN_)this.clearFormatting(S.pts),this.flushDisplayed(S.pts),this.shiftRowsUp_(),this.startPts_=S.pts;else if(x===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(x===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(S.pts),this.displayed_=pa();else if(x===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=pa();else if(x===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(S.pts),this.displayed_=pa()),this.mode_="paintOn",this.startPts_=S.pts;else if(this.isSpecialCharacter(N,ee))N=(N&3)<<8,ce=ln(N|ee),this[this.mode_](S.pts,ce),this.column_++;else if(this.isExtCharacter(N,ee))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),N=(N&3)<<8,ce=ln(N|ee),this[this.mode_](S.pts,ce),this.column_++;else if(this.isMidRowCode(N,ee))this.clearFormatting(S.pts),this[this.mode_](S.pts," "),this.column_++,(ee&14)===14&&this.addFormatting(S.pts,["i"]),(ee&1)===1&&this.addFormatting(S.pts,["u"]);else if(this.isOffsetControlCode(N,ee))this.column_+=ee&3;else if(this.isPAC(N,ee)){var Te=dn.indexOf(x&7968);this.mode_==="rollUp"&&(Te-this.rollUpRows_+1<0&&(Te=this.rollUpRows_-1),this.setRollUp(S.pts,Te)),Te!==this.row_&&(this.clearFormatting(S.pts),this.row_=Te),ee&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(S.pts,["u"]),(x&16)===16&&(this.column_=((x&14)>>1)*4),this.isColorPAC(ee)&&(ee&14)===14&&this.addFormatting(S.pts,["i"])}else this.isNormalChar(N)&&(ee===0&&(ee=null),ce=ln(N),ce+=ln(ee),this[this.mode_](S.pts,ce),this.column_+=ce.length)}};gr.prototype=new e,gr.prototype.flushDisplayed=function(W){var b=this.displayed_.map(function(E,S){try{return E.trim()}catch{return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+S+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");b.length&&this.trigger("data",{startPts:this.startPts_,endPts:W,text:b,stream:this.name_})},gr.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=pa(),this.nonDisplayed_=pa(),this.lastControlCode_=null,this.column_=0,this.row_=Pn,this.rollUpRows_=2,this.formatting_=[]},gr.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},gr.prototype.isSpecialCharacter=function(W,b){return W===this.EXT_&&b>=48&&b<=63},gr.prototype.isExtCharacter=function(W,b){return(W===this.EXT_+1||W===this.EXT_+2)&&b>=32&&b<=63},gr.prototype.isMidRowCode=function(W,b){return W===this.EXT_&&b>=32&&b<=47},gr.prototype.isOffsetControlCode=function(W,b){return W===this.OFFSET_&&b>=33&&b<=35},gr.prototype.isPAC=function(W,b){return W>=this.BASE_&&W<this.BASE_+8&&b>=64&&b<=127},gr.prototype.isColorPAC=function(W){return W>=64&&W<=79||W>=96&&W<=127},gr.prototype.isNormalChar=function(W){return W>=32&&W<=127},gr.prototype.setRollUp=function(W,b){if(this.mode_!=="rollUp"&&(this.row_=Pn,this.mode_="rollUp",this.flushDisplayed(W),this.nonDisplayed_=pa(),this.displayed_=pa()),b!==void 0&&b!==this.row_)for(var E=0;E<this.rollUpRows_;E++)this.displayed_[b-E]=this.displayed_[this.row_-E],this.displayed_[this.row_-E]="";b===void 0&&(b=this.row_),this.topRow_=b-this.rollUpRows_+1},gr.prototype.addFormatting=function(W,b){this.formatting_=this.formatting_.concat(b);var E=b.reduce(function(S,x){return S+"<"+x+">"},"");this[this.mode_](W,E)},gr.prototype.clearFormatting=function(W){if(this.formatting_.length){var b=this.formatting_.reverse().reduce(function(E,S){return E+"</"+S+">"},"");this.formatting_=[],this[this.mode_](W,b)}},gr.prototype.popOn=function(W,b){var E=this.nonDisplayed_[this.row_];E+=b,this.nonDisplayed_[this.row_]=E},gr.prototype.rollUp=function(W,b){var E=this.displayed_[this.row_];E+=b,this.displayed_[this.row_]=E},gr.prototype.shiftRowsUp_=function(){var W;for(W=0;W<this.topRow_;W++)this.displayed_[W]="";for(W=this.row_+1;W<Pn+1;W++)this.displayed_[W]="";for(W=this.topRow_;W<this.row_;W++)this.displayed_[W]=this.displayed_[W+1];this.displayed_[this.row_]=""},gr.prototype.paintOn=function(W,b){var E=this.displayed_[this.row_];E+=b,this.displayed_[this.row_]=E};var mi={CaptionStream:qt,Cea608Stream:gr,Cea708Stream:Kt},vi={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},ha=8589934592,Ka=4294967296,ro="shared",wn=function(b,E){var S=1;for(b>E&&(S=-1);Math.abs(E-b)>Ka;)b+=S*ha;return b},Wr=function W(b){var E,S;W.prototype.init.call(this),this.type_=b||ro,this.push=function(x){this.type_!==ro&&x.type!==this.type_||(S===void 0&&(S=x.dts),x.dts=wn(x.dts,S),x.pts=wn(x.pts,S),E=x.dts,this.trigger("data",x))},this.flush=function(){S=E,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){S=void 0,E=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Wr.prototype=new e;var Qr={TimestampRolloverStream:Wr,handleRollover:wn},Ii=function(b,E,S){var x,R="";for(x=E;x<S;x++)R+="%"+("00"+b[x].toString(16)).slice(-2);return R},ps=function(b,E,S){return decodeURIComponent(Ii(b,E,S))},Xa=function(b,E,S){return unescape(Ii(b,E,S))},lr=function(b){return b[0]<<21|b[1]<<14|b[2]<<7|b[3]},Rn={TXXX:function(b){var E;if(b.data[0]===3){for(E=1;E<b.data.length;E++)if(b.data[E]===0){b.description=ps(b.data,1,E),b.value=ps(b.data,E+1,b.data.length).replace(/\0*$/,"");break}b.data=b.value}},WXXX:function(b){var E;if(b.data[0]===3){for(E=1;E<b.data.length;E++)if(b.data[E]===0){b.description=ps(b.data,1,E),b.url=ps(b.data,E+1,b.data.length);break}}},PRIV:function(b){var E;for(E=0;E<b.data.length;E++)if(b.data[E]===0){b.owner=Xa(b.data,0,E);break}b.privateData=b.data.subarray(E+1),b.data=b.privateData}},Dt;Dt=function(b){var E={descriptor:b&&b.descriptor},S=0,x=[],R=0,N;if(Dt.prototype.init.call(this),this.dispatchType=vi.METADATA_STREAM_TYPE.toString(16),E.descriptor)for(N=0;N<E.descriptor.length;N++)this.dispatchType+=("00"+E.descriptor[N].toString(16)).slice(-2);this.push=function(ee){var ce,Te,_e,xe,Qe,wt;if(ee.type==="timed-metadata"){if(ee.dataAlignmentIndicator&&(R=0,x.length=0),x.length===0&&(ee.data.length<10||ee.data[0]!==73||ee.data[1]!==68||ee.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(x.push(ee),R+=ee.data.byteLength,x.length===1&&(S=lr(ee.data.subarray(6,10)),S+=10),!(R<S)){for(ce={data:new Uint8Array(S),frames:[],pts:x[0].pts,dts:x[0].dts},Qe=0;Qe<S;)ce.data.set(x[0].data.subarray(0,S-Qe),Qe),Qe+=x[0].data.byteLength,R-=x[0].data.byteLength,x.shift();Te=10,ce.data[5]&64&&(Te+=4,Te+=lr(ce.data.subarray(10,14)),S-=lr(ce.data.subarray(16,20)));do{if(_e=lr(ce.data.subarray(Te+4,Te+8)),_e<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping metadata parsing."});return}if(wt=String.fromCharCode(ce.data[Te],ce.data[Te+1],ce.data[Te+2],ce.data[Te+3]),xe={id:wt,data:ce.data.subarray(Te+10,Te+_e+10)},xe.key=xe.id,Rn[xe.id]&&(Rn[xe.id](xe),xe.owner==="com.apple.streaming.transportStreamTimestamp")){var Pt=xe.data,mt=(Pt[3]&1)<<30|Pt[4]<<22|Pt[5]<<14|Pt[6]<<6|Pt[7]>>>2;mt*=4,mt+=Pt[7]&3,xe.timeStamp=mt,ce.pts===void 0&&ce.dts===void 0&&(ce.pts=xe.timeStamp,ce.dts=xe.timeStamp),this.trigger("timestamp",xe)}ce.frames.push(xe),Te+=10,Te+=_e}while(Te<S);this.trigger("data",ce)}}}},Dt.prototype=new e;var Ht=Dt,fr=Qr.TimestampRolloverStream,Vt,Pr,nn,Tn=188,Dn=71;Vt=function(){var b=new Uint8Array(Tn),E=0;Vt.prototype.init.call(this),this.push=function(S){var x=0,R=Tn,N;for(E?(N=new Uint8Array(S.byteLength+E),N.set(b.subarray(0,E)),N.set(S,E),E=0):N=S;R<N.byteLength;){if(N[x]===Dn&&N[R]===Dn){this.trigger("data",N.subarray(x,R)),x+=Tn,R+=Tn;continue}x++,R++}x<N.byteLength&&(b.set(N.subarray(x),0),E=N.byteLength-x)},this.flush=function(){E===Tn&&b[0]===Dn&&(this.trigger("data",b),E=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){E=0,this.trigger("reset")}},Vt.prototype=new e,Pr=function(){var b,E,S,x;Pr.prototype.init.call(this),x=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,b=function(N,ee){var ce=0;ee.payloadUnitStartIndicator&&(ce+=N[ce]+1),ee.type==="pat"?E(N.subarray(ce),ee):S(N.subarray(ce),ee)},E=function(N,ee){ee.section_number=N[7],ee.last_section_number=N[8],x.pmtPid=(N[10]&31)<<8|N[11],ee.pmtPid=x.pmtPid},S=function(N,ee){var ce,Te,_e,xe;if(N[5]&1){for(x.programMapTable={video:null,audio:null,"timed-metadata":{}},ce=(N[1]&15)<<8|N[2],Te=3+ce-4,_e=(N[10]&15)<<8|N[11],xe=12+_e;xe<Te;){var Qe=N[xe],wt=(N[xe+1]&31)<<8|N[xe+2];Qe===vi.H264_STREAM_TYPE&&x.programMapTable.video===null?x.programMapTable.video=wt:Qe===vi.ADTS_STREAM_TYPE&&x.programMapTable.audio===null?x.programMapTable.audio=wt:Qe===vi.METADATA_STREAM_TYPE&&(x.programMapTable["timed-metadata"][wt]=Qe),xe+=((N[xe+3]&15)<<8|N[xe+4])+5}ee.programMapTable=x.programMapTable}},this.push=function(R){var N={},ee=4;if(N.payloadUnitStartIndicator=!!(R[1]&64),N.pid=R[1]&31,N.pid<<=8,N.pid|=R[2],(R[3]&48)>>>4>1&&(ee+=R[ee]+1),N.pid===0)N.type="pat",b(R.subarray(ee),N),this.trigger("data",N);else if(N.pid===this.pmtPid)for(N.type="pmt",b(R.subarray(ee),N),this.trigger("data",N);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([R,ee,N]):this.processPes_(R,ee,N)},this.processPes_=function(R,N,ee){ee.pid===this.programMapTable.video?ee.streamType=vi.H264_STREAM_TYPE:ee.pid===this.programMapTable.audio?ee.streamType=vi.ADTS_STREAM_TYPE:ee.streamType=this.programMapTable["timed-metadata"][ee.pid],ee.type="pes",ee.data=R.subarray(N),this.trigger("data",ee)}},Pr.prototype=new e,Pr.STREAM_TYPES={h264:27,adts:15},nn=function(){var b=this,E=!1,S={data:[],size:0},x={data:[],size:0},R={data:[],size:0},N,ee=function(_e,xe){var Qe,wt=_e[0]<<16|_e[1]<<8|_e[2];xe.data=new Uint8Array,wt===1&&(xe.packetLength=6+(_e[4]<<8|_e[5]),xe.dataAlignmentIndicator=(_e[6]&4)!==0,Qe=_e[7],Qe&192&&(xe.pts=(_e[9]&14)<<27|(_e[10]&255)<<20|(_e[11]&254)<<12|(_e[12]&255)<<5|(_e[13]&254)>>>3,xe.pts*=4,xe.pts+=(_e[13]&6)>>>1,xe.dts=xe.pts,Qe&64&&(xe.dts=(_e[14]&14)<<27|(_e[15]&255)<<20|(_e[16]&254)<<12|(_e[17]&255)<<5|(_e[18]&254)>>>3,xe.dts*=4,xe.dts+=(_e[18]&6)>>>1)),xe.data=_e.subarray(9+_e[8]))},ce=function(_e,xe,Qe){var wt=new Uint8Array(_e.size),Pt={type:xe},mt=0,Gt=0,qi=!1,Ji;if(!(!_e.data.length||_e.size<9)){for(Pt.trackId=_e.data[0].pid,mt=0;mt<_e.data.length;mt++)Ji=_e.data[mt],wt.set(Ji.data,Gt),Gt+=Ji.data.byteLength;ee(wt,Pt),qi=xe==="video"||Pt.packetLength<=_e.size,(Qe||qi)&&(_e.size=0,_e.data.length=0),qi&&b.trigger("data",Pt)}};nn.prototype.init.call(this),this.push=function(Te){({pat:function(){},pes:function(){var xe,Qe;switch(Te.streamType){case vi.H264_STREAM_TYPE:xe=S,Qe="video";break;case vi.ADTS_STREAM_TYPE:xe=x,Qe="audio";break;case vi.METADATA_STREAM_TYPE:xe=R,Qe="timed-metadata";break;default:return}Te.payloadUnitStartIndicator&&ce(xe,Qe,!0),xe.data.push(Te),xe.size+=Te.data.byteLength},pmt:function(){var xe={type:"metadata",tracks:[]};N=Te.programMapTable,N.video!==null&&xe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.video,codec:"avc",type:"video"}),N.audio!==null&&xe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.audio,codec:"adts",type:"audio"}),E=!0,b.trigger("data",xe)}})[Te.type]()},this.reset=function(){S.size=0,S.data.length=0,x.size=0,x.data.length=0,this.trigger("reset")},this.flushStreams_=function(){ce(S,"video"),ce(x,"audio"),ce(R,"timed-metadata")},this.flush=function(){if(!E&&N){var Te={type:"metadata",tracks:[]};N.video!==null&&Te.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.video,codec:"avc",type:"video"}),N.audio!==null&&Te.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.audio,codec:"adts",type:"audio"}),b.trigger("data",Te)}E=!1,this.flushStreams_(),this.trigger("done")}},nn.prototype=new e;var Zr={PAT_PID:0,MP2T_PACKET_LENGTH:Tn,TransportPacketStream:Vt,TransportParseStream:Pr,ElementaryStream:nn,TimestampRolloverStream:fr,CaptionStream:mi.CaptionStream,Cea608Stream:mi.Cea608Stream,Cea708Stream:mi.Cea708Stream,MetadataStream:Ht};for(var yi in vi)vi.hasOwnProperty(yi)&&(Zr[yi]=vi[yi]);var Sn=Zr,Vn=U.ONE_SECOND_IN_TS,Ln,O=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Ln=function(b){var E,S=0;Ln.prototype.init.call(this),this.skipWarn_=function(x,R){this.trigger("log",{level:"warn",message:"adts skiping bytes "+x+" to "+R+" in frame "+S+" outside syncword"})},this.push=function(x){var R=0,N,ee,ce,Te,_e;if(b||(S=0),x.type==="audio"){E&&E.length?(ce=E,E=new Uint8Array(ce.byteLength+x.data.byteLength),E.set(ce),E.set(x.data,ce.byteLength)):E=x.data;for(var xe;R+7<E.length;){if(E[R]!==255||(E[R+1]&246)!==240){typeof xe!="number"&&(xe=R),R++;continue}if(typeof xe=="number"&&(this.skipWarn_(xe,R),xe=null),ee=(~E[R+1]&1)*2,N=(E[R+3]&3)<<11|E[R+4]<<3|(E[R+5]&224)>>5,Te=((E[R+6]&3)+1)*1024,_e=Te*Vn/O[(E[R+2]&60)>>>2],E.byteLength-R<N)break;this.trigger("data",{pts:x.pts+S*_e,dts:x.dts+S*_e,sampleCount:Te,audioobjecttype:(E[R+2]>>>6&3)+1,channelcount:(E[R+2]&1)<<2|(E[R+3]&192)>>>6,samplerate:O[(E[R+2]&60)>>>2],samplingfrequencyindex:(E[R+2]&60)>>>2,samplesize:16,data:E.subarray(R+7+ee,R+N)}),S++,R+=N}typeof xe=="number"&&(this.skipWarn_(xe,R),xe=null),E=E.subarray(R)}},this.flush=function(){S=0,this.trigger("done")},this.reset=function(){E=void 0,this.trigger("reset")},this.endTimeline=function(){E=void 0,this.trigger("endedtimeline")}},Ln.prototype=new e;var q=Ln,ae;ae=function(b){var E=b.byteLength,S=0,x=0;this.length=function(){return 8*E},this.bitsAvailable=function(){return 8*E+x},this.loadWord=function(){var R=b.byteLength-E,N=new Uint8Array(4),ee=Math.min(4,E);if(ee===0)throw new Error("no bytes available");N.set(b.subarray(R,R+ee)),S=new DataView(N.buffer).getUint32(0),x=ee*8,E-=ee},this.skipBits=function(R){var N;x>R?(S<<=R,x-=R):(R-=x,N=Math.floor(R/8),R-=N*8,E-=N,this.loadWord(),S<<=R,x-=R)},this.readBits=function(R){var N=Math.min(x,R),ee=S>>>32-N;return x-=N,x>0?S<<=N:E>0&&this.loadWord(),N=R-N,N>0?ee<<N|this.readBits(N):ee},this.skipLeadingZeros=function(){var R;for(R=0;R<x;++R)if((S&2147483648>>>R)!==0)return S<<=R,x-=R,R;return this.loadWord(),R+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var R=this.skipLeadingZeros();return this.readBits(R+1)-1},this.readExpGolomb=function(){var R=this.readUnsignedExpGolomb();return 1&R?1+R>>>1:-1*(R>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var $e=ae,Ke,pt,Wt;pt=function(){var b=0,E,S;pt.prototype.init.call(this),this.push=function(x){var R;S?(R=new Uint8Array(S.byteLength+x.data.byteLength),R.set(S),R.set(x.data,S.byteLength),S=R):S=x.data;for(var N=S.byteLength;b<N-3;b++)if(S[b+2]===1){E=b+5;break}for(;E<N;)switch(S[E]){case 0:if(S[E-1]!==0){E+=2;break}else if(S[E-2]!==0){E++;break}b+3!==E-2&&this.trigger("data",S.subarray(b+3,E-2));do E++;while(S[E]!==1&&E<N);b=E-2,E+=3;break;case 1:if(S[E-1]!==0||S[E-2]!==0){E+=3;break}this.trigger("data",S.subarray(b+3,E-2)),b=E-2,E+=3;break;default:E+=3;break}S=S.subarray(b),E-=b,b=0},this.reset=function(){S=null,b=0,this.trigger("reset")},this.flush=function(){S&&S.byteLength>3&&this.trigger("data",S.subarray(b+3)),S=null,b=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},pt.prototype=new e,Wt={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Ke=function(){var b=new pt,E,S,x,R,N,ee,ce;Ke.prototype.init.call(this),E=this,this.push=function(Te){Te.type==="video"&&(S=Te.trackId,x=Te.pts,R=Te.dts,b.push(Te))},b.on("data",function(Te){var _e={trackId:S,pts:x,dts:R,data:Te,nalUnitTypeCode:Te[0]&31};switch(_e.nalUnitTypeCode){case 5:_e.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:_e.nalUnitType="sei_rbsp",_e.escapedRBSP=N(Te.subarray(1));break;case 7:_e.nalUnitType="seq_parameter_set_rbsp",_e.escapedRBSP=N(Te.subarray(1)),_e.config=ee(_e.escapedRBSP);break;case 8:_e.nalUnitType="pic_parameter_set_rbsp";break;case 9:_e.nalUnitType="access_unit_delimiter_rbsp";break}E.trigger("data",_e)}),b.on("done",function(){E.trigger("done")}),b.on("partialdone",function(){E.trigger("partialdone")}),b.on("reset",function(){E.trigger("reset")}),b.on("endedtimeline",function(){E.trigger("endedtimeline")}),this.flush=function(){b.flush()},this.partialFlush=function(){b.partialFlush()},this.reset=function(){b.reset()},this.endTimeline=function(){b.endTimeline()},ce=function(_e,xe){var Qe=8,wt=8,Pt,mt;for(Pt=0;Pt<_e;Pt++)wt!==0&&(mt=xe.readExpGolomb(),wt=(Qe+mt+256)%256),Qe=wt===0?Qe:wt},N=function(_e){for(var xe=_e.byteLength,Qe=[],wt=1,Pt,mt;wt<xe-2;)_e[wt]===0&&_e[wt+1]===0&&_e[wt+2]===3?(Qe.push(wt+2),wt+=2):wt++;if(Qe.length===0)return _e;Pt=xe-Qe.length,mt=new Uint8Array(Pt);var Gt=0;for(wt=0;wt<Pt;Gt++,wt++)Gt===Qe[0]&&(Gt++,Qe.shift()),mt[wt]=_e[Gt];return mt},ee=function(_e){var xe=0,Qe=0,wt=0,Pt=0,mt,Gt,qi,Ji,Ya,Gl,qg,jg,Hg,Wf,Vl,Ur=[1,1],Gg,ao;if(mt=new $e(_e),Gt=mt.readUnsignedByte(),Ji=mt.readUnsignedByte(),qi=mt.readUnsignedByte(),mt.skipUnsignedExpGolomb(),Wt[Gt]&&(Ya=mt.readUnsignedExpGolomb(),Ya===3&&mt.skipBits(1),mt.skipUnsignedExpGolomb(),mt.skipUnsignedExpGolomb(),mt.skipBits(1),mt.readBoolean()))for(Vl=Ya!==3?8:12,ao=0;ao<Vl;ao++)mt.readBoolean()&&(ao<6?ce(16,mt):ce(64,mt));if(mt.skipUnsignedExpGolomb(),Gl=mt.readUnsignedExpGolomb(),Gl===0)mt.readUnsignedExpGolomb();else if(Gl===1)for(mt.skipBits(1),mt.skipExpGolomb(),mt.skipExpGolomb(),qg=mt.readUnsignedExpGolomb(),ao=0;ao<qg;ao++)mt.skipExpGolomb();if(mt.skipUnsignedExpGolomb(),mt.skipBits(1),jg=mt.readUnsignedExpGolomb(),Hg=mt.readUnsignedExpGolomb(),Wf=mt.readBits(1),Wf===0&&mt.skipBits(1),mt.skipBits(1),mt.readBoolean()&&(xe=mt.readUnsignedExpGolomb(),Qe=mt.readUnsignedExpGolomb(),wt=mt.readUnsignedExpGolomb(),Pt=mt.readUnsignedExpGolomb()),mt.readBoolean()&&mt.readBoolean()){switch(Gg=mt.readUnsignedByte(),Gg){case 1:Ur=[1,1];break;case 2:Ur=[12,11];break;case 3:Ur=[10,11];break;case 4:Ur=[16,11];break;case 5:Ur=[40,33];break;case 6:Ur=[24,11];break;case 7:Ur=[20,11];break;case 8:Ur=[32,11];break;case 9:Ur=[80,33];break;case 10:Ur=[18,11];break;case 11:Ur=[15,11];break;case 12:Ur=[64,33];break;case 13:Ur=[160,99];break;case 14:Ur=[4,3];break;case 15:Ur=[3,2];break;case 16:Ur=[2,1];break;case 255:{Ur=[mt.readUnsignedByte()<<8|mt.readUnsignedByte(),mt.readUnsignedByte()<<8|mt.readUnsignedByte()];break}}Ur&&Ur[0]/Ur[1]}return{profileIdc:Gt,levelIdc:qi,profileCompatibility:Ji,width:(jg+1)*16-xe*2-Qe*2,height:(2-Wf)*(Hg+1)*16-wt*2-Pt*2,sarRatio:Ur}}},Ke.prototype=new e;var Rr={H264Stream:Ke,NalByteStream:pt},xt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Qt=function(b,E){var S=b[E+6]<<21|b[E+7]<<14|b[E+8]<<7|b[E+9],x=b[E+5],R=(x&16)>>4;return S=S>=0?S:0,R?S+20:S+10},Lt=function W(b,E){return b.length-E<10||b[E]!==73||b[E+1]!==68||b[E+2]!==51?E:(E+=Qt(b,E),W(b,E))},zn=function(b){var E=Lt(b,0);return b.length>=E+2&&(b[E]&255)===255&&(b[E+1]&240)===240&&(b[E+1]&22)===16},fn=function(b){return b[0]<<21|b[1]<<14|b[2]<<7|b[3]},nr=function(b,E,S){var x,R="";for(x=E;x<S;x++)R+="%"+("00"+b[x].toString(16)).slice(-2);return R},Nn=function(b,E,S){return unescape(nr(b,E,S))},bi=function(b,E){var S=(b[E+5]&224)>>5,x=b[E+4]<<3,R=b[E+3]&6144;return R|x|S},oi=function(b,E){return b[E]===73&&b[E+1]===68&&b[E+2]===51?"timed-metadata":b[E]&!0&&(b[E+1]&240)===240?"audio":null},Gr=function(b){for(var E=0;E+5<b.length;){if(b[E]!==255||(b[E+1]&246)!==240){E++;continue}return xt[(b[E+2]&60)>>>2]}return null},Bi=function(b){var E,S,x,R;E=10,b[5]&64&&(E+=4,E+=fn(b.subarray(10,14)));do{if(S=fn(b.subarray(E+4,E+8)),S<1)return null;if(R=String.fromCharCode(b[E],b[E+1],b[E+2],b[E+3]),R==="PRIV"){x=b.subarray(E+10,E+S+10);for(var N=0;N<x.byteLength;N++)if(x[N]===0){var ee=Nn(x,0,N);if(ee==="com.apple.streaming.transportStreamTimestamp"){var ce=x.subarray(N+1),Te=(ce[3]&1)<<30|ce[4]<<22|ce[5]<<14|ce[6]<<6|ce[7]>>>2;return Te*=4,Te+=ce[7]&3,Te}break}}E+=10,E+=S}while(E<b.byteLength);return null},ki={isLikelyAacData:zn,parseId3TagSize:Qt,parseAdtsSize:bi,parseType:oi,parseSampleRate:Gr,parseAacTimestamp:Bi},Xi;Xi=function(){var b=new Uint8Array,E=0;Xi.prototype.init.call(this),this.setTimestamp=function(S){E=S},this.push=function(S){var x=0,R=0,N,ee,ce,Te;for(b.length?(Te=b.length,b=new Uint8Array(S.byteLength+Te),b.set(b.subarray(0,Te)),b.set(S,Te)):b=S;b.length-R>=3;){if(b[R]===73&&b[R+1]===68&&b[R+2]===51){if(b.length-R<10||(x=ki.parseId3TagSize(b,R),R+x>b.length))break;ee={type:"timed-metadata",data:b.subarray(R,R+x)},this.trigger("data",ee),R+=x;continue}else if((b[R]&255)===255&&(b[R+1]&240)===240){if(b.length-R<7||(x=ki.parseAdtsSize(b,R),R+x>b.length))break;ce={type:"audio",data:b.subarray(R,R+x),pts:E,dts:E},this.trigger("data",ce),R+=x;continue}R++}N=b.length-R,N>0?b=b.subarray(R):b=new Uint8Array},this.reset=function(){b=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){b=new Uint8Array,this.trigger("endedtimeline")}},Xi.prototype=new e;var ei=Xi,pn=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Ac=pn,Lo=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],jt=Lo,hr=Rr.H264Stream,vr=ki.isLikelyAacData,ti=U.ONE_SECOND_IN_TS,xr,Dr,Ra,hn,No=function(b,E){E.stream=b,this.trigger("log",E)},Ri=function(b,E){for(var S=Object.keys(E),x=0;x<S.length;x++){var R=S[x];R==="headOfPipeline"||!E[R].on||E[R].on("log",No.bind(b,R))}},Du=function(b,E){var S;if(b.length!==E.length)return!1;for(S=0;S<b.length;S++)if(b[S]!==E[S])return!1;return!0},Mo=function(b,E,S,x,R,N){var ee=S-E,ce=x-E,Te=R-S;return{start:{dts:b,pts:b+ee},end:{dts:b+ce,pts:b+Te},prependedContentDuration:N,baseMediaDecodeTime:b}};Dr=function(b,E){var S=[],x,R=0,N=0,ee=1/0;E=E||{},x=E.firstSequenceNumber||0,Dr.prototype.init.call(this),this.push=function(ce){er.collectDtsInfo(b,ce),b&&Ac.forEach(function(Te){b[Te]=ce[Te]}),S.push(ce)},this.setEarliestDts=function(ce){R=ce},this.setVideoBaseMediaDecodeTime=function(ce){ee=ce},this.setAudioAppendStart=function(ce){N=ce},this.flush=function(){var ce,Te,_e,xe,Qe,wt,Pt;if(S.length===0){this.trigger("done","AudioSegmentStream");return}ce=Ie.trimAdtsFramesByEarliestDts(S,b,R),b.baseMediaDecodeTime=er.calculateTrackBaseMediaDecodeTime(b,E.keepOriginalTimestamps),Pt=Ie.prefixWithSilence(b,ce,N,ee),b.samples=Ie.generateSampleTable(ce),_e=Z.mdat(Ie.concatenateFrameData(ce)),S=[],Te=Z.moof(x,[b]),xe=new Uint8Array(Te.byteLength+_e.byteLength),x++,xe.set(Te),xe.set(_e,Te.byteLength),er.clearDtsInfo(b),Qe=Math.ceil(ti*1024/b.samplerate),ce.length&&(wt=ce.length*Qe,this.trigger("segmentTimingInfo",Mo(U.audioTsToVideoTs(b.baseMediaDecodeTime,b.samplerate),ce[0].dts,ce[0].pts,ce[0].dts+wt,ce[0].pts+wt,Pt||0)),this.trigger("timingInfo",{start:ce[0].pts,end:ce[0].pts+wt})),this.trigger("data",{track:b,boxes:xe}),this.trigger("done","AudioSegmentStream")},this.reset=function(){er.clearDtsInfo(b),S=[],this.trigger("reset")}},Dr.prototype=new e,xr=function(b,E){var S,x=[],R=[],N,ee;E=E||{},S=E.firstSequenceNumber||0,xr.prototype.init.call(this),delete b.minPTS,this.gopCache_=[],this.push=function(ce){er.collectDtsInfo(b,ce),ce.nalUnitType==="seq_parameter_set_rbsp"&&!N&&(N=ce.config,b.sps=[ce.data],jt.forEach(function(Te){b[Te]=N[Te]},this)),ce.nalUnitType==="pic_parameter_set_rbsp"&&!ee&&(ee=ce.data,b.pps=[ce.data]),x.push(ce)},this.flush=function(){for(var ce,Te,_e,xe,Qe,wt,Pt=0,mt,Gt;x.length&&x[0].nalUnitType!=="access_unit_delimiter_rbsp";)x.shift();if(x.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(ce=Ge.groupNalsIntoFrames(x),_e=Ge.groupFramesIntoGops(ce),_e[0][0].keyFrame||(Te=this.getGopForFusion_(x[0],b),Te?(Pt=Te.duration,_e.unshift(Te),_e.byteLength+=Te.byteLength,_e.nalCount+=Te.nalCount,_e.pts=Te.pts,_e.dts=Te.dts,_e.duration+=Te.duration):_e=Ge.extendFirstKeyFrame(_e)),R.length){var qi;if(E.alignGopsAtEnd?qi=this.alignGopsAtEnd_(_e):qi=this.alignGopsAtStart_(_e),!qi){this.gopCache_.unshift({gop:_e.pop(),pps:b.pps,sps:b.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),x=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}er.clearDtsInfo(b),_e=qi}er.collectDtsInfo(b,_e),b.samples=Ge.generateSampleTable(_e),Qe=Z.mdat(Ge.concatenateNalData(_e)),b.baseMediaDecodeTime=er.calculateTrackBaseMediaDecodeTime(b,E.keepOriginalTimestamps),this.trigger("processedGopsInfo",_e.map(function(Ji){return{pts:Ji.pts,dts:Ji.dts,byteLength:Ji.byteLength}})),mt=_e[0],Gt=_e[_e.length-1],this.trigger("segmentTimingInfo",Mo(b.baseMediaDecodeTime,mt.dts,mt.pts,Gt.dts+Gt.duration,Gt.pts+Gt.duration,Pt)),this.trigger("timingInfo",{start:_e[0].pts,end:_e[_e.length-1].pts+_e[_e.length-1].duration}),this.gopCache_.unshift({gop:_e.pop(),pps:b.pps,sps:b.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),x=[],this.trigger("baseMediaDecodeTime",b.baseMediaDecodeTime),this.trigger("timelineStartInfo",b.timelineStartInfo),xe=Z.moof(S,[b]),wt=new Uint8Array(xe.byteLength+Qe.byteLength),S++,wt.set(xe),wt.set(Qe,xe.byteLength),this.trigger("data",{track:b,boxes:wt}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),x=[],this.gopCache_.length=0,R.length=0,this.trigger("reset")},this.resetStream_=function(){er.clearDtsInfo(b),N=void 0,ee=void 0},this.getGopForFusion_=function(ce){var Te=45e3,_e=1e4,xe=1/0,Qe,wt,Pt,mt,Gt;for(Gt=0;Gt<this.gopCache_.length;Gt++)mt=this.gopCache_[Gt],Pt=mt.gop,!(!(b.pps&&Du(b.pps[0],mt.pps[0]))||!(b.sps&&Du(b.sps[0],mt.sps[0])))&&(Pt.dts<b.timelineStartInfo.dts||(Qe=ce.dts-Pt.dts-Pt.duration,Qe>=-_e&&Qe<=Te&&(!wt||xe>Qe)&&(wt=mt,xe=Qe)));return wt?wt.gop:null},this.alignGopsAtStart_=function(ce){var Te,_e,xe,Qe,wt,Pt,mt,Gt;for(wt=ce.byteLength,Pt=ce.nalCount,mt=ce.duration,Te=_e=0;Te<R.length&&_e<ce.length&&(xe=R[Te],Qe=ce[_e],xe.pts!==Qe.pts);){if(Qe.pts>xe.pts){Te++;continue}_e++,wt-=Qe.byteLength,Pt-=Qe.nalCount,mt-=Qe.duration}return _e===0?ce:_e===ce.length?null:(Gt=ce.slice(_e),Gt.byteLength=wt,Gt.duration=mt,Gt.nalCount=Pt,Gt.pts=Gt[0].pts,Gt.dts=Gt[0].dts,Gt)},this.alignGopsAtEnd_=function(ce){var Te,_e,xe,Qe,wt,Pt;for(Te=R.length-1,_e=ce.length-1,wt=null,Pt=!1;Te>=0&&_e>=0;){if(xe=R[Te],Qe=ce[_e],xe.pts===Qe.pts){Pt=!0;break}if(xe.pts>Qe.pts){Te--;continue}Te===R.length-1&&(wt=_e),_e--}if(!Pt&&wt===null)return null;var mt;if(Pt?mt=_e:mt=wt,mt===0)return ce;var Gt=ce.slice(mt),qi=Gt.reduce(function(Ji,Ya){return Ji.byteLength+=Ya.byteLength,Ji.duration+=Ya.duration,Ji.nalCount+=Ya.nalCount,Ji},{byteLength:0,duration:0,nalCount:0});return Gt.byteLength=qi.byteLength,Gt.duration=qi.duration,Gt.nalCount=qi.nalCount,Gt.pts=Gt[0].pts,Gt.dts=Gt[0].dts,Gt},this.alignGopsWith=function(ce){R=ce}},xr.prototype=new e,hn=function(b,E){this.numberOfTracks=0,this.metadataStream=E,b=b||{},typeof b.remux<"u"?this.remuxTracks=!!b.remux:this.remuxTracks=!0,typeof b.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=b.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,hn.prototype.init.call(this),this.push=function(S){if(S.text)return this.pendingCaptions.push(S);if(S.frames)return this.pendingMetadata.push(S);this.pendingTracks.push(S.track),this.pendingBytes+=S.boxes.byteLength,S.track.type==="video"&&(this.videoTrack=S.track,this.pendingBoxes.push(S.boxes)),S.track.type==="audio"&&(this.audioTrack=S.track,this.pendingBoxes.unshift(S.boxes))}},hn.prototype=new e,hn.prototype.flush=function(W){var b=0,E={captions:[],captionStreams:{},metadata:[],info:{}},S,x,R,N=0,ee;if(this.pendingTracks.length<this.numberOfTracks){if(W!=="VideoSegmentStream"&&W!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(N=this.videoTrack.timelineStartInfo.pts,jt.forEach(function(ce){E.info[ce]=this.videoTrack[ce]},this)):this.audioTrack&&(N=this.audioTrack.timelineStartInfo.pts,Ac.forEach(function(ce){E.info[ce]=this.audioTrack[ce]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?E.type=this.pendingTracks[0].type:E.type="combined",this.emittedTracks+=this.pendingTracks.length,R=Z.initSegment(this.pendingTracks),E.initSegment=new Uint8Array(R.byteLength),E.initSegment.set(R),E.data=new Uint8Array(this.pendingBytes),ee=0;ee<this.pendingBoxes.length;ee++)E.data.set(this.pendingBoxes[ee],b),b+=this.pendingBoxes[ee].byteLength;for(ee=0;ee<this.pendingCaptions.length;ee++)S=this.pendingCaptions[ee],S.startTime=U.metadataTsToSeconds(S.startPts,N,this.keepOriginalTimestamps),S.endTime=U.metadataTsToSeconds(S.endPts,N,this.keepOriginalTimestamps),E.captionStreams[S.stream]=!0,E.captions.push(S);for(ee=0;ee<this.pendingMetadata.length;ee++)x=this.pendingMetadata[ee],x.cueTime=U.metadataTsToSeconds(x.pts,N,this.keepOriginalTimestamps),E.metadata.push(x);for(E.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",E),ee=0;ee<E.captions.length;ee++)S=E.captions[ee],this.trigger("caption",S);for(ee=0;ee<E.metadata.length;ee++)x=E.metadata[ee],this.trigger("id3Frame",x)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},hn.prototype.setRemux=function(W){this.remuxTracks=W},Ra=function(b){var E=this,S=!0,x,R;Ra.prototype.init.call(this),b=b||{},this.baseMediaDecodeTime=b.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var N={};this.transmuxPipeline_=N,N.type="aac",N.metadataStream=new Sn.MetadataStream,N.aacStream=new ei,N.audioTimestampRolloverStream=new Sn.TimestampRolloverStream("audio"),N.timedMetadataTimestampRolloverStream=new Sn.TimestampRolloverStream("timed-metadata"),N.adtsStream=new q,N.coalesceStream=new hn(b,N.metadataStream),N.headOfPipeline=N.aacStream,N.aacStream.pipe(N.audioTimestampRolloverStream).pipe(N.adtsStream),N.aacStream.pipe(N.timedMetadataTimestampRolloverStream).pipe(N.metadataStream).pipe(N.coalesceStream),N.metadataStream.on("timestamp",function(ee){N.aacStream.setTimestamp(ee.timeStamp)}),N.aacStream.on("data",function(ee){ee.type!=="timed-metadata"&&ee.type!=="audio"||N.audioSegmentStream||(R=R||{timelineStartInfo:{baseMediaDecodeTime:E.baseMediaDecodeTime},codec:"adts",type:"audio"},N.coalesceStream.numberOfTracks++,N.audioSegmentStream=new Dr(R,b),N.audioSegmentStream.on("log",E.getLogTrigger_("audioSegmentStream")),N.audioSegmentStream.on("timingInfo",E.trigger.bind(E,"audioTimingInfo")),N.adtsStream.pipe(N.audioSegmentStream).pipe(N.coalesceStream),E.trigger("trackinfo",{hasAudio:!!R,hasVideo:!!x}))}),N.coalesceStream.on("data",this.trigger.bind(this,"data")),N.coalesceStream.on("done",this.trigger.bind(this,"done")),Ri(this,N)},this.setupTsPipeline=function(){var N={};this.transmuxPipeline_=N,N.type="ts",N.metadataStream=new Sn.MetadataStream,N.packetStream=new Sn.TransportPacketStream,N.parseStream=new Sn.TransportParseStream,N.elementaryStream=new Sn.ElementaryStream,N.timestampRolloverStream=new Sn.TimestampRolloverStream,N.adtsStream=new q,N.h264Stream=new hr,N.captionStream=new Sn.CaptionStream(b),N.coalesceStream=new hn(b,N.metadataStream),N.headOfPipeline=N.packetStream,N.packetStream.pipe(N.parseStream).pipe(N.elementaryStream).pipe(N.timestampRolloverStream),N.timestampRolloverStream.pipe(N.h264Stream),N.timestampRolloverStream.pipe(N.adtsStream),N.timestampRolloverStream.pipe(N.metadataStream).pipe(N.coalesceStream),N.h264Stream.pipe(N.captionStream).pipe(N.coalesceStream),N.elementaryStream.on("data",function(ee){var ce;if(ee.type==="metadata"){for(ce=ee.tracks.length;ce--;)!x&&ee.tracks[ce].type==="video"?(x=ee.tracks[ce],x.timelineStartInfo.baseMediaDecodeTime=E.baseMediaDecodeTime):!R&&ee.tracks[ce].type==="audio"&&(R=ee.tracks[ce],R.timelineStartInfo.baseMediaDecodeTime=E.baseMediaDecodeTime);x&&!N.videoSegmentStream&&(N.coalesceStream.numberOfTracks++,N.videoSegmentStream=new xr(x,b),N.videoSegmentStream.on("log",E.getLogTrigger_("videoSegmentStream")),N.videoSegmentStream.on("timelineStartInfo",function(Te){R&&!b.keepOriginalTimestamps&&(R.timelineStartInfo=Te,N.audioSegmentStream.setEarliestDts(Te.dts-E.baseMediaDecodeTime))}),N.videoSegmentStream.on("processedGopsInfo",E.trigger.bind(E,"gopInfo")),N.videoSegmentStream.on("segmentTimingInfo",E.trigger.bind(E,"videoSegmentTimingInfo")),N.videoSegmentStream.on("baseMediaDecodeTime",function(Te){R&&N.audioSegmentStream.setVideoBaseMediaDecodeTime(Te)}),N.videoSegmentStream.on("timingInfo",E.trigger.bind(E,"videoTimingInfo")),N.h264Stream.pipe(N.videoSegmentStream).pipe(N.coalesceStream)),R&&!N.audioSegmentStream&&(N.coalesceStream.numberOfTracks++,N.audioSegmentStream=new Dr(R,b),N.audioSegmentStream.on("log",E.getLogTrigger_("audioSegmentStream")),N.audioSegmentStream.on("timingInfo",E.trigger.bind(E,"audioTimingInfo")),N.audioSegmentStream.on("segmentTimingInfo",E.trigger.bind(E,"audioSegmentTimingInfo")),N.adtsStream.pipe(N.audioSegmentStream).pipe(N.coalesceStream)),E.trigger("trackinfo",{hasAudio:!!R,hasVideo:!!x})}}),N.coalesceStream.on("data",this.trigger.bind(this,"data")),N.coalesceStream.on("id3Frame",function(ee){ee.dispatchType=N.metadataStream.dispatchType,E.trigger("id3Frame",ee)}),N.coalesceStream.on("caption",this.trigger.bind(this,"caption")),N.coalesceStream.on("done",this.trigger.bind(this,"done")),Ri(this,N)},this.setBaseMediaDecodeTime=function(N){var ee=this.transmuxPipeline_;b.keepOriginalTimestamps||(this.baseMediaDecodeTime=N),R&&(R.timelineStartInfo.dts=void 0,R.timelineStartInfo.pts=void 0,er.clearDtsInfo(R),ee.audioTimestampRolloverStream&&ee.audioTimestampRolloverStream.discontinuity()),x&&(ee.videoSegmentStream&&(ee.videoSegmentStream.gopCache_=[]),x.timelineStartInfo.dts=void 0,x.timelineStartInfo.pts=void 0,er.clearDtsInfo(x),ee.captionStream.reset()),ee.timestampRolloverStream&&ee.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(N){R&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(N)},this.setRemux=function(N){var ee=this.transmuxPipeline_;b.remux=N,ee&&ee.coalesceStream&&ee.coalesceStream.setRemux(N)},this.alignGopsWith=function(N){x&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(N)},this.getLogTrigger_=function(N){var ee=this;return function(ce){ce.stream=N,ee.trigger("log",ce)}},this.push=function(N){if(S){var ee=vr(N);ee&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!ee&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),S=!1}this.transmuxPipeline_.headOfPipeline.push(N)},this.flush=function(){S=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Ra.prototype=new e;var Lu={Transmuxer:Ra,VideoSegmentStream:xr,AudioSegmentStream:Dr,AUDIO_PROPERTIES:Ac,VIDEO_PROPERTIES:jt,generateSegmentTimingInfo:Mo},Uf=function(b){return b>>>0},hs=function(b){return("00"+b.toString(16)).slice(-2)},Da={toUnsigned:Uf,toHexString:hs},Nu=function(b){var E="";return E+=String.fromCharCode(b[0]),E+=String.fromCharCode(b[1]),E+=String.fromCharCode(b[2]),E+=String.fromCharCode(b[3]),E},gn=Nu,Yi=Da.toUnsigned,$o=function W(b,E){var S=[],x,R,N,ee,ce;if(!E.length)return null;for(x=0;x<b.byteLength;)R=Yi(b[x]<<24|b[x+1]<<16|b[x+2]<<8|b[x+3]),N=gn(b.subarray(x+4,x+8)),ee=R>1?x+R:b.byteLength,N===E[0]&&(E.length===1?S.push(b.subarray(x+8,ee)):(ce=W(b.subarray(x+8,ee),E.slice(1)),ce.length&&(S=S.concat(ce)))),x=ee;return S},ri=$o,Ig=Da.toUnsigned,s0=i.getUint64,kg=function(b){var E={version:b[0],flags:new Uint8Array(b.subarray(1,4))};return E.version===1?E.baseMediaDecodeTime=s0(b.subarray(4)):E.baseMediaDecodeTime=Ig(b[4]<<24|b[5]<<16|b[6]<<8|b[7]),E},Ff=kg,Ml=function(b){return{isLeading:(b[0]&12)>>>2,dependsOn:b[0]&3,isDependedOn:(b[1]&192)>>>6,hasRedundancy:(b[1]&48)>>>4,paddingValue:(b[1]&14)>>>1,isNonSyncSample:b[1]&1,degradationPriority:b[2]<<8|b[3]}},Og=Ml,o0=function(b){var E={version:b[0],flags:new Uint8Array(b.subarray(1,4)),samples:[]},S=new DataView(b.buffer,b.byteOffset,b.byteLength),x=E.flags[2]&1,R=E.flags[2]&4,N=E.flags[1]&1,ee=E.flags[1]&2,ce=E.flags[1]&4,Te=E.flags[1]&8,_e=S.getUint32(4),xe=8,Qe;for(x&&(E.dataOffset=S.getInt32(xe),xe+=4),R&&_e&&(Qe={flags:Og(b.subarray(xe,xe+4))},xe+=4,N&&(Qe.duration=S.getUint32(xe),xe+=4),ee&&(Qe.size=S.getUint32(xe),xe+=4),Te&&(E.version===1?Qe.compositionTimeOffset=S.getInt32(xe):Qe.compositionTimeOffset=S.getUint32(xe),xe+=4),E.samples.push(Qe),_e--);_e--;)Qe={},N&&(Qe.duration=S.getUint32(xe),xe+=4),ee&&(Qe.size=S.getUint32(xe),xe+=4),ce&&(Qe.flags=Og(b.subarray(xe,xe+4)),xe+=4),Te&&(E.version===1?Qe.compositionTimeOffset=S.getInt32(xe):Qe.compositionTimeOffset=S.getUint32(xe),xe+=4),E.samples.push(Qe);return E},Pg=o0,u0=function(b){var E=new DataView(b.buffer,b.byteOffset,b.byteLength),S={version:b[0],flags:new Uint8Array(b.subarray(1,4)),trackId:E.getUint32(4)},x=S.flags[2]&1,R=S.flags[2]&2,N=S.flags[2]&8,ee=S.flags[2]&16,ce=S.flags[2]&32,Te=S.flags[0]&65536,_e=S.flags[0]&131072,xe;return xe=8,x&&(xe+=4,S.baseDataOffset=E.getUint32(12),xe+=4),R&&(S.sampleDescriptionIndex=E.getUint32(xe),xe+=4),N&&(S.defaultSampleDuration=E.getUint32(xe),xe+=4),ee&&(S.defaultSampleSize=E.getUint32(xe),xe+=4),ce&&(S.defaultSampleFlags=E.getUint32(xe)),Te&&(S.durationIsEmpty=!0),!x&&_e&&(S.baseDataOffsetIsMoof=!0),S},Rg=u0,Dg=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:{},Mu;typeof window<"u"?Mu=window:typeof Dg<"u"?Mu=Dg:typeof self<"u"?Mu=self:Mu={};var Ic=Mu,Bf=Yr.discardEmulationPreventionBytes,Lg=mi.CaptionStream,c0=function(b,E){for(var S=b,x=0;x<E.length;x++){var R=E[x];if(S<R.size)return R;S-=R.size}return null},$l=function(b,E,S){var x=new DataView(b.buffer,b.byteOffset,b.byteLength),R={logs:[],seiNals:[]},N,ee,ce,Te;for(ee=0;ee+4<b.length;ee+=ce)if(ce=x.getUint32(ee),ee+=4,!(ce<=0))switch(b[ee]&31){case 6:var _e=b.subarray(ee+1,ee+1+ce),xe=c0(ee,E);if(N={nalUnitType:"sei_rbsp",size:ce,data:_e,escapedRBSP:Bf(_e),trackId:S},xe)N.pts=xe.pts,N.dts=xe.dts,Te=xe;else if(Te)N.pts=Te.pts,N.dts=Te.dts;else{R.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+ee+" for trackId "+S+". See mux.js#223."});break}R.seiNals.push(N);break}return R},Ng=function(b,E,S){var x=E,R=S.defaultSampleDuration||0,N=S.defaultSampleSize||0,ee=S.trackId,ce=[];return b.forEach(function(Te){var _e=Pg(Te),xe=_e.samples;xe.forEach(function(Qe){Qe.duration===void 0&&(Qe.duration=R),Qe.size===void 0&&(Qe.size=N),Qe.trackId=ee,Qe.dts=x,Qe.compositionTimeOffset===void 0&&(Qe.compositionTimeOffset=0),typeof x=="bigint"?(Qe.pts=x+Ic.BigInt(Qe.compositionTimeOffset),x+=Ic.BigInt(Qe.duration)):(Qe.pts=x+Qe.compositionTimeOffset,x+=Qe.duration)}),ce=ce.concat(xe)}),ce},Uo=function(b,E){var S=ri(b,["moof","traf"]),x=ri(b,["mdat"]),R={},N=[];return x.forEach(function(ee,ce){var Te=S[ce];N.push({mdat:ee,traf:Te})}),N.forEach(function(ee){var ce=ee.mdat,Te=ee.traf,_e=ri(Te,["tfhd"]),xe=Rg(_e[0]),Qe=xe.trackId,wt=ri(Te,["tfdt"]),Pt=wt.length>0?Ff(wt[0]).baseMediaDecodeTime:0,mt=ri(Te,["trun"]),Gt,qi;E===Qe&&mt.length>0&&(Gt=Ng(mt,Pt,xe),qi=$l(ce,Gt,Qe),R[Qe]||(R[Qe]={seiNals:[],logs:[]}),R[Qe].seiNals=R[Qe].seiNals.concat(qi.seiNals),R[Qe].logs=R[Qe].logs.concat(qi.logs))}),R},Fo=function(b,E,S){var x;if(E===null)return null;x=Uo(b,E);var R=x[E]||{};return{seiNals:R.seiNals,logs:R.logs,timescale:S}},Mg=function(){var b=!1,E,S,x,R,N,ee;this.isInitialized=function(){return b},this.init=function(ce){E=new Lg,b=!0,ee=ce?ce.isPartial:!1,E.on("data",function(Te){Te.startTime=Te.startPts/R,Te.endTime=Te.endPts/R,N.captions.push(Te),N.captionStreams[Te.stream]=!0}),E.on("log",function(Te){N.logs.push(Te)})},this.isNewInit=function(ce,Te){return ce&&ce.length===0||Te&&typeof Te=="object"&&Object.keys(Te).length===0?!1:x!==ce[0]||R!==Te[x]},this.parse=function(ce,Te,_e){var xe;if(this.isInitialized()){if(!Te||!_e)return null;if(this.isNewInit(Te,_e))x=Te[0],R=_e[x];else if(x===null||!R)return S.push(ce),null}else return null;for(;S.length>0;){var Qe=S.shift();this.parse(Qe,Te,_e)}return xe=Fo(ce,x,R),xe&&xe.logs&&(N.logs=N.logs.concat(xe.logs)),xe===null||!xe.seiNals?N.logs.length?{logs:N.logs,captions:[],captionStreams:[]}:null:(this.pushNals(xe.seiNals),this.flushStream(),N)},this.pushNals=function(ce){if(!this.isInitialized()||!ce||ce.length===0)return null;ce.forEach(function(Te){E.push(Te)})},this.flushStream=function(){if(!this.isInitialized())return null;ee?E.partialFlush():E.flush()},this.clearParsedCaptions=function(){N.captions=[],N.captionStreams={},N.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;E.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){S=[],x=null,R=null,N?this.clearParsedCaptions():N={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},kc=Mg,Ds=Da.toUnsigned,Bo=Da.toHexString,l0=i.getUint64,qf,Ul,jf,yr,Hf,Gf;qf=function(b){var E={},S=ri(b,["moov","trak"]);return S.reduce(function(x,R){var N,ee,ce,Te,_e;return N=ri(R,["tkhd"])[0],!N||(ee=N[0],ce=ee===0?12:20,Te=Ds(N[ce]<<24|N[ce+1]<<16|N[ce+2]<<8|N[ce+3]),_e=ri(R,["mdia","mdhd"])[0],!_e)?null:(ee=_e[0],ce=ee===0?12:20,x[Te]=Ds(_e[ce]<<24|_e[ce+1]<<16|_e[ce+2]<<8|_e[ce+3]),x)},E)},Ul=function(b,E){var S;S=ri(E,["moof","traf"]);var x=S.reduce(function(R,N){var ee=ri(N,["tfhd"])[0],ce=Ds(ee[4]<<24|ee[5]<<16|ee[6]<<8|ee[7]),Te=b[ce]||9e4,_e=ri(N,["tfdt"])[0],xe=new DataView(_e.buffer,_e.byteOffset,_e.byteLength),Qe;_e[0]===1?Qe=l0(_e.subarray(4,12)):Qe=xe.getUint32(4);var wt;return typeof Qe=="bigint"?wt=Qe/Ic.BigInt(Te):typeof Qe=="number"&&!isNaN(Qe)&&(wt=Qe/Te),wt<Number.MAX_SAFE_INTEGER&&(wt=Number(wt)),wt<R&&(R=wt),R},1/0);return typeof x=="bigint"||isFinite(x)?x:0},jf=function(b,E){var S=ri(E,["moof","traf"]),x=0,R=0,N;if(S&&S.length){var ee=ri(S[0],["tfhd"])[0],ce=ri(S[0],["trun"])[0],Te=ri(S[0],["tfdt"])[0];if(ee){var _e=Rg(ee);N=_e.trackId}if(Te){var xe=Ff(Te);x=xe.baseMediaDecodeTime}if(ce){var Qe=Pg(ce);Qe.samples&&Qe.samples.length&&(R=Qe.samples[0].compositionTimeOffset||0)}}var wt=b[N]||9e4;typeof x=="bigint"&&(R=Ic.BigInt(R),wt=Ic.BigInt(wt));var Pt=(x+R)/wt;return typeof Pt=="bigint"&&Pt<Number.MAX_SAFE_INTEGER&&(Pt=Number(Pt)),Pt},yr=function(b){var E=ri(b,["moov","trak"]),S=[];return E.forEach(function(x){var R=ri(x,["mdia","hdlr"]),N=ri(x,["tkhd"]);R.forEach(function(ee,ce){var Te=gn(ee.subarray(8,12)),_e=N[ce],xe,Qe,wt;Te==="vide"&&(xe=new DataView(_e.buffer,_e.byteOffset,_e.byteLength),Qe=xe.getUint8(0),wt=Qe===0?xe.getUint32(12):xe.getUint32(20),S.push(wt))})}),S},Gf=function(b){var E=b[0],S=E===0?12:20;return Ds(b[S]<<24|b[S+1]<<16|b[S+2]<<8|b[S+3])},Hf=function(b){var E=ri(b,["moov","trak"]),S=[];return E.forEach(function(x){var R={},N=ri(x,["tkhd"])[0],ee,ce;N&&(ee=new DataView(N.buffer,N.byteOffset,N.byteLength),ce=ee.getUint8(0),R.id=ce===0?ee.getUint32(12):ee.getUint32(20));var Te=ri(x,["mdia","hdlr"])[0];if(Te){var _e=gn(Te.subarray(8,12));_e==="vide"?R.type="video":_e==="soun"?R.type="audio":R.type=_e}var xe=ri(x,["mdia","minf","stbl","stsd"])[0];if(xe){var Qe=xe.subarray(8);R.codec=gn(Qe.subarray(4,8));var wt=ri(Qe,[R.codec])[0],Pt,mt;wt&&(/^[asm]vc[1-9]$/i.test(R.codec)?(Pt=wt.subarray(78),mt=gn(Pt.subarray(4,8)),mt==="avcC"&&Pt.length>11?(R.codec+=".",R.codec+=Bo(Pt[9]),R.codec+=Bo(Pt[10]),R.codec+=Bo(Pt[11])):R.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(R.codec)?(Pt=wt.subarray(28),mt=gn(Pt.subarray(4,8)),mt==="esds"&&Pt.length>20&&Pt[19]!==0?(R.codec+="."+Bo(Pt[19]),R.codec+="."+Bo(Pt[20]>>>2&63).replace(/^0/,"")):R.codec="mp4a.40.2"):R.codec=R.codec.toLowerCase())}var Gt=ri(x,["mdia","mdhd"])[0];Gt&&(R.timescale=Gf(Gt)),S.push(R)}),S};var $g={findBox:ri,parseType:gn,timescale:qf,startTime:Ul,compositionStartTime:jf,videoTrackIds:yr,tracks:Hf,getTimescaleFromMediaHeader:Gf},Fl=function(b){var E=b[1]&31;return E<<=8,E|=b[2],E},Bl=function(b){return!!(b[1]&64)},ql=function(b){var E=0;return(b[3]&48)>>>4>1&&(E+=b[4]+1),E},d0=function(b,E){var S=Fl(b);return S===0?"pat":S===E?"pmt":E?"pes":null},Vf=function(b){var E=Bl(b),S=4+ql(b);return E&&(S+=b[S]+1),(b[S+10]&31)<<8|b[S+11]},f0=function(b){var E={},S=Bl(b),x=4+ql(b);if(S&&(x+=b[x]+1),!!(b[x+5]&1)){var R,N,ee;R=(b[x+1]&15)<<8|b[x+2],N=3+R-4,ee=(b[x+10]&15)<<8|b[x+11];for(var ce=12+ee;ce<N;){var Te=x+ce;E[(b[Te+1]&31)<<8|b[Te+2]]=b[Te],ce+=((b[Te+3]&15)<<8|b[Te+4])+5}return E}},Oc=function(b,E){var S=Fl(b),x=E[S];switch(x){case vi.H264_STREAM_TYPE:return"video";case vi.ADTS_STREAM_TYPE:return"audio";case vi.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},Ug=function(b){var E=Bl(b);if(!E)return null;var S=4+ql(b);if(S>=b.byteLength)return null;var x=null,R;return R=b[S+7],R&192&&(x={},x.pts=(b[S+9]&14)<<27|(b[S+10]&255)<<20|(b[S+11]&254)<<12|(b[S+12]&255)<<5|(b[S+13]&254)>>>3,x.pts*=4,x.pts+=(b[S+13]&6)>>>1,x.dts=x.pts,R&64&&(x.dts=(b[S+14]&14)<<27|(b[S+15]&255)<<20|(b[S+16]&254)<<12|(b[S+17]&255)<<5|(b[S+18]&254)>>>3,x.dts*=4,x.dts+=(b[S+18]&6)>>>1)),x},io=function(b){switch(b){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},zf=function(b){for(var E=4+ql(b),S=b.subarray(E),x=0,R=0,N=!1,ee;R<S.byteLength-3;R++)if(S[R+2]===1){x=R+5;break}for(;x<S.byteLength;)switch(S[x]){case 0:if(S[x-1]!==0){x+=2;break}else if(S[x-2]!==0){x++;break}R+3!==x-2&&(ee=io(S[R+3]&31),ee==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0));do x++;while(S[x]!==1&&x<S.length);R=x-2,x+=3;break;case 1:if(S[x-1]!==0||S[x-2]!==0){x+=3;break}ee=io(S[R+3]&31),ee==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0),R=x-2,x+=3;break;default:x+=3;break}return S=S.subarray(R),x-=R,R=0,S&&S.byteLength>3&&(ee=io(S[R+3]&31),ee==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0)),N},qo={parseType:d0,parsePat:Vf,parsePmt:f0,parsePayloadUnitStartIndicator:Bl,parsePesType:Oc,parsePesTime:Ug,videoPacketContainsKeyFrame:zf},no=Qr.handleRollover,Lr={};Lr.ts=qo,Lr.aac=ki;var La=U.ONE_SECOND_IN_TS,Oi=188,Mn=71,p0=function(b,E){for(var S=0,x=Oi,R,N;x<b.byteLength;){if(b[S]===Mn&&b[x]===Mn){switch(R=b.subarray(S,x),N=Lr.ts.parseType(R,E.pid),N){case"pat":E.pid=Lr.ts.parsePat(R);break;case"pmt":var ee=Lr.ts.parsePmt(R);E.table=E.table||{},Object.keys(ee).forEach(function(ce){E.table[ce]=ee[ce]});break}S+=Oi,x+=Oi;continue}S++,x++}},jo=function(b,E,S){for(var x=0,R=Oi,N,ee,ce,Te,_e,xe=!1;R<=b.byteLength;){if(b[x]===Mn&&(b[R]===Mn||R===b.byteLength)){switch(N=b.subarray(x,R),ee=Lr.ts.parseType(N,E.pid),ee){case"pes":ce=Lr.ts.parsePesType(N,E.table),Te=Lr.ts.parsePayloadUnitStartIndicator(N),ce==="audio"&&Te&&(_e=Lr.ts.parsePesTime(N),_e&&(_e.type="audio",S.audio.push(_e),xe=!0));break}if(xe)break;x+=Oi,R+=Oi;continue}x++,R++}for(R=b.byteLength,x=R-Oi,xe=!1;x>=0;){if(b[x]===Mn&&(b[R]===Mn||R===b.byteLength)){switch(N=b.subarray(x,R),ee=Lr.ts.parseType(N,E.pid),ee){case"pes":ce=Lr.ts.parsePesType(N,E.table),Te=Lr.ts.parsePayloadUnitStartIndicator(N),ce==="audio"&&Te&&(_e=Lr.ts.parsePesTime(N),_e&&(_e.type="audio",S.audio.push(_e),xe=!0));break}if(xe)break;x-=Oi,R-=Oi;continue}x--,R--}},h0=function(b,E,S){for(var x=0,R=Oi,N,ee,ce,Te,_e,xe,Qe,wt,Pt=!1,mt={data:[],size:0};R<b.byteLength;){if(b[x]===Mn&&b[R]===Mn){switch(N=b.subarray(x,R),ee=Lr.ts.parseType(N,E.pid),ee){case"pes":if(ce=Lr.ts.parsePesType(N,E.table),Te=Lr.ts.parsePayloadUnitStartIndicator(N),ce==="video"&&(Te&&!Pt&&(_e=Lr.ts.parsePesTime(N),_e&&(_e.type="video",S.video.push(_e),Pt=!0)),!S.firstKeyFrame)){if(Te&&mt.size!==0){for(xe=new Uint8Array(mt.size),Qe=0;mt.data.length;)wt=mt.data.shift(),xe.set(wt,Qe),Qe+=wt.byteLength;if(Lr.ts.videoPacketContainsKeyFrame(xe)){var Gt=Lr.ts.parsePesTime(xe);Gt?(S.firstKeyFrame=Gt,S.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}mt.size=0}mt.data.push(N),mt.size+=N.byteLength}break}if(Pt&&S.firstKeyFrame)break;x+=Oi,R+=Oi;continue}x++,R++}for(R=b.byteLength,x=R-Oi,Pt=!1;x>=0;){if(b[x]===Mn&&b[R]===Mn){switch(N=b.subarray(x,R),ee=Lr.ts.parseType(N,E.pid),ee){case"pes":ce=Lr.ts.parsePesType(N,E.table),Te=Lr.ts.parsePayloadUnitStartIndicator(N),ce==="video"&&Te&&(_e=Lr.ts.parsePesTime(N),_e&&(_e.type="video",S.video.push(_e),Pt=!0));break}if(Pt)break;x-=Oi,R-=Oi;continue}x--,R--}},Fg=function(b,E){if(b.audio&&b.audio.length){var S=E;(typeof S>"u"||isNaN(S))&&(S=b.audio[0].dts),b.audio.forEach(function(N){N.dts=no(N.dts,S),N.pts=no(N.pts,S),N.dtsTime=N.dts/La,N.ptsTime=N.pts/La})}if(b.video&&b.video.length){var x=E;if((typeof x>"u"||isNaN(x))&&(x=b.video[0].dts),b.video.forEach(function(N){N.dts=no(N.dts,x),N.pts=no(N.pts,x),N.dtsTime=N.dts/La,N.ptsTime=N.pts/La}),b.firstKeyFrame){var R=b.firstKeyFrame;R.dts=no(R.dts,x),R.pts=no(R.pts,x),R.dtsTime=R.dts/La,R.ptsTime=R.pts/La}}},jl=function(b){for(var E=!1,S=0,x=null,R=null,N=0,ee=0,ce;b.length-ee>=3;){var Te=Lr.aac.parseType(b,ee);switch(Te){case"timed-metadata":if(b.length-ee<10){E=!0;break}if(N=Lr.aac.parseId3TagSize(b,ee),N>b.length){E=!0;break}R===null&&(ce=b.subarray(ee,ee+N),R=Lr.aac.parseAacTimestamp(ce)),ee+=N;break;case"audio":if(b.length-ee<7){E=!0;break}if(N=Lr.aac.parseAdtsSize(b,ee),N>b.length){E=!0;break}x===null&&(ce=b.subarray(ee,ee+N),x=Lr.aac.parseSampleRate(ce)),S++,ee+=N;break;default:ee++;break}if(E)return null}if(x===null||R===null)return null;var _e=La/x,xe={audio:[{type:"audio",dts:R,pts:R},{type:"audio",dts:R+S*1024*_e,pts:R+S*1024*_e}]};return xe},Hl=function(b){var E={pid:null,table:null},S={};p0(b,E);for(var x in E.table)if(E.table.hasOwnProperty(x)){var R=E.table[x];switch(R){case vi.H264_STREAM_TYPE:S.video=[],h0(b,E,S),S.video.length===0&&delete S.video;break;case vi.ADTS_STREAM_TYPE:S.audio=[],jo(b,E,S),S.audio.length===0&&delete S.audio;break}}return S},g0=function(b,E){var S=Lr.aac.isLikelyAacData(b),x;return S?x=jl(b):x=Hl(b),!x||!x.audio&&!x.video?null:(Fg(x,E),x)},m0={inspect:g0,parseAudioPes_:jo},Bg=function(b,E){E.on("data",function(S){var x=S.initSegment;S.initSegment={data:x.buffer,byteOffset:x.byteOffset,byteLength:x.byteLength};var R=S.data;S.data=R.buffer,b.postMessage({action:"data",segment:S,byteOffset:R.byteOffset,byteLength:R.byteLength},[S.data])}),E.on("done",function(S){b.postMessage({action:"done"})}),E.on("gopInfo",function(S){b.postMessage({action:"gopInfo",gopInfo:S})}),E.on("videoSegmentTimingInfo",function(S){var x={start:{decode:U.videoTsToSeconds(S.start.dts),presentation:U.videoTsToSeconds(S.start.pts)},end:{decode:U.videoTsToSeconds(S.end.dts),presentation:U.videoTsToSeconds(S.end.pts)},baseMediaDecodeTime:U.videoTsToSeconds(S.baseMediaDecodeTime)};S.prependedContentDuration&&(x.prependedContentDuration=U.videoTsToSeconds(S.prependedContentDuration)),b.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:x})}),E.on("audioSegmentTimingInfo",function(S){var x={start:{decode:U.videoTsToSeconds(S.start.dts),presentation:U.videoTsToSeconds(S.start.pts)},end:{decode:U.videoTsToSeconds(S.end.dts),presentation:U.videoTsToSeconds(S.end.pts)},baseMediaDecodeTime:U.videoTsToSeconds(S.baseMediaDecodeTime)};S.prependedContentDuration&&(x.prependedContentDuration=U.videoTsToSeconds(S.prependedContentDuration)),b.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:x})}),E.on("id3Frame",function(S){b.postMessage({action:"id3Frame",id3Frame:S})}),E.on("caption",function(S){b.postMessage({action:"caption",caption:S})}),E.on("trackinfo",function(S){b.postMessage({action:"trackinfo",trackInfo:S})}),E.on("audioTimingInfo",function(S){b.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:U.videoTsToSeconds(S.start),end:U.videoTsToSeconds(S.end)}})}),E.on("videoTimingInfo",function(S){b.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:U.videoTsToSeconds(S.start),end:U.videoTsToSeconds(S.end)}})}),E.on("log",function(S){b.postMessage({action:"log",log:S})})},Pc=function(){function W(E,S){this.options=S||{},this.self=E,this.init()}var b=W.prototype;return b.init=function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new Lu.Transmuxer(this.options),Bg(this.self,this.transmuxer)},b.pushMp4Captions=function(S){this.captionParser||(this.captionParser=new kc,this.captionParser.init());var x=new Uint8Array(S.data,S.byteOffset,S.byteLength),R=this.captionParser.parse(x,S.trackIds,S.timescales);this.self.postMessage({action:"mp4Captions",captions:R&&R.captions||[],logs:R&&R.logs||[],data:x.buffer},[x.buffer])},b.probeMp4StartTime=function(S){var x=S.timescales,R=S.data,N=$g.startTime(x,R);this.self.postMessage({action:"probeMp4StartTime",startTime:N,data:R},[R.buffer])},b.probeMp4Tracks=function(S){var x=S.data,R=$g.tracks(x);this.self.postMessage({action:"probeMp4Tracks",tracks:R,data:x},[x.buffer])},b.probeTs=function(S){var x=S.data,R=S.baseStartTime,N=typeof R=="number"&&!isNaN(R)?R*U.ONE_SECOND_IN_TS:void 0,ee=m0.inspect(x,N),ce=null;ee&&(ce={hasVideo:ee.video&&ee.video.length===2||!1,hasAudio:ee.audio&&ee.audio.length===2||!1},ce.hasVideo&&(ce.videoStart=ee.video[0].ptsTime),ce.hasAudio&&(ce.audioStart=ee.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:ce,data:x},[x.buffer])},b.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},b.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},b.push=function(S){var x=new Uint8Array(S.data,S.byteOffset,S.byteLength);this.transmuxer.push(x)},b.reset=function(){this.transmuxer.reset()},b.setTimestampOffset=function(S){var x=S.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(U.secondsToVideoTs(x)))},b.setAudioAppendStart=function(S){this.transmuxer.setAudioAppendStart(Math.ceil(U.secondsToVideoTs(S.appendStart)))},b.setRemux=function(S){this.transmuxer.setRemux(S.remux)},b.flush=function(S){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})},b.endTimeline=function(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})},b.alignGopsWith=function(S){this.transmuxer.alignGopsWith(S.gopsToAlignWith.slice())},W}();self.onmessage=function(W){if(W.data.action==="init"&&W.data.options){this.messageHandlers=new Pc(self,W.data.options);return}this.messageHandlers||(this.messageHandlers=new Pc(self)),W.data&&W.data.action&&W.data.action!=="init"&&this.messageHandlers[W.data.action]&&this.messageHandlers[W.data.action](W.data)}})),jY=CR(qY),HY=function(e,r,n){var i=e.data.segment,a=i.type,s=i.initSegment,o=i.captions,c=i.captionStreams,l=i.metadata,f=i.videoFrameDtsTime,g=i.videoFramePtsTime;r.buffer.push({captions:o,captionStreams:c,metadata:l});var m=e.data.segment.boxes||{data:e.data.segment.data},y={type:a,data:new Uint8Array(m.data,m.data.byteOffset,m.data.byteLength),initSegment:new Uint8Array(s.data,s.byteOffset,s.byteLength)};typeof f<"u"&&(y.videoFrameDtsTime=f),typeof g<"u"&&(y.videoFramePtsTime=g),n(y)},GY=function(e){var r=e.transmuxedData,n=e.callback;r.buffer=[],n(r)},VY=function(e,r){r.gopInfo=e.data.gopInfo},kR=function(e){var r=e.transmuxer,n=e.bytes,i=e.audioAppendStart,a=e.gopsToAlignWith,s=e.remux,o=e.onData,c=e.onTrackInfo,l=e.onAudioTimingInfo,f=e.onVideoTimingInfo,g=e.onVideoSegmentTimingInfo,m=e.onAudioSegmentTimingInfo,y=e.onId3,A=e.onCaptions,k=e.onDone,I=e.onEndedTimeline,F=e.onTransmuxerLog,J=e.isEndOfTimeline,pe={buffer:[]},L=J,H=function(ie){r.currentTransmux===e&&(ie.data.action==="data"&&HY(ie,pe,o),ie.data.action==="trackinfo"&&c(ie.data.trackInfo),ie.data.action==="gopInfo"&&VY(ie,pe),ie.data.action==="audioTimingInfo"&&l(ie.data.audioTimingInfo),ie.data.action==="videoTimingInfo"&&f(ie.data.videoTimingInfo),ie.data.action==="videoSegmentTimingInfo"&&g(ie.data.videoSegmentTimingInfo),ie.data.action==="audioSegmentTimingInfo"&&m(ie.data.audioSegmentTimingInfo),ie.data.action==="id3Frame"&&y([ie.data.id3Frame],ie.data.id3Frame.dispatchType),ie.data.action==="caption"&&A(ie.data.caption),ie.data.action==="endedtimeline"&&(L=!1,I()),ie.data.action==="log"&&F(ie.data.log),ie.data.type==="transmuxed"&&(L||(r.onmessage=null,GY({transmuxedData:pe,callback:k}),OR(r))))};if(r.onmessage=H,i&&r.postMessage({action:"setAudioAppendStart",appendStart:i}),Array.isArray(a)&&r.postMessage({action:"alignGopsWith",gopsToAlignWith:a}),typeof s<"u"&&r.postMessage({action:"setRemux",remux:s}),n.byteLength){var j=n instanceof ArrayBuffer?n:n.buffer,X=n instanceof ArrayBuffer?0:n.byteOffset;r.postMessage({action:"push",data:j,byteOffset:X,byteLength:n.byteLength},[j])}J&&r.postMessage({action:"endTimeline"}),r.postMessage({action:"flush"})},OR=function(e){e.currentTransmux=null,e.transmuxQueue.length&&(e.currentTransmux=e.transmuxQueue.shift(),typeof e.currentTransmux=="function"?e.currentTransmux():kR(e.currentTransmux))},kP=function(e,r){e.postMessage({action:r}),OR(e)},PR=function(e,r){if(!r.currentTransmux){r.currentTransmux=e,kP(r,e);return}r.transmuxQueue.push(kP.bind(null,r,e))},zY=function(e){PR("reset",e)},WY=function(e){PR("endTimeline",e)},RR=function(e){if(!e.transmuxer.currentTransmux){e.transmuxer.currentTransmux=e,kR(e);return}e.transmuxer.transmuxQueue.push(e)},KY=function(e){var r=new jY;r.currentTransmux=null,r.transmuxQueue=[];var n=r.terminate;return r.terminate=function(){return r.currentTransmux=null,r.transmuxQueue.length=0,n.call(r)},r.postMessage({action:"init",options:e}),r},dw={reset:zY,endTimeline:WY,transmux:RR,createTransmuxer:KY},tv=function(e){var r=e.transmuxer,n=e.endAction||e.action,i=e.callback,a=el.default({},e,{endAction:null,transmuxer:null,callback:null}),s=function l(f){f.data.action===n&&(r.removeEventListener("message",l),f.data.data&&(f.data.data=new Uint8Array(f.data.data,e.byteOffset||0,e.byteLength||f.data.data.byteLength),e.data&&(e.data=f.data.data)),i(f.data))};if(r.addEventListener("message",s),e.data){var o=e.data instanceof ArrayBuffer;a.byteOffset=o?0:e.data.byteOffset,a.byteLength=e.data.byteLength;var c=[o?e.data:e.data.buffer];r.postMessage(a,c)}else r.postMessage(a)},vo={FAILURE:2,TIMEOUT:-101,ABORTED:-102},Iw=function(e){e.forEach(function(r){r.abort()})},XY=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}},YY=function(e){var r=e.target,n=Date.now()-r.requestTime,i={bandwidth:1/0,bytesReceived:0,roundTripTime:n||0};return i.bytesReceived=e.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i},fT=function(e,r){return r.timedout?{status:r.status,message:"HLS request timed-out at URL: "+r.uri,code:vo.TIMEOUT,xhr:r}:r.aborted?{status:r.status,message:"HLS request aborted at URL: "+r.uri,code:vo.ABORTED,xhr:r}:e?{status:r.status,message:"HLS request errored at URL: "+r.uri,code:vo.FAILURE,xhr:r}:r.responseType==="arraybuffer"&&r.response.byteLength===0?{status:r.status,message:"Empty HLS response at URL: "+r.uri,code:vo.FAILURE,xhr:r}:null},OP=function(e,r,n){return function(i,a){var s=a.response,o=fT(i,a);if(o)return n(o,e);if(s.byteLength!==16)return n({status:a.status,message:"Invalid HLS key at URL: "+a.uri,code:vo.FAILURE,xhr:a},e);for(var c=new DataView(s),l=new Uint32Array([c.getUint32(0),c.getUint32(4),c.getUint32(8),c.getUint32(12)]),f=0;f<r.length;f++)r[f].bytes=l;return n(null,e)}},DR=function(e,r){var n=qm.detectContainerForBytes(e.map.bytes);if(n!=="mp4"){var i=e.map.resolvedUri||e.map.uri;return r({internal:!0,message:"Found unsupported "+(n||"unknown")+" container for initialization segment at URL: "+i,code:vo.FAILURE})}tv({action:"probeMp4Tracks",data:e.map.bytes,transmuxer:e.transmuxer,callback:function(s){var o=s.tracks,c=s.data;return e.map.bytes=c,o.forEach(function(l){e.map.tracks=e.map.tracks||{},!e.map.tracks[l.type]&&(e.map.tracks[l.type]=l,typeof l.id=="number"&&l.timescale&&(e.map.timescales=e.map.timescales||{},e.map.timescales[l.id]=l.timescale))}),r(null)}})},JY=function(e){var r=e.segment,n=e.finishProcessingFn;return function(i,a){var s=fT(i,a);if(s)return n(s,r);var o=new Uint8Array(a.response);if(r.map.key)return r.map.encryptedBytes=o,n(null,r);r.map.bytes=o,DR(r,function(c){if(c)return c.xhr=a,c.status=a.status,n(c,r);n(null,r)})}},QY=function(e){var r=e.segment,n=e.finishProcessingFn,i=e.responseType;return function(a,s){var o=fT(a,s);if(o)return n(o,r);var c=i==="arraybuffer"||!s.responseText?s.response:FY(s.responseText.substring(r.lastReachedChar||0));return r.stats=XY(s),r.key?r.encryptedBytes=new Uint8Array(c):r.bytes=new Uint8Array(c),n(null,r)}},ZY=function(e){var r=e.segment,n=e.bytes,i=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,c=e.id3Fn,l=e.captionsFn,f=e.isEndOfTimeline,g=e.endedTimelineFn,m=e.dataFn,y=e.doneFn,A=e.onTransmuxerLog,k=r.map&&r.map.tracks||{},I=!!(k.audio&&k.video),F=a.bind(null,r,"audio","start"),J=a.bind(null,r,"audio","end"),pe=a.bind(null,r,"video","start"),L=a.bind(null,r,"video","end"),H=function(){return RR({bytes:n,transmuxer:r.transmuxer,audioAppendStart:r.audioAppendStart,gopsToAlignWith:r.gopsToAlignWith,remux:I,onData:function(V){V.type=V.type==="combined"?"video":V.type,m(r,V)},onTrackInfo:function(V){i&&(I&&(V.isMuxed=!0),i(r,V))},onAudioTimingInfo:function(V){F&&typeof V.start<"u"&&(F(V.start),F=null),J&&typeof V.end<"u"&&J(V.end)},onVideoTimingInfo:function(V){pe&&typeof V.start<"u"&&(pe(V.start),pe=null),L&&typeof V.end<"u"&&L(V.end)},onVideoSegmentTimingInfo:function(V){s(V)},onAudioSegmentTimingInfo:function(V){o(V)},onId3:function(V,ie){c(r,V,ie)},onCaptions:function(V){l(r,[V])},isEndOfTimeline:f,onEndedTimeline:function(){g()},onTransmuxerLog:A,onDone:function(V){y&&(V.type=V.type==="combined"?"video":V.type,y(null,r,V))}})};tv({action:"probeTs",transmuxer:r.transmuxer,data:n,baseStartTime:r.baseStartTime,callback:function(X){r.bytes=n=X.data;var V=X.result;V&&(i(r,{hasAudio:V.hasAudio,hasVideo:V.hasVideo,isMuxed:I}),i=null,V.hasAudio&&!I&&F(V.audioStart),V.hasVideo&&pe(V.videoStart),F=null,pe=null),H()}})},LR=function(e){var r=e.segment,n=e.bytes,i=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,c=e.id3Fn,l=e.captionsFn,f=e.isEndOfTimeline,g=e.endedTimelineFn,m=e.dataFn,y=e.doneFn,A=e.onTransmuxerLog,k=new Uint8Array(n);if(qm.isLikelyFmp4MediaSegment(k)){r.isFmp4=!0;var I=r.map.tracks,F={isFmp4:!0,hasVideo:!!I.video,hasAudio:!!I.audio};I.audio&&I.audio.codec&&I.audio.codec!=="enca"&&(F.audioCodec=I.audio.codec),I.video&&I.video.codec&&I.video.codec!=="encv"&&(F.videoCodec=I.video.codec),I.video&&I.audio&&(F.isMuxed=!0),i(r,F);var J=function(L){m(r,{data:k,type:F.hasAudio&&!F.isMuxed?"audio":"video"}),L&&L.length&&l(r,L),y(null,r,{})};tv({action:"probeMp4StartTime",timescales:r.map.timescales,data:k,transmuxer:r.transmuxer,callback:function(L){var H=L.data,j=L.startTime;if(n=H.buffer,r.bytes=k=H,F.hasAudio&&!F.isMuxed&&a(r,"audio","start",j),F.hasVideo&&a(r,"video","start",j),!I.video||!H.byteLength||!r.transmuxer){J();return}tv({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:r.transmuxer,data:k,timescales:r.map.timescales,trackIds:[I.video.id],callback:function(V){n=V.data.buffer,r.bytes=k=V.data,V.logs.forEach(function(ie){A(Oe.mergeOptions(ie,{stream:"mp4CaptionParser"}))}),J(V.captions)}})}});return}if(!r.transmuxer){y(null,r,{});return}if(typeof r.container>"u"&&(r.container=qm.detectContainerForBytes(k)),r.container!=="ts"&&r.container!=="aac"){i(r,{hasAudio:!1,hasVideo:!1}),y(null,r,{});return}ZY({segment:r,bytes:n,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:c,captionsFn:l,isEndOfTimeline:f,endedTimelineFn:g,dataFn:m,doneFn:y,onTransmuxerLog:A})},NR=function(e,r){var n=e.id,i=e.key,a=e.encryptedBytes,s=e.decryptionWorker,o=function l(f){if(f.data.source===n){s.removeEventListener("message",l);var g=f.data.decrypted;r(new Uint8Array(g.bytes,g.byteOffset,g.byteLength))}};s.addEventListener("message",o);var c;i.bytes.slice?c=i.bytes.slice():c=new Uint32Array(Array.prototype.slice.call(i.bytes)),s.postMessage(_R({source:n,encrypted:a,key:c,iv:i.iv}),[a.buffer,c.buffer])},eJ=function(e){var r=e.decryptionWorker,n=e.segment,i=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,c=e.id3Fn,l=e.captionsFn,f=e.isEndOfTimeline,g=e.endedTimelineFn,m=e.dataFn,y=e.doneFn,A=e.onTransmuxerLog;NR({id:n.requestId,key:n.key,encryptedBytes:n.encryptedBytes,decryptionWorker:r},function(k){n.bytes=k,LR({segment:n,bytes:n.bytes,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:c,captionsFn:l,isEndOfTimeline:f,endedTimelineFn:g,dataFn:m,doneFn:y,onTransmuxerLog:A})})},tJ=function(e){var r=e.activeXhrs,n=e.decryptionWorker,i=e.trackInfoFn,a=e.timingInfoFn,s=e.videoSegmentTimingInfoFn,o=e.audioSegmentTimingInfoFn,c=e.id3Fn,l=e.captionsFn,f=e.isEndOfTimeline,g=e.endedTimelineFn,m=e.dataFn,y=e.doneFn,A=e.onTransmuxerLog,k=0,I=!1;return function(F,J){if(!I){if(F)return I=!0,Iw(r),y(F,J);if(k+=1,k===r.length){var pe=function(){if(J.encryptedBytes)return eJ({decryptionWorker:n,segment:J,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:c,captionsFn:l,isEndOfTimeline:f,endedTimelineFn:g,dataFn:m,doneFn:y,onTransmuxerLog:A});LR({segment:J,bytes:J.bytes,trackInfoFn:i,timingInfoFn:a,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:o,id3Fn:c,captionsFn:l,isEndOfTimeline:f,endedTimelineFn:g,dataFn:m,doneFn:y,onTransmuxerLog:A})};if(J.endOfAllRequests=Date.now(),J.map&&J.map.encryptedBytes&&!J.map.bytes)return NR({decryptionWorker:n,id:J.requestId+"-init",encryptedBytes:J.map.encryptedBytes,key:J.map.key},function(L){J.map.bytes=L,DR(J,function(H){if(H)return Iw(r),y(H,J);pe()})});pe()}}}},rJ=function(e){var r=e.loadendState,n=e.abortFn;return function(i){var a=i.target;a.aborted&&n&&!r.calledAbortFn&&(n(),r.calledAbortFn=!0)}},iJ=function(e){var r=e.segment,n=e.progressFn;return e.trackInfoFn,e.timingInfoFn,e.videoSegmentTimingInfoFn,e.audioSegmentTimingInfoFn,e.id3Fn,e.captionsFn,e.isEndOfTimeline,e.endedTimelineFn,e.dataFn,function(i){var a=i.target;if(!a.aborted)return r.stats=Oe.mergeOptions(r.stats,YY(i)),!r.stats.firstBytesReceivedAt&&r.stats.bytesReceived&&(r.stats.firstBytesReceivedAt=Date.now()),n(i,r)}},nJ=function(e){var r=e.xhr,n=e.xhrOptions,i=e.decryptionWorker,a=e.segment,s=e.abortFn,o=e.progressFn,c=e.trackInfoFn,l=e.timingInfoFn,f=e.videoSegmentTimingInfoFn,g=e.audioSegmentTimingInfoFn,m=e.id3Fn,y=e.captionsFn,A=e.isEndOfTimeline,k=e.endedTimelineFn,I=e.dataFn,F=e.doneFn,J=e.onTransmuxerLog,pe=[],L=tJ({activeXhrs:pe,decryptionWorker:i,trackInfoFn:c,timingInfoFn:l,videoSegmentTimingInfoFn:f,audioSegmentTimingInfoFn:g,id3Fn:m,captionsFn:y,isEndOfTimeline:A,endedTimelineFn:k,dataFn:I,doneFn:F,onTransmuxerLog:J});if(a.key&&!a.key.bytes){var H=[a.key];a.map&&!a.map.bytes&&a.map.key&&a.map.key.resolvedUri===a.key.resolvedUri&&H.push(a.map.key);var j=Oe.mergeOptions(n,{uri:a.key.resolvedUri,responseType:"arraybuffer"}),X=OP(a,H,L),V=r(j,X);pe.push(V)}if(a.map&&!a.map.bytes){var ie=a.map.key&&(!a.key||a.key.resolvedUri!==a.map.key.resolvedUri);if(ie){var fe=Oe.mergeOptions(n,{uri:a.map.key.resolvedUri,responseType:"arraybuffer"}),Re=OP(a,[a.map.key],L),ye=r(fe,Re);pe.push(ye)}var ze=Oe.mergeOptions(n,{uri:a.map.resolvedUri,responseType:"arraybuffer",headers:Cw(a.map)}),Ue=JY({segment:a,finishProcessingFn:L}),de=r(ze,Ue);pe.push(de)}var Q=Oe.mergeOptions(n,{uri:a.part&&a.part.resolvedUri||a.resolvedUri,responseType:"arraybuffer",headers:Cw(a)}),Fe=QY({segment:a,finishProcessingFn:L,responseType:Q.responseType}),We=r(Q,Fe);We.addEventListener("progress",iJ({segment:a,progressFn:o,trackInfoFn:c,timingInfoFn:l,videoSegmentTimingInfoFn:f,audioSegmentTimingInfoFn:g,id3Fn:m,captionsFn:y,isEndOfTimeline:A,endedTimelineFn:k,dataFn:I})),pe.push(We);var tt={};return pe.forEach(function(Le){Le.addEventListener("loadend",rJ({loadendState:tt,abortFn:s}))}),function(){return Iw(pe)}},aJ=Bs("CodecUtils"),sJ=function(e){var r=e.attributes||{};if(r.CODECS)return ci.parseCodecs(r.CODECS)},MR=function(e,r){var n=r.attributes||{};return e&&e.mediaGroups&&e.mediaGroups.AUDIO&&n.AUDIO&&e.mediaGroups.AUDIO[n.AUDIO]},oJ=function(e,r){if(!MR(e,r))return!0;var n=r.attributes||{},i=e.mediaGroups.AUDIO[n.AUDIO];for(var a in i)if(!i[a].uri&&!i[a].playlists)return!0;return!1},rv=function(e){var r={};return e.forEach(function(n){var i=n.mediaType,a=n.type,s=n.details;r[i]=r[i]||[],r[i].push(ci.translateLegacyCodec(""+a+s))}),Object.keys(r).forEach(function(n){if(r[n].length>1){aJ("multiple "+n+" codecs found as attributes: "+r[n].join(", ")+". Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs."),r[n]=null;return}r[n]=r[n][0]}),r},PP=function(e){var r=0;return e.audio&&r++,e.video&&r++,r},Hp=function(e,r){var n=r.attributes||{},i=rv(sJ(r)||[]);if(MR(e,r)&&!i.audio&&!oJ(e,r)){var a=rv(ci.codecsFromDefault(e,n.AUDIO)||[]);a.audio&&(i.audio=a.audio)}return i},Lm=Bs("PlaylistSelector"),RP=function(e){if(!(!e||!e.playlist)){var r=e.playlist;return JSON.stringify({id:r.id,bandwidth:e.bandwidth,width:e.width,height:e.height,codecs:r.attributes&&r.attributes.CODECS||""})}},iv=function(e,r){if(!e)return"";var n=Se.default.getComputedStyle(e);return n?n[r]:""},wd=function(e,r){var n=e.slice();e.sort(function(i,a){var s=r(i,a);return s===0?n.indexOf(i)-n.indexOf(a):s})},pT=function(e,r){var n,i;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||Se.default.Number.MAX_VALUE,r.attributes.BANDWIDTH&&(i=r.attributes.BANDWIDTH),i=i||Se.default.Number.MAX_VALUE,n-i},uJ=function(e,r){var n,i;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||Se.default.Number.MAX_VALUE,r.attributes.RESOLUTION&&r.attributes.RESOLUTION.width&&(i=r.attributes.RESOLUTION.width),i=i||Se.default.Number.MAX_VALUE,n===i&&e.attributes.BANDWIDTH&&r.attributes.BANDWIDTH?e.attributes.BANDWIDTH-r.attributes.BANDWIDTH:n-i},$R=function(e,r,n,i,a,s){if(e){var o={bandwidth:r,width:n,height:i,limitRenditionByPlayerDimensions:a},c=e.playlists;Ba.isAudioOnly(e)&&(c=s.getAudioTrackPlaylists_(),o.audioOnly=!0);var l=c.map(function(fe){var Re,ye=fe.attributes&&fe.attributes.RESOLUTION&&fe.attributes.RESOLUTION.width,ze=fe.attributes&&fe.attributes.RESOLUTION&&fe.attributes.RESOLUTION.height;return Re=fe.attributes&&fe.attributes.BANDWIDTH,Re=Re||Se.default.Number.MAX_VALUE,{bandwidth:Re,width:ye,height:ze,playlist:fe}});wd(l,function(fe,Re){return fe.bandwidth-Re.bandwidth}),l=l.filter(function(fe){return!Ba.isIncompatible(fe.playlist)});var f=l.filter(function(fe){return Ba.isEnabled(fe.playlist)});f.length||(f=l.filter(function(fe){return!Ba.isDisabled(fe.playlist)}));var g=f.filter(function(fe){return fe.bandwidth*An.BANDWIDTH_VARIANCE<r}),m=g[g.length-1],y=g.filter(function(fe){return fe.bandwidth===m.bandwidth})[0];if(a===!1){var A=y||f[0]||l[0];if(A&&A.playlist){var k="sortedPlaylistReps";return y&&(k="bandwidthBestRep"),f[0]&&(k="enabledPlaylistReps"),Lm("choosing "+RP(A)+" using "+k+" with options",o),A.playlist}return Lm("could not choose a playlist with options",o),null}var I=g.filter(function(fe){return fe.width&&fe.height});wd(I,function(fe,Re){return fe.width-Re.width});var F=I.filter(function(fe){return fe.width===n&&fe.height===i});m=F[F.length-1];var J=F.filter(function(fe){return fe.bandwidth===m.bandwidth})[0],pe,L,H;J||(pe=I.filter(function(fe){return fe.width>n||fe.height>i}),L=pe.filter(function(fe){return fe.width===pe[0].width&&fe.height===pe[0].height}),m=L[L.length-1],H=L.filter(function(fe){return fe.bandwidth===m.bandwidth})[0]);var j;if(s.experimentalLeastPixelDiffSelector){var X=I.map(function(fe){return fe.pixelDiff=Math.abs(fe.width-n)+Math.abs(fe.height-i),fe});wd(X,function(fe,Re){return fe.pixelDiff===Re.pixelDiff?Re.bandwidth-fe.bandwidth:fe.pixelDiff-Re.pixelDiff}),j=X[0]}var V=j||H||J||y||f[0]||l[0];if(V&&V.playlist){var ie="sortedPlaylistReps";return j?ie="leastPixelDiffRep":H?ie="resolutionPlusOneRep":J?ie="resolutionBestRep":y?ie="bandwidthBestRep":f[0]&&(ie="enabledPlaylistReps"),Lm("choosing "+RP(V)+" using "+ie+" with options",o),V.playlist}return Lm("could not choose a playlist with options",o),null}},DP=function(){var e=this.useDevicePixelRatio&&Se.default.devicePixelRatio||1;return $R(this.playlists.master,this.systemBandwidth,parseInt(iv(this.tech_.el(),"width"),10)*e,parseInt(iv(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)},cJ=function(e){var r=-1,n=-1;if(e<0||e>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var i=this.useDevicePixelRatio&&Se.default.devicePixelRatio||1;return r<0&&(r=this.systemBandwidth,n=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==n&&(r=e*this.systemBandwidth+(1-e)*r,n=this.systemBandwidth),$R(this.playlists.master,r,parseInt(iv(this.tech_.el(),"width"),10)*i,parseInt(iv(this.tech_.el(),"height"),10)*i,this.limitRenditionByPlayerDimensions,this.masterPlaylistController_)}},lJ=function(e){var r=e.master,n=e.currentTime,i=e.bandwidth,a=e.duration,s=e.segmentDuration,o=e.timeUntilRebuffer,c=e.currentTimeline,l=e.syncController,f=r.playlists.filter(function(k){return!Ba.isIncompatible(k)}),g=f.filter(Ba.isEnabled);g.length||(g=f.filter(function(k){return!Ba.isDisabled(k)}));var m=g.filter(Ba.hasAttribute.bind(null,"BANDWIDTH")),y=m.map(function(k){var I=l.getSyncPoint(k,a,c,n),F=I?1:2,J=Ba.estimateSegmentRequestTime(s,i,k),pe=J*F-o;return{playlist:k,rebufferingImpact:pe}}),A=y.filter(function(k){return k.rebufferingImpact<=0});return wd(A,function(k,I){return pT(I.playlist,k.playlist)}),A.length?A[0]:(wd(y,function(k,I){return k.rebufferingImpact-I.rebufferingImpact}),y[0]||null)},dJ=function(){var e=this,r=this.playlists.master.playlists.filter(Ba.isEnabled);wd(r,function(i,a){return pT(i,a)});var n=r.filter(function(i){return!!Hp(e.playlists.master,i).video});return n[0]||null},fJ=function(e){var r=0,n;return e.bytes&&(n=new Uint8Array(e.bytes),e.segments.forEach(function(i){n.set(i,r),r+=i.byteLength})),n},pJ=function(e,r,n){if(!e[n]){r.trigger({type:"usage",name:"vhs-608"}),r.trigger({type:"usage",name:"hls-608"});var i=n;/^cc708_/.test(n)&&(i="SERVICE"+n.split("_")[1]);var a=r.textTracks().getTrackById(i);if(a)e[n]=a;else{var s=r.options_.vhs&&r.options_.vhs.captionServices||{},o=n,c=n,l=!1,f=s[i];f&&(o=f.label,c=f.language,l=f.default),e[n]=r.addRemoteTextTrack({kind:"captions",id:i,default:l,label:o,language:c},!1).track}}},hJ=function(e){var r=e.inbandTextTracks,n=e.captionArray,i=e.timestampOffset;if(n){var a=Se.default.WebKitDataCue||Se.default.VTTCue;n.forEach(function(s){var o=s.stream;r[o].addCue(new a(s.startTime+i,s.endTime+i,s.text))})}},gJ=function(e){Object.defineProperties(e.frame,{id:{get:function(){return Oe.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return Oe.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return Oe.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})},mJ=function(e){var r=e.inbandTextTracks,n=e.metadataArray,i=e.timestampOffset,a=e.videoDuration;if(n){var s=Se.default.WebKitDataCue||Se.default.VTTCue,o=r.metadataTrack_;if(o&&(n.forEach(function(y){var A=y.cueTime+i;typeof A!="number"||Se.default.isNaN(A)||A<0||!(A<1/0)||y.frames.forEach(function(k){var I=new s(A,A,k.value||k.url||k.data||"");I.frame=k,I.value=k,gJ(I),o.addCue(I)})}),!(!o.cues||!o.cues.length))){for(var c=o.cues,l=[],f=0;f<c.length;f++)c[f]&&l.push(c[f]);var g=l.reduce(function(y,A){var k=y[A.startTime]||[];return k.push(A),y[A.startTime]=k,y},{}),m=Object.keys(g).sort(function(y,A){return Number(y)-Number(A)});m.forEach(function(y,A){var k=g[y],I=Number(m[A+1])||a;k.forEach(function(F){F.endTime=I})})}}},vJ=function(e,r,n){e.metadataTrack_||(e.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=r)},Bp=function(e,r,n){var i,a;if(n&&n.cues)for(i=n.cues.length;i--;)a=n.cues[i],a.startTime>=e&&a.endTime<=r&&n.removeCue(a)},yJ=function(e){var r=e.cues;if(r)for(var n=0;n<r.length;n++){for(var i=[],a=0,s=0;s<r.length;s++)r[n].startTime===r[s].startTime&&r[n].endTime===r[s].endTime&&r[n].text===r[s].text&&(a++,a>1&&i.push(r[s]));i.length&&i.forEach(function(o){return e.removeCue(o)})}},bJ=function(e,r,n){if(typeof r>"u"||r===null||!e.length)return[];var i=Math.ceil((r-n+3)*jm.ONE_SECOND_IN_TS),a;for(a=0;a<e.length&&!(e[a].pts>i);a++);return e.slice(a)},_J=function(e,r,n){if(!r.length)return e;if(n)return r.slice();var i=r[0].pts,a=0;for(a;a<e.length&&!(e[a].pts>=i);a++);return e.slice(0,a).concat(r)},wJ=function(e,r,n,i){for(var a=Math.ceil((r-i)*jm.ONE_SECOND_IN_TS),s=Math.ceil((n-i)*jm.ONE_SECOND_IN_TS),o=e.slice(),c=e.length;c--&&!(e[c].pts<=s););if(c===-1)return o;for(var l=c+1;l--&&!(e[l].pts<=a););return l=Math.max(l,0),o.splice(l,c-l+1),o},TJ=function(e,r){if(!e&&!r||!e&&r||e&&!r)return!1;if(e===r)return!0;var n=Object.keys(e).sort(),i=Object.keys(r).sort();if(n.length!==i.length)return!1;for(var a=0;a<n.length;a++){var s=n[a];if(s!==i[a]||e[s]!==r[s])return!1}return!0},UR=22,SJ=function(e,r,n){r=r||[];for(var i=[],a=0,s=0;s<r.length;s++){var o=r[s];if(e===o.timeline&&(i.push(s),a+=o.duration,a>n))return s}return i.length===0?0:i[i.length-1]},Up=1,EJ=500,LP=function(e){return typeof e=="number"&&isFinite(e)},Nm=1/60,xJ=function(e,r,n){return e!=="main"||!r||!n?null:!n.hasAudio&&!n.hasVideo?"Neither audio nor video found in segment.":r.hasVideo&&!n.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!r.hasVideo&&n.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null},CJ=function(e,r,n){var i=r-An.BACK_BUFFER_LENGTH;e.length&&(i=Math.max(i,e.start(0)));var a=r-n;return Math.min(a,i)},gd=function(e){var r=e.startOfSegment,n=e.duration,i=e.segment,a=e.part,s=e.playlist,o=s.mediaSequence,c=s.id,l=s.segments,f=l===void 0?[]:l,g=e.mediaIndex,m=e.partIndex,y=e.timeline,A=f.length-1,k="mediaIndex/partIndex increment";e.getMediaInfoForTime?k="getMediaInfoForTime ("+e.getMediaInfoForTime+")":e.isSyncRequest&&(k="getSyncSegmentCandidate (isSyncRequest)"),e.independent&&(k+=" with independent "+e.independent);var I=typeof m=="number",F=e.segment.uri?"segment":"pre-segment",J=I?sR({preloadSegment:i})-1:0;return F+" ["+(o+g)+"/"+(o+A)+"]"+(I?" part ["+m+"/"+J+"]":"")+(" segment start/end ["+i.start+" => "+i.end+"]")+(I?" part start/end ["+a.start+" => "+a.end+"]":"")+(" startOfSegment ["+r+"]")+(" duration ["+n+"]")+(" timeline ["+y+"]")+(" selected by ["+k+"]")+(" playlist ["+c+"]")},NP=function(e){return e+"TimingInfo"},AJ=function(e){var r=e.segmentTimeline,n=e.currentTimeline,i=e.startOfSegment,a=e.buffered,s=e.overrideCheck;return!s&&r===n?null:r<n?i:a.length?a.end(a.length-1):i},MP=function(e){var r=e.timelineChangeController,n=e.currentTimeline,i=e.segmentTimeline,a=e.loaderType,s=e.audioDisabled;if(n===i)return!1;if(a==="audio"){var o=r.lastTimelineChange({type:"main"});return!o||o.to!==i}if(a==="main"&&s){var c=r.pendingTimelineChange({type:"audio"});return!(c&&c.to===i)}return!1},IJ=function(e){var r=0;return["video","audio"].forEach(function(n){var i=e[n+"TimingInfo"];if(i){var a=i.start,s=i.end,o;typeof a=="bigint"||typeof s=="bigint"?o=Se.default.BigInt(s)-Se.default.BigInt(a):typeof a=="number"&&typeof s=="number"&&(o=s-a),typeof o<"u"&&o>r&&(r=o)}}),typeof r=="bigint"&&r<Number.MAX_SAFE_INTEGER&&(r=Number(r)),r},$P=function(e){var r=e.segmentDuration,n=e.maxDuration;return r?Math.round(r)>n+Ju:!1},kJ=function(e,r){if(r!=="hls")return null;var n=IJ({audioTimingInfo:e.audioTimingInfo,videoTimingInfo:e.videoTimingInfo});if(!n)return null;var i=e.playlist.targetDuration,a=$P({segmentDuration:n,maxDuration:i*2}),s=$P({segmentDuration:n,maxDuration:i}),o="Segment with index "+e.mediaIndex+" "+("from playlist "+e.playlist.id+" ")+("has a duration of "+n+" ")+("when the reported duration is "+e.duration+" ")+("and the target duration is "+i+". ")+"For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";return a||s?{severity:a?"warn":"info",message:o}:null},kw=function(t){Ct.default(e,t);function e(n,i){var a;if(a=t.call(this)||this,!n)throw new TypeError("Initialization settings are required");if(typeof n.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!n.mediaSource)throw new TypeError("No MediaSource specified");return a.bandwidth=n.bandwidth,a.throughput={rate:0,count:0},a.roundTrip=NaN,a.resetStats_(),a.mediaIndex=null,a.partIndex=null,a.hasPlayed_=n.hasPlayed,a.currentTime_=n.currentTime,a.seekable_=n.seekable,a.seeking_=n.seeking,a.duration_=n.duration,a.mediaSource_=n.mediaSource,a.vhs_=n.vhs,a.loaderType_=n.loaderType,a.currentMediaInfo_=void 0,a.startingMediaInfo_=void 0,a.segmentMetadataTrack_=n.segmentMetadataTrack,a.goalBufferLength_=n.goalBufferLength,a.sourceType_=n.sourceType,a.sourceUpdater_=n.sourceUpdater,a.inbandTextTracks_=n.inbandTextTracks,a.state_="INIT",a.timelineChangeController_=n.timelineChangeController,a.shouldSaveSegmentTimingInfo_=!0,a.parse708captions_=n.parse708captions,a.useDtsForTimestampOffset_=n.useDtsForTimestampOffset,a.captionServices_=n.captionServices,a.experimentalExactManifestTimings=n.experimentalExactManifestTimings,a.checkBufferTimeout_=null,a.error_=void 0,a.currentTimeline_=-1,a.pendingSegment_=null,a.xhrOptions_=null,a.pendingSegments_=[],a.audioDisabled_=!1,a.isPendingTimestampOffset_=!1,a.gopBuffer_=[],a.timeMapping_=0,a.safeAppend_=Oe.browser.IE_VERSION>=11,a.appendInitSegment_={audio:!0,video:!0},a.playlistOfLastInitSegment_={audio:null,video:null},a.callQueue_=[],a.loadQueue_=[],a.metadataQueue_={id3:[],caption:[]},a.waitingOnRemove_=!1,a.quotaExceededErrorRetryTimeout_=null,a.activeInitSegmentId_=null,a.initSegments_={},a.cacheEncryptionKeys_=n.cacheEncryptionKeys,a.keyCache_={},a.decrypter_=n.decrypter,a.syncController_=n.syncController,a.syncPoint_={segmentIndex:0,time:0},a.transmuxer_=a.createTransmuxer_(),a.triggerSyncInfoUpdate_=function(){return a.trigger("syncinfoupdate")},a.syncController_.on("syncinfoupdate",a.triggerSyncInfoUpdate_),a.mediaSource_.addEventListener("sourceopen",function(){a.isEndOfStream_()||(a.ended_=!1)}),a.fetchAtBuffer_=!1,a.logger_=Bs("SegmentLoader["+a.loaderType_+"]"),Object.defineProperty(ir.default(a),"state",{get:function(){return this.state_},set:function(o){o!==this.state_&&(this.logger_(this.state_+" -> "+o),this.state_=o,this.trigger("statechange"))}}),a.sourceUpdater_.on("ready",function(){a.hasEnoughInfoToAppend_()&&a.processCallQueue_()}),a.loaderType_==="main"&&a.timelineChangeController_.on("pendingtimelinechange",function(){a.hasEnoughInfoToAppend_()&&a.processCallQueue_()}),a.loaderType_==="audio"&&a.timelineChangeController_.on("timelinechange",function(){a.hasEnoughInfoToLoad_()&&a.processLoadQueue_(),a.hasEnoughInfoToAppend_()&&a.processCallQueue_()}),a}var r=e.prototype;return r.createTransmuxer_=function(){return dw.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})},r.resetStats_=function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0},r.dispose=function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&Se.default.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()},r.setAudio=function(i){this.audioDisabled_=!i,i?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},r.abort=function(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()},r.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,Se.default.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null},r.checkForAbort_=function(i){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==i},r.error=function(i){return typeof i<"u"&&(this.logger_("error occurred:",i),this.error_=i),this.pendingSegment_=null,this.error_},r.endOfStream=function(){this.ended_=!0,this.transmuxer_&&dw.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")},r.buffered_=function(){var i=this.getMediaInfo_();if(!this.sourceUpdater_||!i)return Oe.createTimeRanges();if(this.loaderType_==="main"){var a=i.hasAudio,s=i.hasVideo,o=i.isMuxed;if(s&&a&&!this.audioDisabled_&&!o)return this.sourceUpdater_.buffered();if(s)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},r.initSegmentForMap=function(i,a){if(a===void 0&&(a=!1),!i)return null;var s=ev(i),o=this.initSegments_[s];return a&&!o&&i.bytes&&(this.initSegments_[s]=o={resolvedUri:i.resolvedUri,byterange:i.byterange,bytes:i.bytes,tracks:i.tracks,timescales:i.timescales}),o||i},r.segmentKey=function(i,a){if(a===void 0&&(a=!1),!i)return null;var s=wR(i),o=this.keyCache_[s];this.cacheEncryptionKeys_&&a&&!o&&i.bytes&&(this.keyCache_[s]=o={resolvedUri:i.resolvedUri,bytes:i.bytes});var c={resolvedUri:(o||i).resolvedUri};return o&&(c.bytes=o.bytes),c},r.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},r.load=function(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}},r.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},r.playlist=function(i,a){if(a===void 0&&(a={}),!!i){var s=this.playlist_,o=this.pendingSegment_;this.playlist_=i,this.xhrOptions_=a,this.state==="INIT"&&(i.syncInfo={mediaSequence:i.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(i));var c=null;if(s&&(s.id?c=s.id:s.uri&&(c=s.uri)),this.logger_("playlist update ["+c+" => "+(i.id||i.uri)+"]"),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!s||s.uri!==i.uri){this.mediaIndex!==null&&(i.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}var l=i.mediaSequence-s.mediaSequence;if(this.logger_("live window shift ["+l+"]"),this.mediaIndex!==null)if(this.mediaIndex-=l,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{var f=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!f.parts||!f.parts.length||!f.parts[this.partIndex])){var g=this.mediaIndex;this.logger_("currently processing part (index "+this.partIndex+") no longer exists."),this.resetLoader(),this.mediaIndex=g}}o&&(o.mediaIndex-=l,o.mediaIndex<0?(o.mediaIndex=null,o.partIndex=null):(o.mediaIndex>=0&&(o.segment=i.segments[o.mediaIndex]),o.partIndex>=0&&o.segment.parts&&(o.part=o.segment.parts[o.partIndex]))),this.syncController_.saveExpiredSegmentInfo(s,i)}},r.pause=function(){this.checkBufferTimeout_&&(Se.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},r.paused=function(){return this.checkBufferTimeout_===null},r.resetEverything=function(i){this.ended_=!1,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,i),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))},r.resetLoader=function(){this.fetchAtBuffer_=!1,this.resyncLoader()},r.resyncLoader=function(){this.transmuxer_&&dw.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},r.remove=function(i,a,s,o){if(s===void 0&&(s=function(){}),o===void 0&&(o=!1),a===1/0&&(a=this.duration_()),a<=i){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}var c=1,l=function(){c--,c===0&&s()};(o||!this.audioDisabled_)&&(c++,this.sourceUpdater_.removeAudio(i,a,l)),(o||this.loaderType_==="main")&&(this.gopBuffer_=wJ(this.gopBuffer_,i,a,this.timeMapping_),c++,this.sourceUpdater_.removeVideo(i,a,l));for(var f in this.inbandTextTracks_)Bp(i,a,this.inbandTextTracks_[f]);Bp(i,a,this.segmentMetadataTrack_),l()},r.monitorBuffer_=function(){this.checkBufferTimeout_&&Se.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Se.default.setTimeout(this.monitorBufferTick_.bind(this),1)},r.monitorBufferTick_=function(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&Se.default.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=Se.default.setTimeout(this.monitorBufferTick_.bind(this),EJ)},r.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){var i=this.chooseNextRequest_();i&&(typeof i.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:i.timeline})),this.loadSegment_(i))}},r.isEndOfStream_=function(i,a,s){if(i===void 0&&(i=this.mediaIndex),a===void 0&&(a=this.playlist_),s===void 0&&(s=this.partIndex),!a||!this.mediaSource_)return!1;var o=typeof i=="number"&&a.segments[i],c=i+1===a.segments.length,l=!o||!o.parts||s+1===o.parts.length;return a.endList&&this.mediaSource_.readyState==="open"&&c&&l},r.chooseNextRequest_=function(){var i=this.buffered_(),a=EP(i)||0,s=oT(i,this.currentTime_()),o=!this.hasPlayed_()&&s>=1,c=s>=this.goalBufferLength_(),l=this.playlist_.segments;if(!l.length||o||c)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());var f={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(f.isSyncRequest)f.mediaIndex=SJ(this.currentTimeline_,l,a);else if(this.mediaIndex!==null){var g=l[this.mediaIndex],m=typeof this.partIndex=="number"?this.partIndex:-1;f.startOfSegment=g.end?g.end:a,g.parts&&g.parts[m+1]?(f.mediaIndex=this.mediaIndex,f.partIndex=m+1):f.mediaIndex=this.mediaIndex+1}else{var y=Ba.getMediaInfoForTime({experimentalExactManifestTimings:this.experimentalExactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?a:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time}),A=y.segmentIndex,k=y.startTime,I=y.partIndex;f.getMediaInfoForTime=this.fetchAtBuffer_?"bufferedEnd "+a:"currentTime "+this.currentTime_(),f.mediaIndex=A,f.startOfSegment=k,f.partIndex=I}var F=l[f.mediaIndex],J=F&&typeof f.partIndex=="number"&&F.parts&&F.parts[f.partIndex];if(!F||typeof f.partIndex=="number"&&!J)return null;if(typeof f.partIndex!="number"&&F.parts&&(f.partIndex=0,J=F.parts[0]),!s&&J&&!J.independent)if(f.partIndex===0){var pe=l[f.mediaIndex-1],L=pe.parts&&pe.parts.length&&pe.parts[pe.parts.length-1];L&&L.independent&&(f.mediaIndex-=1,f.partIndex=pe.parts.length-1,f.independent="previous segment")}else F.parts[f.partIndex-1].independent&&(f.partIndex-=1,f.independent="previous part");var H=this.mediaSource_&&this.mediaSource_.readyState==="ended";return f.mediaIndex>=l.length-1&&H&&!this.seeking_()?null:this.generateSegmentInfo_(f)},r.generateSegmentInfo_=function(i){var a=i.independent,s=i.playlist,o=i.mediaIndex,c=i.startOfSegment,l=i.isSyncRequest,f=i.partIndex,g=i.forceTimestampOffset,m=i.getMediaInfoForTime,y=s.segments[o],A=typeof f=="number"&&y.parts[f],k={requestId:"segment-loader-"+Math.random(),uri:A&&A.resolvedUri||y.resolvedUri,mediaIndex:o,partIndex:A?f:null,isSyncRequest:l,startOfSegment:c,playlist:s,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:y.timeline,duration:A&&A.duration||y.duration,segment:y,part:A,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:m,independent:a},I=typeof g<"u"?g:this.isPendingTimestampOffset_;k.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:y.timeline,currentTimeline:this.currentTimeline_,startOfSegment:c,buffered:this.buffered_(),overrideCheck:I});var F=EP(this.sourceUpdater_.audioBuffered());return typeof F=="number"&&(k.audioAppendStart=F-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(k.gopsToAlignWith=bJ(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),k},r.timestampOffsetForSegment_=function(i){return AJ(i)},r.earlyAbortWhenNeeded_=function(i){if(!(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)&&!(Date.now()-(i.firstBytesReceivedAt||Date.now())<1e3)){var a=this.currentTime_(),s=i.bandwidth,o=this.pendingSegment_.duration,c=Ba.estimateSegmentRequestTime(o,s,this.playlist_,i.bytesReceived),l=ZX(this.buffered_(),a,this.vhs_.tech_.playbackRate())-1;if(!(c<=l)){var f=lJ({master:this.vhs_.playlists.master,currentTime:a,bandwidth:s,duration:this.duration_(),segmentDuration:o,timeUntilRebuffer:l,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(f){var g=c-l,m=g-f.rebufferingImpact,y=.5;l<=Ju&&(y=1),!(!f.playlist||f.playlist.uri===this.playlist_.uri||m<y)&&(this.bandwidth=f.playlist.attributes.BANDWIDTH*An.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}}},r.handleAbort_=function(i){this.logger_("Aborting "+gd(i)),this.mediaRequestsAborted+=1},r.handleProgress_=function(i,a){this.earlyAbortWhenNeeded_(a.stats),!this.checkForAbort_(a.requestId)&&this.trigger("progress")},r.handleTrackInfo_=function(i,a){this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)&&(this.checkForIllegalMediaSwitch(a)||(a=a||{},TJ(this.currentMediaInfo_,a)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=a,this.currentMediaInfo_=a,this.logger_("trackinfo update",a),this.trigger("trackinfo")),!this.checkForAbort_(i.requestId)&&(this.pendingSegment_.trackInfo=a,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))},r.handleTimingInfo_=function(i,a,s,o){if(this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)){var c=this.pendingSegment_,l=NP(a);c[l]=c[l]||{},c[l][s]=o,this.logger_("timinginfo: "+a+" - "+s+" - "+o),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},r.handleCaptions_=function(i,a){var s=this;if(this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)){if(a.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}var o=this.pendingSegment_;if(!o.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,i,a));return}var c=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),l={};a.forEach(function(f){l[f.stream]=l[f.stream]||{startTime:1/0,captions:[],endTime:0};var g=l[f.stream];g.startTime=Math.min(g.startTime,f.startTime+c),g.endTime=Math.max(g.endTime,f.endTime+c),g.captions.push(f)}),Object.keys(l).forEach(function(f){var g=l[f],m=g.startTime,y=g.endTime,A=g.captions,k=s.inbandTextTracks_;s.logger_("adding cues from "+m+" -> "+y+" for "+f),pJ(k,s.vhs_.tech_,f),Bp(m,y,k[f]),hJ({captionArray:A,inbandTextTracks:k,timestampOffset:c})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}},r.handleId3_=function(i,a,s){if(this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)){var o=this.pendingSegment_;if(!o.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,i,a,s));return}var c=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();vJ(this.inbandTextTracks_,s,this.vhs_.tech_),mJ({inbandTextTracks:this.inbandTextTracks_,metadataArray:a,timestampOffset:c,videoDuration:this.duration_()})}},r.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(i){return i()}),this.metadataQueue_.caption.forEach(function(i){return i()}),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]},r.processCallQueue_=function(){var i=this.callQueue_;this.callQueue_=[],i.forEach(function(a){return a()})},r.processLoadQueue_=function(){var i=this.loadQueue_;this.loadQueue_=[],i.forEach(function(a){return a()})},r.hasEnoughInfoToLoad_=function(){if(this.loaderType_!=="audio")return!0;var i=this.pendingSegment_;return i?this.getCurrentMediaInfo_()?!MP({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:i.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1},r.getCurrentMediaInfo_=function(i){return i===void 0&&(i=this.pendingSegment_),i&&i.trackInfo||this.currentMediaInfo_},r.getMediaInfo_=function(i){return i===void 0&&(i=this.pendingSegment_),this.getCurrentMediaInfo_(i)||this.startingMediaInfo_},r.hasEnoughInfoToAppend_=function(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;var i=this.pendingSegment_,a=this.getCurrentMediaInfo_();if(!i||!a)return!1;var s=a.hasAudio,o=a.hasVideo,c=a.isMuxed;return!(o&&!i.videoTimingInfo||s&&!this.audioDisabled_&&!c&&!i.audioTimingInfo||MP({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:i.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))},r.handleData_=function(i,a){if(this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)){if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,i,a));return}var s=this.pendingSegment_;if(this.setTimeMapping_(s.timeline),this.updateMediaSecondsLoaded_(s.part||s.segment),this.mediaSource_.readyState!=="closed"){if(i.map&&(i.map=this.initSegmentForMap(i.map,!0),s.segment.map=i.map),i.key&&this.segmentKey(i.key,!0),s.isFmp4=i.isFmp4,s.timingInfo=s.timingInfo||{},s.isFmp4)this.trigger("fmp4"),s.timingInfo.start=s[NP(a.type)].start;else{var o=this.getCurrentMediaInfo_(),c=this.loaderType_==="main"&&o&&o.hasVideo,l;c&&(l=s.videoTimingInfo.start),s.timingInfo.start=this.trueSegmentStart_({currentStart:s.timingInfo.start,playlist:s.playlist,mediaIndex:s.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:c,firstVideoFrameTimeForData:l,videoTimingInfo:s.videoTimingInfo,audioTimingInfo:s.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(s,a.type),this.updateSourceBufferTimestampOffset_(s),s.isSyncRequest){this.updateTimingInfoEnd_(s),this.syncController_.saveSegmentTimingInfo({segmentInfo:s,shouldSaveTimelineMapping:this.loaderType_==="main"});var f=this.chooseNextRequest_();if(f.mediaIndex!==s.mediaIndex||f.partIndex!==s.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}s.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(s,a)}}},r.updateAppendInitSegmentStatus=function(i,a){this.loaderType_==="main"&&typeof i.timestampOffset=="number"&&!i.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[a]!==i.playlist&&(this.appendInitSegment_[a]=!0)},r.getInitSegmentAndUpdateState_=function(i){var a=i.type,s=i.initSegment,o=i.map,c=i.playlist;if(o){var l=ev(o);if(this.activeInitSegmentId_===l)return null;s=this.initSegmentForMap(o,!0).bytes,this.activeInitSegmentId_=l}return s&&this.appendInitSegment_[a]?(this.playlistOfLastInitSegment_[a]=c,this.appendInitSegment_[a]=!1,this.activeInitSegmentId_=null,s):null},r.handleQuotaExceededError_=function(i,a){var s=this,o=i.segmentInfo,c=i.type,l=i.bytes,f=this.sourceUpdater_.audioBuffered(),g=this.sourceUpdater_.videoBuffered();f.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Xc(f).join(", ")),g.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Xc(g).join(", "));var m=f.length?f.start(0):0,y=f.length?f.end(f.length-1):0,A=g.length?g.start(0):0,k=g.length?g.end(g.length-1):0;if(y-m<=Up&&k-A<=Up){this.logger_("On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. "+("Appended byte length: "+l.byteLength+", ")+("audio buffer: "+Xc(f).join(", ")+", ")+("video buffer: "+Xc(g).join(", ")+", ")),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:o,type:c,bytes:l}));var I=this.currentTime_(),F=I-Up;this.logger_("On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to "+F),this.remove(0,F,function(){s.logger_("On QUOTA_EXCEEDED_ERR, retrying append in "+Up+"s"),s.waitingOnRemove_=!1,s.quotaExceededErrorRetryTimeout_=Se.default.setTimeout(function(){s.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),s.quotaExceededErrorRetryTimeout_=null,s.processCallQueue_()},Up*1e3)},!0)},r.handleAppendError_=function(i,a){var s=i.segmentInfo,o=i.type,c=i.bytes;if(a){if(a.code===UR){this.handleQuotaExceededError_({segmentInfo:s,type:o,bytes:c});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",a),this.error(o+" append of "+c.length+"b failed for segment "+("#"+s.mediaIndex+" in playlist "+s.playlist.id)),this.trigger("appenderror")}},r.appendToSourceBuffer_=function(i){var a=i.segmentInfo,s=i.type,o=i.initSegment,c=i.data,l=i.bytes;if(!l){var f=[c],g=c.byteLength;o&&(f.unshift(o),g+=o.byteLength),l=fJ({bytes:g,segments:f})}this.sourceUpdater_.appendBuffer({segmentInfo:a,type:s,bytes:l},this.handleAppendError_.bind(this,{segmentInfo:a,type:s,bytes:l}))},r.handleSegmentTimingInfo_=function(i,a,s){if(!(!this.pendingSegment_||a!==this.pendingSegment_.requestId)){var o=this.pendingSegment_.segment,c=i+"TimingInfo";o[c]||(o[c]={}),o[c].transmuxerPrependedSeconds=s.prependedContentDuration||0,o[c].transmuxedPresentationStart=s.start.presentation,o[c].transmuxedDecodeStart=s.start.decode,o[c].transmuxedPresentationEnd=s.end.presentation,o[c].transmuxedDecodeEnd=s.end.decode,o[c].baseMediaDecodeTime=s.baseMediaDecodeTime}},r.appendData_=function(i,a){var s=a.type,o=a.data;if(!(!o||!o.byteLength)&&!(s==="audio"&&this.audioDisabled_)){var c=this.getInitSegmentAndUpdateState_({type:s,initSegment:a.initSegment,playlist:i.playlist,map:i.isFmp4?i.segment.map:null});this.appendToSourceBuffer_({segmentInfo:i,type:s,initSegment:c,data:o})}},r.loadSegment_=function(i){var a=this;if(this.state="WAITING",this.pendingSegment_=i,this.trimBackBuffer_(i),typeof i.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(function(){var s=el.default({},i,{forceTimestampOffset:!0});el.default(i,a.generateSegmentInfo_(s)),a.isPendingTimestampOffset_=!1,a.updateTransmuxerAndRequestSegment_(i)});return}this.updateTransmuxerAndRequestSegment_(i)},r.updateTransmuxerAndRequestSegment_=function(i){var a=this;this.shouldUpdateTransmuxerTimestampOffset_(i.timestampOffset)&&(this.gopBuffer_.length=0,i.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:i.timestampOffset}));var s=this.createSimplifiedSegmentObj_(i),o=this.isEndOfStream_(i.mediaIndex,i.playlist,i.partIndex),c=this.mediaIndex!==null,l=i.timeline!==this.currentTimeline_&&i.timeline>0,f=o||c&&l;this.logger_("Requesting "+gd(i)),s.map&&!s.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),i.abortRequests=nJ({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:s,abortFn:this.handleAbort_.bind(this,i),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",i.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",i.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:f,endedTimelineFn:function(){a.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:function(m){var y=m.message,A=m.level,k=m.stream;a.logger_(gd(i)+" logged from transmuxer stream "+k+" as a "+A+": "+y)}})},r.trimBackBuffer_=function(i){var a=CJ(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);a>0&&this.remove(0,a)},r.createSimplifiedSegmentObj_=function(i){var a=i.segment,s=i.part,o={resolvedUri:s?s.resolvedUri:a.resolvedUri,byterange:s?s.byterange:a.byterange,requestId:i.requestId,transmuxer:i.transmuxer,audioAppendStart:i.audioAppendStart,gopsToAlignWith:i.gopsToAlignWith,part:i.part},c=i.playlist.segments[i.mediaIndex-1];if(c&&c.timeline===a.timeline&&(c.videoTimingInfo?o.baseStartTime=c.videoTimingInfo.transmuxedDecodeEnd:c.audioTimingInfo&&(o.baseStartTime=c.audioTimingInfo.transmuxedDecodeEnd)),a.key){var l=a.key.iv||new Uint32Array([0,0,0,i.mediaIndex+i.playlist.mediaSequence]);o.key=this.segmentKey(a.key),o.key.iv=l}return a.map&&(o.map=this.initSegmentForMap(a.map)),o},r.saveTransferStats_=function(i){this.mediaRequests+=1,i&&(this.mediaBytesTransferred+=i.bytesReceived,this.mediaTransferDuration+=i.roundTripTime)},r.saveBandwidthRelatedStats_=function(i,a){if(this.pendingSegment_.byteLength=a.bytesReceived,i<Nm){this.logger_("Ignoring segment's bandwidth because its duration of "+i+(" is less than the min to record "+Nm));return}this.bandwidth=a.bandwidth,this.roundTrip=a.roundTripTime},r.handleTimeout_=function(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate")},r.segmentRequestFinished_=function(i,a,s){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,i,a,s));return}if(this.saveTransferStats_(a.stats),!!this.pendingSegment_&&a.requestId===this.pendingSegment_.requestId){if(i){if(this.pendingSegment_=null,this.state="READY",i.code===vo.ABORTED)return;if(this.pause(),i.code===vo.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(i),this.trigger("error");return}var o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,a.stats),o.endOfAllRequests=a.endOfAllRequests,s.gopInfo&&(this.gopBuffer_=_J(this.gopBuffer_,s.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(o)}},r.setTimeMapping_=function(i){var a=this.syncController_.mappingForTimeline(i);a!==null&&(this.timeMapping_=a)},r.updateMediaSecondsLoaded_=function(i){typeof i.start=="number"&&typeof i.end=="number"?this.mediaSecondsLoaded+=i.end-i.start:this.mediaSecondsLoaded+=i.duration},r.shouldUpdateTransmuxerTimestampOffset_=function(i){return i===null?!1:this.loaderType_==="main"&&i!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&i!==this.sourceUpdater_.audioTimestampOffset()},r.trueSegmentStart_=function(i){var a=i.currentStart,s=i.playlist,o=i.mediaIndex,c=i.firstVideoFrameTimeForData,l=i.currentVideoTimestampOffset,f=i.useVideoTimingInfo,g=i.videoTimingInfo,m=i.audioTimingInfo;if(typeof a<"u")return a;if(!f)return m.start;var y=s.segments[o-1];return o===0||!y||typeof y.start>"u"||y.end!==c+l?c:g.start},r.waitForAppendsToComplete_=function(i){var a=this.getCurrentMediaInfo_(i);if(!a){this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:1/0}),this.trigger("error");return}var s=a.hasAudio,o=a.hasVideo,c=a.isMuxed,l=this.loaderType_==="main"&&o,f=!this.audioDisabled_&&s&&!c;if(i.waitingOnAppends=0,!i.hasAppendedData_){!i.timingInfo&&typeof i.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),i.timingInfo={start:0},i.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(i),this.processMetadataQueue_()),this.checkAppendsDone_(i);return}l&&i.waitingOnAppends++,f&&i.waitingOnAppends++,l&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,i)),f&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,i))},r.checkAppendsDone_=function(i){this.checkForAbort_(i.requestId)||(i.waitingOnAppends--,i.waitingOnAppends===0&&this.handleAppendsDone_())},r.checkForIllegalMediaSwitch=function(i){var a=xJ(this.loaderType_,this.getCurrentMediaInfo_(),i);return a?(this.error({message:a,blacklistDuration:1/0}),this.trigger("error"),!0):!1},r.updateSourceBufferTimestampOffset_=function(i){if(!(i.timestampOffset===null||typeof i.timingInfo.start!="number"||i.changedTimestampOffset||this.loaderType_!=="main")){var a=!1;i.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:i.segment.videoTimingInfo,audioTimingInfo:i.segment.audioTimingInfo,timingInfo:i.timingInfo}),i.changedTimestampOffset=!0,i.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(i.timestampOffset),a=!0),i.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(i.timestampOffset),a=!0),a&&this.trigger("timestampoffset")}},r.getSegmentStartTimeForTimestampOffsetCalculation_=function(i){var a=i.videoTimingInfo,s=i.audioTimingInfo,o=i.timingInfo;return this.useDtsForTimestampOffset_?a&&typeof a.transmuxedDecodeStart=="number"?a.transmuxedDecodeStart:s&&typeof s.transmuxedDecodeStart=="number"?s.transmuxedDecodeStart:o.start:o.start},r.updateTimingInfoEnd_=function(i){i.timingInfo=i.timingInfo||{};var a=this.getMediaInfo_(),s=this.loaderType_==="main"&&a&&a.hasVideo,o=s&&i.videoTimingInfo?i.videoTimingInfo:i.audioTimingInfo;o&&(i.timingInfo.end=typeof o.end=="number"?o.end:o.start+i.duration)},r.handleAppendsDone_=function(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}var i=this.pendingSegment_;this.updateTimingInfoEnd_(i),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:this.loaderType_==="main"});var a=kJ(i,this.sourceType_);if(a&&(a.severity==="warn"?Oe.log.warn(a.message):this.logger_(a.message)),this.recordThroughput_(i),this.pendingSegment_=null,this.state="READY",i.isSyncRequest&&(this.trigger("syncinfoupdate"),!i.hasAppendedData_)){this.logger_("Throwing away un-appended sync request "+gd(i));return}this.logger_("Appended "+gd(i)),this.addSegmentMetadataCue_(i),this.fetchAtBuffer_=!0,this.currentTimeline_!==i.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:i.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:i.timeline})),this.currentTimeline_=i.timeline,this.trigger("syncinfoupdate");var s=i.segment,o=i.part,c=s.end&&this.currentTime_()-s.end>i.playlist.targetDuration*3,l=o&&o.end&&this.currentTime_()-o.end>i.playlist.partTargetDuration*3;if(c||l){this.logger_("bad "+(c?"segment":"part")+" "+gd(i)),this.resetEverything();return}var f=this.mediaIndex!==null;f&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=i.mediaIndex,this.partIndex=i.partIndex,this.isEndOfStream_(i.mediaIndex,i.playlist,i.partIndex)&&this.endOfStream(),this.trigger("appended"),i.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()},r.recordThroughput_=function(i){if(i.duration<Nm){this.logger_("Ignoring segment's throughput because its duration of "+i.duration+(" is less than the min to record "+Nm));return}var a=this.throughput.rate,s=Date.now()-i.endOfAllRequests+1,o=Math.floor(i.byteLength/s*8*1e3);this.throughput.rate+=(o-a)/++this.throughput.count},r.addSegmentMetadataCue_=function(i){if(this.segmentMetadataTrack_){var a=i.segment,s=a.start,o=a.end;if(!(!LP(s)||!LP(o))){Bp(s,o,this.segmentMetadataTrack_);var c=Se.default.WebKitDataCue||Se.default.VTTCue,l={custom:a.custom,dateTimeObject:a.dateTimeObject,dateTimeString:a.dateTimeString,bandwidth:i.playlist.attributes.BANDWIDTH,resolution:i.playlist.attributes.RESOLUTION,codecs:i.playlist.attributes.CODECS,byteLength:i.byteLength,uri:i.uri,timeline:i.timeline,playlist:i.playlist.id,start:s,end:o},f=JSON.stringify(l),g=new c(s,o,f);g.value=l,this.segmentMetadataTrack_.addCue(g)}}},e}(Oe.EventTarget);function ru(){}var FR=function(e){return typeof e!="string"?e:e.replace(/./,function(r){return r.toUpperCase()})},OJ=["video","audio"],Ow=function(e,r){var n=r[e+"Buffer"];return n&&n.updating||r.queuePending[e]},PJ=function(e,r){for(var n=0;n<r.length;n++){var i=r[n];if(i.type==="mediaSource")return null;if(i.type===e)return n}return null},hT=function t(e,r){if(r.queue.length!==0){var n=0,i=r.queue[n];if(i.type==="mediaSource"){!r.updating()&&r.mediaSource.readyState!=="closed"&&(r.queue.shift(),i.action(r),i.doneFn&&i.doneFn(),t("audio",r),t("video",r));return}if(e!=="mediaSource"&&!(!r.ready()||r.mediaSource.readyState==="closed"||Ow(e,r))){if(i.type!==e){if(n=PJ(e,r.queue),n===null)return;i=r.queue[n]}if(r.queue.splice(n,1),r.queuePending[e]=i,i.action(e,r),!i.doneFn){r.queuePending[e]=null,t(e,r);return}}}},BR=function(e,r){var n=r[e+"Buffer"],i=FR(e);n&&(n.removeEventListener("updateend",r["on"+i+"UpdateEnd_"]),n.removeEventListener("error",r["on"+i+"Error_"]),r.codecs[e]=null,r[e+"Buffer"]=null)},ho=function(e,r){return e&&r&&Array.prototype.indexOf.call(e.sourceBuffers,r)!==-1},es={appendBuffer:function(e,r,n){return function(i,a){var s=a[i+"Buffer"];if(ho(a.mediaSource,s)){a.logger_("Appending segment "+r.mediaIndex+"'s "+e.length+" bytes to "+i+"Buffer");try{s.appendBuffer(e)}catch(o){a.logger_("Error with code "+o.code+" "+(o.code===UR?"(QUOTA_EXCEEDED_ERR) ":"")+("when appending segment "+r.mediaIndex+" to "+i+"Buffer")),a.queuePending[i]=null,n(o)}}}},remove:function(e,r){return function(n,i){var a=i[n+"Buffer"];if(ho(i.mediaSource,a)){i.logger_("Removing "+e+" to "+r+" from "+n+"Buffer");try{a.remove(e,r)}catch{i.logger_("Remove "+e+" to "+r+" from "+n+"Buffer failed")}}}},timestampOffset:function(e){return function(r,n){var i=n[r+"Buffer"];ho(n.mediaSource,i)&&(n.logger_("Setting "+r+"timestampOffset to "+e),i.timestampOffset=e)}},callback:function(e){return function(r,n){e()}},endOfStream:function(e){return function(r){if(r.mediaSource.readyState==="open"){r.logger_("Calling mediaSource endOfStream("+(e||"")+")");try{r.mediaSource.endOfStream(e)}catch(n){Oe.log.warn("Failed to call media source endOfStream",n)}}}},duration:function(e){return function(r){r.logger_("Setting mediaSource duration to "+e);try{r.mediaSource.duration=e}catch(n){Oe.log.warn("Failed to set media source duration",n)}}},abort:function(){return function(e,r){if(r.mediaSource.readyState==="open"){var n=r[e+"Buffer"];if(ho(r.mediaSource,n)){r.logger_("calling abort on "+e+"Buffer");try{n.abort()}catch(i){Oe.log.warn("Failed to abort on "+e+"Buffer",i)}}}}},addSourceBuffer:function(e,r){return function(n){var i=FR(e),a=ci.getMimeForCodec(r);n.logger_("Adding "+e+"Buffer with codec "+r+" to mediaSource");var s=n.mediaSource.addSourceBuffer(a);s.addEventListener("updateend",n["on"+i+"UpdateEnd_"]),s.addEventListener("error",n["on"+i+"Error_"]),n.codecs[e]=r,n[e+"Buffer"]=s}},removeSourceBuffer:function(e){return function(r){var n=r[e+"Buffer"];if(BR(e,r),!!ho(r.mediaSource,n)){r.logger_("Removing "+e+"Buffer with codec "+r.codecs[e]+" from mediaSource");try{r.mediaSource.removeSourceBuffer(n)}catch(i){Oe.log.warn("Failed to removeSourceBuffer "+e+"Buffer",i)}}}},changeType:function(e){return function(r,n){var i=n[r+"Buffer"],a=ci.getMimeForCodec(e);ho(n.mediaSource,i)&&n.codecs[r]!==e&&(n.logger_("changing "+r+"Buffer codec from "+n.codecs[r]+" to "+e),i.changeType(a),n.codecs[r]=e)}}},ts=function(e){var r=e.type,n=e.sourceUpdater,i=e.action,a=e.doneFn,s=e.name;n.queue.push({type:r,action:i,doneFn:a,name:s}),hT(r,n)},UP=function(e,r){return function(n){if(r.queuePending[e]){var i=r.queuePending[e].doneFn;r.queuePending[e]=null,i&&i(r[e+"Error_"])}hT(e,r)}},qR=function(t){Ct.default(e,t);function e(n){var i;return i=t.call(this)||this,i.mediaSource=n,i.sourceopenListener_=function(){return hT("mediaSource",ir.default(i))},i.mediaSource.addEventListener("sourceopen",i.sourceopenListener_),i.logger_=Bs("SourceUpdater"),i.audioTimestampOffset_=0,i.videoTimestampOffset_=0,i.queue=[],i.queuePending={audio:null,video:null},i.delayedAudioAppendQueue_=[],i.videoAppendQueued_=!1,i.codecs={},i.onVideoUpdateEnd_=UP("video",ir.default(i)),i.onAudioUpdateEnd_=UP("audio",ir.default(i)),i.onVideoError_=function(a){i.videoError_=a},i.onAudioError_=function(a){i.audioError_=a},i.createdSourceBuffers_=!1,i.initializedEme_=!1,i.triggeredReady_=!1,i}var r=e.prototype;return r.initializedEme=function(){this.initializedEme_=!0,this.triggerReady()},r.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_},r.hasInitializedAnyEme=function(){return this.initializedEme_},r.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},r.createSourceBuffers=function(i){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(i),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},r.triggerReady=function(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},r.addSourceBuffer=function(i,a){ts({type:"mediaSource",sourceUpdater:this,action:es.addSourceBuffer(i,a),name:"addSourceBuffer"})},r.abort=function(i){ts({type:i,sourceUpdater:this,action:es.abort(i),name:"abort"})},r.removeSourceBuffer=function(i){if(!this.canRemoveSourceBuffer()){Oe.log.error("removeSourceBuffer is not supported!");return}ts({type:"mediaSource",sourceUpdater:this,action:es.removeSourceBuffer(i),name:"removeSourceBuffer"})},r.canRemoveSourceBuffer=function(){return!Oe.browser.IE_VERSION&&!Oe.browser.IS_FIREFOX&&Se.default.MediaSource&&Se.default.MediaSource.prototype&&typeof Se.default.MediaSource.prototype.removeSourceBuffer=="function"},e.canChangeType=function(){return Se.default.SourceBuffer&&Se.default.SourceBuffer.prototype&&typeof Se.default.SourceBuffer.prototype.changeType=="function"},r.canChangeType=function(){return this.constructor.canChangeType()},r.changeType=function(i,a){if(!this.canChangeType()){Oe.log.error("changeType is not supported!");return}ts({type:i,sourceUpdater:this,action:es.changeType(a),name:"changeType"})},r.addOrChangeSourceBuffers=function(i){var a=this;if(!i||typeof i!="object"||Object.keys(i).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(i).forEach(function(s){var o=i[s];if(!a.hasCreatedSourceBuffers())return a.addSourceBuffer(s,o);a.canChangeType()&&a.changeType(s,o)})},r.appendBuffer=function(i,a){var s=this,o=i.segmentInfo,c=i.type,l=i.bytes;if(this.processedAppend_=!0,c==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([i,a]),this.logger_("delayed audio append of "+l.length+" until video append");return}var f=a;if(ts({type:c,sourceUpdater:this,action:es.appendBuffer(l,o||{mediaIndex:-1},f),doneFn:a,name:"appendBuffer"}),c==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;var g=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+g.length+" appendBuffers"),this.delayedAudioAppendQueue_.length=0,g.forEach(function(m){s.appendBuffer.apply(s,m)})}},r.audioBuffered=function(){return ho(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Oe.createTimeRange()},r.videoBuffered=function(){return ho(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Oe.createTimeRange()},r.buffered=function(){var i=ho(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,a=ho(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return a&&!i?this.audioBuffered():i&&!a?this.videoBuffered():QX(this.audioBuffered(),this.videoBuffered())},r.setDuration=function(i,a){a===void 0&&(a=ru),ts({type:"mediaSource",sourceUpdater:this,action:es.duration(i),name:"duration",doneFn:a})},r.endOfStream=function(i,a){i===void 0&&(i=null),a===void 0&&(a=ru),typeof i!="string"&&(i=void 0),ts({type:"mediaSource",sourceUpdater:this,action:es.endOfStream(i),name:"endOfStream",doneFn:a})},r.removeAudio=function(i,a,s){if(s===void 0&&(s=ru),!this.audioBuffered().length||this.audioBuffered().end(0)===0){s();return}ts({type:"audio",sourceUpdater:this,action:es.remove(i,a),doneFn:s,name:"remove"})},r.removeVideo=function(i,a,s){if(s===void 0&&(s=ru),!this.videoBuffered().length||this.videoBuffered().end(0)===0){s();return}ts({type:"video",sourceUpdater:this,action:es.remove(i,a),doneFn:s,name:"remove"})},r.updating=function(){return!!(Ow("audio",this)||Ow("video",this))},r.audioTimestampOffset=function(i){return typeof i<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==i&&(ts({type:"audio",sourceUpdater:this,action:es.timestampOffset(i),name:"timestampOffset"}),this.audioTimestampOffset_=i),this.audioTimestampOffset_},r.videoTimestampOffset=function(i){return typeof i<"u"&&this.videoBuffer&&this.videoTimestampOffset!==i&&(ts({type:"video",sourceUpdater:this,action:es.timestampOffset(i),name:"timestampOffset"}),this.videoTimestampOffset_=i),this.videoTimestampOffset_},r.audioQueueCallback=function(i){this.audioBuffer&&ts({type:"audio",sourceUpdater:this,action:es.callback(i),name:"callback"})},r.videoQueueCallback=function(i){this.videoBuffer&&ts({type:"video",sourceUpdater:this,action:es.callback(i),name:"callback"})},r.dispose=function(){var i=this;this.trigger("dispose"),OJ.forEach(function(a){i.abort(a),i.canRemoveSourceBuffer()?i.removeSourceBuffer(a):i[a+"QueueCallback"](function(){return BR(a,i)})}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()},e}(Oe.EventTarget),FP=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},BP=new Uint8Array(`

`.split("").map(function(t){return t.charCodeAt(0)})),RJ=function(t){Ct.default(e,t);function e(n,i){var a;return i===void 0&&(i={}),a=t.call(this,n,i)||this,a.mediaSource_=null,a.subtitlesTrack_=null,a.loaderType_="subtitle",a.featuresNativeTextTracks_=n.featuresNativeTextTracks,a.shouldSaveSegmentTimingInfo_=!1,a}var r=e.prototype;return r.createTransmuxer_=function(){return null},r.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Oe.createTimeRanges();var i=this.subtitlesTrack_.cues,a=i[0].startTime,s=i[i.length-1].startTime;return Oe.createTimeRanges([[a,s]])},r.initSegmentForMap=function(i,a){if(a===void 0&&(a=!1),!i)return null;var s=ev(i),o=this.initSegments_[s];if(a&&!o&&i.bytes){var c=BP.byteLength+i.bytes.byteLength,l=new Uint8Array(c);l.set(i.bytes),l.set(BP,i.bytes.byteLength),this.initSegments_[s]=o={resolvedUri:i.resolvedUri,byterange:i.byterange,bytes:l}}return o||i},r.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},r.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},r.track=function(i){return typeof i>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=i,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)},r.remove=function(i,a){Bp(i,a,this.subtitlesTrack_)},r.fillBuffer_=function(){var i=this,a=this.chooseNextRequest_();if(a){if(this.syncController_.timestampOffsetForTimeline(a.timeline)===null){var s=function(){i.state="READY",i.paused()||i.monitorBuffer_()};this.syncController_.one("timestampoffset",s),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(a)}},r.timestampOffsetForSegment_=function(){return null},r.chooseNextRequest_=function(){return this.skipEmptySegments_(t.prototype.chooseNextRequest_.call(this))},r.skipEmptySegments_=function(i){for(;i&&i.segment.empty;){if(i.mediaIndex+1>=i.playlist.segments.length){i=null;break}i=this.generateSegmentInfo_({playlist:i.playlist,mediaIndex:i.mediaIndex+1,startOfSegment:i.startOfSegment+i.duration,isSyncRequest:i.isSyncRequest})}return i},r.stopForError=function(i){this.error(i),this.state="READY",this.pause(),this.trigger("error")},r.segmentRequestFinished_=function(i,a,s){var o=this;if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(a.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(i){i.code===vo.TIMEOUT&&this.handleTimeout_(),i.code===vo.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(i);return}var c=this.pendingSegment_;this.saveBandwidthRelatedStats_(c.duration,a.stats),this.state="APPENDING",this.trigger("appending");var l=c.segment;if(l.map&&(l.map.bytes=a.map.bytes),c.bytes=a.bytes,typeof Se.default.WebVTT!="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var f,g=function(){o.subtitlesTrack_.tech_.off("vttjsloaded",f),o.stopForError({message:"Error loading vtt.js"})};f=function(){o.subtitlesTrack_.tech_.off("vttjserror",g),o.segmentRequestFinished_(i,a,s)},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",f),this.subtitlesTrack_.tech_.one("vttjserror",g);return}l.requested=!0;try{this.parseVTTCues_(c)}catch(m){this.stopForError({message:m.message});return}if(this.updateTimeMapping_(c,this.syncController_.timelines[c.timeline],this.playlist_),c.cues.length?c.timingInfo={start:c.cues[0].startTime,end:c.cues[c.cues.length-1].endTime}:c.timingInfo={start:c.startOfSegment,end:c.startOfSegment+c.duration},c.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}c.byteLength=c.bytes.byteLength,this.mediaSecondsLoaded+=l.duration,c.cues.forEach(function(m){o.subtitlesTrack_.addCue(o.featuresNativeTextTracks_?new Se.default.VTTCue(m.startTime,m.endTime,m.text):m)}),yJ(this.subtitlesTrack_),this.handleAppendsDone_()},r.handleData_=function(){},r.updateTimingInfoEnd_=function(){},r.parseVTTCues_=function(i){var a,s=!1;typeof Se.default.TextDecoder=="function"?a=new Se.default.TextDecoder("utf8"):(a=Se.default.WebVTT.StringDecoder(),s=!0);var o=new Se.default.WebVTT.Parser(Se.default,Se.default.vttjs,a);if(i.cues=[],i.timestampmap={MPEGTS:0,LOCAL:0},o.oncue=i.cues.push.bind(i.cues),o.ontimestampmap=function(f){i.timestampmap=f},o.onparsingerror=function(f){Oe.log.warn("Error encountered when parsing cues: "+f.message)},i.segment.map){var c=i.segment.map.bytes;s&&(c=FP(c)),o.parse(c)}var l=i.bytes;s&&(l=FP(l)),o.parse(l),o.flush()},r.updateTimeMapping_=function(i,a,s){var o=i.segment;if(a){if(!i.cues.length){o.empty=!0;return}var c=i.timestampmap,l=c.MPEGTS/jm.ONE_SECOND_IN_TS-c.LOCAL+a.mapping;if(i.cues.forEach(function(m){m.startTime+=l,m.endTime+=l}),!s.syncInfo){var f=i.cues[0].startTime,g=i.cues[i.cues.length-1].startTime;s.syncInfo={mediaSequence:s.mediaSequence+i.mediaIndex,time:Math.min(f,g-o.duration)}}}},e}(kw),DJ=function(e,r){for(var n=e.cues,i=0;i<n.length;i++){var a=n[i];if(r>=a.adStartTime&&r<=a.adEndTime)return a}return null},LJ=function(e,r,n){if(n===void 0&&(n=0),!!e.segments)for(var i=n,a,s=0;s<e.segments.length;s++){var o=e.segments[s];if(a||(a=DJ(r,i+o.duration/2)),a){if("cueIn"in o){a.endTime=i,a.adEndTime=i,i+=o.duration,a=null;continue}if(i<a.endTime){i+=o.duration;continue}a.endTime+=o.duration}else if("cueOut"in o&&(a=new Se.default.VTTCue(i,i+o.duration,o.cueOut),a.adStartTime=i,a.adEndTime=i+parseFloat(o.cueOut),r.addCue(a)),"cueOutCont"in o){var c=o.cueOutCont.split("/").map(parseFloat),l=c[0],f=c[1];a=new Se.default.VTTCue(i,i+o.duration,""),a.adStartTime=i-l,a.adEndTime=a.adStartTime+f,r.addCue(a)}i+=o.duration}},NJ=86400,qP=[{name:"VOD",run:function(e,r,n,i,a){if(n!==1/0){var s={time:0,segmentIndex:0,partIndex:null};return s}return null}},{name:"ProgramDateTime",run:function(e,r,n,i,a){if(!Object.keys(e.timelineToDatetimeMappings).length)return null;var s=null,o=null,c=ww(r);a=a||0;for(var l=0;l<c.length;l++){var f=r.endList||a===0?l:c.length-(l+1),g=c[f],m=g.segment,y=e.timelineToDatetimeMappings[m.timeline];if(!(!y||!m.dateTimeObject)){var A=m.dateTimeObject.getTime()/1e3,k=A+y;if(m.parts&&typeof g.partIndex=="number")for(var I=0;I<g.partIndex;I++)k+=m.parts[I].duration;var F=Math.abs(a-k);if(o!==null&&(F===0||o<F))break;o=F,s={time:k,segmentIndex:g.segmentIndex,partIndex:g.partIndex}}}return s}},{name:"Segment",run:function(e,r,n,i,a){var s=null,o=null;a=a||0;for(var c=ww(r),l=0;l<c.length;l++){var f=r.endList||a===0?l:c.length-(l+1),g=c[f],m=g.segment,y=g.part&&g.part.start||m&&m.start;if(m.timeline===i&&typeof y<"u"){var A=Math.abs(a-y);if(o!==null&&o<A)break;(!s||o===null||o>=A)&&(o=A,s={time:y,segmentIndex:g.segmentIndex,partIndex:g.partIndex})}}return s}},{name:"Discontinuity",run:function(e,r,n,i,a){var s=null;if(a=a||0,r.discontinuityStarts&&r.discontinuityStarts.length)for(var o=null,c=0;c<r.discontinuityStarts.length;c++){var l=r.discontinuityStarts[c],f=r.discontinuitySequence+c+1,g=e.discontinuities[f];if(g){var m=Math.abs(a-g.time);if(o!==null&&o<m)break;(!s||o===null||o>=m)&&(o=m,s={time:g.time,segmentIndex:l,partIndex:null})}}return s}},{name:"Playlist",run:function(e,r,n,i,a){if(r.syncInfo){var s={time:r.syncInfo.time,segmentIndex:r.syncInfo.mediaSequence-r.mediaSequence,partIndex:null};return s}return null}}],MJ=function(t){Ct.default(e,t);function e(n){var i;return i=t.call(this)||this,i.timelines=[],i.discontinuities=[],i.timelineToDatetimeMappings={},i.logger_=Bs("SyncController"),i}var r=e.prototype;return r.getSyncPoint=function(i,a,s,o){var c=this.runStrategies_(i,a,s,o);return c.length?this.selectSyncPoint_(c,{key:"time",value:o}):null},r.getExpiredTime=function(i,a){if(!i||!i.segments)return null;var s=this.runStrategies_(i,a,i.discontinuitySequence,0);if(!s.length)return null;var o=this.selectSyncPoint_(s,{key:"segmentIndex",value:0});return o.segmentIndex>0&&(o.time*=-1),Math.abs(o.time+jp({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:o.segmentIndex,endIndex:0}))},r.runStrategies_=function(i,a,s,o){for(var c=[],l=0;l<qP.length;l++){var f=qP[l],g=f.run(this,i,a,s,o);g&&(g.strategy=f.name,c.push({strategy:f.name,syncPoint:g}))}return c},r.selectSyncPoint_=function(i,a){for(var s=i[0].syncPoint,o=Math.abs(i[0].syncPoint[a.key]-a.value),c=i[0].strategy,l=1;l<i.length;l++){var f=Math.abs(i[l].syncPoint[a.key]-a.value);f<o&&(o=f,s=i[l].syncPoint,c=i[l].strategy)}return this.logger_("syncPoint for ["+a.key+": "+a.value+"] chosen with strategy"+(" ["+c+"]: [time:"+s.time+",")+(" segmentIndex:"+s.segmentIndex)+(typeof s.partIndex=="number"?",partIndex:"+s.partIndex:"")+"]"),s},r.saveExpiredSegmentInfo=function(i,a){var s=a.mediaSequence-i.mediaSequence;if(s>NJ){Oe.log.warn("Not saving expired segment info. Media sequence gap "+s+" is too large.");return}for(var o=s-1;o>=0;o--){var c=i.segments[o];if(c&&typeof c.start<"u"){a.syncInfo={mediaSequence:i.mediaSequence+o,time:c.start},this.logger_("playlist refresh sync: [time:"+a.syncInfo.time+","+(" mediaSequence: "+a.syncInfo.mediaSequence+"]")),this.trigger("syncinfoupdate");break}}},r.setDateTimeMappingForStart=function(i){if(this.timelineToDatetimeMappings={},i.segments&&i.segments.length&&i.segments[0].dateTimeObject){var a=i.segments[0],s=a.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[a.timeline]=-s}},r.saveSegmentTimingInfo=function(i){var a=i.segmentInfo,s=i.shouldSaveTimelineMapping,o=this.calculateSegmentTimeMapping_(a,a.timingInfo,s),c=a.segment;o&&(this.saveDiscontinuitySyncInfo_(a),a.playlist.syncInfo||(a.playlist.syncInfo={mediaSequence:a.playlist.mediaSequence+a.mediaIndex,time:c.start}));var l=c.dateTimeObject;c.discontinuity&&s&&l&&(this.timelineToDatetimeMappings[c.timeline]=-(l.getTime()/1e3))},r.timestampOffsetForTimeline=function(i){return typeof this.timelines[i]>"u"?null:this.timelines[i].time},r.mappingForTimeline=function(i){return typeof this.timelines[i]>"u"?null:this.timelines[i].mapping},r.calculateSegmentTimeMapping_=function(i,a,s){var o=i.segment,c=i.part,l=this.timelines[i.timeline],f,g;if(typeof i.timestampOffset=="number")l={time:i.startOfSegment,mapping:i.startOfSegment-a.start},s&&(this.timelines[i.timeline]=l,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+i.timeline+": "+("[time: "+l.time+"] [mapping: "+l.mapping+"]"))),f=i.startOfSegment,g=a.end+l.mapping;else if(l)f=a.start+l.mapping,g=a.end+l.mapping;else return!1;return c&&(c.start=f,c.end=g),(!o.start||f<o.start)&&(o.start=f),o.end=g,!0},r.saveDiscontinuitySyncInfo_=function(i){var a=i.playlist,s=i.segment;if(s.discontinuity)this.discontinuities[s.timeline]={time:s.start,accuracy:0};else if(a.discontinuityStarts&&a.discontinuityStarts.length)for(var o=0;o<a.discontinuityStarts.length;o++){var c=a.discontinuityStarts[o],l=a.discontinuitySequence+o+1,f=c-i.mediaIndex,g=Math.abs(f);if(!this.discontinuities[l]||this.discontinuities[l].accuracy>g){var m=void 0;f<0?m=s.start-jp({defaultDuration:a.targetDuration,durationList:a.segments,startIndex:i.mediaIndex,endIndex:c}):m=s.end+jp({defaultDuration:a.targetDuration,durationList:a.segments,startIndex:i.mediaIndex+1,endIndex:c}),this.discontinuities[l]={time:m,accuracy:g}}}},r.dispose=function(){this.trigger("dispose"),this.off()},e}(Oe.EventTarget),$J=function(t){Ct.default(e,t);function e(){var n;return n=t.call(this)||this,n.pendingTimelineChanges_={},n.lastTimelineChanges_={},n}var r=e.prototype;return r.clearPendingTimelineChange=function(i){this.pendingTimelineChanges_[i]=null,this.trigger("pendingtimelinechange")},r.pendingTimelineChange=function(i){var a=i.type,s=i.from,o=i.to;return typeof s=="number"&&typeof o=="number"&&(this.pendingTimelineChanges_[a]={type:a,from:s,to:o},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[a]},r.lastTimelineChange=function(i){var a=i.type,s=i.from,o=i.to;return typeof s=="number"&&typeof o=="number"&&(this.lastTimelineChanges_[a]={type:a,from:s,to:o},delete this.pendingTimelineChanges_[a],this.trigger("timelinechange")),this.lastTimelineChanges_[a]},r.dispose=function(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()},e}(Oe.EventTarget),UJ=AR(IR(function(){var t=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:{};function e(L,H,j){return j={path:H,exports:{},require:function(V,ie){return r(V,ie??j.path)}},L(j,j.exports),j.exports}function r(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var n=e(function(L){function H(X,V){for(var ie=0;ie<V.length;ie++){var fe=V[ie];fe.enumerable=fe.enumerable||!1,fe.configurable=!0,"value"in fe&&(fe.writable=!0),Object.defineProperty(X,fe.key,fe)}}function j(X,V,ie){return V&&H(X.prototype,V),ie&&H(X,ie),X}L.exports=j,L.exports.default=L.exports,L.exports.__esModule=!0}),i=e(function(L){function H(j,X){return L.exports=H=Object.setPrototypeOf||function(ie,fe){return ie.__proto__=fe,ie},L.exports.default=L.exports,L.exports.__esModule=!0,H(j,X)}L.exports=H,L.exports.default=L.exports,L.exports.__esModule=!0}),a=e(function(L){function H(j,X){j.prototype=Object.create(X.prototype),j.prototype.constructor=j,i(j,X)}L.exports=H,L.exports.default=L.exports,L.exports.__esModule=!0}),s=function(){function L(){this.listeners={}}var H=L.prototype;return H.on=function(X,V){this.listeners[X]||(this.listeners[X]=[]),this.listeners[X].push(V)},H.off=function(X,V){if(!this.listeners[X])return!1;var ie=this.listeners[X].indexOf(V);return this.listeners[X]=this.listeners[X].slice(0),this.listeners[X].splice(ie,1),ie>-1},H.trigger=function(X){var V=this.listeners[X];if(V)if(arguments.length===2)for(var ie=V.length,fe=0;fe<ie;++fe)V[fe].call(this,arguments[1]);else for(var Re=Array.prototype.slice.call(arguments,1),ye=V.length,ze=0;ze<ye;++ze)V[ze].apply(this,Re)},H.dispose=function(){this.listeners={}},H.pipe=function(X){this.on("data",function(V){X.push(V)})},L}();function o(L){return L.subarray(0,L.byteLength-L[L.byteLength-1])}var c=function(){var H=[[[],[],[],[],[]],[[],[],[],[],[]]],j=H[0],X=H[1],V=j[4],ie=X[4],fe,Re,ye,ze=[],Ue=[],de,Q,Fe,We,tt,Le;for(fe=0;fe<256;fe++)Ue[(ze[fe]=fe<<1^(fe>>7)*283)^fe]=fe;for(Re=ye=0;!V[Re];Re^=de||1,ye=Ue[ye]||1)for(We=ye^ye<<1^ye<<2^ye<<3^ye<<4,We=We>>8^We&255^99,V[Re]=We,ie[We]=Re,Fe=ze[Q=ze[de=ze[Re]]],Le=Fe*16843009^Q*65537^de*257^Re*16843008,tt=ze[We]*257^We*16843008,fe=0;fe<4;fe++)j[fe][Re]=tt=tt<<24^tt>>>8,X[fe][We]=Le=Le<<24^Le>>>8;for(fe=0;fe<5;fe++)j[fe]=j[fe].slice(0),X[fe]=X[fe].slice(0);return H},l=null,f=function(){function L(j){l||(l=c()),this._tables=[[l[0][0].slice(),l[0][1].slice(),l[0][2].slice(),l[0][3].slice(),l[0][4].slice()],[l[1][0].slice(),l[1][1].slice(),l[1][2].slice(),l[1][3].slice(),l[1][4].slice()]];var X,V,ie,fe=this._tables[0][4],Re=this._tables[1],ye=j.length,ze=1;if(ye!==4&&ye!==6&&ye!==8)throw new Error("Invalid aes key size");var Ue=j.slice(0),de=[];for(this._key=[Ue,de],X=ye;X<4*ye+28;X++)ie=Ue[X-1],(X%ye===0||ye===8&&X%ye===4)&&(ie=fe[ie>>>24]<<24^fe[ie>>16&255]<<16^fe[ie>>8&255]<<8^fe[ie&255],X%ye===0&&(ie=ie<<8^ie>>>24^ze<<24,ze=ze<<1^(ze>>7)*283)),Ue[X]=Ue[X-ye]^ie;for(V=0;X;V++,X--)ie=Ue[V&3?X:X-4],X<=4||V<4?de[V]=ie:de[V]=Re[0][fe[ie>>>24]]^Re[1][fe[ie>>16&255]]^Re[2][fe[ie>>8&255]]^Re[3][fe[ie&255]]}var H=L.prototype;return H.decrypt=function(X,V,ie,fe,Re,ye){var ze=this._key[1],Ue=X^ze[0],de=fe^ze[1],Q=ie^ze[2],Fe=V^ze[3],We,tt,Le,Tt=ze.length/4-2,It,St=4,Zt=this._tables[1],Ze=Zt[0],Z=Zt[1],me=Zt[2],ke=Zt[3],we=Zt[4];for(It=0;It<Tt;It++)We=Ze[Ue>>>24]^Z[de>>16&255]^me[Q>>8&255]^ke[Fe&255]^ze[St],tt=Ze[de>>>24]^Z[Q>>16&255]^me[Fe>>8&255]^ke[Ue&255]^ze[St+1],Le=Ze[Q>>>24]^Z[Fe>>16&255]^me[Ue>>8&255]^ke[de&255]^ze[St+2],Fe=Ze[Fe>>>24]^Z[Ue>>16&255]^me[de>>8&255]^ke[Q&255]^ze[St+3],St+=4,Ue=We,de=tt,Q=Le;for(It=0;It<4;It++)Re[(3&-It)+ye]=we[Ue>>>24]<<24^we[de>>16&255]<<16^we[Q>>8&255]<<8^we[Fe&255]^ze[St++],We=Ue,Ue=de,de=Q,Q=Fe,Fe=We},L}(),g=function(L){a(H,L);function H(){var X;return X=L.call(this,s)||this,X.jobs=[],X.delay=1,X.timeout_=null,X}var j=H.prototype;return j.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},j.push=function(V){this.jobs.push(V),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},H}(s),m=function(H){return H<<24|(H&65280)<<8|(H&16711680)>>8|H>>>24},y=function(H,j,X){var V=new Int32Array(H.buffer,H.byteOffset,H.byteLength>>2),ie=new f(Array.prototype.slice.call(j)),fe=new Uint8Array(H.byteLength),Re=new Int32Array(fe.buffer),ye,ze,Ue,de,Q,Fe,We,tt,Le;for(ye=X[0],ze=X[1],Ue=X[2],de=X[3],Le=0;Le<V.length;Le+=4)Q=m(V[Le]),Fe=m(V[Le+1]),We=m(V[Le+2]),tt=m(V[Le+3]),ie.decrypt(Q,Fe,We,tt,Re,Le),Re[Le]=m(Re[Le]^ye),Re[Le+1]=m(Re[Le+1]^ze),Re[Le+2]=m(Re[Le+2]^Ue),Re[Le+3]=m(Re[Le+3]^de),ye=Q,ze=Fe,Ue=We,de=tt;return fe},A=function(){function L(j,X,V,ie){var fe=L.STEP,Re=new Int32Array(j.buffer),ye=new Uint8Array(j.byteLength),ze=0;for(this.asyncStream_=new g,this.asyncStream_.push(this.decryptChunk_(Re.subarray(ze,ze+fe),X,V,ye)),ze=fe;ze<Re.length;ze+=fe)V=new Uint32Array([m(Re[ze-4]),m(Re[ze-3]),m(Re[ze-2]),m(Re[ze-1])]),this.asyncStream_.push(this.decryptChunk_(Re.subarray(ze,ze+fe),X,V,ye));this.asyncStream_.push(function(){ie(null,o(ye))})}var H=L.prototype;return H.decryptChunk_=function(X,V,ie,fe){return function(){var Re=y(X,V,ie);fe.set(Re,X.byteOffset)}},n(L,null,[{key:"STEP",get:function(){return 32e3}}]),L}(),k;typeof window<"u"?k=window:typeof t<"u"?k=t:typeof self<"u"?k=self:k={};var I=k,F=function(H){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(H):H&&H.buffer instanceof ArrayBuffer},J=I.BigInt||Number;J("0x1"),J("0x100"),J("0x10000"),J("0x1000000"),J("0x100000000"),J("0x10000000000"),J("0x1000000000000"),J("0x100000000000000"),J("0x10000000000000000");var pe=function(H){var j={};return Object.keys(H).forEach(function(X){var V=H[X];F(V)?j[X]={bytes:V.buffer,byteOffset:V.byteOffset,byteLength:V.byteLength}:j[X]=V}),j};self.onmessage=function(L){var H=L.data,j=new Uint8Array(H.encrypted.bytes,H.encrypted.byteOffset,H.encrypted.byteLength),X=new Uint32Array(H.key.bytes,H.key.byteOffset,H.key.byteLength/4),V=new Uint32Array(H.iv.bytes,H.iv.byteOffset,H.iv.byteLength/4);new A(j,X,V,function(ie,fe){self.postMessage(pe({source:H.source,decrypted:fe}),[fe.buffer])})}})),FJ=CR(UJ),BJ=function(e){var r=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(r="main-desc"),r},nv=function(e,r){e.abort(),e.pause(),r&&r.activePlaylistLoader&&(r.activePlaylistLoader.pause(),r.activePlaylistLoader=null)},Pw=function(e,r){r.activePlaylistLoader=e,e.load()},qJ=function(e,r){return function(){var n=r.segmentLoaders,i=n[e],a=n.main,s=r.mediaTypes[e],o=s.activeTrack(),c=s.getActiveGroup(),l=s.activePlaylistLoader,f=s.lastGroup_;if(!(c&&f&&c.id===f.id)&&(s.lastGroup_=c,s.lastTrack_=o,nv(i,s),!(!c||c.isMasterPlaylist))){if(!c.playlistLoader){l&&a.resetEverything();return}i.resyncLoader(),Pw(c.playlistLoader,s)}}},jJ=function(e,r){return function(){var n=r.segmentLoaders[e],i=r.mediaTypes[e];i.lastGroup_=null,n.abort(),n.pause()}},HJ=function(e,r){return function(){var n=r.masterPlaylistLoader,i=r.segmentLoaders,a=i[e],s=i.main,o=r.mediaTypes[e],c=o.activeTrack(),l=o.getActiveGroup(),f=o.activePlaylistLoader,g=o.lastTrack_;if(!(g&&c&&g.id===c.id)&&(o.lastGroup_=l,o.lastTrack_=c,nv(a,o),!!l)){if(l.isMasterPlaylist){if(!c||!g||c.id===g.id)return;var m=r.vhs.masterPlaylistController_,y=m.selectPlaylist();if(m.media()===y)return;o.logger_("track change. Switching master audio from "+g.id+" to "+c.id),n.pause(),s.resetEverything(),m.fastQualityChange_(y);return}if(e==="AUDIO"){if(!l.playlistLoader){s.setAudio(!0),s.resetEverything();return}a.setAudio(!0),s.setAudio(!1)}if(f===l.playlistLoader){Pw(l.playlistLoader,o);return}a.track&&a.track(c),a.resetEverything(),Pw(l.playlistLoader,o)}}},av={AUDIO:function(e,r){return function(){var n=r.segmentLoaders[e],i=r.mediaTypes[e],a=r.blacklistCurrentPlaylist;nv(n,i);var s=i.activeTrack(),o=i.activeGroup(),c=(o.filter(function(g){return g.default})[0]||o[0]).id,l=i.tracks[c];if(s===l){a({message:"Problem encountered loading the default audio track."});return}Oe.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(var f in i.tracks)i.tracks[f].enabled=i.tracks[f]===l;i.onTrackChanged()}},SUBTITLES:function(e,r){return function(){var n=r.segmentLoaders[e],i=r.mediaTypes[e];Oe.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),nv(n,i);var a=i.activeTrack();a&&(a.mode="disabled"),i.onTrackChanged()}}},jP={AUDIO:function(e,r,n){if(r){var i=n.tech,a=n.requestOptions,s=n.segmentLoaders[e];r.on("loadedmetadata",function(){var o=r.media();s.playlist(o,a),(!i.paused()||o.endList&&i.preload()!=="none")&&s.load()}),r.on("loadedplaylist",function(){s.playlist(r.media(),a),i.paused()||s.load()}),r.on("error",av[e](e,n))}},SUBTITLES:function(e,r,n){var i=n.tech,a=n.requestOptions,s=n.segmentLoaders[e],o=n.mediaTypes[e];r.on("loadedmetadata",function(){var c=r.media();s.playlist(c,a),s.track(o.activeTrack()),(!i.paused()||c.endList&&i.preload()!=="none")&&s.load()}),r.on("loadedplaylist",function(){s.playlist(r.media(),a),i.paused()||s.load()}),r.on("error",av[e](e,n))}},GJ={AUDIO:function(e,r){var n=r.vhs,i=r.sourceType,a=r.segmentLoaders[e],s=r.requestOptions,o=r.master.mediaGroups,c=r.mediaTypes[e],l=c.groups,f=c.tracks,g=c.logger_,m=r.masterPlaylistLoader,y=eh(m.master);(!o[e]||Object.keys(o[e]).length===0)&&(o[e]={main:{default:{default:!0}}},y&&(o[e].main.default.playlists=m.master.playlists));for(var A in o[e]){l[A]||(l[A]=[]);for(var k in o[e][A]){var I=o[e][A][k],F=void 0;if(y?(g("AUDIO group '"+A+"' label '"+k+"' is a master playlist"),I.isMasterPlaylist=!0,F=null):i==="vhs-json"&&I.playlists?F=new yd(I.playlists[0],n,s):I.resolvedUri?F=new yd(I.resolvedUri,n,s):I.playlists&&i==="dash"?F=new Aw(I.playlists[0],n,s,m):F=null,I=Oe.mergeOptions({id:k,playlistLoader:F},I),jP[e](e,I.playlistLoader,r),l[A].push(I),typeof f[k]>"u"){var J=new Oe.AudioTrack({id:k,kind:BJ(I),enabled:!1,language:I.language,default:I.default,label:k});f[k]=J}}}a.on("error",av[e](e,r))},SUBTITLES:function(e,r){var n=r.tech,i=r.vhs,a=r.sourceType,s=r.segmentLoaders[e],o=r.requestOptions,c=r.master.mediaGroups,l=r.mediaTypes[e],f=l.groups,g=l.tracks,m=r.masterPlaylistLoader;for(var y in c[e]){f[y]||(f[y]=[]);for(var A in c[e][y])if(!c[e][y][A].forced){var k=c[e][y][A],I=void 0;if(a==="hls")I=new yd(k.resolvedUri,i,o);else if(a==="dash"){var F=k.playlists.filter(function(pe){return pe.excludeUntil!==1/0});if(!F.length)return;I=new Aw(k.playlists[0],i,o,m)}else a==="vhs-json"&&(I=new yd(k.playlists?k.playlists[0]:k.resolvedUri,i,o));if(k=Oe.mergeOptions({id:A,playlistLoader:I},k),jP[e](e,k.playlistLoader,r),f[y].push(k),typeof g[A]>"u"){var J=n.addRemoteTextTrack({id:A,kind:"subtitles",default:k.default&&k.autoselect,language:k.language,label:A},!1).track;g[A]=J}}}s.on("error",av[e](e,r))},"CLOSED-CAPTIONS":function(e,r){var n=r.tech,i=r.master.mediaGroups,a=r.mediaTypes[e],s=a.groups,o=a.tracks;for(var c in i[e]){s[c]||(s[c]=[]);for(var l in i[e][c]){var f=i[e][c][l];if(/^(?:CC|SERVICE)/.test(f.instreamId)){var g=n.options_.vhs&&n.options_.vhs.captionServices||{},m={label:l,language:f.language,instreamId:f.instreamId,default:f.default&&f.autoselect};if(g[m.instreamId]&&(m=Oe.mergeOptions(m,g[m.instreamId])),m.default===void 0&&delete m.default,s[c].push(Oe.mergeOptions({id:l},f)),typeof o[l]>"u"){var y=n.addRemoteTextTrack({id:m.instreamId,kind:"captions",default:m.default,language:m.language,label:m.label},!1).track;o[l]=y}}}}}},VJ=function t(e,r){for(var n=0;n<e.length;n++)if(lT(r,e[n])||e[n].playlists&&t(e[n].playlists,r))return!0;return!1},zJ=function(e,r){return function(n){var i=r.masterPlaylistLoader,a=r.mediaTypes[e].groups,s=i.media();if(!s)return null;var o=null;s.attributes[e]&&(o=a[s.attributes[e]]);var c=Object.keys(a);if(!o)if(e==="AUDIO"&&c.length>1&&eh(r.master))for(var l=0;l<c.length;l++){var f=a[c[l]];if(VJ(f,s)){o=f;break}}else a.main?o=a.main:c.length===1&&(o=a[c[0]]);return typeof n>"u"?o:n===null||!o?null:o.filter(function(g){return g.id===n.id})[0]||null}},WJ={AUDIO:function(e,r){return function(){var n=r.mediaTypes[e].tracks;for(var i in n)if(n[i].enabled)return n[i];return null}},SUBTITLES:function(e,r){return function(){var n=r.mediaTypes[e].tracks;for(var i in n)if(n[i].mode==="showing"||n[i].mode==="hidden")return n[i];return null}}},KJ=function(e,r){var n=r.mediaTypes;return function(){var i=n[e].activeTrack();return i?n[e].activeGroup(i):null}},XJ=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(A){GJ[A](A,e)});var r=e.mediaTypes,n=e.masterPlaylistLoader,i=e.tech,a=e.vhs,s=e.segmentLoaders,o=s.AUDIO,c=s.main;["AUDIO","SUBTITLES"].forEach(function(A){r[A].activeGroup=zJ(A,e),r[A].activeTrack=WJ[A](A,e),r[A].onGroupChanged=qJ(A,e),r[A].onGroupChanging=jJ(A,e),r[A].onTrackChanged=HJ(A,e),r[A].getActiveGroup=KJ(A,e)});var l=r.AUDIO.activeGroup();if(l){var f=(l.filter(function(A){return A.default})[0]||l[0]).id;r.AUDIO.tracks[f].enabled=!0,r.AUDIO.onGroupChanged(),r.AUDIO.onTrackChanged();var g=r.AUDIO.getActiveGroup();g.playlistLoader?(c.setAudio(!1),o.setAudio(!0)):c.setAudio(!0)}n.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(A){return r[A].onGroupChanged()})}),n.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(A){return r[A].onGroupChanging()})});var m=function(){r.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"vhs-audio-change"}),i.trigger({type:"usage",name:"hls-audio-change"})};i.audioTracks().addEventListener("change",m),i.remoteTextTracks().addEventListener("change",r.SUBTITLES.onTrackChanged),a.on("dispose",function(){i.audioTracks().removeEventListener("change",m),i.remoteTextTracks().removeEventListener("change",r.SUBTITLES.onTrackChanged)}),i.clearTracks("audio");for(var y in r.AUDIO.tracks)i.audioTracks().addTrack(r.AUDIO.tracks[y])},YJ=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(r){e[r]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:ru,activeTrack:ru,getActiveGroup:ru,onGroupChanged:ru,onTrackChanged:ru,lastTrack_:null,logger_:Bs("MediaGroups["+r+"]")}}),e},JJ=60*2,Zo,QJ=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],ZJ=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},eQ=function(e){var r=e.currentPlaylist,n=e.buffered,i=e.currentTime,a=e.nextPlaylist,s=e.bufferLowWaterLine,o=e.bufferHighWaterLine,c=e.duration,l=e.experimentalBufferBasedABR,f=e.log;if(!a)return Oe.log.warn("We received no playlist to switch to. Please check your stream."),!1;var g="allowing switch "+(r&&r.id||"null")+" -> "+a.id;if(!r)return f(g+" as current playlist is not set"),!0;if(a.id===r.id)return!1;var m=!!vd(n,i).length;if(!r.endList)return!m&&typeof r.partTargetDuration=="number"?(f("not "+g+" as current playlist is live llhls, but currentTime isn't in buffered."),!1):(f(g+" as current playlist is live"),!0);var y=oT(n,i),A=l?An.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:An.MAX_BUFFER_LOW_WATER_LINE;if(c<A)return f(g+" as duration < max low water line ("+c+" < "+A+")"),!0;var k=a.attributes.BANDWIDTH,I=r.attributes.BANDWIDTH;if(k<I&&(!l||y<o)){var F=g+" as next bandwidth < current bandwidth ("+k+" < "+I+")";return l&&(F+=" and forwardBuffer < bufferHighWaterLine ("+y+" < "+o+")"),f(F),!0}if((!l||k>I)&&y>=s){var J=g+" as forwardBuffer >= bufferLowWaterLine ("+y+" >= "+s+")";return l&&(J+=" and next bandwidth > current bandwidth ("+k+" > "+I+")"),f(J),!0}return f("not "+g+" as no switching criteria met"),!1},tQ=function(t){Ct.default(e,t);function e(n){var i;i=t.call(this)||this;var a=n.src,s=n.handleManifestRedirects,o=n.withCredentials,c=n.tech,l=n.bandwidth,f=n.externVhs,g=n.useCueTags,m=n.blacklistDuration,y=n.enableLowInitialPlaylist,A=n.sourceType,k=n.cacheEncryptionKeys,I=n.experimentalBufferBasedABR,F=n.experimentalLeastPixelDiffSelector,J=n.captionServices;if(!a)throw new Error("A non-empty playlist URL or JSON manifest string is required");var pe=n.maxPlaylistRetries;(pe===null||typeof pe>"u")&&(pe=1/0),Zo=f,i.experimentalBufferBasedABR=!!I,i.experimentalLeastPixelDiffSelector=!!F,i.withCredentials=o,i.tech_=c,i.vhs_=c.vhs,i.sourceType_=A,i.useCueTags_=g,i.blacklistDuration=m,i.maxPlaylistRetries=pe,i.enableLowInitialPlaylist=y,i.useCueTags_&&(i.cueTagsTrack_=i.tech_.addTextTrack("metadata","ad-cues"),i.cueTagsTrack_.inBandMetadataTrackDispatchType=""),i.requestOptions_={withCredentials:o,handleManifestRedirects:s,maxPlaylistRetries:pe,timeout:null},i.on("error",i.pauseLoading),i.mediaTypes_=YJ(),i.mediaSource=new Se.default.MediaSource,i.handleDurationChange_=i.handleDurationChange_.bind(ir.default(i)),i.handleSourceOpen_=i.handleSourceOpen_.bind(ir.default(i)),i.handleSourceEnded_=i.handleSourceEnded_.bind(ir.default(i)),i.mediaSource.addEventListener("durationchange",i.handleDurationChange_),i.mediaSource.addEventListener("sourceopen",i.handleSourceOpen_),i.mediaSource.addEventListener("sourceended",i.handleSourceEnded_),i.seekable_=Oe.createTimeRanges(),i.hasPlayed_=!1,i.syncController_=new MJ(n),i.segmentMetadataTrack_=c.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,i.decrypter_=new FJ,i.sourceUpdater_=new qR(i.mediaSource),i.inbandTextTracks_={},i.timelineChangeController_=new $J;var L={vhs:i.vhs_,parse708captions:n.parse708captions,useDtsForTimestampOffset:n.useDtsForTimestampOffset,captionServices:J,mediaSource:i.mediaSource,currentTime:i.tech_.currentTime.bind(i.tech_),seekable:function(){return i.seekable()},seeking:function(){return i.tech_.seeking()},duration:function(){return i.duration()},hasPlayed:function(){return i.hasPlayed_},goalBufferLength:function(){return i.goalBufferLength()},bandwidth:l,syncController:i.syncController_,decrypter:i.decrypter_,sourceType:i.sourceType_,inbandTextTracks:i.inbandTextTracks_,cacheEncryptionKeys:k,sourceUpdater:i.sourceUpdater_,timelineChangeController:i.timelineChangeController_,experimentalExactManifestTimings:n.experimentalExactManifestTimings};i.masterPlaylistLoader_=i.sourceType_==="dash"?new Aw(a,i.vhs_,i.requestOptions_):new yd(a,i.vhs_,i.requestOptions_),i.setupMasterPlaylistLoaderListeners_(),i.mainSegmentLoader_=new kw(Oe.mergeOptions(L,{segmentMetadataTrack:i.segmentMetadataTrack_,loaderType:"main"}),n),i.audioSegmentLoader_=new kw(Oe.mergeOptions(L,{loaderType:"audio"}),n),i.subtitleSegmentLoader_=new RJ(Oe.mergeOptions(L,{loaderType:"vtt",featuresNativeTextTracks:i.tech_.featuresNativeTextTracks}),n),i.setupSegmentLoaderListeners_(),i.experimentalBufferBasedABR&&(i.masterPlaylistLoader_.one("loadedplaylist",function(){return i.startABRTimer_()}),i.tech_.on("pause",function(){return i.stopABRTimer_()}),i.tech_.on("play",function(){return i.startABRTimer_()})),QJ.forEach(function(j){i[j+"_"]=ZJ.bind(ir.default(i),j)}),i.logger_=Bs("MPC"),i.triggeredFmp4Usage=!1,i.tech_.preload()==="none"?(i.loadOnPlay_=function(){i.loadOnPlay_=null,i.masterPlaylistLoader_.load()},i.tech_.one("play",i.loadOnPlay_)):i.masterPlaylistLoader_.load(),i.timeToLoadedData__=-1,i.mainAppendsToLoadedData__=-1,i.audioAppendsToLoadedData__=-1;var H=i.tech_.preload()==="none"?"play":"loadstart";return i.tech_.one(H,function(){var j=Date.now();i.tech_.one("loadeddata",function(){i.timeToLoadedData__=Date.now()-j,i.mainAppendsToLoadedData__=i.mainSegmentLoader_.mediaAppends,i.audioAppendsToLoadedData__=i.audioSegmentLoader_.mediaAppends})}),i}var r=e.prototype;return r.mainAppendsToLoadedData_=function(){return this.mainAppendsToLoadedData__},r.audioAppendsToLoadedData_=function(){return this.audioAppendsToLoadedData__},r.appendsToLoadedData_=function(){var i=this.mainAppendsToLoadedData_(),a=this.audioAppendsToLoadedData_();return i===-1||a===-1?-1:i+a},r.timeToLoadedData_=function(){return this.timeToLoadedData__},r.checkABR_=function(){var i=this.selectPlaylist();i&&this.shouldSwitchToMedia_(i)&&this.switchMedia_(i,"abr")},r.switchMedia_=function(i,a,s){var o=this.media(),c=o&&(o.id||o.uri),l=i.id||i.uri;c&&c!==l&&(this.logger_("switch media "+c+" -> "+l+" from "+a),this.tech_.trigger({type:"usage",name:"vhs-rendition-change-"+a})),this.masterPlaylistLoader_.media(i,s)},r.startABRTimer_=function(){var i=this;this.stopABRTimer_(),this.abrTimer_=Se.default.setInterval(function(){return i.checkABR_()},250)},r.stopABRTimer_=function(){this.tech_.scrubbing&&this.tech_.scrubbing()||(Se.default.clearInterval(this.abrTimer_),this.abrTimer_=null)},r.getAudioTrackPlaylists_=function(){var i=this.master(),a=i&&i.playlists||[];if(!i||!i.mediaGroups||!i.mediaGroups.AUDIO)return a;var s=i.mediaGroups.AUDIO,o=Object.keys(s),c;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)c=this.mediaTypes_.AUDIO.activeTrack();else{var l=s.main||o.length&&s[o[0]];for(var f in l)if(l[f].default){c={label:f};break}}if(!c)return a;var g=[];for(var m in s)if(s[m][c.label]){var y=s[m][c.label];if(y.playlists&&y.playlists.length)g.push.apply(g,y.playlists);else if(y.uri)g.push(y);else if(i.playlists.length)for(var A=0;A<i.playlists.length;A++){var k=i.playlists[A];k.attributes&&k.attributes.AUDIO&&k.attributes.AUDIO===m&&g.push(k)}}return g.length?g:a},r.setupMasterPlaylistLoaderListeners_=function(){var i=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var a=i.masterPlaylistLoader_.media(),s=a.targetDuration*1.5*1e3;Tw(i.masterPlaylistLoader_.master,i.masterPlaylistLoader_.media())?i.requestOptions_.timeout=0:i.requestOptions_.timeout=s,a.endList&&i.tech_.preload()!=="none"&&(i.mainSegmentLoader_.playlist(a,i.requestOptions_),i.mainSegmentLoader_.load()),XJ({sourceType:i.sourceType_,segmentLoaders:{AUDIO:i.audioSegmentLoader_,SUBTITLES:i.subtitleSegmentLoader_,main:i.mainSegmentLoader_},tech:i.tech_,requestOptions:i.requestOptions_,masterPlaylistLoader:i.masterPlaylistLoader_,vhs:i.vhs_,master:i.master(),mediaTypes:i.mediaTypes_,blacklistCurrentPlaylist:i.blacklistCurrentPlaylist.bind(i)}),i.triggerPresenceUsage_(i.master(),a),i.setupFirstPlay(),!i.mediaTypes_.AUDIO.activePlaylistLoader||i.mediaTypes_.AUDIO.activePlaylistLoader.media()?i.trigger("selectedinitialmedia"):i.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){i.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){i.loadOnPlay_&&i.tech_.off("play",i.loadOnPlay_);var a=i.masterPlaylistLoader_.media();if(!a){i.excludeUnsupportedVariants_();var s;if(i.enableLowInitialPlaylist&&(s=i.selectInitialPlaylist()),s||(s=i.selectPlaylist()),!s||!i.shouldSwitchToMedia_(s))return;i.initialMedia_=s,i.switchMedia_(i.initialMedia_,"initial");var o=i.sourceType_==="vhs-json"&&i.initialMedia_.segments;if(!o)return;a=i.initialMedia_}i.handleUpdatedMediaPlaylist(a)}),this.masterPlaylistLoader_.on("error",function(){i.blacklistCurrentPlaylist(i.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){i.mainSegmentLoader_.abort(),i.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var a=i.masterPlaylistLoader_.media(),s=a.targetDuration*1.5*1e3;Tw(i.masterPlaylistLoader_.master,i.masterPlaylistLoader_.media())?i.requestOptions_.timeout=0:i.requestOptions_.timeout=s,i.mainSegmentLoader_.playlist(a,i.requestOptions_),i.mainSegmentLoader_.load(),i.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var a=i.masterPlaylistLoader_.media();if(a.lastExcludeReason_!=="playlist-unchanged"){var s=i.stuckAtPlaylistEnd_(a);s&&(i.blacklistCurrentPlaylist({message:"Playlist no longer updating.",reason:"playlist-unchanged"}),i.tech_.trigger("playliststuck"))}}),this.masterPlaylistLoader_.on("renditiondisabled",function(){i.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"}),i.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){i.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"}),i.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},r.handleUpdatedMediaPlaylist=function(i){this.useCueTags_&&this.updateAdCues_(i),this.mainSegmentLoader_.playlist(i,this.requestOptions_),this.updateDuration(!i.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},r.triggerPresenceUsage_=function(i,a){var s=i.mediaGroups||{},o=!0,c=Object.keys(s.AUDIO);for(var l in s.AUDIO)for(var f in s.AUDIO[l]){var g=s.AUDIO[l][f];g.uri||(o=!1)}o&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"})),Object.keys(s.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"})),Zo.Playlist.isAes(a)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"})),c.length&&Object.keys(s.AUDIO[c[0]]).length>1&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"})),this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},r.shouldSwitchToMedia_=function(i){var a=this.masterPlaylistLoader_.media()||this.masterPlaylistLoader_.pendingMedia_,s=this.tech_.currentTime(),o=this.bufferLowWaterLine(),c=this.bufferHighWaterLine(),l=this.tech_.buffered();return eQ({buffered:l,currentTime:s,currentPlaylist:a,nextPlaylist:i,bufferLowWaterLine:o,bufferHighWaterLine:c,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})},r.setupSegmentLoaderListeners_=function(){var i=this;this.experimentalBufferBasedABR||(this.mainSegmentLoader_.on("bandwidthupdate",function(){var s=i.selectPlaylist();i.shouldSwitchToMedia_(s)&&i.switchMedia_(s,"bandwidthupdate"),i.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){i.trigger("progress")})),this.mainSegmentLoader_.on("error",function(){i.blacklistCurrentPlaylist(i.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("appenderror",function(){i.error=i.mainSegmentLoader_.error_,i.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",function(){i.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){i.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"}),i.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){i.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",function(){i.error=i.audioSegmentLoader_.error_,i.trigger("error")}),this.mainSegmentLoader_.on("ended",function(){i.logger_("main segment loader ended"),i.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(s){i.experimentalBufferBasedABR||(i.delegateLoaders_("all",["abort"]),i.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},JJ))});var a=function(){if(!i.sourceUpdater_.hasCreatedSourceBuffers())return i.tryToCreateSourceBuffers_();var o=i.getCodecsOrExclude_();o&&i.sourceUpdater_.addOrChangeSourceBuffers(o)};this.mainSegmentLoader_.on("trackinfo",a),this.audioSegmentLoader_.on("trackinfo",a),this.mainSegmentLoader_.on("fmp4",function(){i.triggeredFmp4Usage||(i.tech_.trigger({type:"usage",name:"vhs-fmp4"}),i.tech_.trigger({type:"usage",name:"hls-fmp4"}),i.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",function(){i.triggeredFmp4Usage||(i.tech_.trigger({type:"usage",name:"vhs-fmp4"}),i.tech_.trigger({type:"usage",name:"hls-fmp4"}),i.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",function(){i.logger_("audioSegmentLoader ended"),i.onEndOfStream()})},r.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},r.load=function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},r.smoothQualityChange_=function(i){i===void 0&&(i=this.selectPlaylist()),this.fastQualityChange_(i)},r.fastQualityChange_=function(i){var a=this;if(i===void 0&&(i=this.selectPlaylist()),i===this.masterPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(i,"fast-quality"),this.mainSegmentLoader_.resetEverything(function(){Oe.browser.IE_VERSION||Oe.browser.IS_EDGE?a.tech_.setCurrentTime(a.tech_.currentTime()+.04):a.tech_.setCurrentTime(a.tech_.currentTime())})},r.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var i=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<i.start(0))return this.tech_.setCurrentTime(i.end(i.length-1))}},r.setupFirstPlay=function(){var i=this,a=this.masterPlaylistLoader_.media();if(!a||this.tech_.paused()||this.hasPlayed_)return!1;if(!a.endList){var s=this.seekable();if(!s.length)return!1;if(Oe.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",function(){i.trigger("firstplay"),i.tech_.setCurrentTime(s.end(0)),i.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(s.end(0))}return this.hasPlayed_=!0,this.load(),!0},r.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var i=this.tech_.play();typeof i<"u"&&typeof i.then=="function"&&i.then(null,function(a){})}this.trigger("sourceopen")},r.handleSourceEnded_=function(){if(this.inbandTextTracks_.metadataTrack_){var i=this.inbandTextTracks_.metadataTrack_.cues;if(!(!i||!i.length)){var a=this.duration();i[i.length-1].endTime=isNaN(a)||Math.abs(a)===1/0?Number.MAX_VALUE:a}}},r.handleDurationChange_=function(){this.tech_.trigger("durationchange")},r.onEndOfStream=function(){var i=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){var a=this.mainSegmentLoader_.getCurrentMediaInfo_();!a||a.hasVideo?i=i&&this.audioSegmentLoader_.ended_:i=this.audioSegmentLoader_.ended_}i&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},r.stuckAtPlaylistEnd_=function(i){var a=this.seekable();if(!a.length)return!1;var s=this.syncController_.getExpiredTime(i,this.duration());if(s===null)return!1;var o=Zo.Playlist.playlistEnd(i,s),c=this.tech_.currentTime(),l=this.tech_.buffered();if(!l.length)return o-c<=mo;var f=l.end(l.length-1);return f-c<=mo&&o-f<=mo},r.blacklistCurrentPlaylist=function(i,a){i===void 0&&(i={});var s=i.playlist||this.masterPlaylistLoader_.media();if(a=a||i.blacklistDuration||this.blacklistDuration,!s){this.error=i,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}s.playlistErrors_++;var o=this.masterPlaylistLoader_.master.playlists,c=o.filter(mv),l=c.length===1&&c[0]===s;if(o.length===1&&a!==1/0)return Oe.log.warn("Problem encountered with playlist "+s.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(l);if(l){var f=!1;o.forEach(function(F){if(F!==s){var J=F.excludeUntil;typeof J<"u"&&J!==1/0&&(f=!0,delete F.excludeUntil)}}),f&&(Oe.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}var g;s.playlistErrors_>this.maxPlaylistRetries?g=1/0:g=Date.now()+a*1e3,s.excludeUntil=g,i.reason&&(s.lastExcludeReason_=i.reason),this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"});var m=this.selectPlaylist();if(!m){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}var y=i.internal?this.logger_:Oe.log.warn,A=i.message?" "+i.message:"";y((i.internal?"Internal problem":"Problem")+" encountered with playlist "+s.id+"."+(A+" Switching to playlist "+m.id+".")),m.attributes.AUDIO!==s.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),m.attributes.SUBTITLES!==s.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);var k=m.targetDuration/2*1e3||5*1e3,I=typeof m.lastRequest=="number"&&Date.now()-m.lastRequest<=k;return this.switchMedia_(m,"exclude",l||I)},r.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()},r.delegateLoaders_=function(i,a){var s=this,o=[],c=i==="all";(c||i==="main")&&o.push(this.masterPlaylistLoader_);var l=[];(c||i==="audio")&&l.push("AUDIO"),(c||i==="subtitle")&&(l.push("CLOSED-CAPTIONS"),l.push("SUBTITLES")),l.forEach(function(f){var g=s.mediaTypes_[f]&&s.mediaTypes_[f].activePlaylistLoader;g&&o.push(g)}),["main","audio","subtitle"].forEach(function(f){var g=s[f+"SegmentLoader_"];g&&(i===f||i==="all")&&o.push(g)}),o.forEach(function(f){return a.forEach(function(g){typeof f[g]=="function"&&f[g]()})})},r.setCurrentTime=function(i){var a=vd(this.tech_.buffered(),i);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())||!this.masterPlaylistLoader_.media().segments)return 0;if(a&&a.length)return i;this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),this.load()},r.duration=function(){if(!this.masterPlaylistLoader_)return 0;var i=this.masterPlaylistLoader_.media();return i?i.endList?this.mediaSource?this.mediaSource.duration:Zo.Playlist.duration(i):1/0:0},r.seekable=function(){return this.seekable_},r.onSyncInfoUpdate_=function(){var i;if(this.masterPlaylistLoader_){var a=this.masterPlaylistLoader_.media();if(a){var s=this.syncController_.getExpiredTime(a,this.duration());if(s!==null){var o=this.masterPlaylistLoader_.master,c=Zo.Playlist.seekable(a,s,Zo.Playlist.liveEdgeDelay(o,a));if(c.length!==0&&!(this.mediaTypes_.AUDIO.activePlaylistLoader&&(a=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),s=this.syncController_.getExpiredTime(a,this.duration()),s===null||(i=Zo.Playlist.seekable(a,s,Zo.Playlist.liveEdgeDelay(o,a)),i.length===0)))){var l,f;this.seekable_&&this.seekable_.length&&(l=this.seekable_.end(0),f=this.seekable_.start(0)),i?i.start(0)>c.end(0)||c.start(0)>i.end(0)?this.seekable_=c:this.seekable_=Oe.createTimeRanges([[i.start(0)>c.start(0)?i.start(0):c.start(0),i.end(0)<c.end(0)?i.end(0):c.end(0)]]):this.seekable_=c,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===l&&this.seekable_.start(0)===f)&&(this.logger_("seekable updated ["+nR(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},r.updateDuration=function(i){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,i),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(i){var a=this.seekable();if(!a.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<a.end(a.length-1))&&this.sourceUpdater_.setDuration(a.end(a.length-1));return}var s=this.tech_.buffered(),o=Zo.Playlist.duration(this.masterPlaylistLoader_.media());s.length>0&&(o=Math.max(o,s.end(s.length-1))),this.mediaSource.duration!==o&&this.sourceUpdater_.setDuration(o)},r.dispose=function(){var i=this;this.trigger("dispose"),this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(function(a){var s=i.mediaTypes_[a].groups;for(var o in s)s[o].forEach(function(c){c.playlistLoader&&c.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()},r.master=function(){return this.masterPlaylistLoader_.master},r.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},r.areMediaTypesKnown_=function(){var i=!!this.mediaTypes_.AUDIO.activePlaylistLoader,a=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),s=i?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!a||!s)},r.getCodecsOrExclude_=function(){var i=this,a={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}};a.video=a.main;var s=Hp(this.master(),this.media()),o={},c=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(a.main.hasVideo&&(o.video=s.video||a.main.videoCodec||ci.DEFAULT_VIDEO_CODEC),a.main.isMuxed&&(o.video+=","+(s.audio||a.main.audioCodec||ci.DEFAULT_AUDIO_CODEC)),(a.main.hasAudio&&!a.main.isMuxed||a.audio.hasAudio||c)&&(o.audio=s.audio||a.main.audioCodec||a.audio.audioCodec||ci.DEFAULT_AUDIO_CODEC,a.audio.isFmp4=a.main.hasAudio&&!a.main.isMuxed?a.main.isFmp4:a.audio.isFmp4),!o.audio&&!o.video){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:1/0});return}var l=function(I,F){return I?ci.browserSupportsCodec(F):ci.muxerSupportsCodec(F)},f={},g;if(["video","audio"].forEach(function(k){if(o.hasOwnProperty(k)&&!l(a[k].isFmp4,o[k])){var I=a[k].isFmp4?"browser":"muxer";f[I]=f[I]||[],f[I].push(o[k]),k==="audio"&&(g=I)}}),c&&g&&this.media().attributes.AUDIO){var m=this.media().attributes.AUDIO;this.master().playlists.forEach(function(k){var I=k.attributes&&k.attributes.AUDIO;I===m&&k!==i.media()&&(k.excludeUntil=1/0)}),this.logger_("excluding audio group "+m+" as "+g+' does not support codec(s): "'+o.audio+'"')}if(Object.keys(f).length){var y=Object.keys(f).reduce(function(k,I){return k&&(k+=", "),k+=I+' does not support codec(s): "'+f[I].join(",")+'"',k},"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:!0,message:y,blacklistDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){var A=[];if(["video","audio"].forEach(function(k){var I=(ci.parseCodecs(i.sourceUpdater_.codecs[k]||"")[0]||{}).type,F=(ci.parseCodecs(o[k]||"")[0]||{}).type;I&&F&&I.toLowerCase()!==F.toLowerCase()&&A.push('"'+i.sourceUpdater_.codecs[k]+'" -> "'+o[k]+'"')}),A.length){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+A.join(", ")+".",blacklistDuration:1/0,internal:!0});return}}return o},r.tryToCreateSourceBuffers_=function(){if(!(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers())&&this.areMediaTypesKnown_()){var i=this.getCodecsOrExclude_();if(i){this.sourceUpdater_.createSourceBuffers(i);var a=[i.video,i.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(a)}}},r.excludeUnsupportedVariants_=function(){var i=this,a=this.master().playlists,s=[];Object.keys(a).forEach(function(o){var c=a[o];if(s.indexOf(c.id)===-1){s.push(c.id);var l=Hp(i.master,c),f=[];l.audio&&!ci.muxerSupportsCodec(l.audio)&&!ci.browserSupportsCodec(l.audio)&&f.push("audio codec "+l.audio),l.video&&!ci.muxerSupportsCodec(l.video)&&!ci.browserSupportsCodec(l.video)&&f.push("video codec "+l.video),l.text&&l.text==="stpp.ttml.im1t"&&f.push("text codec "+l.text),f.length&&(c.excludeUntil=1/0,i.logger_("excluding "+c.id+" for unsupported: "+f.join(", ")))}})},r.excludeIncompatibleVariants_=function(i){var a=this,s=[],o=this.master().playlists,c=rv(ci.parseCodecs(i)),l=PP(c),f=c.video&&ci.parseCodecs(c.video)[0]||null,g=c.audio&&ci.parseCodecs(c.audio)[0]||null;Object.keys(o).forEach(function(m){var y=o[m];if(!(s.indexOf(y.id)!==-1||y.excludeUntil===1/0)){s.push(y.id);var A=[],k=Hp(a.masterPlaylistLoader_.master,y),I=PP(k);if(!(!k.audio&&!k.video)){if(I!==l&&A.push('codec count "'+I+'" !== "'+l+'"'),!a.sourceUpdater_.canChangeType()){var F=k.video&&ci.parseCodecs(k.video)[0]||null,J=k.audio&&ci.parseCodecs(k.audio)[0]||null;F&&f&&F.type.toLowerCase()!==f.type.toLowerCase()&&A.push('video codec "'+F.type+'" !== "'+f.type+'"'),J&&g&&J.type.toLowerCase()!==g.type.toLowerCase()&&A.push('audio codec "'+J.type+'" !== "'+g.type+'"')}A.length&&(y.excludeUntil=1/0,a.logger_("blacklisting "+y.id+": "+A.join(" && ")))}}})},r.updateAdCues_=function(i){var a=0,s=this.seekable();s.length&&(a=s.start(0)),LJ(i,this.cueTagsTrack_,a)},r.goalBufferLength=function(){var i=this.tech_.currentTime(),a=An.GOAL_BUFFER_LENGTH,s=An.GOAL_BUFFER_LENGTH_RATE,o=Math.max(a,An.MAX_GOAL_BUFFER_LENGTH);return Math.min(a+i*s,o)},r.bufferLowWaterLine=function(){var i=this.tech_.currentTime(),a=An.BUFFER_LOW_WATER_LINE,s=An.BUFFER_LOW_WATER_LINE_RATE,o=Math.max(a,An.MAX_BUFFER_LOW_WATER_LINE),c=Math.max(a,An.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(a+i*s,this.experimentalBufferBasedABR?c:o)},r.bufferHighWaterLine=function(){return An.BUFFER_HIGH_WATER_LINE},e}(Oe.EventTarget),rQ=function(e,r,n){return function(i){var a=e.master.playlists[r],s=cT(a),o=mv(a);return typeof i>"u"?o:(i?delete a.disabled:a.disabled=!0,i!==o&&!s&&(n(),i?e.trigger("renditionenabled"):e.trigger("renditiondisabled")),i)}},iQ=function(e,r,n){var i=e.masterPlaylistController_,a=e.options_.smoothQualityChange,s=a?"smooth":"fast",o=i[s+"QualityChange_"].bind(i);if(r.attributes){var c=r.attributes.RESOLUTION;this.width=c&&c.width,this.height=c&&c.height,this.bandwidth=r.attributes.BANDWIDTH}this.codecs=Hp(i.master(),r),this.playlist=r,this.id=n,this.enabled=rQ(e.playlists,r.id,o)},nQ=function(e){e.representations=function(){var r=e.masterPlaylistController_.master(),n=eh(r)?e.masterPlaylistController_.getAudioTrackPlaylists_():r.playlists;return n?n.filter(function(i){return!cT(i)}).map(function(i,a){return new iQ(e,i,i.id)}):[]}},HP=["seeking","seeked","pause","playing","error"],aQ=function(){function t(r){var n=this;this.masterPlaylistController_=r.masterPlaylistController,this.tech_=r.tech,this.seekable=r.seekable,this.allowSeeksWithinUnsafeLiveWindow=r.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=r.liveRangeSafeTimeDelta,this.media=r.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Bs("PlaybackWatcher"),this.logger_("initialize");var i=function(){return n.monitorCurrentTime_()},a=function(){return n.monitorCurrentTime_()},s=function(){return n.techWaiting_()},o=function(){return n.cancelTimer_()},c=this.masterPlaylistController_,l=["main","subtitle","audio"],f={};l.forEach(function(m){f[m]={reset:function(){return n.resetSegmentDownloads_(m)},updateend:function(){return n.checkSegmentDownloads_(m)}},c[m+"SegmentLoader_"].on("appendsdone",f[m].updateend),c[m+"SegmentLoader_"].on("playlistupdate",f[m].reset),n.tech_.on(["seeked","seeking"],f[m].reset)});var g=function(y){["main","audio"].forEach(function(A){c[A+"SegmentLoader_"][y]("appended",n.seekingAppendCheck_)})};this.seekingAppendCheck_=function(){n.fixesBadSeeks_()&&(n.consecutiveUpdates=0,n.lastRecordedTime=n.tech_.currentTime(),g("off"))},this.clearSeekingAppendCheck_=function(){return g("off")},this.watchForBadSeeking_=function(){n.clearSeekingAppendCheck_(),g("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",s),this.tech_.on(HP,o),this.tech_.on("canplay",a),this.tech_.one("play",i),this.dispose=function(){n.clearSeekingAppendCheck_(),n.logger_("dispose"),n.tech_.off("waiting",s),n.tech_.off(HP,o),n.tech_.off("canplay",a),n.tech_.off("play",i),n.tech_.off("seeking",n.watchForBadSeeking_),n.tech_.off("seeked",n.clearSeekingAppendCheck_),l.forEach(function(m){c[m+"SegmentLoader_"].off("appendsdone",f[m].updateend),c[m+"SegmentLoader_"].off("playlistupdate",f[m].reset),n.tech_.off(["seeked","seeking"],f[m].reset)}),n.checkCurrentTimeTimeout_&&Se.default.clearTimeout(n.checkCurrentTimeTimeout_),n.cancelTimer_()}}var e=t.prototype;return e.monitorCurrentTime_=function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&Se.default.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=Se.default.setTimeout(this.monitorCurrentTime_.bind(this),250)},e.resetSegmentDownloads_=function(n){var i=this.masterPlaylistController_[n+"SegmentLoader_"];this[n+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+n+" loader"),this[n+"StalledDownloads_"]=0,this[n+"Buffered_"]=i.buffered_()},e.checkSegmentDownloads_=function(n){var i=this.masterPlaylistController_,a=i[n+"SegmentLoader_"],s=a.buffered_(),o=eY(this[n+"Buffered_"],s);if(this[n+"Buffered_"]=s,o){this.resetSegmentDownloads_(n);return}this[n+"StalledDownloads_"]++,this.logger_("found #"+this[n+"StalledDownloads_"]+" "+n+" appends that did not increase buffer (possible stalled download)",{playlistId:a.playlist_&&a.playlist_.id,buffered:Xc(s)}),!(this[n+"StalledDownloads_"]<10)&&(this.logger_(n+" loader stalled download exclusion"),this.resetSegmentDownloads_(n),this.tech_.trigger({type:"usage",name:"vhs-"+n+"-download-exclusion"}),n!=="subtitle"&&i.blacklistCurrentPlaylist({message:"Excessive "+n+" segment downloading detected."},1/0))},e.checkCurrentTime_=function(){if(!(this.tech_.paused()||this.tech_.seeking())){var n=this.tech_.currentTime(),i=this.tech_.buffered();if(this.lastRecordedTime===n&&(!i.length||n+mo>=i.end(i.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&n===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):n===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=n)}},e.cancelTimer_=function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null},e.fixesBadSeeks_=function(){var n=this.tech_.seeking();if(!n)return!1;var i=this.seekable(),a=this.tech_.currentTime(),s=this.afterSeekableWindow_(i,a,this.media(),this.allowSeeksWithinUnsafeLiveWindow),o;if(s){var c=i.end(i.length-1);o=c}if(this.beforeSeekableWindow_(i,a)){var l=i.start(0);o=l+(l===i.end(0)?0:mo)}if(typeof o<"u")return this.logger_("Trying to seek outside of seekable at time "+a+" with "+("seekable range "+nR(i)+". Seeking to ")+(o+".")),this.tech_.setCurrentTime(o),!0;for(var f=this.masterPlaylistController_.sourceUpdater_,g=this.tech_.buffered(),m=f.audioBuffer?f.audioBuffered():null,y=f.videoBuffer?f.videoBuffered():null,A=this.media(),k=A.partTargetDuration?A.partTargetDuration:(A.targetDuration-Ju)*2,I=[m,y],F=0;F<I.length;F++)if(I[F]){var J=oT(I[F],a);if(J<k)return!1}var pe=Dm(g,a);return pe.length===0?!1:(o=pe.start(0)+mo,this.logger_("Buffered region starts ("+pe.start(0)+") "+(" just beyond seek point ("+a+"). Seeking to "+o+".")),this.tech_.setCurrentTime(o),!0)},e.waiting_=function(){if(!this.techWaiting_()){var n=this.tech_.currentTime(),i=this.tech_.buffered(),a=vd(i,n);if(a.length&&n+3<=a.end(0)){this.cancelTimer_(),this.tech_.setCurrentTime(n),this.logger_("Stopped at "+n+" while inside a buffered region "+("["+a.start(0)+" -> "+a.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time."),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"}),this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}}},e.techWaiting_=function(){var n=this.seekable(),i=this.tech_.currentTime();if(this.tech_.seeking()||this.timer_!==null)return!0;if(this.beforeSeekableWindow_(n,i)){var a=n.end(n.length-1);return this.logger_("Fell out of live window at time "+i+". Seeking to "+("live point (seekable end) "+a)),this.cancelTimer_(),this.tech_.setCurrentTime(a),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var s=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,o=this.tech_.buffered(),c=this.videoUnderflow_({audioBuffered:s.audioBuffered(),videoBuffered:s.videoBuffered(),currentTime:i});if(c)return this.cancelTimer_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;var l=Dm(o,i);if(l.length>0){var f=l.start(0)-i;return this.logger_("Stopped at "+i+", setting timer for "+f+", seeking "+("to "+l.start(0))),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),f*1e3,i),!0}return!1},e.afterSeekableWindow_=function(n,i,a,s){if(s===void 0&&(s=!1),!n.length)return!1;var o=n.end(n.length-1)+mo,c=!a.endList;return c&&s&&(o=n.end(n.length-1)+a.targetDuration*3),i>o},e.beforeSeekableWindow_=function(n,i){return!!(n.length&&n.start(0)>0&&i<n.start(0)-this.liveRangeSafeTimeDelta)},e.videoUnderflow_=function(n){var i=n.videoBuffered,a=n.audioBuffered,s=n.currentTime;if(i){var o;if(i.length&&a.length){var c=vd(i,s-3),l=vd(i,s),f=vd(a,s);f.length&&!l.length&&c.length&&(o={start:c.end(0),end:f.end(0)})}else{var g=Dm(i,s);g.length||(o=this.gapFromVideoUnderflow_(i,s))}return o?(this.logger_("Encountered a gap in video from "+o.start+" to "+o.end+". "+("Seeking to current time "+s)),!0):!1}},e.skipTheGap_=function(n){var i=this.tech_.buffered(),a=this.tech_.currentTime(),s=Dm(i,a);this.cancelTimer_(),!(s.length===0||a!==n)&&(this.logger_("skipTheGap_:","currentTime:",a,"scheduled currentTime:",n,"nextRange start:",s.start(0)),this.tech_.setCurrentTime(s.start(0)+Ju),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},e.gapFromVideoUnderflow_=function(n,i){for(var a=JX(n),s=0;s<a.length;s++){var o=a.start(s),c=a.end(s);if(i-o<4&&i-o>2)return{start:o,end:c}}return null},t}(),sQ={errorInterval:30,getSource:function(e){var r=this.tech({IWillNotUseThisInPlugins:!0}),n=r.currentSource_||this.currentSource();return e(n)}},oQ=function t(e,r){var n=0,i=0,a=Oe.mergeOptions(sQ,r);e.ready(function(){e.trigger({type:"usage",name:"vhs-error-reload-initialized"}),e.trigger({type:"usage",name:"hls-error-reload-initialized"})});var s=function(){i&&e.currentTime(i)},o=function(m){m!=null&&(i=e.duration()!==1/0&&e.currentTime()||0,e.one("loadedmetadata",s),e.src(m),e.trigger({type:"usage",name:"vhs-error-reload"}),e.trigger({type:"usage",name:"hls-error-reload"}),e.play())},c=function(){if(Date.now()-n<a.errorInterval*1e3){e.trigger({type:"usage",name:"vhs-error-reload-canceled"}),e.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!a.getSource||typeof a.getSource!="function"){Oe.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return n=Date.now(),a.getSource.call(e,o)},l=function g(){e.off("loadedmetadata",s),e.off("error",c),e.off("dispose",g)},f=function(m){l(),t(e,m)};e.on("error",c),e.on("dispose",l),e.reloadSourceOnError=f},uQ=function(e){oQ(this,e)},jR="2.14.2",cQ="6.0.1",lQ="0.21.1",dQ="4.7.1",fQ="3.1.3",Un={PlaylistLoader:yd,Playlist:Ba,utils:EY,STANDARD_PLAYLIST_SELECTOR:DP,INITIAL_PLAYLIST_SELECTOR:dJ,lastBandwidthSelector:DP,movingAverageBandwidthSelector:cJ,comparePlaylistBandwidth:pT,comparePlaylistResolution:uJ,xhr:bR()};Object.keys(An).forEach(function(t){Object.defineProperty(Un,t,{get:function(){return Oe.log.warn("using Vhs."+t+" is UNSAFE be sure you know what you are doing"),An[t]},set:function(r){if(Oe.log.warn("using Vhs."+t+" is UNSAFE be sure you know what you are doing"),typeof r!="number"||r<0){Oe.log.warn("value of Vhs."+t+" must be greater than or equal to 0");return}An[t]=r}})});var HR="videojs-vhs",GR=function(e,r){for(var n=r.media(),i=-1,a=0;a<e.length;a++)if(e[a].id===n.id){i=a;break}e.selectedIndex_=i,e.trigger({selectedIndex:i,type:"change"})},pQ=function(e,r){r.representations().forEach(function(n){e.addQualityLevel(n)}),GR(e,r.playlists)};Un.canPlaySource=function(){return Oe.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var hQ=function(e,r,n){if(!e)return e;var i={};r&&r.attributes&&r.attributes.CODECS&&(i=rv(ci.parseCodecs(r.attributes.CODECS))),n&&n.attributes&&n.attributes.CODECS&&(i.audio=n.attributes.CODECS);var a=ci.getMimeForCodec(i.video),s=ci.getMimeForCodec(i.audio),o={};for(var c in e)o[c]={},s&&(o[c].audioContentType=s),a&&(o[c].videoContentType=a),r.contentProtection&&r.contentProtection[c]&&r.contentProtection[c].pssh&&(o[c].pssh=r.contentProtection[c].pssh),typeof e[c]=="string"&&(o[c].url=e[c]);return Oe.mergeOptions(e,o)},gQ=function(e,r){return e.reduce(function(n,i){if(!i.contentProtection)return n;var a=r.reduce(function(s,o){var c=i.contentProtection[o];return c&&c.pssh&&(s[o]={pssh:c.pssh}),s},{});return Object.keys(a).length&&n.push(a),n},[])},mQ=function(e){var r=e.player,n=e.sourceKeySystems,i=e.audioMedia,a=e.mainPlaylists;if(!r.eme.initializeMediaKeys)return Promise.resolve();var s=i?a.concat([i]):a,o=gQ(s,Object.keys(n)),c=[],l=[];return o.forEach(function(f){l.push(new Promise(function(g,m){r.tech_.one("keysessioncreated",g)})),c.push(new Promise(function(g,m){r.eme.initializeMediaKeys({keySystems:f},function(y){if(y){m(y);return}g()})}))}),Promise.race([Promise.all(c),Promise.race(l)])},vQ=function(e){var r=e.player,n=e.sourceKeySystems,i=e.media,a=e.audioMedia,s=hQ(n,i,a);return s?(r.currentSource().keySystems=s,s&&!r.eme?(Oe.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},VR=function(){if(!Se.default.localStorage)return null;var e=Se.default.localStorage.getItem(HR);if(!e)return null;try{return JSON.parse(e)}catch{return null}},yQ=function(e){if(!Se.default.localStorage)return!1;var r=VR();r=r?Oe.mergeOptions(r,e):e;try{Se.default.localStorage.setItem(HR,JSON.stringify(r))}catch{return!1}return r},bQ=function(e){return e.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(e.substring(e.indexOf(",")+1)):e};Un.supportsNativeHls=function(){if(!yt.default||!yt.default.createElement)return!1;var t=yt.default.createElement("video");if(!Oe.getTech("Html5").isSupported())return!1;var e=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"];return e.some(function(r){return/maybe|probably/i.test(t.canPlayType(r))})}();Un.supportsNativeDash=function(){return!yt.default||!yt.default.createElement||!Oe.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(yt.default.createElement("video").canPlayType("application/dash+xml"))}();Un.supportsTypeNatively=function(t){return t==="hls"?Un.supportsNativeHls:t==="dash"?Un.supportsNativeDash:!1};Un.isSupported=function(){return Oe.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var _Q=Oe.getComponent("Component"),gT=function(t){Ct.default(e,t);function e(n,i,a){var s;if(s=t.call(this,i,Oe.mergeOptions(a.hls,a.vhs))||this,a.hls&&Object.keys(a.hls).length&&Oe.log.warn("Using hls options is deprecated. Please rename `hls` to `vhs` in your options object."),typeof a.initialBandwidth=="number"&&(s.options_.bandwidth=a.initialBandwidth),s.logger_=Bs("VhsHandler"),i.options_&&i.options_.playerId){var o=Oe(i.options_.playerId);o.hasOwnProperty("hls")||Object.defineProperty(o,"hls",{get:function(){return Oe.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),i.trigger({type:"usage",name:"hls-player-access"}),ir.default(s)},configurable:!0}),o.hasOwnProperty("vhs")||Object.defineProperty(o,"vhs",{get:function(){return Oe.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),i.trigger({type:"usage",name:"vhs-player-access"}),ir.default(s)},configurable:!0}),o.hasOwnProperty("dash")||Object.defineProperty(o,"dash",{get:function(){return Oe.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),ir.default(s)},configurable:!0}),s.player_=o}if(s.tech_=i,s.source_=n,s.stats={},s.ignoreNextSeekingEvent_=!1,s.setOptions_(),s.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(s.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return s.on(yt.default,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(c){var l=yt.default.fullscreenElement||yt.default.webkitFullscreenElement||yt.default.mozFullScreenElement||yt.default.msFullscreenElement;l&&l.contains(s.tech_.el())?s.masterPlaylistController_.fastQualityChange_():s.masterPlaylistController_.checkABR_()}),s.on(s.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),s.on(s.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),s.on(s.tech_,"play",s.play),s}var r=e.prototype;return r.setOptions_=function(){var i=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects!==!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,typeof this.options_.blacklistDuration!="number"&&(this.options_.blacklistDuration=5*60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){var a=VR();a&&a.bandwidth&&(this.options_.bandwidth=a.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),a&&a.throughput&&(this.options_.throughput=a.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=An.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===An.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta","experimentalLLHLS","useNetworkInformationApi","useDtsForTimestampOffset","experimentalExactManifestTimings","experimentalLeastPixelDiffSelector"].forEach(function(s){typeof i.source_[s]<"u"&&(i.options_[s]=i.source_[s])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio},r.src=function(i,a){var s=this;if(i){this.setOptions_(),this.options_.src=bQ(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Un,this.options_.sourceType=VP.simpleTypeFromSourceType(a),this.options_.seekTo=function(l){s.tech_.setCurrentTime(l)},this.options_.smoothQualityChange&&Oe.log.warn("smoothQualityChange is deprecated and will be removed in the next major version"),this.masterPlaylistController_=new tQ(this.options_);var o=Oe.mergeOptions({liveRangeSafeTimeDelta:mo},this.options_,{seekable:function(){return s.seekable()},media:function(){return s.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new aQ(o),this.masterPlaylistController_.on("error",function(){var l=Oe.players[s.tech_.options_.playerId],f=s.masterPlaylistController_.error;typeof f=="object"&&!f.code?f.code=3:typeof f=="string"&&(f={message:f,code:3}),l.error(f)});var c=this.options_.experimentalBufferBasedABR?Un.movingAverageBandwidthSelector(.55):Un.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):c.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Un.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(f){this.masterPlaylistController_.selectPlaylist=f.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(f){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=f,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){var f=this.masterPlaylistController_.mainSegmentLoader_.bandwidth,g=Se.default.navigator.connection||Se.default.navigator.mozConnection||Se.default.navigator.webkitConnection,m=1e7;if(this.options_.useNetworkInformationApi&&g){var y=g.downlink*1e3*1e3;y>=m&&f>=m?f=Math.max(f,y):f=y}return f},set:function(f){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=f,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var f=1/(this.bandwidth||1),g;this.throughput>0?g=1/this.throughput:g=0;var m=Math.floor(1/(f+g));return m},set:function(){Oe.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return s.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return s.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return s.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return s.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return s.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return s.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return s.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return s.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},mediaAppends:{get:function(){return s.masterPlaylistController_.mediaAppends_()||0},enumerable:!0},mainAppendsToLoadedData:{get:function(){return s.masterPlaylistController_.mainAppendsToLoadedData_()||0},enumerable:!0},audioAppendsToLoadedData:{get:function(){return s.masterPlaylistController_.audioAppendsToLoadedData_()||0},enumerable:!0},appendsToLoadedData:{get:function(){return s.masterPlaylistController_.appendsToLoadedData_()||0},enumerable:!0},timeToLoadedData:{get:function(){return s.masterPlaylistController_.timeToLoadedData_()||0},enumerable:!0},buffered:{get:function(){return Xc(s.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return s.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return s.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return s.tech_.name_},enumerable:!0},duration:{get:function(){return s.tech_.duration()},enumerable:!0},master:{get:function(){return s.playlists.master},enumerable:!0},playerDimensions:{get:function(){return s.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Xc(s.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return s.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){s.options_.useBandwidthFromLocalStorage&&yQ({bandwidth:s.bandwidth,throughput:Math.round(s.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){nQ(s)}),this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",function(){s.setupEme_()}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=Se.default.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},r.createKeySessions_=function(){var i=this,a=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),mQ({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:a&&a.media(),mainPlaylists:this.playlists.master.playlists}).then(function(){i.logger_("created EME key session"),i.masterPlaylistController_.sourceUpdater_.initializedEme()}).catch(function(s){i.logger_("error while creating EME key session",s),i.player_.error({message:"Failed to initialize media keys for EME",code:3})})},r.handleWaitingForKey_=function(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()},r.setupEme_=function(){var i=this,a=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,s=vQ({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:a&&a.media()});if(this.player_.tech_.on("keystatuschange",function(o){o.status==="output-restricted"&&i.masterPlaylistController_.blacklistCurrentPlaylist({playlist:i.masterPlaylistController_.media(),message:"DRM keystatus changed to "+o.status+". Playlist will fail to play. Check for HDCP content.",blacklistDuration:1/0})}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),Oe.browser.IE_VERSION===11||!s){this.masterPlaylistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()},r.setupQualityLevels_=function(){var i=this,a=Oe.players[this.tech_.options_.playerId];!a||!a.qualityLevels||this.qualityLevels_||(this.qualityLevels_=a.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){pQ(i.qualityLevels_,i)}),this.playlists.on("mediachange",function(){GR(i.qualityLevels_,i.playlists)}))},e.version=function(){return{"@videojs/http-streaming":jR,"mux.js":cQ,"mpd-parser":lQ,"m3u8-parser":dQ,"aes-decrypter":fQ}},r.version=function(){return this.constructor.version()},r.canChangeType=function(){return qR.canChangeType()},r.play=function(){this.masterPlaylistController_.play()},r.setCurrentTime=function(i){this.masterPlaylistController_.setCurrentTime(i)},r.duration=function(){return this.masterPlaylistController_.duration()},r.seekable=function(){return this.masterPlaylistController_.seekable()},r.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.tech_&&delete this.tech_.hls,this.mediaSourceUrl_&&Se.default.URL.revokeObjectURL&&(Se.default.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),t.prototype.dispose.call(this)},r.convertToProgramTime=function(i,a){return PY({playlist:this.masterPlaylistController_.media(),time:i,callback:a})},r.seekToProgramTime=function(i,a,s,o){return s===void 0&&(s=!0),o===void 0&&(o=2),RY({programTime:i,playlist:this.masterPlaylistController_.media(),retryCount:o,pauseAfterSeek:s,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:a})},e}(_Q),vv={name:"videojs-http-streaming",VERSION:jR,canHandleSource:function(e,r){r===void 0&&(r={});var n=Oe.mergeOptions(Oe.options,r);return vv.canPlayType(e.type,n)},handleSource:function(e,r,n){n===void 0&&(n={});var i=Oe.mergeOptions(Oe.options,n);return r.vhs=new gT(e,r,i),Oe.hasOwnProperty("hls")||Object.defineProperty(r,"hls",{get:function(){return Oe.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),r.vhs},configurable:!0}),r.vhs.xhr=bR(),r.vhs.src(e.src,e.type),r.vhs},canPlayType:function(e,r){r===void 0&&(r={});var n=Oe.mergeOptions(Oe.options,r),i=n.vhs;i=i===void 0?{}:i;var a=i.overrideNative,s=a===void 0?!Oe.browser.IS_ANY_SAFARI:a,o=n.hls;o=o===void 0?{}:o;var c=o.overrideNative,l=c===void 0?!1:c,f=VP.simpleTypeFromSourceType(e),g=f&&(!Un.supportsTypeNatively(f)||l||s);return g?"maybe":""}},wQ=function(){return ci.browserSupportsCodec("avc1.4d400d,mp4a.40.2")};wQ()&&Oe.getTech("Html5").registerSourceHandler(vv,0);Oe.VhsHandler=gT;Object.defineProperty(Oe,"HlsHandler",{get:function(){return Oe.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),gT},configurable:!0});Oe.VhsSourceHandler=vv;Object.defineProperty(Oe,"HlsSourceHandler",{get:function(){return Oe.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),vv},configurable:!0});Oe.Vhs=Un;Object.defineProperty(Oe,"Hls",{get:function(){return Oe.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),Un},configurable:!0});Oe.use||(Oe.registerComponent("Hls",Un),Oe.registerComponent("Vhs",Un));Oe.options.vhs=Oe.options.vhs||{};Oe.options.hls=Oe.options.hls||{};(!Oe.getPlugin||!Oe.getPlugin("reloadSourceOnError"))&&(GP=Oe.registerPlugin||Oe.plugin,GP("reloadSourceOnError",uQ));var GP;zR.exports=Oe});var oD=D((SAe,sD)=>{"use strict";var YR=Cr(),TQ=_i(),SQ=ui().createDOMSubtreeModifiedListener,EQ=Ql(),xQ=WR(),CQ=Zl(),AQ="//youtube.com/favicon.ico",IQ="//vimeo.com/favicon.ico",JR,QR=!0,rh,ih,yv=!1,bv=!1,al,Nd,nl,ZR,eD,nh,bs,Si,il,wT,rl;function KR(t,e){var r=new Image;r.onload=function(){e(!1)},r.onerror=function(){e(!0)},r.src=t}function lu(){if(bv=!0,eD.fadeOut(750,function(){Si.fadeIn(750)}),Si==nl&&(il.play(),il.on("ended",mT),il.on("pause",function(){Qu(!0)}),il.on("play",function(){Qu(!1)})),Si==al){var t={autoplay:0,rel:0,showinfo:0};window.pageSpecific.humanLanguage==="es"&&(t.cc_lang_pref="es",t.cc_load_policy=1),window.pageSpecific.accessibilityMode&&(t.cc_load_policy=1),wT=new window.YT.Player("youtube-player",{height:"100%",width:"100%",videoId:JR,playerVars:t,events:{onStateChange:function(e){e.data==window.YT.PlayerState.PLAYING?Qu(!1):e.data==window.YT.PlayerState.ENDED?(Qu(!0),mT()):e.data==window.YT.PlayerState.PAUSED&&Qu(!0)},onReady:function(e){e.target.playVideo()}}})}Si==Nd&&(Qu(!0),rl=new Vimeo.Player("vimeo-video"),rl.ready().then(function(){rl.on("ended",function(){mT()}),rl.on("pause",function(){Qu(!0)}),rl.on("play",function(){Qu(!1)})}))}function XR(){_v(),!(rh===void 0||ih===void 0||yv===!0)&&(!rh&&!ih||!rh&&ih?(Si=al,bs.youtube.addClass("selected")):rh&&!ih&&QR?(Si=Nd,bs.vimeo.addClass("selected")):(Si=nl,bs.codehs.addClass("selected")))}function kQ(){ZR.on("click",function(){lu()})}function mT(){if(document.fullscreenElement&&document.exitFullscreen(),Si.fadeOut(750),wT=null,rl=null,nh.fadeIn(750),window.pageSpecific.isOwnPage){var t={};window.pageSpecific.studentAssignmentID?t={student_assignment_id:window.pageSpecific.studentAssignmentID}:t={item_id:window.pageSpecific.CHS_CURRENT_ITEM_ID,module_id:window.pageSpecific.CHS_CURRENT_MODULE_ID,course_id:window.pageSpecific.CHS_CURRENT_COURSE_ID},EQ(t,self.goToNext)}}function Qu(t){t?($(".navbar").fadeIn(750),$("#editor-bottombar-nav").fadeIn(750),$("body").animate({"background-color":"#FFF"},750),$(".lti-launch-banner").fadeIn(750)):($(".navbar").fadeOut(750),$("#editor-bottombar-nav").fadeOut(750),$("body").animate({"background-color":"#000"},750),$(".lti-launch-banner").fadeOut(750))}function _v(){bs.codehs.removeClass("selected"),bs.youtube.removeClass("selected"),bs.vimeo.removeClass("selected")}var yT=function(){_v(),bs.codehs.addClass("selected"),yv=!0,bv?(Si.fadeOut(600),Si=nl,Si.fadeIn(600),lu()):(Si=nl,lu()),nh.hide()},bT=function(){_v(),bs.youtube.addClass("selected"),yv=!0,bv?(Si.fadeOut(600),Si=al,Si.fadeIn(600),lu()):(Si=al,lu()),nh.hide()},_T=function(){_v(),bs.vimeo.addClass("selected"),yv=!0,bv?(Si.fadeOut(600),Si=Nd,Si.fadeIn(600),lu()):(Si=Nd,lu()),nh.hide()},tD=function(t){JR=t},rD=function(){QR=!1};function OQ(){window.location.href=$("#done-button").attr("data-next")}var PQ=function(){$("#video-view").toggleClass("video-view-left video-view-full"),$("#video-view-notepad-container").toggle()},iD=function(t){TQ.send({method:"save_user_notes",app:"editor",data:{notes:t,item_id:window.pageSpecific.CHS_CURRENT_ITEM_ID}})};function nD(t,e){var r=$(".slides-link-template").html();$(".navbar-left").append(r),$(".slides-link").on("click",function(){var n=new URLSearchParams(window.location.search),i=t;n.has("lock-override")&&(i+="&lock-override=1"),window.location.href=i}),$(".next-link").on("click",function(){window.location.href=e})}var aD=function(){nD(window.pageSpecific.slidesLink,window.pageSpecific.nextLink);var t=CQ.createEditor("#notepad",window.pageSpecific.userNotes);bs={codehs:$(".codehsOption"),youtube:$(".youtubeOption"),vimeo:$(".vimeoOption")},ZR=$(".play-button"),eD=$("#pre-video-container"),nh=$("#post-video-container"),al=$("#youtube-video-container"),Nd=$("#vimeo-video-container"),nl=$("#codehs-video-container"),il=xQ("codehsvideo",{controls:!0,playbackRates:[.5,.75,1,1.25,1.5,1.75,2],fill:!0}),wT=$(".youtube-video"),rl=$(".vimeo-video"),Si=nl,bs.codehs.addClass("selected"),kQ(),KR(AQ,function(e){rh=e,XR()}),KR(IQ,function(e){ih=e,XR()}),$("#done-button").on("click",function(e){e.preventDefault(),$(this).attr("disabled","disabled"),$("#replay-button").attr("disabled","disabled"),$("#replay-button").fadeOut(),$("#done-button").fadeOut(400,function(){$("#loading-div").fadeIn()}),OQ()}),$("#replay-button").on("click",function(e){e.preventDefault(),Si==nl?yT():Si==al?bT():Si==Nd&&_T()}),$(".codehsOption").on("click",function(){yT()}),$(".youtubeOption").on("click",function(){bT()}),$(".vimeoOption").on("click",function(){_T()}),tD(window.pageSpecific.youtubeID),window.pageSpecific.noVimeo&&rD(),$("#notepad-button").on("click",function(){PQ()}),SQ($("body")[0],".ql-editor",function(){var e;$("#save-status").text("Saving..."),e&&clearTimeout(e),e=setTimeout(function(){var r=$("#notepad").find(".ql-editor").html();iD(r),$("#save-status").text("Saved")},1e3)}),$(window).on("beforeunload",vT),$(document).one("turbolinks:before-render",function(){vT(),$(window).off("beforeunload",vT)})},vT=function(){il&&il.dispose()};YR.on("editor:newVideoPage:setup",aD);YR.on("editor:newVideoPage:playVideo",lu);sD.exports={setup:aD,setupNavButtons:nD,setPlayerCodeHS:yT,setPlayerYoutube:bT,setPlayerVimeo:_T,setYoutubeID:tD,noVimeoVideo:rD,playVideo:lu,saveNotes:iD}});var cD=D(()=>{"use strict";var uD=Cr(),RQ=Ql();function DQ(){var t=$(".slides-link-template").html();$(".navbar-left").append(t),$(".video-link").on("click",function(){var e=new URLSearchParams(window.location.search),r=window.pageSpecific.videoLink;e.has("lock-override")&&(r+="?lock-override=1"),window.location.href=r}),$(".next-link").on("click",function(){window.location.href=window.pageSpecific.nextUrl})}uD.on("slides:setup",DQ);uD.on("slides:novideo",function(){if(window.pageSpecific.isOwnPage){var t={};window.pageSpecific.studentAssignmentID?t={student_assignment_id:window.pageSpecific.studentAssignmentID}:t={item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID},RQ(t,function(){})}})});var pD=D(()=>{"use strict";var Fn=Nr(),TT=Cr(),LQ=_i(),NQ=Jl(),sl="#next-button",wv,ah;function lD(t){var e=0;return t.each(function(){var r=parseInt($(this).data("qtype")),n=$(this).data("answered"),i;if(r==Fn.SurveyQuestion.FREE_RESPONSE){var a=$(this).find("textarea");n=$(a).val()}else r==Fn.SurveyQuestion.ONE_TO_TEN_AND_WHY?(i=$(this).find("textarea"),n=$(i).val()):r==Fn.SurveyQuestion.ONE_TO_FIVE_AND_WHY&&(i=$(this).find("textarea"),n=$(i).val());(window._.isNumber(n)||n!==""&&n!=="None")&&e++}),e}function fD(t){var e=$(".question"),r=e.length,n=$(".question:not(.blocking)").length,i=lD(e);if(r===n)return i>0&&!t?($("#survey-questions").addClass("disabled"),$("#survey-questions").css({pointerEvents:"none"}),!0):i>0&&t?($("#survey-questions").addClass("disabled"),$("#survey-questions").css({pointerEvents:"none"}),$("#continue-no-answer-link").css("display","None"),$(sl).text("Next"),!0):!1;var a=$(".question.blocking"),s=a.length,o=lD(a);return s===o&&!t?($("#survey-questions").addClass("disabled"),$("#survey-questions").css({pointerEvents:"none"}),!0):s===o&&t?($("#survey-questions").addClass("disabled"),$("#survey-questions").css({pointerEvents:"none"}),$("#continue-no-answer-link").css("display","None"),$(sl).text("Next"),!0):!1}function Tv(t,e,r){var n=parseInt(e)-1,i=$("#q-"+t+" .answers tr.selected");i&&i.removeClass(r);var a=$("#q-"+t+" .answers tr")[n];$(a).addClass(r)}function dD(t,e){var r;if(e===Fn.SurveyQuestion.MULTIPLE_CHOICE||e==Fn.SurveyQuestion.ONE_TO_TEN||e==Fn.SurveyQuestion.ONE_TO_TEN_AND_WHY||e==Fn.SurveyQuestion.ONE_TO_FIVE_AND_WHY||e==Fn.SurveyQuestion.ONE_TO_FIVE_AND_WHY){r=$("input[name=question"+t+"]:checked");var n=r.data("idx");return n+1}else return null}function MQ(t){$(".question").each(function(){var e=$(this).data("questionid"),r=$(this).data("answered"),n=$(this).data("qtype");if(r!="None"){if(n==Fn.SurveyQuestion.FREE_RESPONSE)$(this).find("textarea").val(r);else if(n==Fn.SurveyQuestion.ONE_TO_TEN_AND_WHY||n==Fn.SurveyQuestion.ONE_TO_FIVE_AND_WHY){typeof r!="string"&&(r=JSON.stringify(r)),r=r.replace(/(\r\n|\n|\r)/gm,"1a2drc7d5f"),r=JSON.parse(r);var i=r.score,a=r.why;a=a.replace(/1a2drc7d5f/gm,`
`),$(this).find("textarea").val(a),Tv(e,i,"selected");var s=parseInt(i)-1,o=$("#q-"+e+" .answers .answer")[s];$(o).find("input:radio").prop("checked",!0)}else{Tv(e,r,"selected");var c=parseInt(r)-1,l=$("#q-"+e+" .answers .answer")[c];$(l).find("input:radio").prop("checked",!0)}$(this).find("input, textarea").attr("disabled",!0)}}),fD(!0)}function $Q(){var t=$(".question");t.each(function(){var e=$(this).data("questionid"),r=$(this).data("qtype");if(r==Fn.SurveyQuestion.FREE_RESPONSE){var n=$(this).find("textarea"),i=n.val(),a=!$.trim($("#myTextArea").val());n.on("change",function(){!$.trim(n.val())!=a&&$("#q-"+e).data("answered",i)})}else if(r==Fn.SurveyQuestion.ONE_TO_TEN_AND_WHY||r==Fn.SurveyQuestion.ONE_TO_FIVE_AND_WHY){$(this).find(".answers .answer").on("click",function(){$(this).find("input:radio").prop("checked",!0);var l=parseInt($(this).data("questionid")),f=parseInt($(this).data("qtype")),g=dD(l,f);$("#q-"+l).data("answered",g),Tv(l,g,"selected")});var s=$("#freeresponse-answer-"+e),o=s.val(),c=!$.trim($("#myTextArea").val());s.on("change",function(){!$.trim(s.val())!=c&&(o=s.val(),s.data("why",o))})}else $(this).find(".answers .answer").on("click",function(){$(this).find("input:radio").prop("checked",!0);var l=parseInt($(this).data("questionid")),f=parseInt($(this).data("qtype")),g=dD(l,f);$("#q-"+l).data("answered",g),Tv(l,g,"selected")})})}function UQ(t){t=t||{},ah=t.numQuestions||0,wv=t.pageUserID||0,MQ(ah),$Q(),$(sl).on("click",function(e){TT.trigger("utils:disableButton",sl),e.preventDefault();var r=fD(!1);if(r){var n=$(".question"),i={};n.each(function(){var a=parseInt($(this).data("qtype")),s=$(this).data("questionid"),o=$(this).data("answered");if(a==Fn.SurveyQuestion.FREE_RESPONSE){var c=$(this).find("textarea"),l=$(c).val();l&&(i[s]={pageUserID:wv,questionID:s,numQuestions:ah,questionType:a,answer:l})}else if((a==Fn.SurveyQuestion.ONE_TO_TEN_AND_WHY||a==Fn.SurveyQuestion.ONE_TO_FIVE_AND_WHY)&&o!="None"){var f=JSON.stringify({score:o,why:$(this).find("textarea").val()});i[s]={pageUserID:wv,questionID:s,numQuestions:ah,questionType:a,answer:f}}else o!="None"&&(i[s]={pageUserID:wv,questionID:s,numQuestions:ah,questionType:a,answer:o})}),LQ.send({method:"answer_survey_question",app:"editor",data:{questionAnswerData:JSON.stringify(i)},success:function(a){$("#survey-questions").addClass("disabled"),$("#survey-questions textarea").attr("readonly",!0),$("#survey-questions .multiple-choice-answers").css({pointerEvents:"none"}),$("#survey-questions input:checkbox:not(:checked)").attr("disabled","disabled")},contentType:"application/json; charset=utf-8"}),window.location.replace($(sl).data("next"))}else NQ({message:"Please answer all of the required questions in order to submit",button:"OK",refocusTarget:sl}),TT.trigger("utils:enableButton",sl)})}function FQ(){var t={numQuestions:window.pageSpecific.numQuestions,pageUserID:window.pageSpecific.pageUserID};UQ(t)}TT.on("editor:survey",FQ)});var hD=D(()=>{"use strict";var BQ=Yl(),qQ=Cr();function jQ(){BQ.warning("You can use the custom content tool to release it.","This exercise is not released.")}qQ.on("editor:showItemNotReleasedToast",jQ)});var gD=D((OAe,HQ)=>{HQ.exports=`<div class="container" style="height:400px; width:700px">
  <style>
    a.place.btn.btn-default{
      border-color: #FFFFFF;
      pointer-events: none;
    }
  </style>
  <h4>Binary (Base-2) Value:</h4>

  <div class="btn-group btn-group-justified" role="group" aria-label="binaryData">
      <a class="place128 bit btn btn-main-dark-blue" data-place="128" id="place128" role="button">0</a>
      <a class="place64 bit btn btn-main-dark-blue" data-place="64" id="place64" role="button">0</a>
      <a class="place32 bit btn btn-main-dark-blue" data-place="32" id="place32" role="button">0</a>
      <a class="place16 bit btn btn-main-dark-blue" data-place="16" id="place16" role="button">0</a>
      <a class="place8 bit btn btn-main-dark-blue" data-place="8" id="place8" role="button">0</a>
      <a class="place4 bit btn btn-main-dark-blue" data-place="4" id="place4" role="button">0</a>
      <a class="place2 bit btn btn-main-dark-blue" data-place="2" id="place2" role="button">0</a>
      <a class="place1 bit btn btn-main-dark-blue" data-place="1" id="place1" role="button">0</a>
  </div>

  <div class="btn-group btn-group-justified" role="group" aria-label="binaryLabels">
      <a class="place btn btn-default">128</a>
      <a class="place btn btn-default">64</a>
      <a class="place btn btn-default">32</a>
      <a class="place btn btn-default">16</a>
      <a class="place btn btn-default">8</a>
      <a class="place btn btn-default">4</a>
      <a class="place btn btn-default">2</a>
      <a class="place btn btn-default">1</a>
  </div>

  <div class="btn-group btn-group-justified" role="group" aria-label="binaryPowers">
      <a class="place btn btn-default">(2<sup>7</sup>)</a>
      <a class="place btn btn-default">(2<sup>6</sup>)</a>
      <a class="place btn btn-default">(2<sup>5</sup>)</a>
      <a class="place btn btn-default">(2<sup>4</sup>)</a>
      <a class="place btn btn-default">(2<sup>3</sup>)</a>
      <a class="place btn btn-default">(2<sup>2</sup>)</a>
      <a class="place btn btn-default">(2<sup>1</sup>)</a>
      <a class="place btn btn-default">(2<sup>0</sup>)</a>
  </div>

  <h4>Decimal (Base-10) Value:</h4>
  <center>
    <h2 id="binaryResult"></h2>
    <h2 id="decimalResult"></h2>
  </center>
</div>
`});var yD=D((PAe,vD)=>{var GQ=".bit",VQ="#decimalResult",zQ="#binaryResult",WQ=gD();function mD(){var t=$(WQ),e=t.find(GQ),r=t.find(VQ),n=t.find(zQ),i=e.get().sort(function(a,s){return parseInt($(a).attr("data-place"))>parseInt($(s).attr("data-place"))?-1:1});return e.on("click",function(){var a=$(this).html();a=="0"?$(this).html("1").addClass("on").addClass("btn-main-blue").removeClass("btn-main-dark-blue"):$(this).html("0").removeClass("on").addClass("btn-main-dark-blue").removeClass("btn-main-blue");var s="",o="",c=0;$.each(i,function(l,f){if(o=o+$(this).html(),$(f).hasClass("on")){var g=$(this).attr("data-place");s=s+" + "+g,c+=parseInt(g)}}),s.length===0?s="0<sub>10</sub> = 0<sub>10</sub>":s=s.substring(3)+"<sub>10</sub> = "+c.toString()+"<sub>10</sub>",o=o+"<sub>2</sub> = "+c.toString()+"<sub>10</sub>",r.html(s),n.html(o)}),t}vD.exports={dialog:function(t){mD().dialog(t)},jqueryElem:mD}});var bD=D(()=>{"use strict";var KQ=Cr(),XQ=yD();function YQ(){$(".notes-section").append(XQ.jqueryElem())}KQ.on("notes:number-base-tool",YQ)});var ET=D((LAe,_D)=>{"use strict";var JQ=Ni().removeComments;function ST(t,e){if(e!="js")throw new Error("Can only translate karel to js karel.");if(t!="java"&&t!="python")throw new Error("Can only translate from java and python");this.fromLanguage="java",this.toLanguage="js"}ST.prototype.translateJavaToJavaScript=function(t,e){return e=typeof e<"u"?e:!0,e&&(t=JQ(t)),t=t.replace(/run\s*\(\s*\)/g,"start()"),t=t.replace(/((public|private)\s+)?class\s+\w+(\s+extends\s+\w+)?/,""),t=t.replace(/{/,""),t=t.replace(/}\s*(?:\/\/\s*[^}]*[\t\n\r]*)*$/,""),t=t.replace(/(\n\t|\n {4})/g,`
`),t=t.replace(/int *\[ *\] *(\w+) *= *new *int *\[ *(\w+) *\]/g,"var $1 = Array($2).fill(0)"),t=t.replace(/\bint/g,"var"),t=t.replace(/((public|private)\s+)?void/g,"function"),t};ST.prototype.translate=function(t){if(this.fromLanguage=="java"&&this.toLanguage=="js")return this.translateJavaToJavaScript(t)};_D.exports=ST});var wD=D((NAe,QQ)=>{QQ.exports=`<div class="modal" id="autograder-modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="alert-close close" data-dismiss="modal">&times;</button>
                <h3>CodeHS</h3>
            </div>
            <div class="modal-body" style="max-height:60%;overflow-y:auto;">
                <h4>
                    {{#if aiGradingInProgress }}
                    <div class="full-width flex flex-align-center">
                        <div class="spinner icon-spinner icon-spin icon"></div>
                    </div>
                    <h3 class="center"> Running Autograder </h3>
                    {{else if passed }}
                        {{#if hasTests}}
                            {{#ifCond prefLang '===' 'es'}}
                                <span>\xA1Excelente!</span> {{#unless freeResponse}}Tu programa funciona.{{/unless}}
                            {{else}}
                                <span>Great job!</span> {{#unless freeResponse}}Your program works.{{/unless}}
                            {{/ifCond}}
                        {{else}}
                            <span>Thanks!</span> Your program has been submitted.
                        {{/if}}
                    {{else if blankFreeResponse}}
                        {{#ifCond prefLang '===' 'es'}}
                            <span>Parece que tu respuesta est\xE1 vac\xEDa.</span>
                            <br>
                            \xA1Revisa la pregunta y vuelve a intentarlo!
                        {{else}}
                            <span>It looks like your response is empty.</span>
                            <br>
                            Take another look at the question and give it a try!
                        {{/ifCond}}
                    {{else}}
                        {{#ifCond prefLang '===' 'es'}}
                            <span>Ups.</span> Parece que tienes algunos errores.
                        {{else}}
                            <span>Oops.</span> It looks like you have a few errors.
                        {{/ifCond}}
                            <br>
                        {{#if isUserLoggedIn }}
                            {{#unless isAbacus }}
                                {{#ifCond prefLang '===' 'es'}}
                                    Deber\xEDas seguir trabajando y volver a intentarlo
                                {{else}}
                                    You should keep working and try again.
                                {{/ifCond}}
                            {{/unless}}
                        {{/if}}
                    {{/if}}
                </h4>

                {{#if funcTests}}
                    <h5>
                        {{#ifCond prefLang '===' 'es'}}
                            Funcionalidad
                        {{else}}
                            Functionality
                        {{/ifCond}}
                    </h5>
                    {{#each funcTests}}
                        <div class="world-status">
                            <div class="status left{{#if success}} pass{{else}} fail{{/if}}">
                                <span class="chs-icon chs-icon-{{#if success}}check text-green{{else}}cancel text-red{{/if}}"></span>
                            </div>
                            <h4 class="left name">
                                {{#if isHiddenTest}}
                                    Hidden Test
                                {{else}}
                                    {{#if test}}
                                        {{{test}}}
                                    {{else}}
                                        {{{message}}}
                                    {{/if}}
                                {{/if}}
                            </h4>
                        </div>
                        <div class="clear"></div>
                    {{/each}}
                {{/if}}

                {{#if styleTests}}
                    <h5>
                        {{#ifCond prefLang '===' 'es'}}
                            Estilo
                        {{else}}
                            Style
                        {{/ifCond}}
                    </h5>
                    {{#each styleTests}}
                        <div class="world-status">
                            <div class="status left{{#if success}} pass{{else}} fail{{/if}}">
                                <span class="chs-icon chs-icon-{{#if success}}check text-green{{else}}cancel text-red{{/if}}"></span>
                            </div>
                            <h4 class="left name">
                                {{{message}}}
                            </h4>
                        </div>
                        <div class="clear"></div>
                    {{/each}}
                {{/if}}

                {{#if aiTests}}
                    <h5>AI Tests</h5>
                    {{#each aiTests}}
                        <div class="world-status">
                            <div class="status left{{#if success}} pass{{else}} fail{{/if}}">
                                <span class="chs-icon chs-icon-{{#if success}}check text-green{{else}}cancel text-red{{/if}}"></span>
                            </div>
                            <h4 class="left name">
                                {{#if test}}
                                    {{{test}}}
                                {{else}}
                                    {{{message}}}
                                {{/if}}
                            </h4>
                        </div>
                        <div class="clear"></div>
                    {{/each}}
                {{/if}}

                {{#if passed}}
                {{#if optionalTests}}
                    <h5>Heads up! Some optional tests didn't pass:</h5>
                    {{#each optionalTests}}
                        {{#unless success}}
                            <div class="world-status">
                                {{#ifCond verbosityLevel '===' 10}}
                                    <div class="status left flex flex-align-center" style="border-color: #fbaf3f;">
                                        <span class="chs-icon fa-solid fa-exclamation text-orange"></span>
                                    </div>
                                {{/ifCond}}
                                {{#ifCond verbosityLevel '===' 20}}
                                    <div class="status left flex flex-align-center" style="border-color: #27a9e1;">
                                        <span class="chs-icon fa-solid fa-info text-blue"></span>
                                    </div>
                                {{/ifCond}}
                                <h4 class="left name">
                                    {{#if isHiddenTest}}
                                        Hidden Test
                                    {{else}}
                                        {{#if test}}
                                            {{{test}}}
                                        {{else}}
                                            {{{message}}}
                                        {{/if}}
                                    {{/if}}
                                </h4>
                            </div>
                            <div class="clear"></div>
                        {{/unless}}
                    {{/each}}
                {{/if}}
                {{/if}}

                {{#if isHourOfCode}}
                {{#if passed}}
                <div id="autograder-signup">
                    <btn id="hoc-signup-autograder-btn" class="btn btn-main-green js-hoc-signup-modal alert-close">Sign Up to save your progress</btn>
                </div>
                {{/if}}
                {{/if}}
            </div>
            <div class="modal-footer">
                {{#if ownPage}}
                    {{#if passed}}
                        <a href="#" class="uppercase alert-close">
                            {{#ifCond prefLang '===' 'es'}}
                                Cerrar
                            {{else}}
                                Close
                            {{/ifCond}}
                        </a>
                        {{#if isPractice}}
                        <a href="{{practiceUrl}}" class="btn btn-main-dark-blue">Back to Practice</a>
                        {{/if}}
                        <a id="submit-correct" href="#" class="btn btn-main alert-close">
                            {{#ifCond prefLang '===' 'es'}}
                                Enviar + Continuar
                            {{else}}
                                Submit + Continue
                            {{/ifCond}}
                        </a>
                    {{else}}
                        {{#unless isPracticeLoggedOut}}
                        <a id="continue-anyways-btn" href="{{nextUrl}}">
                            {{#ifCond prefLang '===' 'es'}}
                                Continuar de todos modos
                            {{else}}
                                Continue Anyway
                            {{/ifCond}}
                        </a>
                        {{/unless}}
                        {{#if isPractice}}
                        <a href="{{practiceUrl}}" class="btn btn-main-dark-blue">Back to Practice</a>
                        {{/if}}
                        <a href="#" class="btn btn-main-transparent alert-close">
                            {{#ifCond prefLang '===' 'es'}}
                                Cerrar
                            {{else}}
                                Close
                            {{/ifCond}}
                        </a>
                    {{/if}}
                {{else}}
                    <a href="#" class="btn btn-main-transparent alert-close">
                        {{#ifCond prefLang '===' 'es'}}
                            Cerrar
                        {{else}}
                            Close
                        {{/ifCond}}
                    </a>
                {{/if}}
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
`});var IT=D((MAe,ID)=>{"use strict";var ta=Qg(),Sv=_i(),sh=Nr(),ns=Cr(),xT=bz(),ZQ=Ni().removeComments,SD=ET(),eZ="#submit-button",tZ=wD(),du={};function ED(t){function e(m){return m==" "||m==`
`||m=="	"}for(var r="",n="",i="",a=0,s=!1,o=!1,c=!1,l={},f=0;f<t.length;f++){var g=t[f];if(e(g)||g=="{"||g=="}"?(r="",g=="{"?a++:g=="}"&&a--):r+=g,o&&g=="}"&&a===0&&(l[n]=i,o=!1,r="",i="",n=""),o&&(i+=g),s&&g=="{")for(s=!1,o=!0;e(t[f+1]);)f++;s&&!e(g)&&!c&&g!="("&&g!=")"&&(n+=g),s&&g=="("?c=!0:s&&g==")"&&(c=!1),!o&&r=="function"&&e(t[f+1])&&(s=!0)}return l}function CT(t){var e={};return e.original=t,e.withoutComments=ZQ(e.original),e.functions=ED(e.withoutComments),e}var TD=["#ff99c6","#de5844","#8e3329","#fbaf3f","#ffdd17","#8cc63e","#00a79d","#2e3092","#9e1e62"];function rZ(t){t.style.animation="particleBurst 1s ease-out forwards",setTimeout(function(){t.remove()},1e3)}function xD(t){if(t.length!==0){t[0].style.position="relative";for(var e=Math.random()*100+100,r=t[0].offsetWidth,n=t[0].offsetHeight,i=Math.max(r,n)/2,a=[],s=0;s<e;s++){var o=document.createElement("div");o.style.position="absolute",o.style.width=Math.random()*10+5+"px",o.style.height=Math.random()*10+5+"px",o.style.backgroundColor=TD[Math.floor(Math.random()*TD.length)],o.style.borderRadius="50%",o.style.left="50%",o.style.top="50%",o.style.transform="translate(-50%, -50%) scale(0)";var c=Math.random()*Math.PI*2,l=i+Math.random()*i,f=Math.cos(c)*l,g=Math.sin(c)*l;o.style.setProperty("--end-x",f+"px"),o.style.setProperty("--end-y",g+"px"),t.append(o),a.push(o)}setTimeout(function(){a.forEach(function(m){rZ(m)})},250)}}function CD(t,e,r,n,i){if(n=n||{},n=ta.defaults(n,{displayPopup:!0,editor:r}),du={},i=i||[],du.Additional=i,r.typeTester.isJavaKarel()){var a=!1;t=new SD("java","js").translateJavaToJavaScript(t,a)}e.grading=e.grading||{},e.prog_type=r.progTypeString,e.sqlSetup=r.sqlSetup;var s=CT(t),o=ta.map(xT,function(c){if(c.shouldRun(n))try{return c.run(s,r)}catch(l){return l}});$.when.apply($,o).then(function(){var c=ta.values(du).concat(i),l=[].concat.apply([],c),f=l.length,g=l.filter(function(k){return k.success}).length;try{document.getElementById("score-text").innerHTML=g+"/"+f;var m=g/f*100,y=100-m;document.getElementById("green-bar").style.width=m+"%",document.getElementById("grey-bar").style.width=y+"%",m==100?document.getElementById("green-bar").style.borderRadius="10px":y==100?document.getElementById("grey-bar").style.borderRadius="10px":(document.getElementById("green-bar").style.borderRadius="10px 0 0 10px",document.getElementById("grey-bar").style.borderRadius="0 10px 10px 0")}catch{}var A=l.length===0&&ta.some(o);window.pageSpecific.showJuice&&(g!==f||A?($("#grading-unit-test-run").addClass("shake btn-main-red"),setTimeout(function(){$("#grading-unit-test-run").removeClass("shake")},1e3)):($("#grading-unit-test-run").removeClass("btn-main-red"),setTimeout(function(){xD($("#autograder-modal .modal-dialog"))},250))),r.studentAssignmentID&&Sv.send({method:"track_autograder_results",app:"events",data:{student_assignment_id:r.studentAssignmentID,numTests:f,numPassed:g,allTests:JSON.stringify(l),hasError:A}}),n.displayPopup?ns.trigger("autograder:testingComplete",{tests:du,isOwnPage:r.isOwnPage(),isHourOfCode:r.isHourOfCode(),hasError:A}):ns.trigger("gradingtab:unitTestsComplete",{tests:l,hasError:A,runsCompleted:o})})}function iZ(t,e,r,n,i){if(n=n||{},n=ta.defaults(n,{displayPopup:!0,editor:r}),du={},i=i||[],n.displayPopup&&r.lastAutograderRun&&r.lastAutograderRun.code===t){ns.trigger("autograder:testingComplete",{tests:r.lastAutograderRun.tests,isOwnPage:r.lastAutograderRun.isOwnPage,isHourOfCode:r.lastAutograderRun.isHourOfCode,hasError:r.lastAutograderRun.hasError}),ns.trigger("gradingtab:unitTestsComplete",{tests:ta.flatten(r.lastAutograderRun.tests)});return}if(r.typeTester.isJavaKarel()){var a=!1;t=new SD("java","js").translateJavaToJavaScript(t,a)}e.grading=e.grading||{},e.prog_type=r.progTypeString,e.sqlSetup=r.sqlSetup;var s=CT(t),o=window.pageSpecific.newAutograderSystem.tests.map(function(l){return function(){l.type===sh.EditorTestFormat.JSON_FILE_TREE?r.autograderCode=l.data:l.type===sh.EditorTestFormat.LEGACY_JSON_CONFIG&&(r.autograderConfig={},r.autograderConfig[l.title]=l.data,r.skipTestingKarelWorlds=l.title!=="karelWorlds"),r.visibleToStudents=l.visibleToStudents,r.verbosityLevel=l.verbosityLevel;var f=xT.map(function(g){if(g.shouldRun(n))try{var m=g.run(s,r);return m.then(function(){ns.trigger("gradingtab:unitTestsProgress",{tests:ta.flatten(ta.values(du))})}),m}catch(y){return y}});return Promise.all(f)}}),c=o.reduce(function(l,f){return l.then(f)},Promise.resolve());c.then(function(){var l=ta.values(du),f=l.length===0&&ta.some(o),g=l.flat(),m=g.length,y=g.filter(function(I){return I.success}).length;try{document.getElementById("score-text").innerHTML=y+"/"+m;var A=y/m*100,k=100-A;document.getElementById("green-bar").style.width=A+"%",document.getElementById("grey-bar").style.width=k+"%",A==100?document.getElementById("green-bar").style.borderRadius="10px":k==100?document.getElementById("grey-bar").style.borderRadius="10px":(document.getElementById("green-bar").style.borderRadius="10px 0 0 10px",document.getElementById("grey-bar").style.borderRadius="0 10px 10px 0")}catch{}window.pageSpecific.showJuice&&(y!==m||f?($("#grading-unit-test-run").addClass("shake btn-main-red"),setTimeout(function(){$("#grading-unit-test-run").removeClass("shake")},1e3)):($("#grading-unit-test-run").removeClass("btn-main-red"),setTimeout(function(){xD($("#autograder-modal .modal-dialog"))},250))),r.studentAssignmentID&&Sv.send({method:"track_autograder_results",app:"events",data:{student_assignment_id:r.studentAssignmentID,numTests:m,numPassed:y,allTests:JSON.stringify(g),hasError:f}}),r.lastAutograderRun={tests:l.concat(i),isOwnPage:r.isOwnPage(),isHourOfCode:!1,hasError:f,code:t},n.displayPopup&&ns.trigger("autograder:testingComplete",{tests:l.concat(i),isOwnPage:r.isOwnPage(),isHourOfCode:!1,hasError:f}),ns.trigger("gradingtab:unitTestsComplete",{tests:ta.flatten(l).concat(i)})})}Handlebars.registerHelper("ifCond",function(t,e,r,n){switch(e){case"==":return t==r?n.fn(this):n.inverse(this);case"===":return t===r?n.fn(this):n.inverse(this);case"!=":return t!=r?n.fn(this):n.inverse(this);case"!==":return t!==r?n.fn(this):n.inverse(this);case"<":return t<r?n.fn(this):n.inverse(this);case"<=":return t<=r?n.fn(this):n.inverse(this);case">":return t>r?n.fn(this):n.inverse(this);case">=":return t>=r?n.fn(this):n.inverse(this);case"&&":return t&&r?n.fn(this):n.inverse(this);case"||":return t||r?n.fn(this):n.inverse(this);default:return n.inverse(this)}});function AD(t,e){e=e||du,ta.has(t,"messagePass")&&(t.success?t.message=t.messagePass:t.message=t.messageFail,delete t.messagePass,delete t.messageFail);var r=t.category||"Functionality";e[r]?e[r].push(t):e[r]=[t]}var nZ=function(t){return ta.every(t,function(e){return e.success||e.verbosityLevel&&e.verbosityLevel>sh.EditorTestVerbosity.ERROR})},aZ=function(t){return t.length},sZ=function(t){return ta.flatten(ta.values(t))},oZ=function(t){return t.filter(function(e){return e.aiTestCase})},uZ=function(t){return t.filter(function(e){return!e.success&&[sh.EditorTestVerbosity.WARNING,sh.EditorTestVerbosity.INFO].includes(e.verbosityLevel)})};function AT(t){var e=window.Handlebars.compile(tZ),r=t.tests,n=t.hasError||!1,i=sZ(r),a=oZ(i),s=uZ(i),o=aZ(i),c=nZ(i)&&!n,l={funcTests:r.Functionality,styleTests:r.Style,aiTests:a,optionalTests:s,passed:c,hasTests:o,isUserLoggedIn:window.userData.isAuthenticated,ownPage:t.isOwnPage,isHourOfCode:t.isHourOfCode,isPractice:window.IS_PRACTICE,isPracticeLoggedOut:window.PRACTICE_LOGGED_OUT_EDITOR,isAbacus:window.pageSpecific.isAbacus||!1,prefLang:window.pageSpecific.preferredLang,freeResponse:window.pageSpecific.useFreeResponseAutograder||!1,blankFreeResponse:t.blankFreeResponse||!1,aiGradingInProgress:t.aiGradingInProgress||!1,nextUrl:$("#next-url").data("url")+"#",practiceUrl:$("#practice-url").data("url")+"#"};$("#autograder-modal").modal("hide"),$("#autograder-modal").remove();var f=e(l);$("body").append(f),$("#autograder-modal").modal({backdrop:"static"}),$(".alert-close").on("click",function(){ns.trigger("utils:enableButton",eZ),$("#autograder-modal").modal("hide"),$("#autograder-modal").remove()})}ns.on("autograder:testingComplete",function(t){AT(t)});ns.on("autograder:addTests",function(t){ta.each(t.tests,function(e){AD(e,du)})});ns.on("autograder:run",function(t,e,r,n){var i=[];function a(){ns.trigger("editor:sr:statusUpdate","Code saved succesfully, running tests now"),window.pageSpecific.newAutograderSystem?iZ(t,e,r,n,i):CD(t,e,r,n,i),Sv.send({method:"track_autograder_run",app:"events",data:{item_id:r.itemID,user_id:r.codeUserID,code:t,student_assignment_id:r.studentAssignmentID,from_submit_button:n.displayPopup}})}n.aiTestCases!==void 0?(n.aiCacheOnly||AT({aiGradingInProgress:!0,tests:{}}),Sv.send({app:"ai",method:"ai_autograde",data:{item_id:r.itemID,student_id:r.codeUserID,student_assignment_id:r.studentAssignmentID,test_cases:n.aiTestCases,cache_only:n.aiCacheOnly},success:function(s){s.status==="ok"?(ns.trigger("editor:sr:statusUpdate","Code Check has been Completed"),i=s.result.map(function(o){return{success:o.pass,message:o.reason||o.criteria,category:o.criteria,showDropdown:!1,showDiff:!1,solutionOutput:null,studentOutput:null,isHiddenTest:!1,aiTestCase:!0}}),a()):n.aiCacheOnly?a():window.toastr.error(s.message)},error:function(s){window.toastr.error("Something went wrong with the AI, please try again.")}})):a()});ID.exports={Components:xT,run:CD,addTest:AD,getCodeObject:CT,getFunctionContents:ED,displayModal:AT}});var OD=D(($Ae,kD)=>{kD.exports=function(e){var r=String.prototype.split,n=/()??/.exec("")[1]===e,i;return i=function(a,g,o){if(Object.prototype.toString.call(g)!=="[object RegExp]")return r.call(a,g,o);var c=[],l=(g.ignoreCase?"i":"")+(g.multiline?"m":"")+(g.extended?"x":"")+(g.sticky?"y":""),f=0,g=new RegExp(g.source,l+"g"),m,y,A,k;for(a+="",n||(m=new RegExp("^"+g.source+"$(?!\\s)",l)),o=o===e?-1>>>0:o>>>0;(y=g.exec(a))&&(A=y.index+y[0].length,!(A>f&&(c.push(a.slice(f,y.index)),!n&&y.length>1&&y[0].replace(m,function(){for(var I=1;I<arguments.length-2;I++)arguments[I]===e&&(y[I]=e)}),y.length>1&&y.index<a.length&&Array.prototype.push.apply(c,y.slice(1)),k=y[0].length,f=A,c.length>=o)));)g.lastIndex===y.index&&g.lastIndex++;return f===a.length?(k||!g.test(""))&&c.push(""):c.push(a.slice(f)),c.length>o?c.slice(0,o):c},i}()});var Ev=D((UAe,PD)=>{var cZ=[].indexOf;PD.exports=function(t,e){if(cZ)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}});var DD=D((FAe,RD)=>{var kT=Ev();RD.exports=lZ;function lZ(t){var e=t.classList;if(e)return e;var r={add:n,remove:i,contains:a,toggle:s,toString:o,length:0,item:c};return r;function n(g){var m=l();kT(m,g)>-1||(m.push(g),f(m))}function i(g){var m=l(),y=kT(m,g);y!==-1&&(m.splice(y,1),f(m))}function a(g){return kT(l(),g)>-1}function s(g){return a(g)?(i(g),!1):(n(g),!0)}function o(){return t.className}function c(g){var m=l();return m[g]||null}function l(){var g=t.className;return dZ(g.split(" "),fZ)}function f(g){var m=g.length;t.className=g.join(" "),r.length=m;for(var y=0;y<g.length;y++)r[y]=g[y];delete g[m]}}function dZ(t,e){for(var r=[],n=0;n<t.length;n++)e(t[n])&&r.push(t[n]);return r}function fZ(t){return!!t}});var LD=D(()=>{});var FD=D((jAe,UD)=>{var pZ=OD(),hZ=DD(),MD=typeof window>"u"?LD():window,oh=MD.document,gZ=MD.Text;function $D(){var t=[];function e(){var r=[].slice.call(arguments),n=null;function i(a){var s;function o(g){var m=pZ(g,/([\.#]?[^\s#.]+)/);/^\.|#/.test(m[1])&&(n=oh.createElement("div")),ND(m,function(y){var A=y.substring(1,y.length);y&&(n?y[0]==="."?hZ(n).add(A):y[0]==="#"&&n.setAttribute("id",A):n=oh.createElement(y))})}if(a!=null){if(typeof a=="string")n?n.appendChild(s=oh.createTextNode(a)):o(a);else if(typeof a=="number"||typeof a=="boolean"||a instanceof Date||a instanceof RegExp)n.appendChild(s=oh.createTextNode(a.toString()));else if(vZ(a))ND(a,i);else if(OT(a))n.appendChild(s=a);else if(a instanceof gZ)n.appendChild(s=a);else if(typeof a=="object")for(var c in a)if(typeof a[c]=="function")/^on\w+/.test(c)?function(g,m){n.addEventListener?(n.addEventListener(g.substring(2),m[g],!1),t.push(function(){n.removeEventListener(g.substring(2),m[g],!1)})):(n.attachEvent(g,m[g]),t.push(function(){n.detachEvent(g,m[g])}))}(c,a):(n[c]=a[c](),t.push(a[c](function(g){n[c]=g})));else if(c==="style")if(typeof a[c]=="string")n.style.cssText=a[c];else for(var l in a[c])(function(g,m){if(typeof m=="function")n.style.setProperty(g,m()),t.push(m(function(A){n.style.setProperty(g,A)}));else var y=a[c][g].match(/(.*)\W+!important\W*$/);y?n.style.setProperty(g,y[1],"important"):n.style.setProperty(g,a[c][g])})(l,a[c][l]);else if(c==="attrs")for(var f in a[c])n.setAttribute(f,a[c][f]);else c.substr(0,5)==="data-"?n.setAttribute(c,a[c]):n[c]=a[c];else if(typeof a=="function"){var f=a();n.appendChild(s=OT(f)?f:oh.createTextNode(f)),t.push(a(function(m){OT(m)&&s.parentElement?(s.parentElement.replaceChild(m,s),s=m):s.textContent=m}))}}return s}for(;r.length;)i(r.shift());return n}return e.cleanup=function(){for(var r=0;r<t.length;r++)t[r]();t.length=0},e}var mZ=UD.exports=$D();mZ.context=$D;function OT(t){return t&&t.nodeName&&t.nodeType}function ND(t,e){if(t.forEach)return t.forEach(e);for(var r=0;r<t.length;r++)e(t[r],r)}function vZ(t){return Object.prototype.toString.call(t)=="[object Array]"}});var GD=D((xv,HD)=>{"use strict";Object.defineProperty(xv,"__esModule",{value:!0});var yZ=function(e){return typeof e=="string"&&e.length>0},BD=function(e,r){return e[0]===r},jD=function(e){return yZ(e)&&(BD(e,".")||BD(e,"#"))},bZ=function(e){return function(r){return function(n){for(var i=arguments.length,a=Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];return jD(n)?e.apply(void 0,[r+n].concat(a)):typeof n>"u"?e(r):e.apply(void 0,[r,n].concat(a))}}},qD=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","content","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","element","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","image","img","input","ins","isindex","kbd","keygen","label","legend","li","link","listing","main","map","mark","marquee","math","menu","menuitem","meta","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","plaintext","pre","progress","q","rb","rbc","rp","rt","rtc","ruby","s","samp","script","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","xmp"];xv.default=function(t){var e=bZ(t),r={TAG_NAMES:qD,isSelector:jD,createTag:e};return qD.forEach(function(n){r[n]=e(n)}),r};HD.exports=xv.default});var YD=D((HAe,XD)=>{"use strict";var _Z=Zf(),wZ=_i(),TZ=em(),VD=Nr(),SZ=Zl(),zD=".start-ex-button",WD="#directions-modal",KD=".program-demo-canvas",EZ=".demo-run-button",xZ=".demo-stop-button",PT=".dark-screen",CZ=".modal-canvas";function bo(t){t.noInstructions&&$(PT).hide(),this.info={itemType:t.itemType,itemID:t.itemID,isGraphics:t.isGraphics,isBlockly:t.isBlockly},this.setup(),this.demo_graphics,this.demo_solution}bo.prototype.needsPopup=function(){return this.info.itemType==VD.ItemType.EXERCISE||this.info.itemType==VD.ItemType.CHALLENGE};bo.prototype.usingGraphics=function(){return this.info.isGraphics&&this.needsPopup()&&$(KD).length};bo.prototype.setupLetsGoButton=function(){var t=this;$(zD).on("click",function(){$(WD).addClass("fly-out").on("animationend",function(){$(this).removeClass("fly-out").hide(),t.usingGraphics()&&t.demo_graphics.fullReset()}),$(PT).fadeOut()})};bo.prototype.setupDemoRunButton=function(){var t=this;$(EZ).on("click",function(){t.usingGraphics()&&t.demo_graphics.fullReset();var e=t.demo_solution;e=e.replace(/&gt;/g,">"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&amp;/g,"&"),e=e.replace(/&nbsp;/g,""),t.usingGraphics()&&t.demo_graphics.runCode(e)})};bo.prototype.setupDemoStopButton=function(){var t=this;$(xZ).on("click",function(){t.usingGraphics()&&t.demo_graphics.fullReset()})};bo.prototype.setupReShowPopup=function(){var t=this;$("#show-editor-instructions").on("click",function(){t.showInstructions()})};bo.prototype.showInstructions=function(){$(PT).show(),$(WD).show().addClass("fly-in").on("animationend",function(){$(this).removeClass("fly-in").show()})};bo.prototype.modalHidden=function(){return $("#directions-modal").css("display")=="none"};bo.prototype.setup=function(){var t=this;if($(zD).exists()){wZ.send({type:"GET",method:"get_solution_code",app:"editor",data:{itemID:t.info.itemID,gulpUrl:CHS.GULP_URL},success:function(n){if(n.status==="ok"){var i=JSON.parse(n.solutionCodeJson.split("").map(function(a,s){var o=CHS.GULP_URL[s%CHS.GULP_URL.length],c=String.fromCharCode((a.charCodeAt(0)-o.charCodeAt(0))%256);return c}).join(""));t.demo_solution=i}else t.demo_solution=""}}),t.info.isBlockly&&$("div.result-end.result-single").css("display","none"),this.setupLetsGoButton(),this.setupDemoRunButton(),this.setupDemoStopButton(),this.setupReShowPopup(),$(CZ).each(function(){_Z.quickDraw($(this),$(this).attr("data-world"),$(this).attr("data-width"),!0)}),this.usingGraphics()&&(this.demo_graphics=new TZ.CodeHSGraphics({canvas:$(KD)}));var e=window.pageSpecific.itemDescription,r=window.pageSpecific.isQuill;SZ.chooseEditor([{qlTarget:"#quill-description",mdTarget:"#markdown-description",content:e}],r),$(".directions a").attr("target","_blank")}};XD.exports=bo});var $T=D((GAe,sL)=>{"use strict";var li=_i(),AZ=Nr(),Cv=Yl(),fu=Cr(),IZ=ui().updateQueryString,kZ=ui().alert,OZ="button.create-share-link",PZ=".new-domain",Zu="#share-program",JD="#share-tab-active-switch",ec="#share-modal-active-switch",rL="#editable-switch",DT="#share-tab-show-code-switch",tc="#share-modal-show-code-switch",iL="#show-file-tree-switch",LT="#share-tab-display-ide-switch",NT="#share-tab-forkable-switch",QD="#share-modal-display-ide-switch",ZD="#share-modal-forkable-switch",RZ="#share-modal-ide-dropdown",DZ="#share-modal-display-mode-dropdown",MT="#share-modal-share-link",Av="#share-modal-edit-description",nL="#share-link",LZ=5e3,qs="#share-modal",uh="#share-options",eL="#embed-options",ch="#assign-options",RT="#collab-options",NZ=".submit-to-contest-container",Md="#share-tab-submit-to-contest-button",MZ="#share-tab-contest-id-input",js="";function ol(){js=window.pageSpecific.shareBaseURL,this.setup()}ol.prototype.createShareDiv=function(t,e,r,n,i,a){var s=$(nL);s.text(i),s.attr("href",i),$(DT).attr("checked",e),$(iL).attr("checked",!0),$(rL).attr("checked",!0),$(LT).attr("checked",r),$(NT).attr("checked",n),$(Md).data("share-id",t);var o="https://twitter.com/intent/tweet?text=Checkout%20this%20cool%20program%20I%20made%20on%20CodeHS%21&url=https%3A%2F%2Fcodehs.com%2Fshare%2F"+t+"&hashtags=ReadWriteCode&via=codehs",c="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fcodehs.com%2Fshare%2F"+t;$("#fb-share-link").attr("href",c),$("#twitter-share-link").attr("href",o),$("#share-tab-active-switch").prop("checked",a),$("#share-info-container").show(),$("#create-share-link-btn").hide()};ol.prototype.domainDiv=function(t,e){$(".create-domain").hasClass("gone")?$("#medomain-link").slideToggle("fast",function(){$(this).attr("href",e).text(t).slideToggle("fast")}):($("#medomain-link").attr("href",e).text(t),$(".create-domain").addClass("gone"),$(".show-domain").removeClass("gone"))};ol.prototype.setupDownloadAppFiles=function(){$("#download-app-files-button").on("click",function(){var t=window.pageSpecific.userProgramID,e=window.location.origin+"/editor/download_app_files/"+t;window.location=e})};function aL(t,e){$.ajax({url:"/core/ajax/upload_image",type:"POST",data:t,processData:!1,dataType:"JSON",contentType:!1}).then(function(r){var n=AZ.Uploads.UPLOADS_PROXY_BASE_URL+r.url;e&&e(n)})}function $Z(t,e){for(var r=atob(t.split(",")[1]),n=[],i=0;i<r.length;i++)n.push(r.charCodeAt(i));var a=new Blob([new Uint8Array(n)],{type:e});return a}ol.prototype.uploadFile=function(){$("#file-name").html($(".img-upload")[0].files[0].name);var t=new FormData($("#upload-icon-form")[0]);aL(t,function(e){$("#icon-thumbnail").attr("src",e),$(".thumbnail-icon-container").removeClass("hidden"),$(".upload-icon-container").hide()})};function tL(){var t=$(".__abacus_runButton");t&&t.trigger("click"),setTimeout(function(){try{var e=document.querySelector("iframe#browser-runner").contentWindow;e.postMessage({type:"screenshot_data",data:{}},"*")}catch{return}},LZ)}ol.prototype.setup=function(){var t=this;$(OZ).on("click",function(){li.send({method:"get_or_create_share_info",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID},success:function(I){I.status=="ok"&&(js=I.shareURL,t.createShareDiv(I.shareIdentifier,I.canShowCode,I.displayIDE,I.forkable,I.shareURL,I.isActive),window.pageSpecific.isAbacus&&window.pageSpecific.shouldScreenshotOnShare&&!I.shareImageURL&&tL())}})}),$(qs).find("#share-modal-create-share-link-btn").on("click",function(){var I=$(this);I.attr("disabled",!0),I.html("<i class='icon-spinner icon-spin'></i>"),li.send({method:"get_or_create_share_info",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID},success:function(F){F.status=="ok"?($("#share-modal-contents").removeClass("gone"),$("#share-modal-create-share-link-btn").addClass("gone"),document.querySelector(MT).value=F.shareURL,js=F.shareURL,t.createShareDiv(F.shareIdentifier,F.canShowCode,F.displayIDE,F.forkable,F.shareURL,F.isActive),window.pageSpecific.isAbacus&&window.pageSpecific.shouldScreenshotOnShare&&!F.shareImageURL&&tL()):(Cv.error("There was an error sharing your program. Try refreshing the page, and contact support@codehs.com if you continue to experience errors."),I.attr("disabled",!1),I.html("Create share link"))},error:function(F){Cv.error("There was an error sharing your program. Try refreshing the page, and contact support@codehs.com if you continue to experience errors."),I.attr("disabled",!1),I.html("Create share link")}})}),$(qs).find("#share-public-copy").on("click",function(I){document.querySelector("#share-modal-public-link").select(),document.execCommand("copy"),window.toastr.success("Copied the URL")}),$(qs).find("#share-code-copy").on("click",function(I){document.querySelector("#share-modal-copy-link").select(),document.execCommand("copy"),window.toastr.success("Copied the URL")}),$(qs).find("#copy-collab-link-btn").on("click",function(I){document.querySelector("#share-modal-collab-link").select(),document.execCommand("copy"),window.toastr.success("Copied the URL")}),$(Av).on("keyup",function(){var I=$(Av).val();$("#preview-description-text").empty().attr("data-markdown",I),fu.trigger("CHS.Utils.markdown:setup")}),$(Av).on("blur",f),g();var e="#embed-opt-display-type",r="#embed-opt-width",n="#embed-opt-height",i="#embed-opt-read-only",a="#embed-opt-show-tree";function s(){$(e).on("change",o),$(r).on("input",function(I){I.target.value=I.target.value.replace(/\D/g,""),o()}),$(n).on("input",function(I){I.target.value=I.target.value.replace(/\D/g,""),o()}),$(i).on("change",o),$(a).on("change",o)}function o(){var I=$(e).val(),F="850",J="500";$(r).val()&&(F=$(r).val()),$(n).val()&&(J=$(n).val());var pe=$(i).prop("checked"),L=$(a).prop("checked"),H='width="'+F+'" height="'+J+'"',j="/?display_mode="+I;pe&&(j+="&read_only=True"),L||(j+="&show_file_tree=False");var X="<iframe "+H+' src="'+js+"/embed"+j+'" frameborder="0" allowfullscreen class="video-iframe"></iframe>';$(MT).val(X)}function c(){if(window.pageSpecific.collaborateBlockedByDroplet){kZ({header:"Unable to collaborate",rawHtml:`<p>It looks like you're trying to collaborate on a Block coding program.
To collaborate, you need to switch this program to use text, not blocks.</p>
<a target="_blank" href="/toggling-block-coding">Learn more about blocks settings</a>`,cancelButton:!0,cancel_callback:function(){li.send({method:"toggle_shared_program_blocks_off",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID},success:function(F){F.status==="ok"?window.location.reload():window.toastr.error(F.msg)}})},cancelButtonText:"Switch to Text and Refresh",cancelButtonClass:"btn-main-blue",buttonClass:"btn-main-green",button:"Close"});return}(!window.Ed.firepad||!window.Ed.firepad.initialized)&&window.Ed.setupFirepad(),$(ec).prop("checked",!0),$(tc).prop("checked",!0),li.send({method:"set_share_active",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,activeStatus:!0}}),li.send({method:"set_share_code",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,showCodeStatus:!0}}),li.send({method:"set_share_ide",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,IDE:"original"}});var I="?collaborate="+window.Ed.firepad.firepadRef.key;$("#share-modal-collab-link").val(js+I),IZ({collaborate:window.Ed.firepad.firepadRef.key})}s(),k(ec),k(tc),window.pageSpecific.unauthenticated&&($(".sharing-option-checkbox").prop("disabled",!0),$("#share-modal-share-link").prop("disabled",!1),$("#share-modal-collab-link").addClass("hidden"),$("#copy-collab-link-btn").addClass("hidden"));function l(I){var F=I.value;F&&(I.classList.add("active"),$(I).siblings().each(function(J,pe){pe.classList.remove("active")}),$("#share-modal-contents").removeClass("hidden"),$("#logged-out-edit-warning").removeClass("hidden"),$("#logged-out-banner-message").text("change the share settings for this program."),$(uh).hasClass("hidden")&&($(uh).removeClass("hidden"),$(eL).addClass("hidden"),$(ch).addClass("hidden"),$(RT).addClass("hidden")),F==="Code"?($(ch).addClass("hidden"),k(ec),k(tc)):F==="Embed"?($(eL).removeClass("hidden"),$(uh).addClass("hidden"),$(ch).addClass("hidden"),o()):F==="Collaborate"?($(RT).removeClass("hidden"),$(uh).addClass("hidden"),$(ch).addClass("hidden"),$("#logged-out-edit-warning").addClass("hidden"),$("#logged-out-banner-message").text("use the collaborate feature."),!window.pageSpecific.unauthenticated&&!window.myAbacus&&(window.pageSpecific.collaborateBlockedByDroplet&&($("#share-tab-button").addClass("active"),$("#collab-tab-button").removeClass("active"),$(RT).addClass("hidden"),$(uh).removeClass("hidden")),c())):($(ch).removeClass("hidden"),$("#share-modal-contents").addClass("hidden")))}$("#share-type-switch").on("click",function(I){var F=I.target;l(F)});function f(){var I=$(Av).val();li.send({method:"save_item",app:"library",data:{itemId:window.pageSpecific.itemID,description:I},success:function(F){if(F.status=="ok"){var J=$(".description-label").find(".chs-icon");J.removeClass("hidden"),setTimeout(function(){J.addClass("hidden")},1e3)}else window.toastr.error(F.msg)}})}function g(){var I=$(".course-select option:selected");m(I),$(".course-select").on("change",function(){I=$(".course-select option:selected"),m(I)}),$("#share-modal-assign-btn").on("click",function(){y($(".course-select option:selected").val())})}function m(I){if(I.hasClass("assigned")){fu.trigger("utils:disableButton",$("#share-modal-assign-btn")),$("#share-modal-assign-btn").html("Assigned");var F=I.val(),J=I.data("assignment-id");A(F,J)}else fu.trigger("utils:enableButton",$("#share-modal-assign-btn")),$("#links-section").addClass("hidden"),$("#share-modal-assign-btn").html("Assign")}function y(I){fu.trigger("utils:disableButton",$("#share-modal-assign-btn"));var F={};F.assignmentType="activity",F.itemId=window.pageSpecific.itemID,F.itemType=$(".item-type-select option:selected").data("type"),F.teacherCourseId=I,F.addToLatestLesson=!0,li.send({method:"add_new_assignment",app:"lms",data:F,success:function(J){J.status=="ok"?($("#share-modal-assign-btn").html('<span class="chs-icon chs-icon-check"><span>'),$(".course-select option:selected").addClass("assigned"),$(".course-select option:selected").data("assignment-id",J.assignment.id),A(I,J.assignment.id)):window.toastr.error(J.msg)}})}function A(I,F){var J="/lms/assignments/"+I+"?activity="+F;$(".view-link").attr("href",J),$("#links-section").removeClass("hidden")}function k(I){I===ec?$(ec).is(":checked")?($("#share-public-container").removeClass("hidden"),$("#share-modal-public-link").val(js+"/run"),$("#share-modal-public-link").attr("href",js+"/run")):$("#share-public-container").addClass("hidden"):I===tc&&($(tc).is(":checked")?($("#share-code-container").removeClass("hidden"),$("#share-modal-copy-link").val(js),$("#share-modal-copy-link").attr("href",js)):$("#share-code-container").addClass("hidden"))}$(Md).on("click",function(){fu.trigger("utils:disableButton",Md),li.send({method:"submit",app:"contest",data:{shared_program_identifier:$(Md).data("share-id"),contest_identifier:$(MZ).val()},success:function(I){fu.trigger("utils:enableButton",Md),I.status=="ok"?$(NZ).html('<span>Successfully submitted to <a target="_blank" href="'+I.contest_url+'">'+I.contest_name+"</a></span>"):window.toastr.error(I.msg)},error:function(){fu.trigger("utils:enableButton",Md),window.toastr.error("There was an error submitting to the contest. Please try again.")}})}),$(PZ).on("click",function(){li.send({method:"create_or_update_codehsme_domain",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID},success:function(I){I.status=="ok"?t.domainDiv(I.fullDomain,I.fullURL):Cv.error("There was an error creating your domain, please try again.")},error:function(){Cv.error("There was an error creating your domain, please try again.")}})}),$(Zu).on("change",JD,function(){var I=$(this).is(":checked");li.send({method:"set_share_active",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,activeStatus:I}}),$(ec).prop("checked",I)}),$(Zu).on("change",DT,function(){var I=$(this).is(":checked");li.send({method:"set_share_code",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,showCodeStatus:I}}),$(tc).prop("checked",I)}),$(Zu).on("change","#shared-width",function(){var I=$(this).val();li.send({method:"set_share_display_width",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,displayWidth:I}})}),$(Zu).on("change","#shared-height",function(){var I=$(this).val();li.send({method:"set_share_display_height",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,displayHeight:I}})}),$(Zu).on("change",iL,function(){var I=$(this).is(":checked");li.send({method:"set_share_show_file_tree",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,showFileTreeStatus:I}})}),$(Zu).on("change",rL,function(){var I=$(this).is(":checked");li.send({method:"set_share_editable",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,editableStatus:I}})}),$(Zu).on("change",LT,function(){var I=$(this).is(":checked");li.send({method:"set_share_display_ide",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,displayIDEStatus:I}}),$(QD).prop("checked",I)}),$(Zu).on("change",NT,function(){var I=$(this).is(":checked");li.send({method:"set_share_forkable",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,forkableStatus:I}}),$(ZD).prop("checked",I)}),$(qs).on("change",ec,function(){var I=$(this).is(":checked");li.send({method:"set_share_active",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,activeStatus:I}}),$(JD).prop("checked",I),k(ec)}),$(qs).on("change",QD,function(){var I=$(this).is(":checked");li.send({method:"set_share_display_ide",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,displayIDEStatus:I}}),$(LT).prop("checked",I)}),$(qs).on("change",tc,function(){var I=$(this).is(":checked");li.send({method:"set_share_code",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,showCodeStatus:I}}),$(DT).prop("checked",I),k(tc)}),$(qs).on("change",ZD,function(){var I=$(this).is(":checked");li.send({method:"set_share_forkable",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,forkableStatus:I}}),$(NT).prop("checked",I)}),$(qs).on("change",RZ,function(){var I=$(this).val();li.send({method:"set_share_ide",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,sharedProgramID:window.pageSpecific.sharedProgramID,IDE:I}})}),$(qs).on("change",DZ,function(){var I=$(this).val();li.send({method:"set_share_abacus_display_mode",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,displayMode:I}})}),$(qs).on("click","#switch-to-abacus",function(I){I.preventDefault(),li.send({method:"set_share_ide",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,IDE:"abacus"},success:function(F){if(F.status==="ok"){$("#collab-editor-warning").html('Switching to the newer editor. The page will reload in <b id="reload-countdown">10</b> seconds.');var J=10,pe=setInterval(function(){$("#reload-countdown").text(J),--J<0&&(clearInterval(pe),location.reload())},1e3)}}})}),$("#upload-icon-btn").on("click",function(){$(".img-upload").trigger("click")}),$("#icon-thumbnail").on("click",function(){$(".img-upload").trigger("click")}),$(".img-upload").on("change",function(){t.uploadFile()}),t.setupDownloadAppFiles(),window.addEventListener("message",function(I){if(!(I.origin!=="https://codehs.com"&&I.origin!=="https://static1.codehs.com"&&I.origin!=="http://localhost:8000")){var F=I.data;if(F.type&&F.type=="screenshot_data"){var J=F.data,pe=$Z(J,"image/png"),L=new FormData;L.append("file",pe),aL(L,function(H){li.send({method:"set_share_image",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,imageURL:H}})})}}})};fu.on("shareTab:setup",function(){js=window.pageSpecific.shareBaseURL,new ol});fu.on("editor:sandboxItemTitleChange",function(t){var e=t[0],r=t[1];js=e;var n=$(nL),i=$(MT);n.text(e),n.attr("href",e),i.text(e),i.attr("href",e),history.pushState({},r,e)});sL.exports=ol});var FT=D((VAe,uL)=>{"use strict";var $d=_i(),ul=Yl(),Iv=Tz(),UZ=ui(),FZ=HA(),BZ=jA(),ll=Cr(),ra="#finalize-btn, #needs-work-btn",ia="#submit-grade-full-credit",na="#submit-grade-give-zero",cl="#ai-grade",kv="#grading-tab-ai-hint",qZ="#assignment-submission-select",jZ="#snapshot-submission-",HZ="#late-submission-message-",GZ="#time-spent-submission-message-",VZ=".late-message",zZ=".time-spent-message",lh="#grade-score-input",pu="#grade-message-input",Pv="#grade-teacher-notes-input",WZ="#current-grade-status",UT="#assignment-grades-list",KZ=".feedback-content",Ov="#add-custom-response-modal",oL="#custom-responses",XZ="#canned-responses",YZ=".add-response";function Hs(t){this.editor=t,this.setup()}Hs.prototype.setup=function(){var t=this;if($("#lms-grading-tab").length!==0){var e="grade_mode"in $.url().param();t.converter=window.Markdown.getSanitizingConverter(),window.Markdown.Extra.init(t.converter,{highlighter:"prettify"}),$(qZ).on("change",function(r){var n=$(this).val();QZ(t,n)}),$(ra).on("click",function(r){r.preventDefault(),$(ra).attr("disabled","disabled"),$(ia).attr("disabled","disabled"),$(na).attr("disabled","disabled"),$("#rubrics-table").addClass("hidden");var n=$(lh).val(),i=$(pu).val(),a=$(this).data("next-step"),s=$(Pv).val(),o=t.editor.studentAssignmentID,c={student_assignment_id:o,score:n,message:i,teacher_notes:s,student_next_step:a,ai_request_id:$(cl).data("request-id")};e&&(c.grade_mode=!0,c.section=$.url().param().section),$d.send({app:"lms",method:"grade_assignment",data:c,success:function(l){if(l.status==="ok")if(t.reload({student_assignment_id:o}),l.next_url)window.useTurbolinks?window.Turbolinks.visit(l.next_url):window.location.href=l.next_url;else{$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled");var f,g;a==window.CHS.C.GradingStatus.PASSED?(f="alert finalized",g='<span class="chs-icon chs-icon-check"></span><span>Status: Finalized</span>'):a==window.CHS.C.GradingStatus.NEEDS_WORK&&(f="alert bg-pink",g='<span class="chs-icon chs-icon-cancel"></span><span>Status: Reviewed</span>'),$("#status-message").removeClass(),$("#status-message").addClass(f),$("#status-message").html(g)}else ul.error(l.message),$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled")},error:function(l){ul.error("There was an error grading this assignment! Please try again"),$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled")}})}),$(ia).on("click",function(r){r.preventDefault(),$(ia).attr("disabled","disabled"),$(na).attr("disabled","disabled"),$(ra).attr("disabled","disabled"),$("#rubrics-table").addClass("hidden");var n=$(Pv).val(),i=t.editor.studentAssignmentID,a=$(pu).val(),s={student_assignment_id:i,score:window.pageSpecific.assignmentMaxPoints,message:a,teacher_notes:n,student_next_step:window.CHS.C.GradingStatus.PASSED,ai_request_id:$(cl).data("request-id")};e&&(s.grade_mode=!0,s.section=$.url().param().section),$d.send({app:"lms",method:"grade_assignment",data:s,success:function(o){o.status==="ok"?(t.reload({student_assignment_id:i}),o.next_url?window.useTurbolinks?window.Turbolinks.visit(o.next_url):window.location.href=o.next_url:($(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled"),$("#status-message").removeClass(),$("#status-message").addClass("alert finalized"),$("#status-message").html('<span class="chs-icon chs-icon-check"></span><span>Status: Finalized</span>'))):(ul.error(o.message),$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled"))},error:function(o){ul.error("There was an error grading this assignment! Please try again"),$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled")}})}),$(na).on("click",function(r){r.preventDefault(),$(ia).attr("disabled","disabled"),$(na).attr("disabled","disabled"),$(ra).attr("disabled","disabled"),$("#rubrics-table").addClass("hidden");var n=$(Pv).val(),i=t.editor.studentAssignmentID,a=$(pu).val(),s={student_assignment_id:i,score:0,message:a,teacher_notes:n,student_next_step:window.CHS.C.GradingStatus.PASSED,ai_request_id:$(cl).data("request-id")};e&&(s.grade_mode=!0,s.section=$.url().param().section),$d.send({app:"lms",method:"grade_assignment",data:s,success:function(o){o.status==="ok"?(t.reload({student_assignment_id:i}),o.next_url?window.useTurbolinks?window.Turbolinks.visit(o.next_url):window.location.href=o.next_url:($(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled"),$("#status-message").removeClass(),$("#status-message").addClass("alert finalized"),$("#status-message").html('<span class="chs-icon chs-icon-check"></span><span>Status: Finalized</span>'))):(ul.error(o.message),$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled"))},error:function(o){ul.error("There was an error grading this assignment! Please try again"),$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled")}})}),$(kv).on("click",function(r){return r.preventDefault(),$(".tooltip").remove(),ll.trigger("utils:disableButton",$(kv)),Iv.hideAIFeedback(),$d.send({app:"ai",method:"get_ai_hint",data:{student_assignment_id:t.editor.studentAssignmentID,location:"Grading Tab"},success:function(n){ll.trigger("utils:enableButton",$(kv)),n.status==="ok"?($(pu).val(n.hint),n.ai_request_id&&Iv.setupAIFeedbackButtons(n.ai_request_id,"AI Hints")):window.toastr.error(n.message)},error:function(){window.toastr.error("There was an error generating your hint."),ll.trigger("utils:enableButton",$(kv))}})}),$(cl).on("click",function(r){ll.trigger("ai:gradingOnboardModal:setup"),r.preventDefault();var n={student_assignment_id:t.editor.studentAssignmentID,strictness:1,location:"Grading Tab",version:$(this).data("version")};ll.trigger("utils:disableButton",cl),$(".tooltip").remove(),$(ia).attr("disabled","disabled"),$(na).attr("disabled","disabled"),$(ra).attr("disabled","disabled"),$d.send({app:"lms",method:"ai_grade_assignment",data:n,success:function(i){ll.trigger("utils:enableButton",cl),$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled"),$(cl).data("request-id",i.ai_request_id),Iv.showAIGradeScore(i,window.pageSpecific.assignmentMaxPoints,$(lh)),$(pu).val(i.message),Iv.setupAIFeedbackButtons(i.ai_request_id,"AI Grading"),i.rubric_table&&($("#rubrics-table").html(i.rubric_table),$("#rubrics-table").removeClass("hidden"))},error:function(){$(ra).removeAttr("disabled"),$(ia).removeAttr("disabled"),$(na).removeAttr("disabled"),ul.error("There was an error grading this assignment.")}})}),this.setupCannedResponses(),this.format(),t.reload({student_assignment_id:t.editor.studentAssignmentID}),$(window).on("beforeunload",t.cleanup),$(document).one("turbolinks:before-render",function(){t.cleanup(),$(window).off("beforeunload",t.cleanup)})}};Hs.prototype.reload=function(t){var e=this;$(lh).val(0),$(pu).val(""),$(Pv).val(""),$d.send({app:"lms",method:"get_grading_history",data:t,type:"GET",success:function(r){if(r.status==="ok"){var n=r.data;if(n.length>0){$(UT).html("");for(var i=0;i<n.length;i++)$(UT).append(ZZ(n[i]));e.format(),ll.trigger("CHS.Utils.markdown:setup")}else $(UT).html("This assignment has not yet been graded");var a=r.current_status,s=$(WZ);s.removeClass().addClass(a.next_step_css),s.find(".grade-next-step").text(a.student_next_step),s.find(".grade-score").text(a.score),s.find(".grade-out-of").text(a.out_of);try{var o=parseFloat(a.score);isNaN(o)||$(lh).val(o)}catch{$(lh).val(0)}a.timestamp?(s.find(".grade-timestamp").text(a.timestamp).show(),s.find(".grade-timestamp").attr("data-original-title",a.longtime)):s.find(".grade-timestamp").hide()}}})};Hs.prototype.unhtmlEntityCode=function(t){return t=t.replace(/&amp;/g,"&"),t};Hs.prototype.format=function(){var t=this;$(KZ).each(function(){var e=$(this).html();e=e.replace(/&gt;/g,">");var r=t.converter.makeHtml(e);r=t.unhtmlEntityCode(r),r=FZ.formatTerms(r),r=BZ.linkItems(r),$(this).html(r),$(this).find("pre").each(function(){$(this).addClass("prettyprint")}),$('[rel="tooltip"]').tooltip()}),$("#wmd-input-second").length>0&&t.cannedResponseEditor.run(),window.prettyPrint()};Hs.prototype.getResponse=function(t){var e=$(".canned-responses").find("[data-resp="+t+"]").html();return e&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),e};Hs.prototype.getCannedResponseID=function(t){var e=$(".canned-responses").find("[data-resp="+t+"]");return e.data("id")};Hs.prototype.cannedResponse=function(t){var e=this,r=e.getResponse(t);if(r){var n=e.getCannedResponseID(t),i=$(pu),a=i.val(),s=i.prop("selectionEnd"),o="";if(a.length>0){s>0&&!/\s/.test(a[s-1])&&(r=" "+r);var c=a.substring(0,s),l=a.substring(s);l.length>0&&!/\s/.test(l[0])&&(l=" "+l),o=c+r+l}else o=r;i.val(o);var f=$(pu).data("cannedResponseIDs")||"";f!==""&&(f+=","),f+=n,i.data("cannedResponseIDs",f),$(pu).trigger("focus"),i.prop("selectionStart",s+r.length),i.prop("selectionEnd",s+r.length)}};Hs.prototype.setupCannedResponses=function(){var t=this;t.cannedResponseEditor=new window.Markdown.Editor(t.converter,"-second"),t.cannedResponseEditor.hooks.chain("onPreviewRefresh",function(){$("#wmd-preview-second").find("pre").each(function(){$(this).addClass("prettyprint")}),window.prettyPrint()}),$("#add-response-btn").on("click",function(r){var n=$(this);n.attr("disabled","disabled");var i=$("#wmd-input-second").val();if(i.trim())UZ.Ajax.send({app:"help",method:"save_canned_response",data:{msg:$("#wmd-input-second").val(),msg_id:0,item_id:t.editor.getItemID(),is_global:$("#add-custom-canned-response-is-global").is(":checked")},success:function(a){if(a.status=="ok")if(a.resp)t.addResponseToList(a.resp),$("#wmd-input-second").val(""),$("#wmd-preview-second").html(""),$(Ov).modal("hide");else{var s="You already have a response saved with that message";$(Ov).find(".response-message").text(s)}else $(Ov).find(".response-message").text("Sorry your response was not saved, please try again")}}),n.removeAttr("disabled");else{$(Ov).find(".response-message").text("Please enter a response to save"),n.removeAttr("disabled");return}});for(var e=1;e<=9;e++)(function(r){var n="ctrl+"+r;$(document).bind("keypress",n,function(){t.cannedResponse(r)})})(e);$(".canned-responses").on("click",".canned-response",function(){var r=$(this),n=r.find(".resp").data("resp");t.cannedResponse(n)})};Hs.prototype.addResponseToList=function(t){function e(a){for(var s="",o;a>0;)o=(a-1)%26,a=Math.floor((a-1)/26),s=String.fromCharCode(97+o)+s;return s}var r=$(oL+" .canned-response").length,n=e(r+1),i=$('<div class="canned-response">');i.append($('<span class="count">').text("("+n+") ")),i.append($('<span class="resp" data-resp="'+n+'">').text(t)),$(XZ).removeClass("no-custom-responses"),$(oL+" "+YZ).before(i)};Hs.prototype.cleanup=function(){$(document).unbind("keypress")};function JZ(t){var e=$(jZ+t),r=e.html();r=r.replace(/&lt;/g,"<"),r=r.replace(/&gt;/g,">"),r=r.replace(/&amp;/g,"&");var n=JSON.parse(r);return n}function QZ(t,e){$(VZ).addClass("hidden"),$(HZ+e).removeClass("hidden"),$(zZ).addClass("hidden"),$(GZ+e).removeClass("hidden");for(var r=JZ(e),n=Object.keys(r),i=0;i<n.length;i++)t.editor.code[n[i]]=r[n[i]],t.editor.currentCode[n[i]]=r[n[i]];window.pageSpecific.isAbacus?t.editor.setCode(r):t.editor.setCode(r[t.editor.activeFile])}var ZZ=function(t){var e='<div class="wrap"><label style="display: inline-block">Score: </label><span> '+t.score+" out of "+t.out_of+'</span><br><label style="display: inline-block">Next Step: </label><span> '+t.student_next_step+'</span><br><label style="display: inline-block">Graded By: </label><span> '+t.graded_by+'</span><br><label style="display: inline-block">Timestamp: </label><span rel="tooltip" title="'+t.longtime+'" style="text-decoration: underline;">'+t.timestamp+"</span>",r=window.pageSpecific.viewerID===window.pageSpecific.codeUserID;return r||(e+='<br><label style="display: inline-block">Teacher Notes (not visible to student): </label><span data-markdown=" '+t.teacher_notes+'"></span>'),e+='<br><label style="display: inline-block">Feedback: </label><div class="feedback-content"> '+t.message.replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</div>",e+="</div>",e};uL.exports=Hs});var HT=D((zAe,pL)=>{"use strict";var Ud=_i(),eee=jA(),tee=HA(),qT=Cr(),BT=ui(),cL=Nr(),hu=".send-message",ic=".help_question",ree="100px",iee="#help-tab .message .comment-content",dL=".open_help",rc=".help-thread",Dv,jT="#rate-msg",nee=jT+" .msg-rating",fL=".message:last-of-type .msg-rating.student",aee=".flag-msg",see=".hide-msg",oee=".save-canned",uee=".add-response",lL="#custom-responses",cee="#canned-responses",Rv="#add-custom-response-modal";function vn(t){this.editor=t,this.setup()}vn.prototype.messageBoxEmpty=function(){var t=$(ic).val();return $.trim(t).length===0};vn.prototype.sendMessage=function(t,e){var r=this,n=r.editor.getInfo();return n.sectionId=window.pageSpecific.sectionID,Ud.send({app:"help",method:"help_message",data:{info:n,content:t,cannedResponseIDs:e},success:function(i){$(ic).val(""),r.reload({checkHelpMode:!0})}})};vn.prototype.sendMessageAndReview=function(t,e,r){var n=this,i=n.sendMessage(t,e);return i.done(function(a){var s={info:n.editor.getInfo(),reviewGrade:r,messageId:a.messageId};return n.codeReview(s)})};vn.prototype.codeReview=function(t){var e=this;return Ud.send({app:"help",method:"code_review",data:t,success:function(r){e.reload({checkHelpMode:!0}),"grade_mode"in $.url().param()&&(window.location.href=e.gradeModeNext);var n=t.reviewGrade;if(n){var i,a;n==cL.GradingStatus.PASSED?(i="alert bg-green",a='<span class="chs-icon chs-icon-check"></span><span>Status: Passed!</span>'):n==cL.GradingStatus.NEEDS_WORK&&(i="alert bg-pink",a='<span class="chs-icon chs-icon-cancel"></span><span>Status: Needs Work</span>'),$("#status-message").removeClass(),$("#status-message").addClass(i),$("#status-message").html(a)}}})};vn.prototype.unhtmlEntityCode=function(t){return t=t.replace(/&amp;/g,"&"),t};vn.prototype.filterProfanity=function(t){for(var e=CHS.Constants.FilteredWords.BADWORDS,r=CHS.Constants.FilteredWords.BADWORDS_NOT_SUBSET,n=CHS.Constants.FilteredWords.EXCLUDED_WORDS,i=" ==== ",a,s,o="(?<!",c=0;c<n.length;c++)o+=n[c],c<n.length-1&&(o+="|");for(o+=")",c=0;c<e.length;c++)s="\\b\\w*"+e[c]+"\\w*\\b",a=new RegExp(s+o,"gi"),t=t.replace(a,i);for(c=0;c<r.length;c++)s="\\b"+r[c]+"\\b",a=new RegExp(s+o,"gi"),t=t.replace(a,i);return t};vn.prototype.reload=function(t){t=t||{};var e=t.checkHelpMode||!1,r=t.clearUnread||!1,n=this,i=this.editor.getInfo();i.clearUnread=r,Ud.send({method:"help_thread",app:"help",data:i,dataType:"HTML",type:"GET",success:function(a){var s=$(rc).html(),o=s.split('<div class="message').length,c=a.split('<div class="message').length;if(o!=c){$(rc).html(a),n.format();var l=c-1;$(Dv).html("Help ("+l+")")}(n.reloadCount>0||e)&&qT.trigger("utils:checkHelpMode"),n.reloadCount++,qT.trigger("Utils.Ratings:setup")}}),$(ic).css("height",ree)};vn.prototype.setupMsgMenu=function(){var t=this;$(rc).on("click",aee,function(e){e.preventDefault();var r=$(this),n=r.parents(".msg-dropdown"),i=n.data("id");Ud.send({method:"flag_message",app:"help",data:{msg_id:i},success:function(a){a.status=="ok"&&r.addClass("has-flag")}})}),$(rc).on("click",see,function(e){e.preventDefault();var r=$(this).parents(".msg-dropdown"),n=r.data("id");Ud.send({method:"hide_message",app:"help",data:{msg_id:n},success:function(i){i.status=="ok"&&t.reload()}})}),$(rc).on("click",oee,function(e){e.preventDefault();var r=$(this),n=r.parents(".msg-dropdown"),i=n.data("id"),a=$(rc).data("itemId");Ud.send({method:"save_canned_response",app:"help",data:{msg_id:i,item_id:a},success:function(s){s.status=="ok"&&(r.addClass("is-saved"),s.resp&&t.addResponseToList(s.resp))}})})};vn.prototype.addResponseToList=function(t){function e(a){for(var s="",o;a>0;)o=(a-1)%26,a=Math.floor((a-1)/26),s=String.fromCharCode(97+o)+s;return s}var r=$(lL+" .canned-response").length,n=e(r+1),i=$('<div class="canned-response">');i.append($('<span class="count">').text("("+n+") ")),i.append($('<span class="resp" data-resp="'+n+'">').text(t)),$(cee).removeClass("no-custom-responses"),$(lL+" "+uee).before(i)};vn.prototype.format=function(){var t=this;$(iee).each(function(){var e=$(this).html();e=t.filterProfanity(e),e=e.replace(/&gt;/g,">");var r=t.converter.makeHtml(e);r=t.unhtmlEntityCode(r),r=tee.formatTerms(r),r=eee.linkItems(r),$(this).html(r),$(this).find("pre").each(function(){$(this).addClass("prettyprint")}),$('[rel="tooltip"]').tooltip()}),$(ic).autogrow(),t.commentEditor.run(),$("#wmd-input-second").length>0&&t.cannedResponseEditor.run(),$("#wmd-preview").html(""),window.prettyPrint()};vn.prototype.hideRating=function(t){var e=t.children("input")[0].value;e&&($(jT).fadeOut("slow"),$(hu).removeAttr("disabled"),$("#wmd-input").removeClass("needs-rating"),$(fL).children("input")[0].value=e)};vn.prototype.setSendButtonText=function(){var t=this,e=$(hu),r=$("input[name=review-options]:checked").data("value"),n=t.messageBoxEmpty();r?n?e.text("Send Review Grade"):e.text("Send Grade with Message"):e.text("Send")};vn.prototype.setup=function(){var t=this;Dv=window.pageSpecific.isAbacus?'.__abacus_tab:contains("Help")':'a[href="#help-tab"]',$("#help-tab").length!==0&&(t.converter=window.Markdown.getSanitizingConverter(),window.Markdown.Extra.init(t.converter,{highlighter:"prettify"}),$(jT).length>0&&$(hu).attr("disabled","disabled"),$(nee).on("click",function(){t.hideRating($(this))}),$(rc).on("click",fL,function(){t.hideRating($(this))}),$("#item-code-review").length>0&&($(ic).on("input paste focus blur",function(){t.setSendButtonText()}),$("input[name=review-options]").on("change",function(){t.setSendButtonText()})),$(hu).on("click",function(e){e.preventDefault(),$(hu).attr("disabled","disabled");var r=$("input[name=review-options]:checked");if($("#item-code-review").length>0&&r.length===0){BT.alert({header:"Select a Grade",message:'Please select a grade or select "None" before sending a message.',close_callback:function(){$(hu).removeAttr("disabled")}});return}var n=$(ic).data("cannedResponseIDs")||"",i=$(ic).val(),a=r.data("value"),s;if(!$("#item-code-review").length||!a){if(t.messageBoxEmpty()){BT.alert({header:"Write a Message",message:"You cannot send a blank message.",close_callback:function(){$(hu).removeAttr("disabled")}});return}s=t.sendMessage(i,n)}else if(t.messageBoxEmpty()){var o={info:t.editor.getInfo(),reviewGrade:a};s=t.codeReview(o)}else s=t.sendMessageAndReview(i,n,a);s.always(function(){$(hu).removeAttr("disabled")})}),t.setupMsgMenu(),$("#add-response-btn").on("click",function(e){var r=$(this);r.attr("disabled","disabled");var n=$("#wmd-input-second").val();if(n.trim())BT.Ajax.send({app:"help",method:"save_canned_response",data:{msg:$("#wmd-input-second").val(),msg_id:0,item_id:$(rc).data("itemId")},success:function(i){if(i.status=="ok")if(i.resp)t.addResponseToList(i.resp),$("#wmd-input-second").val(""),$("#wmd-preview-second").html(""),$(Rv).modal("hide");else{var a="You already have a response saved with that message";$(Rv).find(".response-message").text(a)}else $(Rv).find(".response-message").text("Sorry your response was not saved, please try again")}}),r.removeAttr("disabled");else{$(Rv).find(".response-message").text("Please enter a response to save"),r.removeAttr("disabled");return}}),$(document).on("click",dL,function(e){e.preventDefault(),t.reload(),qT.trigger("utils:switchToTab","#help-tab",".right-col-tabs","editor-tab-content"),$("#wmd-input").trigger("focus"),$(Dv).removeClass("new-messages")}),$(Dv).on("click",function(){t.editor.stop(),$(this).removeClass("new-messages"),t.reload({clearUnread:!0})}),t.commentEditor=new window.Markdown.Editor(t.converter),t.commentEditor.hooks.chain("onPreviewRefresh",function(){$("#wmd-preview").find("pre").each(function(){$(this).addClass("prettyprint")}),window.prettyPrint()}),t.cannedResponseEditor=new window.Markdown.Editor(t.converter,"-second"),t.cannedResponseEditor.hooks.chain("onPreviewRefresh",function(){$("#wmd-preview-second").find("pre").each(function(){$(this).addClass("prettyprint")}),window.prettyPrint()}),t.format(),this.setupGrading(),$(window).on("beforeunload",t.cleanup),$(document).one("turbolinks:before-render",function(){t.cleanup(),$(window).off("beforeunload",t.cleanup)}))};var lee="#wmd-input",dee="#ask_question";vn.prototype.getResponse=function(t){var e=$(".canned-responses").find("[data-resp="+t+"]").html();return e&&(e=e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")),e};vn.prototype.getCannedResponseID=function(t){var e=$(".canned-responses").find("[data-resp="+t+"]");return e.data("id")};vn.prototype.cannedResponse=function(t){var e=this,r=e.getResponse(t);if(r){var n=e.getCannedResponseID(t),i=$(lee),a=i.val();a.length>0&&(a+=`

`),i.val(a+r);var s=$(ic).data("cannedResponseIDs")||"";s!==""&&(s+=","),s+=n,i.data("cannedResponseIDs",s),$(dee).trigger("focus");var o=$(hu),c=$("input[name=review-options]:checked").data("value");c?o.text("Send Grade with Message"):o.text("Send")}};vn.prototype.setupGrading=function(){for(var t=this,e=1;e<=9;e++)(function(r){var n="ctrl+"+r;$(document).bind("keypress",n,function(){t.cannedResponse(r)})})(e);$(".canned-responses").on("click",".canned-response",function(){var r=$(this),n=r.find(".resp").data("resp");t.cannedResponse(n)})};vn.prototype.cleanup=function(){$(document).unbind("keypress"),$(document).off("click",dL)};pL.exports=vn});var gL=D((hL,Lv)=>{(function(t,e){var r=Object.prototype.toString;function n(L,H,j){if(Array.prototype.map)return Array.prototype.map.call(L,H,j);for(var X=new Array(L.length),V=0,ie=L.length;V<ie;V++)X[V]=H.call(j,L[V],V,L);return X}function i(L){return{newPos:L.newPos,components:L.components.slice(0)}}function a(L){for(var H=[],j=0;j<L.length;j++)L[j]&&H.push(L[j]);return H}function s(L){var H=L;return H=H.replace(/&/g,"&amp;"),H=H.replace(/</g,"&lt;"),H=H.replace(/>/g,"&gt;"),H=H.replace(/"/g,"&quot;"),H}function o(L,H,j){H=H||[],j=j||[];var X;for(X=0;X<H.length;X+=1)if(H[X]===L)return j[X];var V;if(r.call(L)==="[object Array]"){for(H.push(L),V=new Array(L.length),j.push(V),X=0;X<L.length;X+=1)V[X]=o(L[X],H,j);H.pop(),j.pop()}else if(typeof L=="object"&&L!==null){H.push(L),V={},j.push(V);var ie=[],fe;for(fe in L)ie.push(fe);for(ie.sort(),X=0;X<ie.length;X+=1)fe=ie[X],V[fe]=o(L[fe],H,j);H.pop(),j.pop()}else V=L;return V}function c(L,H,j,X){for(var V=0,ie=L.length,fe=0,Re=0;V<ie;V++){var ye=L[V];if(ye.removed){if(ye.value=j.slice(Re,Re+ye.count).join(""),Re+=ye.count,V&&L[V-1].added){var Ue=L[V-1];L[V-1]=L[V],L[V]=Ue}}else{if(!ye.added&&X){var ze=H.slice(fe,fe+ye.count);ze=n(ze,function(de,Q){var Fe=j[Re+Q];return Fe.length>de.length?Fe:de}),ye.value=ze.join("")}else ye.value=H.slice(fe,fe+ye.count).join("");fe+=ye.count,ye.added||(Re+=ye.count)}}return L}function l(L){this.ignoreWhitespace=L}l.prototype={diff:function(L,H,j){var X=this;function V(Fe){return j?(setTimeout(function(){j(e,Fe)},0),!0):Fe}if(H===L)return V([{value:H}]);if(!H)return V([{value:L,removed:!0}]);if(!L)return V([{value:H,added:!0}]);H=this.tokenize(H),L=this.tokenize(L);var ie=H.length,fe=L.length,Re=1,ye=ie+fe,ze=[{newPos:-1,components:[]}],Ue=this.extractCommon(ze[0],H,L,0);if(ze[0].newPos+1>=ie&&Ue+1>=fe)return V([{value:H.join("")}]);function de(){for(var Fe=-1*Re;Fe<=Re;Fe+=2){var We,tt=ze[Fe-1],Le=ze[Fe+1],Tt=(Le?Le.newPos:0)-Fe;tt&&(ze[Fe-1]=e);var It=tt&&tt.newPos+1<ie,St=Le&&0<=Tt&&Tt<fe;if(!It&&!St){ze[Fe]=e;continue}if(!It||St&&tt.newPos<Le.newPos?(We=i(Le),X.pushComponent(We.components,e,!0)):(We=tt,We.newPos++,X.pushComponent(We.components,!0,e)),Tt=X.extractCommon(We,H,L,Fe),We.newPos+1>=ie&&Tt+1>=fe)return V(c(We.components,H,L,X.useLongestToken));ze[Fe]=We}Re++}if(j)(function Fe(){setTimeout(function(){if(Re>ye)return j();de()||Fe()},0)})();else for(;Re<=ye;){var Q=de();if(Q)return Q}},pushComponent:function(L,H,j){var X=L[L.length-1];X&&X.added===H&&X.removed===j?L[L.length-1]={count:X.count+1,added:H,removed:j}:L.push({count:1,added:H,removed:j})},extractCommon:function(L,H,j,X){for(var V=H.length,ie=j.length,fe=L.newPos,Re=fe-X,ye=0;fe+1<V&&Re+1<ie&&this.equals(H[fe+1],j[Re+1]);)fe++,Re++,ye++;return ye&&L.components.push({count:ye}),L.newPos=fe,Re},equals:function(L,H){var j=/\S/;return L===H||this.ignoreWhitespace&&!j.test(L)&&!j.test(H)},tokenize:function(L){return L.split("")}};var f=new l,g=new l(!0),m=new l;g.tokenize=m.tokenize=function(L){return a(L.split(/(\s+|\b)/))};var y=new l(!0);y.tokenize=function(L){return a(L.split(/([{}:;,]|\s+)/))};var A=new l,k=new l;k.ignoreTrim=!0,A.tokenize=k.tokenize=function(L){for(var H=[],j=L.split(/^/m),X=0;X<j.length;X++){var V=j[X],ie=j[X-1],fe=ie&&ie[ie.length-1];V===`
`&&fe==="\r"?H[H.length-1]=H[H.length-1].slice(0,-1)+`\r
`:(this.ignoreTrim&&(V=V.trim(),X<j.length-1&&(V+=`
`)),H.push(V))}return H};var I=new l;I.tokenize=function(L){var H=[],j=L.split(/(\n|\r\n)/);j[j.length-1]||j.pop();for(var X=0;X<j.length;X++){var V=j[X];X%2?H[H.length-1]+=V:H.push(V)}return H};var F=new l;F.tokenize=function(L){return a(L.split(/(\S.+?[.!?])(?=\s+|$)/))};var J=new l;J.useLongestToken=!0,J.tokenize=A.tokenize,J.equals=function(L,H){return A.equals(L.replace(/,([\r\n])/g,"$1"),H.replace(/,([\r\n])/g,"$1"))};var pe={Diff:l,diffChars:function(L,H,j){return f.diff(L,H,j)},diffWords:function(L,H,j){return g.diff(L,H,j)},diffWordsWithSpace:function(L,H,j){return m.diff(L,H,j)},diffLines:function(L,H,j){return A.diff(L,H,j)},diffTrimmedLines:function(L,H,j){return k.diff(L,H,j)},diffSentences:function(L,H,j){return F.diff(L,H,j)},diffCss:function(L,H,j){return y.diff(L,H,j)},diffJson:function(L,H,j){return J.diff(typeof L=="string"?L:JSON.stringify(o(L),e,"  "),typeof H=="string"?H:JSON.stringify(o(H),e,"  "),j)},createTwoFilesPatch:function(L,H,j,X,V,ie){var fe=[];L==H&&fe.push("Index: "+L),fe.push("==================================================================="),fe.push("--- "+L+(typeof V>"u"?"":"	"+V)),fe.push("+++ "+H+(typeof ie>"u"?"":"	"+ie));var Re=I.diff(j,X);Re.push({value:"",lines:[]});function ye(Zt){return n(Zt,function(Ze){return" "+Ze})}function ze(Zt,Ze,Z){var me=Re[Re.length-2],ke=Ze===Re.length-2,we=Ze===Re.length-3&&Z.added!==me.added;!/\n$/.test(Z.value)&&(ke||we)&&Zt.push("\\ No newline at end of file")}for(var Ue=0,de=0,Q=[],Fe=1,We=1,tt=0;tt<Re.length;tt++){var Le=Re[tt],Tt=Le.lines||Le.value.replace(/\n$/,"").split(`
`);if(Le.lines=Tt,Le.added||Le.removed){if(!Ue){var It=Re[tt-1];Ue=Fe,de=We,It&&(Q=ye(It.lines.slice(-4)),Ue-=Q.length,de-=Q.length)}Q.push.apply(Q,n(Tt,function(Zt){return(Le.added?"+":"-")+Zt})),ze(Q,tt,Le),Le.added?We+=Tt.length:Fe+=Tt.length}else{if(Ue)if(Tt.length<=8&&tt<Re.length-2)Q.push.apply(Q,ye(Tt));else{var St=Math.min(Tt.length,4);fe.push("@@ -"+Ue+","+(Fe-Ue+St)+" +"+de+","+(We-de+St)+" @@"),fe.push.apply(fe,Q),fe.push.apply(fe,ye(Tt.slice(0,St))),Tt.length<=4&&ze(fe,tt,Le),Ue=0,de=0,Q=[]}Fe+=Tt.length,We+=Tt.length}}return fe.join(`
`)+`
`},createPatch:function(L,H,j,X,V){return pe.createTwoFilesPatch(L,L,H,j,X,V)},applyPatch:function(L,H){for(var j=H.split(`
`),X=[],V=0,ie=!1,fe=!1;V<j.length&&!/^@@/.test(j[V]);)V++;for(;V<j.length;V++)if(j[V][0]==="@"){var Re=j[V].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);X.unshift({start:Re[3],oldlength:+Re[2],removed:[],newlength:Re[4],added:[]})}else j[V][0]==="+"?X[0].added.push(j[V].substr(1)):j[V][0]==="-"?X[0].removed.push(j[V].substr(1)):j[V][0]===" "?(X[0].added.push(j[V].substr(1)),X[0].removed.push(j[V].substr(1))):j[V][0]==="\\"&&(j[V-1][0]==="+"?ie=!0:j[V-1][0]==="-"&&(fe=!0));var ye=L.split(`
`);for(V=X.length-1;V>=0;V--){for(var ze=X[V],Ue=0;Ue<ze.oldlength;Ue++)if(ye[ze.start-1+Ue]!==ze.removed[Ue])return!1;Array.prototype.splice.apply(ye,[ze.start-1,ze.oldlength].concat(ze.added))}if(ie)for(;!ye[ye.length-1];)ye.pop();else fe&&ye.push("");return ye.join(`
`)},convertChangesToXML:function(L){for(var H=[],j=0;j<L.length;j++){var X=L[j];X.added?H.push("<ins>"):X.removed&&H.push("<del>"),H.push(s(X.value)),X.added?H.push("</ins>"):X.removed&&H.push("</del>")}return H.join("")},convertChangesToDMP:function(L){for(var H=[],j,X,V=0;V<L.length;V++)j=L[V],j.added?X=1:j.removed?X=-1:X=0,H.push([X,j.value]);return H},canonicalize:o};typeof Lv<"u"&&Lv.exports?Lv.exports=pe:typeof define=="function"&&define.amd?define([],function(){return pe}):typeof t.JsDiff>"u"&&(t.JsDiff=pe)})(hL)});var mL=D((WAe,fee)=>{fee.exports=`<table class="table table-condensed">
    <thead class="table-header-sticky">
        <tr>
            <th class="bottom-border"></th>
            <th class="bottom-border">
                Pass
            </th>
            <th class="bottom-border">
                Test
            </th>
            <th class="bottom-border">
                Message
            </th>
            {{#if showAIHelpTestCases}}
            <th class="bottom-border">
                Hint
            </th>
            {{/if}}
        </tr>
    </thead>
    {{#each tests}}
        {{#if showDropdown}}
            <tr tabindex="0"
            class="
            {{#if success}}
            success-test accordion-toggle side-borders collapsed
            {{else}}
                {{#if invalid}}
                invalid-test accordion-toggle side-borders bottom-border
                {{else}}
                danger-test accordion-toggle side-borders bottom-border
                {{/if}}
            {{/if}}
            "
            data-toggle="collapse" data-target="#result{{@index}}">

                <td class="test-show test-case-spacing">
                    <span class="icon-caret-right"><i class="fas fa-angle-right"></i></span>
                    <span class="icon-caret-down"><i class="fas fa-angle-down"></i></span>
                </td>

                <td class="test-case-spacing">
                    {{#if success}}
                        <div class="green-circle"><span class="chs-icon-check" role="img" aria-label="Passed"></span></div>
                    {{else}}
                    {{#ifCond verbosityLevel '===' 0}}
                    <div class="red-circle"><span class="chs-icon-cancel" role="img" aria-label="Failed"></span></div>
                    {{/ifCond}}
                    {{#ifCond verbosityLevel '===' 10}}
                    <div class="grading-circle warning-circle"
                         rel="tooltip-left"
                         title="This is something you should fix, but you can still submit your work.">
                        <span class="fa-solid fa-exclamation"
                              role="img"
                              aria-label="Warning"></span>
                    </div>
                    {{/ifCond}}
                    {{#ifCond verbosityLevel '===' 20}}
                    <div class="grading-circle info-circle"
                         rel="tooltip-left"
                         title="This is a best practice to note. You can still submit your work.">
                        <span class="fa-solid fa-info"
                              role="img"
                              aria-label="Info"></span>
                    </div>
                    {{/ifCond}}
                    {{/if}}
                </td>

                <td class="grading-code test-case-spacing">
                    {{#if isHiddenTest}}
                        <span class="icon icon-eye-close" rel="tooltip-left" title="Hidden tests hide the input and output of the test case. Your program should work for all inputs, even the ones there isn't a test for."></span>
                    {{/if}}
                    {{{test}}}
                </td>

                <td class="test-case-spacing">
                {{{message}}}
                </td>

                {{#if ../showAIHelpTestCases}}
                    {{#unless success}}
                        {{#unless invalid}}
                        <td class="test-case-spacing">
                            <button class="btn btn-main-white btn-ai-hint" id="grading-unit-test-ai-hint-{{@index}}" aria-label="Get AI hints for this test case" rel="tooltip-left" title="Get AI hints for this test case">
                                <i class="fas fa-wand-magic-sparkles"></i>
                            </button>
                        </td>
                        {{/unless}}
                    {{/unless}}
                {{/if}}
            </tr>
            <tr>
                <td colspan="5" class="hidden-row side-borders bottom-border"><div class="accordion-body collapse{{#unless success}} in{{/unless}}" id="result{{@index}}" data-toggle="false">
                {{#if solutionOutput}}
                <div class="expanded-case">
                    <div class="div-spacing grading-code">Expected result:</div>
                    <div class="div-spacing bottom-spacing grading-code">
                        <pre class="rounded">{{solutionOutput}}</pre>
                    </div>
                </div>
                {{/if}}
                {{#if studentOutput}}
                <div class="expanded-case">
                    <div class="div-spacing grading-code">Your result:</div>
                    <div class="div-spacing bottom-spacing grading-code">
                        <pre class="rounded">{{studentOutput}}</pre>
                    </div>
                </div>
                {{/if}}
                {{#if showDiff}}
                <div class="expanded-case">
                    <div class="div-spacing grading-code">Difference:</div>
                    <div class="div-spacing bottom-spacing grading-code">
                        <pre class="result rounded">{{{diff}}}</pre>
                    </div>
                </div>

                {{/if}}
                </div></td>
            </tr>
        {{else}}
            {{#if isHiddenTest}}
            <tr tabindex="0"
            class="
            {{#if success}}
            success-test
            {{else}}
                {{#if invalid}}
                invalid-test
                {{else}}
                danger-test
                {{/if}}
                bottom-border
            {{/if}}
            side-borders"
            data-toggle="collapse" data-target="#result{{@index}}">
                <td class="test-case-spacing"></td>
                <td class="test-case-spacing">
                    {{#if success}}
                    <div class="green-circle"><span class="chs-icon-check" role="img" aria-label="Passed"></span></div>
                    {{else}}
                    {{#ifCond verbosityLevel '===' 0}}
                    <div class="red-circle"><span class="chs-icon-cancel" role="img" aria-label="Failed"></span></div>
                    {{/ifCond}}
                    {{#ifCond verbosityLevel '===' 10}}
                    <div class="grading-circle warning-circle"
                         rel="tooltip-left"
                         title="This is something you should fix, but you can still submit your work.">
                        <span class="fa-solid fa-exclamation"
                              role="img"
                              aria-label="Warning"></span>
                    </div>
                    {{/ifCond}}
                    {{#ifCond verbosityLevel '===' 20}}
                    <div class="grading-circle info-circle"
                         rel="tooltip-left"
                         title="This is a best practice to note. You can still submit your work.">
                        <span class="fa-solid fa-info"
                              role="img"
                              aria-label="Info"></span>
                    </div>
                    {{/ifCond}}
                    {{/if}}
                </td>
                <td class="grading-code test-case-spacing">
                    {{#if isHiddenTest}}
                    <span class="icon icon-eye-close" rel="tooltip-left" title="Hidden tests hide the input and output of the test case. Your program should work for all inputs, even the ones there isn't a test for."></span>
                    {{/if}}
                     Hidden Test</td>
                <td class="test-case-spacing"></td>
            </tr>
            {{else}}
            <tr tabindex="0"
            class="
            {{#if success}}
            success-test
            {{else}}
                {{#if invalid}}
                invalid-test
                {{else}}
                danger-test
                {{/if}}
            {{/if}}
            side-borders"
            data-toggle="collapse" data-target="#result{{@index}}">
                {{#if aiTestCase}}
                <td class="test-show" style="padding-left: 12px; padding-top: 7px; font-size: 20px">\u2728</td>
                {{else}}
                <td class="test-show"></td>
                {{/if}}
                <td>
                    {{#if success}}
                    <div class="green-circle"><span class="chs-icon-check" role="img" aria-label="Passed"></span></div>
                    {{else}}
                    {{#ifCond verbosityLevel '===' 0}}
                    <div class="red-circle"><span class="chs-icon-cancel" role="img" aria-label="Failed"></span></div>
                    {{/ifCond}}
                    {{#ifCond verbosityLevel '===' 10}}
                    <div class="grading-circle warning-circle"
                         rel="tooltip-left"
                         title="This is something you should fix, but you can still submit your work.">
                        <span class="fa-solid fa-exclamation"
                              role="img"
                              aria-label="Warning"></span>
                    </div>
                    {{/ifCond}}
                    {{#ifCond verbosityLevel '===' 20}}
                    <div class="grading-circle info-circle"
                         rel="tooltip-left"
                         title="This is a best practice to note. You can still submit your work.">
                        <span class="fa-solid fa-info"
                              role="img"
                              aria-label="Info"></span>
                    </div>
                    {{/ifCond}}
                    {{/if}}
                </td>
                {{#if isHiddenTest}}
                    <td>
                        <span class="icon icon-eye-close" rel="tooltip-left" title="Hidden tests hide the input and output of the test case. Your program should work for all inputs, even the ones there isn't a test for."></span>
                    </td>
                {{/if}}
                <td class="grading-code">
                    {{{category}}}
                </td>
                <td>
                {{{message}}}
                </td>
            </tr>
            {{/if}}
        {{/if}}
    {{/each}}
    {{#if stillRunning}}
        <tr>
            <td colspan="5" class="bottom-border side-borders">
                <span class="icon-spinner icon-spin spacing-left spacing-right"></span> Running More Tests...
            </td>
        </tr>
    {{/if}}
</table>
`});var Nv=D((YAe,_L)=>{"use strict";var GT=Nr(),fl=Cr(),KAe=Jl(),XAe=_i(),pee=gL(),hee=mL(),dl="#grading-container",vL="#grading-unit-test-run",yL="#grading-unit-test-ai-hint",gee="button.grade_code",mee="#grading-unit-test-expand-all",vee="#grading-unit-test-collapse-all",yee=".error-box",bee=".error-container";function VT(t){this.editor=t,this.setup()}function bL(t){function e(a){a.success||(typeof a.solutionOutput=="string"&&(a.solutionOutput=a.solutionOutput.replace(/\n$/,`\u23CE
`)),typeof a.studentOutput=="string"&&(a.studentOutput=a.studentOutput.replace(/\n$/,`\u23CE
`)));var s=pee.diffChars(a.solutionOutput,a.studentOutput),o="";s.forEach(function(c){var l=c.value;c.added?l="<ins>"+l+"</ins>":c.removed&&(l="<del>"+l+"</del>"),o+=l}),a.diff=o,a.showDropdown===void 0&&(a.showDropdown=!(a.category==="Style"||a.category==="Functionality"||a.isHiddenTest&&(window.Ed.isOwnPage()||window.Ed.codeUserID==GT.User.NONE_USER_ID))),a.isHiddenTest=a.isHiddenTest||!1,a.verbosityLevel=a.verbosityLevel||GT.EditorTestVerbosity.ERROR}_.each(t.tests,e),window.Ed&&(t.isHTML=window.Ed.typeTester.isHTML()),t.showAIHelpTestCases=window.pageSpecific.showAIChatTab,window.testcases=t.tests;var r;r=window.Handlebars.compile(hee);var n=r(t);$(dl).html(n),window.prettyPrint(),$("[rel=tooltip-left]").tooltip({placement:"left",container:"body"}),$(".accordion-toggle").on("keypress",function(a){a.which===13&&$(this).trigger("click"),a.which===32&&(a.preventDefault(),$(this).trigger("click"))});var i=t.tests.filter(function(a){return!a.success});i.length>0&&($(yL).removeClass("hidden"),$("#ai-hint-main-button").data("extra-context","The student's code failed the following test cases: "+JSON.stringify(i)))}function _ee(t){var e=$(t).text(),r=0,n=.1,i="";function a(c){return"display: inline-block; animation: bounce-up 3s ease-in-out infinite; animation-delay: "+c+"s;"}for(var s=0;s<e.length;s++){var o=e.charAt(s);o===" "?i+=" ":i+='<span class="bounce-up" style="'+a(r)+'">'+o+"</span>",r+=n}$(t).html(i)}VT.prototype.gradeCode=function(t){var e=this,r=$(yee),n=$(bee);r.exists()&&n.exists()&&(r.hide(),n.html("")),t!==void 0?($(dl).html('<div class="loader-container"><div class="loader"></div><p class="ai-loading-text">\u2728 Grading with AI... \u2728</p></div>'),_ee(".ai-loading-text")):$(dl).html(""),fl.trigger("autograder:run",e.editor.getCode(),e.editor.info,e.editor,{displayPopup:!1,aiTestCases:t})};VT.prototype.setup=function(){var t=this;$(vL).on("click",function(){if(t.editor.getItemType()===GT.ItemType.UNIT_TEST&&($('[data-filename="Unit Test"]').trigger("click"),fl.trigger("editor:sr:statusUpdate","Running unit tests")),t.editor.isOwnPage())t.editor.save(function(){$("div.show-graded").removeClass("flex"),$("div.show-graded").addClass("hide-bar"),t.gradeCode()},"run");else{$("div.show-graded").removeClass("flex"),$("div.show-graded").addClass("hide-bar");var e=t.editor.currentCode;e[t.editor.activeFile]=t.editor.getCode(),t.gradeCode()}}),$(yL).on("click",function(){window.pageSpecific.isAbacus?window.myAbacus.selectTabWithIdentifier("rightTabs","convo-tab"):fl.trigger("utils:switchToTab","#help-tab",".right-col-tabs",".editor-tab-content"),$("#ai-hint-main-button").trigger("click")}),$(gee).on("click",function(){fl.trigger("utils:switchToTab","#grading-tab",".right-col-tabs",".editor-tab-content"),$(vL).trigger("click")}),$(mee).on("click",function(){$(dl+" .accordion-toggle").each(function(){$(this).removeClass("collapsed"),$(this).addClass("bottom-border")}),$(dl+" .accordion-body").each(function(){$(this).collapse("show")})}),$(vee).on("click",function(){$(dl+" .accordion-toggle").each(function(){$(this).addClass("collapsed"),$(this).removeClass("bottom-border")}),$(dl+" .accordion-body").each(function(){$(this).collapse("hide")})}),$(".practice-grading-header").on("click",function(){$(this).toggleClass("open"),$(this).hasClass("open")?$(".practice-description").show():$(".practice-description").hide()})};fl.on("gradingtab:unitTestsProgress",function(t){t.stillRunning=!0,bL(t)});fl.on("gradingtab:unitTestsComplete",function(t){fl.trigger("editor:sr:statusUpdate","Completed unit tests"),bL(t),$("div.show-graded").removeClass("hide-bar"),$("div.show-graded").addClass("flex"),window.applyAIHintButtonDisabledState&&window.applyAIHintButtonDisabledState()});_L.exports=VT});var zT=D((JAe,wL)=>{"use strict";var wee=Nr(),Tee=wee.Uploads.UPLOADS_PROXY_BASE_URL,See="#result-url";function dh(t){this.editor=t,this.setup()}dh.prototype.setup=function(){var t=this,e=null,r=null,n=null,i=!1,a=320,s=0,o=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext,c=0;$("#file-select").on("click",function(l){l.preventDefault(),$(".microphone").hide(),$(".camera").hide(),$(".mic-result").hide(),$("#file-upload").trigger("click")}),$("#zip-select").on("click",function(l){l.preventDefault(),$(".microphone").hide(),$(".camera").hide(),$(".mic-result").hide(),$("#zip-upload").trigger("click")}),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&($("#webcam").removeClass("hidden"),window.MediaRecorder&&($("#microphone").removeClass("hidden"),$("#browser-warning").addClass("hidden")),$("#webcam").on("click",function(l){l.preventDefault(),$(".microphone").hide(),$(".mic-result").hide(),$(".camera").show(),e=document.getElementById("video"),r=document.getElementById("video-still-canvas"),n=document.getElementById("webcam-still"),n.addEventListener("click",function(g){f(),g.preventDefault()},!1),e.addEventListener("canplay",function(g){i||(s=e.videoHeight/(e.videoWidth/a),isNaN(s)&&(s=a/(4/3)),e.setAttribute("width",a),e.setAttribute("height",s),r.setAttribute("width",a),r.setAttribute("height",s),i=!0)},!1);function f(){n.disabled=!0,n.innerHTML="...";var g=r.getContext("2d");if(a&&s){r.width=a,r.height=s,e.pause(),g.filter=t.getCurrentImageFilterCSS(),g.drawImage(e,0,0,a,s);for(var m=r.toDataURL(),y=atob(m.split(",")[1]),A=[],k=0;k<y.length;k++)A.push(y.charCodeAt(k));var I=new File([new Uint8Array(A)],"webcam.png",{type:"image/png"}),F=new FormData;F.append("file",I),Mv(F,function(){$(".camera").hide(),n.innerHTML='<span class="icon icon-camera"></span> Take photo',n.disabled=!1})}}navigator.mediaDevices.getUserMedia({video:!0}).then(function(g){e.srcObject=g,e.play()}).catch(function(g){console.error("The following getUserMedia error occured: ",g)})}),$("#microphone").on("click",function(l){l.preventDefault(),$(".camera").hide(),$(".mic-result").hide(),$(".microphone").show();var f=$("#mic-record");if(!c&&o)try{c=new o}catch{console.log("Too many AudioContexts are in use. Please close all browser windows and retry."),c=0}function g(m){if(c){let pe=function(){var L=F.width,H=F.height;requestAnimationFrame(pe),A.getByteTimeDomainData(I),J.fillStyle="rgb(200, 200, 200)",J.fillRect(0,0,L,H),J.lineWidth=2,J.strokeStyle="rgb(0, 0, 0)",J.beginPath();for(var j=L*1/k,X=0,V=0;V<k;V++){var ie=I[V]/128,fe=ie*H/2;V===0?J.moveTo(X,fe):J.lineTo(X,fe),X+=j}J.lineTo(F.width,F.height/2),J.stroke()};var y=c.createMediaStreamSource(m),A=c.createAnalyser();A.fftSize=2048;var k=A.frequencyBinCount,I=new Uint8Array(k);y.connect(A);var F=document.querySelector("#mic-analyser"),J=F.getContext("2d");pe()}else $("#mic-analyser").hide()}navigator.mediaDevices.getUserMedia({audio:!0}).then(function(m){g(m);var y=new MediaRecorder(m),A=[];f.on("click",function(k){y.state!="recording"?(y.start(),f.addClass("btn-main-red"),f.removeClass("btn-main-blue"),f.html('<span class="icon icon-stop"></span> Stop')):(y.stop(),f.addClass("btn-main-blue"),f.removeClass("btn-main-red"),f.html("Uploading..."),f.attr("disabled",!0))}),y.ondataavailable=function(k){A.push(k.data)},y.onstop=function(k){var I=new File(A,"microphone.mp3",{type:"audio/mpeg"});A=[];var F=new FormData;F.append("file",I),Mv(F,function(){$(".microphone").hide(),f.html('<span class="icon icon-circle"></span> Record'),f.attr("disabled",!1),$(".mic-result").show();var J=$("#audio-result"),pe=window.URL.createObjectURL(I);J.attr("src",pe)},"/core/ajax/upload_asset")}}).catch(function(m){console.log("The following getUserMedia error occured: "+m)})})),$("body").on("change","#file-upload",Eee),$("body").on("change","#zip-upload",xee),$(See).on("click",function(){$(this).trigger("select"),document.execCommand("copy"),window.toastr.success("Copied the URL")}),this.setupImageFilters()};dh.prototype.setupImageFilters=function(){var t=this;t.filters={grayscale:0,sepia:0,invert:0,contrast:100,brightness:100,saturate:100,"hue-rotate":0},$("#filter-toggle").on("click",function(){$("#filters-container").toggleClass("hidden")}),$(".slider").each(function(){$(this).slider({orientation:"horizontal",range:"min",min:$(this).data("min-value"),max:$(this).data("max-value"),value:$(this).data("start-value"),change:function(e,r){t.updateFilter($(this).data("filter-name"),r.value)},slide:function(e,r){t.updateFilter($(this).data("filter-name"),r.value)}})})};dh.prototype.updateFilter=function(t,e){var r=this;r.filters.hasOwnProperty(t)&&(r.filters[t]=e),$("#video").css("filter",r.getCurrentImageFilterCSS())};dh.prototype.getCurrentImageFilterCSS=function(){var t=this,e="";return Object.keys(t.filters).forEach(function(r){var n="%";r=="hue-rotate"&&(n="deg"),e+=r+"("+t.filters[r]+n+") "}),e};function Eee(){var t=new FormData($("#js-upload-form")[0]);Mv(t)}function xee(){var t=new FormData($("#js-zip-upload-form")[0]);Mv(t,function(){},"/core/ajax/upload_zip_to_code")}function Mv(t,e,r){r=r!==void 0?r:"/core/ajax/upload_image",$.ajax({url:r,type:"POST",data:t,processData:!1,dataType:"JSON",contentType:!1}).then(function(n){var i=Tee+n.url;$("#img-thumbnail").attr("src",i),$(".upload-url-container").show(),$("#result-url").val(i),e&&e(n)})}wL.exports=dh});var WT=D((QAe,SL)=>{"use strict";var Cee=ui().writeQRCode;function TL(t){this.editor=t,this.setup()}TL.prototype.setup=function(){if($("#html-qr-code").length){var t=$("#html-qr-code").data("url");Cee(t,"#html-qr-code")}};SL.exports=TL});var KT=D((ZAe,EL)=>{"use strict";var Aee=xn(),Iee=mn();function $v(){var t=this;t.running=!1,t.__graphics__=new window.CodeHSGraphics({canvas:$(".codehs-editor-canvas")})}Aee.inherits($v,Iee);$v.prototype.run=function(t,e){var r=this;return r.stop(),r.running=!0,r.helperCode&&(t=r.helperCode+t),r.__graphics__.runCode(t,e)};$v.prototype.stop=function(){var t=this;t.__graphics__.removeAll(),t.__graphics__.fullReset(),t.running=!1};EL.exports=$v});var IL=D((eIe,AL)=>{"use strict";var kee=xn(),Oee=mn(),xL="html-destination",CL="#html";function Uv(t){var e=this;e.running=!1,e.editor=t}kee.inherits(Uv,Oee);Uv.prototype.run=function(t){var e=this;e.running=!0;var r=$("<iframe>");r.addClass(xL),$(CL).html(r);var n=r.get(0).contentDocument,i,a=Object.keys(t).length===1&&!e.editor.isOwnPage();if(window.HOC_LOGGED_OUT_PLAYLIST_EDITOR||a){if(n.open(),n.write(e.editor.getCode()),n.close(),Object.keys(t).length>1){var s=window.location.pathname.replace("playlist","html"),o=s.substring(0,s.lastIndexOf("/"));r.on("load",function(){var pe=r.contents(),L,H;pe.find("link").each(function(){H=$(this),L=H.attr("href").trim(),!L.startsWith("http://")&&!L.startsWith("https://")&&!L.startsWith("//")&&(L.startsWith("/")||(L="/"+L),H.attr("href",o+L))})})}}else if(e.editor.isOwnPage())e.editor.studentAssignmentID?i="/editor/html/"+e.editor.itemID+"/"+e.editor.codeUserID+"/"+e.editor.studentAssignmentID+"/"+e.editor.mainClass:i="/editor/html/"+e.editor.itemID+"/"+e.editor.codeUserID+"/"+e.editor.mainClass,r.attr("src",i);else{var c,l,f;r.on("load",function(){f=r.get(0).contentDocument,l=r.contents(),l.find("a").on("click",function(X){if(c=$(this).attr("href").trim(),m.hasOwnProperty(c))X.preventDefault(),r.attr("src",m[c]);else return!0});var pe,L;l.find("script").each(function(){pe=$(this).attr("src").trim(),m.hasOwnProperty(pe)&&(L=f.createElement("script"),L.type="text/javascript",L.src=m[pe],f.body.appendChild(L))});var H,j;l.find("link").each(function(){j=$(this),H=j.attr("href").trim(),m.hasOwnProperty(H)&&j.attr("href",m[H])})}),e.editor.currentCode[e.editor.activeFile]=e.editor.getCode();var g,m={},y=e.editor.currentCode,A=!0,k=/[^.]*$/,I,F;Object.keys(y).forEach(function(pe){g=y[pe],I=pe.match(k)[0].toLowerCase(),F=J(I),F||(A=!1),m[pe]=URL.createObjectURL(new Blob([g],{type:F}))}),A?i=m[e.editor.mainClass]:i="/editor/html/"+e.editor.itemID+"/"+e.editor.codeUserID+"/"+e.editor.mainClass,r.attr("src",i)}e.running=!1;function J(pe){switch(pe){case"html":return"text/html";case"css":return"text/css";case"js":return"text/javascript"}}};Uv.prototype.stop=function(){var t=this,e=$("<iframe>");e.addClass(xL),$(CL).html(e),t.running=!1};AL.exports=Uv});var OL=D((tIe,kL)=>{"use strict";var Pee=xn(),Ree=mn();function Fv(t){var e=this;e.running=!1,e.editor=t,e.__console__=new window.CodeHSConsole}Pee.inherits(Fv,Ree);Fv.prototype.run=function(t,e){var r=this;return r.stop(),r.running=!0,r.__console__.runCode(t,e)};Fv.prototype.stop=function(){var t=this;t.running=!1};kL.exports=Fv});var DL=D((rIe,RL)=>{"use strict";var Vr=B0(),Dee=Lc(),XT=Nc(),PL=xz();function Xt(t){this.karelRunner=t,this.usingSuperKarel=this.karelRunner.usingSuperKarel(),this.usingUltraKarel=this.karelRunner.usingUltraKarel()}Xt.checkCommandArgs=function(t,e){if(t!=Dee.KAREL_ARGUMENT_SECRET)throw new Error("You cannot have anything between the parentheses for "+e+".")};Xt.prototype.functionCall=function(t){this.karelRunner.pushCommand({c:Vr.FUNCTION,l:t})};Xt.prototype.move=function(t,e){Xt.checkCommandArgs(t,"move command"),this.getWorld().canMove()?(this.getWorld().move(),this.pushCommand({c:Vr.MOVE,l:e})):this.pushCommand({c:Vr.ERROR_CRASH_INTO_WALL,l:e})};Xt.prototype.putBall=function(t,e){Xt.checkCommandArgs(t,"putBall command"),this.getWorld().putBall(),this.pushCommand({c:Vr.PUT_BEEPER,l:e})};Xt.prototype.bark=function(t,e){this.pushCommand({c:Vr.BARK,l:e})};Xt.prototype.takeBall=function(t,e){Xt.checkCommandArgs(t,"takeBall command"),this.getWorld().ballsPresent()?(this.getWorld().takeBall(),this.pushCommand({c:Vr.PICK_BEEPER,l:e})):this.pushCommand({c:Vr.ERROR_NO_BEEPERS,l:e})};Xt.prototype.turnLeft=function(t,e){Xt.checkCommandArgs(t,"turnLeft command"),this.getWorld().turnLeft(),this.pushCommand({c:Vr.TURN_LEFT,l:e})};Xt.prototype.frontIsClear=function(t,e){return Xt.checkCommandArgs(t,"frontIsClear condition"),this.validateCondition()?(this.pushCommand({c:Vr.FRONT_IS_CLEAR,l:e}),this.getWorld().frontIsClear()):!1};Xt.prototype.frontIsBlocked=function(t,e){return Xt.checkCommandArgs(t,"frontIsBlocked condition"),this.validateCondition()?(this.pushCommand({c:Vr.FRONT_IS_CLEAR,l:e}),!this.getWorld().frontIsClear()):!1};Xt.prototype.leftIsClear=function(t,e){return Xt.checkCommandArgs(t,"leftIsClear condition"),this.validateCondition()?(this.pushCommand({c:Vr.LEFT_IS_CLEAR,l:e}),this.getWorld().leftIsClear()):!1};Xt.prototype.leftIsBlocked=function(t,e){return Xt.checkCommandArgs(t,"leftIsClear condition"),this.validateCondition()?(this.pushCommand({c:Vr.LEFT_IS_CLEAR,l:e}),!this.getWorld().leftIsClear()):!1};Xt.prototype.rightIsClear=function(t,e){return Xt.checkCommandArgs(t,"rightIsClear condition"),this.validateCondition()?(this.pushCommand({c:Vr.RIGHT_IS_CLEAR,l:e}),this.getWorld().rightIsClear()):!1};Xt.prototype.rightIsBlocked=function(t,e){return Xt.checkCommandArgs(t,"rightIsBlocked condition"),this.validateCondition()?(this.pushCommand({c:Vr.RIGHT_IS_CLEAR,l:e}),!this.getWorld().rightIsClear()):!1};Xt.prototype.ballsPresent=function(t,e){return Xt.checkCommandArgs(t,"ballsPresent condition"),this.validateCondition()?(this.pushCommand({c:Vr.BALLS_PRESENT,l:e}),this.getWorld().ballsPresent()):!1};Xt.prototype.noBallsPresent=function(t,e){return Xt.checkCommandArgs(t,"noBallsPresent condition"),this.validateCondition()?(this.pushCommand({c:Vr.BALLS_PRESENT,l:e}),!this.getWorld().ballsPresent()):!1};Xt.prototype.facingNorth=function(t,e){return Xt.checkCommandArgs(t,"facingNorth condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_NORTH,l:e}),this.getWorld().facingNorth()):!1};Xt.prototype.notFacingNorth=function(t,e){return Xt.checkCommandArgs(t,"notFacingNorth condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_NORTH,l:e}),!this.getWorld().facingNorth()):!1};Xt.prototype.facingSouth=function(t,e){return Xt.checkCommandArgs(t,"facingSouth condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_SOUTH,l:e}),this.getWorld().facingSouth()):!1};Xt.prototype.notFacingSouth=function(t,e){return Xt.checkCommandArgs(t,"notFacingSouth condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_SOUTH,l:e}),!this.getWorld().facingSouth()):!1};Xt.prototype.facingEast=function(t,e){return Xt.checkCommandArgs(t,"facingEast condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_EAST,l:e}),this.getWorld().facingEast()):!1};Xt.prototype.notFacingEast=function(t,e){return Xt.checkCommandArgs(t,"notFacingEast condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_EAST,l:e}),!this.getWorld().facingEast()):!1};Xt.prototype.facingWest=function(t,e){return Xt.checkCommandArgs(t,"facingWest condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_WEST,l:e}),this.getWorld().facingWest()):!1};Xt.prototype.notFacingWest=function(t,e){return Xt.checkCommandArgs(t,"notFacingWest condition"),this.validateCondition()?(this.pushCommand({c:Vr.FACING_WEST,l:e}),!this.getWorld().facingWest()):!1};Xt.prototype.turnRight=function(t,e){Xt.checkCommandArgs(t,"turnRight command"),this.getWorld().turnRight(),this.pushCommand({c:Vr.TURN_RIGHT,l:e})};Xt.prototype.turnAround=function(t,e){Xt.checkCommandArgs(t,"turnAround command"),this.getWorld().turnAround(),this.pushCommand({c:Vr.TURN_AROUND,l:e})};Xt.prototype.randomInt=function(t,e){return PL.nextInt(e)};Xt.prototype.colorIs=function(t,e){return this.pushCommand({c:Vr.COLOR_IS,l:1}),this.getWorld().colorIs(t)};Xt.prototype.randomChance=function(t,e){return typeof e!="number"?(XT.libraryError("You must pass a number to randomChance()."),!1):e>1?(XT.libraryError("You must pass a number between 0 and 1 to randomChance()."),!1):typeof t!="number"?(XT.libraryError("You have an error in your randomChance() call."),!1):(this.pushCommand({c:Vr.RANDOM_CHANCE,l:t}),PL.nextBoolean(e))};Xt.prototype.paint=function(t,e,r){this.getWorld().paint(t),this.pushCommand({c:Vr.PAINT,color:t,l:r})};RL.exports=Xt});var ML=D((iIe,NL)=>{"use strict";var YT=Lc(),Fd=Ni(),pl=Nc();function LL(t){this.code=t.code||"",this.checkMissingParens=t.checkMissingParens||!1,this.checkUndefinedCondition=t.checkUndefinedCondition||!1,this.checkCapitalFunctionDeclaration=t.checkInvalidFunctionDeclaration||!1,this.checkHasFunctionRedefinition=t.checkHasFunctionRedefinition||!1,this.checkHasSemicolonInFunctionDef=t.checkHasSemicolonInFunctionDef||!1,this.checkMisspelledFunction=t.checkMisspelledFunction||!1,this.checkValidCommands=t.checkValidCommands||!1}var Lee=function(t){var e=YT.getBuiltIns(!0),r=new RegExp("("+e.join("|")+")(?!\\s*\\(\\))(\\)|\\s+)",""),n=t.match(r);if(n!=null){var i='Missing <span class="code">()</span> after <span class="code">'+n[1]+'</span><br/><br/>You should write <span class="code">'+n[1]+"()</span>";return pl.show({message:i,lineNumber:"",progtype:"karel"}),!0}return!1},Nee=function(t){var e=YT.getConditions(),r=!1,n;if(t.indexOf("randomChance")==-1&&t.indexOf("colorIs")==-1){var i=/while\s*\((.*)\)/gi,a=i.exec(t),s;a!=null&&(s=a[1].replace("()","").trim(),e.indexOf(s)==-1&&(n="You can't write: <span class='code'>"+a[0]+"</span><br/> You need to choose a valid Karel condition to go inside the while loop. Make sure your spelling and capitalization is correct.<br/><br/>These are the choices you have:<pre class='prettyprint'>"+e.join("()<br/>")+"()</pre>",r=!0));var o=/if\s*\((.*)\)/gi,c=o.exec(t);return c!=null&&(s=c[1].replace("()","").trim(),e.indexOf(s)==-1&&(n=`You can't write: <span class="code">`+c[0]+'</span><br/> You need to choose a valid Karel condition to go inside the if statement. Make sure your spelling and capitalization is correct.<br/><br/>These are the choices you have:<pre class="prettyprint">'+e.join("()<br/>")+"()</pre>",r=!0)),r&&pl.show({message:n,lineNumber:"",progtype:"karel"}),r}},Mee=function(t){for(var e=Fd.generateCodeArray(t),r=!1,n="",i="",a=new RegExp(/^\s*Function *.+\s*\(\)/m),s,o=0;o<e.length;o++)if(a.exec(e[o])){n='The function keyword must be in all lowercase. Make sure your function declaration follows the format <br/> <span class="code">function functionName(){}</span><br/>',r=!0,i=String(o+1);break}return r&&pl.show({message:n,lineNumber:i,progtype:"karel"}),r},$ee=function(t){for(var e=Fd.generateCodeArray(t),r=!1,n="",i="",a=/^function\s+([\w\$]+)\s*\(/gim,s={},o,c=0;c<e.length;c++)if(o=a.exec(e[c]),o){var l=o[1];if(l in s){n=`You've defined the function <span class="code">`+l+"</span> twice, on lines "+(c+1)+" and "+s[l]+".<br/>Remove one of the two definitions.",i=String(c+1),r=!0;break}else s[l]=c+1}return r&&pl.show({message:n,lineNumber:i,progtype:"karel"}),r},Uee=function(t){for(var e=Fd.generateCodeArray(t),r=!1,n="",i="",a=/^function\s.+\s*\(\s*\);/gim,s,o=0;o<e.length;o++)s=a.exec(e[o]),s&&(n="You have a semicolon where you define <code>"+s[0]+`</code>. 
When creating a function, you don't need a semicolon
`,i=String(o+1),r=!0);return r&&pl.show({message:n,lineNumber:i,progtype:"karel"}),r},Fee=function(t){for(var e=Fd.generateCodeArray(t),r=!1,n="",i="",a=/^\w+(?= [\$\w]+\s*\([\$\w\s,]*\)\s*{?)/gim,s,o=0;o<e.length;o++)if(s=a.exec(e[o]),s&&s[0]!=="function"){n="You misspelled <code> function </code> in your function declaration.",i=String(o+1),r=!0;break}return r&&pl.show({message:n,lineNumber:i,progtype:"karel"}),r};function Bee(t){var e,r,n,i,a,s;e=!1,r=-1,n="",a=Fd.generateCodeArray(t),s=["You need a semicolon at the end."],a.forEach(function(c,l,f){f[l]+=`
`});for(var o=0;o<a.length;o++)if(i=YT.testCommandStyle(a[o]),!i.isValid&&!_.contains(s,i.reason)){e=!0,r=o+1,n=i.reason;break}return e&&pl.show({message:n,lineNumber:r,progtype:"karel"}),e}LL.prototype.hasErrors=function(){var t=Fd.removeComments(this.code);return!!(this.checkMissingParens&&Lee(t)||this.checkUndefinedCondition&&Nee(t)||this.checkCapitalFunctionDeclaration&&Mee(t)||this.checkHasFunctionRedefinition&&$ee(t)||this.checkHasSemicolonInFunctionDef&&Uee(t)||this.checkMisspelledFunction&&Fee(t)||this.checkValidCommands&&Bee(t))};NL.exports=LL});var BL=D((nIe,FL)=>{"use strict";var qee=Nr(),$L=Ni(),UL=Lc(),jee=ML();function Hee(t,e){for(var r=UL.getBuiltIns(t,e),n=`
`,i=0;i<r.length;i++){var a=r[i];n+="function "+a+`(){
	return __karelRunner__.builtIns.`+a+`.apply(__karelRunner__, arguments);
}
`}return n}function Gee(t,e,r,n){t=$L.removeComments(t);var i=new jee({code:t,checkMissingParens:!0,checkUndefinedCondition:!0,checkInvalidFunctionDeclaration:!0,checkHasFunctionRedefinition:!0,checkHasSemicolonInFunctionDef:!0,checkMisspelledFunction:!0,checkValidCommands:n!==qee.ProgrammingLanguage.JAVA});if(i.hasErrors())return{code:t,success:!1};t=$L.makeSafeForInfiniteLoops(t),t=UL.preprocessWithLineNums({code:t,usingSuperKarel:e,usingUltraKarel:r});var a=Hee(e,r),s="";return s+=a,s+=t,s+=`

if(typeof start == 'function') {start();} `,t=s,{code:t,success:!0}}FL.exports={run:Gee}});var HL=D((aIe,jL)=>{"use strict";var qL=Nr(),Vee=B0(),hl=Lc(),Bv="#tester-message";function fh(t,e){this.editor=t,this.karelRunner=e}fh.prototype.worldsAreEquivalent=function(t,e){var r=window.pageSpecific.preferredLang,n,i;switch(r){case"es":n="<strong>\xA1Gran trabajo!</strong> \xA1Lo lograste!";break;default:n="<strong>Nice job!</strong> You got it!"}this.editor.getInfo().itemType==qL.ItemType.EXAMPLE&&(n+=' <a href="#" id="inline-next-button">Continue.</a>');var a={success:!0,message:n};if((t.rows!=e.rows||t.cols!=e.cols)&&(a.success=!1,a.message="<strong>Oops!</strong> Something's wrong here."),t.karelDir!=e.karelDir&&e.karelDir!=null&&e.karelDir!=-1){switch(r){case"es":n="<strong>\xA1Ups!</strong> Karel deber\xEDa estar mirando hacia el "+hl.dirName(e.karelDir)+"pero est\xE1 mirando hacia el "+hl.dirName(t.karelDir);break;default:n="<strong>Oops!</strong> Karel should be facing "+hl.dirName(e.karelDir)+" but is facing "+hl.dirName(t.karelDir)}a.success=!1,a.message=n}if(t.karelRow!=e.karelRow&&e.karelRow!=null){a.success=!1;var s=parseInt(t.karelRow)+1,o=parseInt(e.karelRow)+1;switch(r){case"es":i=["<strong>Ups!</strong> ","Karel deber\xEDa estar en la fila ",o.toString()," pero est\xE1 en la fila ",s.toString()];break;default:i=["<strong>Oops!</strong> ","Karel should be on row ",o.toString()," but is on row ",s.toString()]}a.message=i.join("")}if(t.karelCol!=e.karelCol&&e.karelCol!=null){a.success=!1;var c=parseInt(t.karelCol)+1,l=parseInt(e.karelCol)+1;switch(r){case"es":i=["<strong>Ups!</strong> ","Karel deber\xEDa estar en la columna ",l.toString()," pero est\xE1 en la columna ",c.toString()];break;default:i=["<strong>Oops!</strong> ","Karel should be on column ",l.toString()," but is on column ",c.toString()]}a.message=i.join("")}for(var f,g,m=0;m<t.rows;m++)for(var y=0;y<t.cols;y++){var A=t.grid.get(m,y),k=e.grid.get(m,y);if(A!=k){a.success=!1;var I=A==1?"is":"are",F=k==1?"":"s";switch(f=m+1,g=y+1,r){case"es":i="<strong>Ups!</strong> Deber\xEDa haber "+k+" pelota"+F+" en ("+f+", "+g+") pero all\xED hay "+A;break;default:i="<strong>Oops!</strong> There should be "+k+" ball"+F+" at ("+f+", "+g+") but there "+I+" "+A}a.message=i}}if(this.editor.typeTester.isUltraKarel()){var J=qL.KarelWorld.RANDOM_COLOR;for(m=0;m<t.rows;m++)for(y=0;y<t.cols;y++){var pe=t.colors.get(m,y),L=e.colors.get(m,y),H="#ffffff";pe=pe?pe.toLowerCase():H,L=L?L.toLowerCase():H;var j=Object.keys(hl.KAREL_COLOR_STRINGS_TO_HEX);j.indexOf(pe)!==-1&&(pe=hl.KAREL_COLOR_STRINGS_TO_HEX[pe].toLowerCase()),j.indexOf(L)!==-1&&(L=hl.KAREL_COLOR_STRINGS_TO_HEX[L].toLowerCase()),(L===J&&pe==H||pe!==L&&L!==J)&&(a.success=!1,f=m+1,g=y+1,a.message="<strong>Oops!</strong> The color at ("+f+", "+g+") is not the proper color.")}}return a};fh.prototype.hasError=function(){for(var t=this.karelRunner.getCommands(),e=0;e<t.length;e++)if(t[e].c<=Vee.ERROR)return!0;return!1};fh.prototype.testSolution=function(t){var e=t.autograding,r=this.karelRunner.getCurrentSolutionWorld(),n=this.karelRunner.getWorld();if(r!=null){var i=this.worldsAreEquivalent(n,r);return e||($(Bv).html(i.message),i.success?($(Bv).removeClass("gone").removeClass("alert-danger").addClass("alert-info"),this.editor.turnSubmitButtonGreen(),this.editor.karelCelebration&&this.karelRunner.celebrate(this.editor.karelCelebration)):$(Bv).removeClass("gone").removeClass("alert-info").addClass("alert-danger"),this.editor.setupSubmitButton(),this.editor.setupNextButton()),i.success=this.hasError()?!1:i.success,i}};fh.prototype.hideMessage=function(){$(Bv).addClass("gone")};jL.exports=fh});var JT=D((sIe,KL)=>{"use strict";var GL=Nr(),zL=Ni(),aa=B0(),qv=Zf(),zee=DL(),Wee=BL(),Kee=Nc(),hh=em(),Xee=_i(),Yee=xn(),Jee=mn(),ph=".sidebar-canvas",WL=0,VL=100;function cr(t){this.editor=t,this.isSuperKarel=this.editor.progTypeString=="superkarel"||this.editor.progTypeString=="java-superkarel",this.isUltraKarel=this.editor.progTypeString=="ultrakarel"||this.editor.progTypeString=="java-ultrakarel",this.onBreakpoint=!1,this.justSeenBreakpoint=-1,this.worlds=this.editor.worlds.concat(this.editor.user_worlds),this.commandIndex=0,this.inGradingMode=!1,this.paused=!1,this.firstDraw=!0,this.curWorld,this.commands=[],this.solutions=[],this.builtIns=new zee(this),this.delayTime=200,this.SPEED=t.karelSliderSpeed,this.tester=new cr.Tester(t,this)}Yee.inherits(cr,Jee);cr.Tester=HL();cr.prototype.init=function(t){if(t=t||{},$(".codehs-editor-canvas").length===0){this._publish("updateCanvas",{canvasId:-1});return}this.headless=t.headless||!1,this.__graphics__=this.headless?void 0:new hh.CodeHSGraphics({canvas:$(".codehs-editor-canvas")}),this.headless||hh.Text.giveDefaultContext(this.__graphics__),this.loadWorld(this.worlds[0]),this.setSpeed(this.SPEED/100),this.setupEvents(),this._publish("updateCanvas");var e=".ex-result-world";$(e).each(function(){qv.quickDraw($(this),$(this).attr("data-world"),360,!0)})};cr.prototype.setupEvents=function(){var t=this;$("#speed_slider").slider({slide:function(e,r){t.setSpeed(r.value/VL),r.value==VL?(t.editor.clearHighlightedLines(),t.editor.highlight=!1):t.editor.highlight=!0},stop:function(e,r){Xee.send({method:"set_karel_slider_speed",app:"editor",data:{speed:r.value}})},value:this.SPEED}),$("#karelworld").on("change",function(){var e=$(this).find(":selected");if(e.hasClass("edit-worlds"))window.location.href=$(this).val();else{var r=e.attr("data-world"),n=t.loadWorldById(r);t.updateSidebarCanvas(n)}}),setTimeout(function(){var e=$("#karelworld").find(":selected").attr("data-world"),r=t.loadWorldById(e);t.updateSidebarCanvas(r)},500)};cr.prototype.updateSidebarCanvas=function(t){var e=this,r="<canvas ";r+='class="sidebar-canvas"',r+='rel="'+$(ph).attr("rel")+'"',r+='data-placement="'+$(ph).attr("data-placement")+'"',r+='data-trigger="'+$(ph).attr("data-trigger")+'"',r+='data-content="'+$(ph).attr("data-content")+'"',r+="></canvas>",$(ph).replaceWith(r),e._publish("updateCanvas",{canvasId:t})};cr.prototype.usingSuperKarel=function(){return this.isSuperKarel};cr.prototype.usingUltraKarel=function(){return this.isUltraKarel};cr.prototype.pushCommand=function(t){this.commands.push(t)};cr.prototype.setup=function(){this.headless||(this.curWorld.draw(),this.__graphics__.redraw())};cr.prototype.reset=function(){this.commands=[],this.commandIndex=0,this.onBreakpoint=!1,this.justSeenBreakpoint=-1,this.headless||(this.curWorld.reset(),this.__graphics__.globalTimer=!1,this.__graphics__.stopTimer("celebration"),this.__graphics__.redraw()),this.tester.hideMessage()};cr.prototype.loadWorld=function(t){var e=this,r=t;this.tester.hideMessage(),this.headless||(this.__graphics__.globalTimer=!1,this.__graphics__.setSize(400,400));var n;this.editor.customKarelBall&&(n={karelBallSettings:this.editor.customKarelBall}),this.curWorld=new qv(r,this.__graphics__,n),this.curWorld=new qv(r,this.__graphics__),this.setup(),this.reset(),this.firstDraw&&(setTimeout(function(){e.reset()},500),this.firstDraw=!1)};cr.prototype.loadWorldById=function(t){for(var e=0;e<this.worlds.length;e++){var r=this.worlds[e];if(r.id==t)return this.loadWorld(r),e}return-1};cr.prototype.animateFromIndex=function(t){var e=this;this.commandIndex=t,setTimeout(function(){e.runOneStep()},this.delayTime),this.__graphics__.redraw()};cr.prototype.animate=function(){this.animateFromIndex(this.commandIndex)};cr.prototype.restart=function(){this.unpause(),this.delayTime==WL&&(this.editor.clearHighlightedLines(),this.editor.highlight=!1),this.animateFromIndex(this.commandIndex)};cr.prototype.pause=function(){this.paused=!0,this.editor.highlight=!0,this.editor.setPauseButton(this.paused)};cr.prototype.unpause=function(){this.paused=!1,this.delayTime==WL&&(this.editor.clearHighlightedLines(),this.editor.highlight=!1),this.editor.setPauseButton(this.paused)};cr.prototype.drawError=function(t){var e=this,r=t.c,n;r==aa.ERROR_NO_BEEPERS?n="No tennis balls to pick up!":r==aa.ERROR_CRASH_INTO_WALL?n="Karel Crashed into a Wall! <br>(Do you have an extra move() command?)":r==aa.INFINITE_LOOP?n="Karel is in an infinite loop!":n="Karel Error!",Kee.show({editor:this.editor,message:n,lineNumber:t.l,langType:"javascript",progtype:e.editor.progtype,log:!1})};cr.prototype.commandListGenerated=function(){return this.commands.length>0};cr.prototype.supportsBreakpoints=function(){return!0};cr.prototype.testBreakpoint=function(t){var e=this;for(var r in e.editor.breakpoints)if(e.editor.breakpoints.hasOwnProperty(r)&&e.editor.breakpoints[r].hasOwnProperty(t))if(e.onBreakpoint)e.onBreakpoint=!1;else return e.editor.breakpoints[r][t].justSeen=!0,e.editor.breakpoints[r][t].timesHit++,e.justSeenBreakpoint=t,e.pause(),e.editor.highlightLine(t),e.onBreakpoint=!0,!0;return!1};cr.prototype.runOneStep=function(){var t=this,e=this.commands[this.commandIndex];if(!(typeof e>"u")&&e.hasOwnProperty("c")){var r=e.c,n=e.l;if(t.editor.highlightLine(n),r==aa.FOR_LOOP&&e.hasOwnProperty("s")&&this.editor.showForLoopVars(e.s),!this.testBreakpoint(n)){if(r<0){this.drawError(e),this.__graphics__.redraw();return}if(this.commandIndex<this.commands.length-1&&(this.paused||setTimeout(function(){t.runOneStep()},this.delayTime)),this.curWorld.animate(e),this.paused&&t.editor.goToLine(e.l),this.commandIndex++,this.commandIndex>=this.commands.length){var i=this.tester.testSolution({autograding:!1});this.editor.finishedProgram(i);return}this.__graphics__.redraw()}}};cr.prototype.reverseOneStep=function(){var t=this;t.commandIndex-=t.commandIndex>0;var e=t.commands[t.commandIndex];if(!(typeof e>"u")&&e.hasOwnProperty("c")){var r=e.c,n=e.l;if(t.editor.highlightLine(n),r===aa.FOR_LOOP&&e.hasOwnProperty("s")&&t.editor.showForLoopVars(e.s),r<0){t.drawError(e),t.__graphics__.redraw();return}t.curWorld.animateBackwards(e),t.paused&&t.editor.goToLine(e.l),t.__graphics__.redraw()}};cr.prototype.stepForward=function(t){this.commandListGenerated()||(this.generateCommandList(t),this.curWorld.reset()),this.pause(),this.runOneStep()};cr.prototype.stepBackward=function(t){this.commandListGenerated()||(this.generateCommandList(t),this.curWorld.reset()),this.pause(),this.reverseOneStep()};cr.prototype.setSpeed=function(t){var e=2,r=800;t=e+(r-e)*t,this.delayTime=r-t};cr.prototype.generateCommandList=function(t){var e=Wee.run(t,this.isSuperKarel,this.isUltraKarel,this.editor.getProgrammingLanguage());return e.success?(this.reset(),e=zL.safeEval(e.code,this,"__karelRunner__"),this.pushCommand({c:aa.PROGRAM_COMPLETE,l:-1}),e):{hasError:!0}};cr.prototype.run=function(t,e){this.unpause();var r=e.isRunning||!1,n={result:"",hasError:!1};return r||(e.pythonCommandList?this.commands=e.pythonCommandList:n=this.generateCommandList(t)),!e.grading&&!n.hasError&&(r||this.curWorld.reset(),this.animate()),n};cr.prototype.stop=function(){this.reset(),this.editor.setRunButtonText("Run!")};cr.prototype.getCurrentSolutionWorld=function(){return this.curWorld.solution_world!==void 0?new qv(this.curWorld.solution_world):null};cr.prototype.useGraphics=function(t){this.__graphics__=t};cr.prototype.validateCondition=function(){var t=this.commands.length;return!(t>0&&this.commands[t-1]<0)};cr.prototype.getWorld=function(){return this.curWorld};cr.prototype.applyCommandsToWorld=function(t,e){return $(e).each(function(r){var n=$(this)[0],i=n.c;if(i<0||isNaN(i))return t.reset(),!0;i==aa.MOVE&&t.move(),i==aa.TURN_LEFT&&t.turnLeft(),i==aa.TURN_RIGHT&&t.turnRight(),i==aa.TURN_AROUND&&t.turnAround(),i==aa.PUT_BEEPER&&t.putBall(),i==aa.PICK_BEEPER&&t.takeBall(),i==aa.PAINT&&t.paint(n.color)}),!1};cr.prototype.setGradingMode=function(t){this.inGradingMode=t};cr.prototype.getCommands=function(){return this.commands};cr.prototype.infiniteLoopDetector=function(t){this.counter=aa.INFINITE_LOOP_COUNTER_MAX;var e=t;this.dec=function(){if(this.counter--,this.counter<=0){var r=new Error;e.pushCommand({c:aa.INFINITE_LOOP,l:zL.lineNumberFromError(r)})}return this.counter>0}};cr.prototype.celebrate=function(t){var e=this,r=this.curWorld.karel,n={dx:null,dy:null,x:null,y:null,gravity:2};function i(){var o=new hh.WebImage(r.filename);o.setRotation(r.rotation,1),n.x==null&&(n.dx=hh.Randomizer.nextInt(2,5),n.dy=hh.Randomizer.nextInt(-8,0),n.x=r.getX(),n.y=r.getY(),r.getX()>e.__graphics__.getWidth()/2&&(n.dx*=-1));var c=n.x+n.dx,l=n.y+n.dy;o.setPosition(c,l),o.setSize(r.getWidth(),r.getHeight()),e.__graphics__.add(o),o.getY()+o.getHeight()>=e.__graphics__.getHeight()?n.dy=-Math.abs(n.dy)*.9:n.dy+=n.gravity,n.x=c,n.y=l,(n.x>=e.__graphics__.getWidth()||n.x<-r.getWidth())&&(n.x=null,n.y=null)}var a={originalWidth:r.getWidth(),rotation:r.rotation,dRotation:.26,dSize:1.05};function s(){var o=a.dSize,c=a.rotation+a.dRotation;a.rotation=c,r.setRotation(c,1),r.setSize(r.getWidth()*o,r.getHeight()*o),r.getWidth()>e.__graphics__.getWidth()?a.dSize=.95:r.getWidth()<=a.originalWidth&&(a.dSize=1.05)}t===GL.KarelCelebration.SOLITAIRE?e.__graphics__.setTimer(i,20,{},"celebration"):t===GL.KarelCelebration.SPIN&&e.__graphics__.setTimer(s,40,{},"celebration")};cr.prototype.__forLoop__=function(t,e){this.pushCommand({c:aa.FOR_LOOP,l:t,s:e})};KL.exports=cr});var Hv=D((oIe,XL)=>{"use strict";var Qee=BA(),jv;Qee.DEBUG?jv="zec":jv="ze";var Zee=function(t,e){for(var r=t.split(""),n=0;n<r.length;n++)if(jv.indexOf(r[n])!==-1){console.log(e);break}},ete=jv==""?function(){}:Zee;XL.exports=ete});var gl=D((uIe,YL)=>{"use strict";var tte=".repl-terminal",rte=">>> ",ite="... ";function nte(t){t=_.defaults(t||{},{terminalSelector:tte,promptLabel:rte,continueLabel:ite,multlineCb:function(){return!1}});var e=$(t.terminalSelector);return e.length?(e=e.jqconsole(t.welcomeString?t.welcomeString+`
`:"",t.promptLabel,t.continueLabel),{writeToConsole:function(r,n){return e.Write.bind(e)(r+(n?"":`
`))},promptForInput:function(r){return e.Prompt.bind(e)(!0,r,t.multlineCb)},reset:function(){e.Reset()},clearPrompt:function(){e.AbortPrompt()}}):{writeToConsole:function(){},promptForInput:function(){},reset:function(){},clearPrompt:function(){}}}YL.exports=nte});var QL=D((cIe,JL)=>{JL.exports=function(t){var e=window.Sk.builtin.file;window.Sk.builtin.file=function(r,n,i){var a,s;if(!(this instanceof Sk.builtin.file))return new Sk.builtin.file(r,n,i);if(this.mode=n,this.name=Sk.ffi.remapToJs(r),this.closed=!1,this.name==="/dev/stdout")this.data$=Sk.builtin.none.none$,this.fileno=1;else if(this.name==="/dev/stdin")this.fileno=0;else if(this.name==="/dev/stderr")this.fileno=2;else{if(Sk.inBrowser)if(this.fileno=10,_.has(t.currentCode,r.v))this.data$=t.currentCode[r.v];else throw new Sk.builtin.IOError("[Errno 2] No such file or directory: '"+r.v+"'");else this.fileno=11,this.data$=Sk.read(r.v);this.lineList=this.data$.split(`
`),this.lineList=this.lineList.slice(0,-1);for(a in this.lineList)this.lineList[a]=this.lineList[a]+`
`;this.currentLine=0}return this.pos$=0,this.__class__=Sk.builtin.file,this},e.prototype.write=new Sk.builtin.func(function(r,n){if(r.closed)throw new Sk.builtin.ValueError("I/O operation on closed file");if(r._pos=r._pos?r._pos:0,r.fileno===1)Sk.output(Sk.ffi.remapToJs(n));else{let s=function(o,c,l){return l.slice(0,o)+c+l.slice(o+c.length)};var a=s,i=s(r._pos,n.v,r.data$);r._pos=r._pos+n.v.length,t.currentCode[r.name]=i,r.data$=i}}),window.Sk.builtin.file.prototype=e.prototype}});var Gv=D((dIe,ZL)=>{"use strict";var lIe=Hv(),QT=Nr(),ate=xn(),ste=Ni().safeSkulpt,ote=gl(),ute=mn();function nc(t,e){var r=this;e=e||{},r.editor=t,QL()(t),window.Sk.configure({inputfun:r.input.bind(r),output:r.output.bind(r),read:r.read.bind(r)}),r.replConsole=ote({welcomeString:"",promptLabel:""}),$(".jqconsole-cursor").css("visibility","hidden"),r.dontPrint=e.dontPrint||!1,r.consoleOutput=[],t.getProgramType()==QT.ProgramType.PYTHON&&($(".codehs-editor-canvas").hide(),$("#console").css("height","400px")),(t.getProgramType()==QT.ProgramType.PYTHON_CANVAS||t.getProgramType()==QT.ProgramType.PYTHON_TURTLE)&&$(".repl-terminal").css({height:"100px",width:"400px",margin:"0px 10px 10px 12px"})}ate.inherits(nc,ute);nc.prototype.getOutput=function(){return this.consoleOutput};nc.prototype.output=function(t){var e=this;this.consoleOutput.push(t),this.dontPrint||e.replConsole.writeToConsole(t,!0)};nc.prototype.read=function(t){var e=t.split("/").pop();if(window.Sk.builtinFiles.files[t])return window.Sk.builtinFiles.files[t];if(this.editor.currentCode[e])return this.editor.currentCode[e];throw"File not found: '"+t+"'"};nc.prototype.input=function(t){var e=this;return $(".jqconsole-cursor").css("visibility","visible"),e.replConsole.writeToConsole(t,!0),new Promise(function(r){return e.replConsole.promptForInput(function(n){r(n),$(".jqconsole-cursor").css("visibility","hidden")})})};nc.prototype.stop=function(t){var e=this;$(".jqconsole-cursor").css("visibility","hidden"),$("#python-canvas").html(""),e.replConsole.reset()};nc.prototype.run=function(t,e){e=e||{};var r=this;r.stop();var n=ste("<stdin>",!1,t,!0,e);return n.then(function(){r.editor.save()}),n.catch(function(i){r.consoleOutput=[]}),n};ZL.exports=nc});var eS=D((gIe,eN)=>{"use strict";var fIe=Hv(),cte=Jl(),Vv=Nr(),pIe=xn(),hIe=mn();function ZT(t){var e=this;e.editor=t,$(".js-python-tutor-run").on("click",function(){var r=t.getCode(),n=t.getProgrammingLanguage();n==Vv.ProgrammingLanguage.JAVASCRIPT&&(r+=`

// Your program starts on Step 4.`,r+=`
// These lines are required for debugging mode.
`,r+="var println = console.log;",r+="var readInt = function(){return 1;};",r+='var readLine = function(){return "";};',r+="var readFloat = function(){return 1;};",r+="var readBoolean = function(){return true;};",r+="if(typeof start == 'function') {start();} "),e.run(r)})}ZT.prototype.getPythonTutorLanguageCode=function(){var t=this.editor.getProgrammingLanguage();return t==Vv.ProgrammingLanguage.JAVASCRIPT?"js":t==Vv.ProgrammingLanguage.PYTHON?"2":t==Vv.ProgrammingLanguage.JAVA?"java":"2"};ZT.prototype.run=function(t){var e=this,r='<iframe width="1000" height="500" frameborder="0" ';r+='src="https://pythontutor.com/iframe-embed.html#code=',r+=encodeURIComponent(t),r+="&origin=opt-frontend.js&cumulative=false&heapPrimitives",r+="=false&textReferences=false&py=",r+=e.getPythonTutorLanguageCode(),r+="&rawInputLstJSON=%5B%5D",r+='&curInstr=0&codeDivWidth=450&codeDivHeight=500"> </iframe>',cte({header:"Debugging: "+window.pageSpecific.itemTitle,message:"",rawHtml:r,button:"Close",buttonClass:"btn-main",cancelButton:!1}),$(".modal-dialog").css("width","90%")};eN.exports=ZT});var gh=D((mIe,iN)=>{"use strict";var lte=Nr(),tN=Nc();function rN(t){this.editor=t}rN.prototype.check=function(t,e){var r=this;r.editor.clearHighlightedLines();var n=t.slice(0),i=t.slice(0);return dte(n,r)||pte(i,e,r)};function dte(t,e){var r=t.shift(),n="^(.*?):([\\d]+): error: (.*)",i=new RegExp(n),a=r.match(i),s;if(a){for(;a;){var o=t.shift(),c=t.shift().length,l=parseInt(a[2]);e.editor.progType==lte.ProgramType.JAVA_METHOD&&(l-=2);var f=fte(t);r=f.firstLine,t=f.output;var g=f.errorParams;s=a[1],tN.show({editor:e.editor,message:a[3],lineNumber:l,errorParams:g,fileName:s,errorLine:o,column:c,errorDisplay:"errorList",progtype:e.editor.progtype,langType:"java",log:!1}),a=r.match(i)}return!0}return!1}function fte(t){for(var e=/ {2}([\w\s]*?):\s*(.*)/,r=t.shift(),n=r.match(e),i={};n;){var a=n[1];i[a]=n[2],a=="symbol"&&(i[a]=i[a].match(/(.*?) (.*)/)[2]),r=t.shift(),n=r.match(e)}return{output:t,firstLine:r,errorParams:i}}function pte(t,e,r){var n=/Exception in thread ".*?" (.*)/,i=e.contents,a=[];i.forEach(function(k){a.push(k.name)});for(var s=a.join("|");t.length>0;){var o=t.shift(),c=o.match(n);if(c){var l=c[1],f="at .*?\\(("+s+"):([\\d]+)\\)",g=new RegExp(f,"m"),m=t.join().match(g),y=m[1],A=m[2];return tN.show({editor:r.editor,message:l,lineNumber:parseInt(A),fileName:y,errorDisplay:"errorList",progtype:r.editor.progtype,langType:"java",log:!1}),!0}}return!1}iN.exports=rN});var aN=D((yIe,nN)=>{"use strict";var sa=Cr(),hte=xn(),vIe=ui(),gte=mn(),mte=gl(),vte="wss://code.codehs.com:443/",Bd=".jqconsole-cursor",zv=".js-server-runner-message",tS="button.grade_code",rS="#grading-unit-test-run",iS="#submit-button",nS=".run_code";function gu(t,e){var r=this;r.replConsole=mte({welcomeString:"",promptLabel:""}),$(Bd).css("visibility","hidden"),r.url=vte+t,r.setState("disconnected"),r.connect(),r.output="",r.first=!0,r.delay=2e4,r.timeoutID=0,$(zv).hide(),e&&(r.errorChecker=e)}hte.inherits(gu,gte);gu.prototype.run=function(t,e){var r=e.arguments||[],n=this;sa.trigger("ProgramRun:create",{userId:e.codeUserID,itemId:e.itemID,startTime:Date.now()}),n.codeTree={name:"root"};var i=[];for(var a in t){var s={};s.name=a,s.contents=t[a],i.push(s)}n.codeTree.contents=i,n.replConsole.reset(),function c(){$(Bd).css("visibility","visible"),n.replConsole.promptForInput(function(l){n.state==="running"&&n.emit("stdin",l+`
`),c()})}(),n.setState("running"),n.output="";var o={code:n.codeTree,name:e.mainClass,args:r,itemID:e.itemID,codeUserID:e.codeUserID};return n.emit("run",o),$(zv).hide(),n.outputPromise=$.Deferred(),n.timeoutID=window.setTimeout(n.oopsMessage.bind(n),n.delay),n.outputPromise};gu.prototype.oopsMessage=function(){var t=this;t.stop(),sa.trigger("utils:switchToTab","#run-tab",".right-col-tabs",".editor-tab-content"),$(zv).show()};gu.prototype.stop=function(){var t=this;window.clearTimeout(t.timeoutID),t.replConsole.reset(),$(Bd).css("visibility","hidden"),$(zv).hide(),t.output="",t.state=="disconnected"?t.connect():t.cnx.close()};gu.prototype.setState=function(t){var e=this;switch(e.state=t,t){case"disconnected":e.running=!1,sa.trigger("utils:disableButton",nS),sa.trigger("utils:disableButton",tS),sa.trigger("utils:disableButton",iS),sa.trigger("utils:disableButton",rS);break;case"idle":e.running=!1,sa.trigger("utils:enableButton",nS),sa.trigger("utils:enableButton",tS),sa.trigger("utils:enableButton",iS),sa.trigger("utils:enableButton",rS);break;case"running":e.running=!0,sa.trigger("utils:disableButton",nS),sa.trigger("utils:disableButton",tS),sa.trigger("utils:disableButton",iS),sa.trigger("utils:disableButton",rS);break}};gu.prototype.emit=function(t,e){var r=this;r.cnx?(console.debug("Sending:",e),r.cnx.send(JSON.stringify({name:t,data:e}))):console.error("Tried to send message while disconnected!")};gu.prototype.connect=function(){var t=this,e=new WebSocket(t.url);t.cnx=e,e.onopen=function(){t.setState("idle")},e.onmessage=function(r){var n=JSON.parse(r.data),i=n.name,a=n.data;switch(i){case"running":break;case"output":window.clearTimeout(t.timeoutID),sa.trigger("ProgramRun:successful",Date.now()),t.output+=a,t.replConsole.writeToConsole(a,!0);break;case"terminated":window.clearTimeout(t.timeoutID),sa.trigger("ProgramRun:successful",Date.now());try{t.replConsole.clearPrompt()}catch{}$(Bd).css("visibility","hidden"),t.errorChecker&&t.errorChecker.check(t.getOutput(),t.codeTree),t.setState("idle"),t.outputPromise.resolve(t.getOutput()),a.exit_code===8&&t.oopsMessage();break;case"error":window.clearTimeout(t.timeoutID),t.replConsole.clearPrompt(),$(Bd).css("visibility","hidden"),console.error("Code server error: ",a);break;default:t.replConsole.clearPrompt(),$(Bd).css("visibility","hidden"),console.warn("Unhandled message from server:",n);break}},e.onclose=function(){t.setState("disconnected"),t.connect()}};gu.prototype.getOutput=function(){return this.output.split(`
`)};nN.exports=gu});var uN=D((bIe,oN)=>{"use strict";var yte=gh(),bte=em(),_te=xn(),wte=mn(),Tte=aN(),sN="__unittests__";function ac(t){var e=this;e.editor=t,e.running=!1,e.serverRunner=new Tte("java",new yte(t)),e.editor.typeTester.isJavaGraphics()&&(e.__graphics__=new bte.CodeHSGraphics({canvas:$(".codehs-editor-canvas")}))}_te.inherits(ac,wte);ac.prototype.run=function(t,e){var r=this;r.running=!0;var n=r.serverRunner.run(t,e),i=$.Deferred();return n.done(function(a){if(r.editor.typeTester.isJavaGraphics()){r.__graphics__.removeAll(),r.__graphics__.fullReset();for(var s="",o=0;o<a.length;o++){var c=a[o];_.startsWith(c,"js:")&&(s+=c.substring(3))}r.__graphics__.runCode(s)}a=a.join(""),_.includes(a,sN)&&r.serverRunner.replConsole.reset(),a=a.split(sN)[1];try{a=JSON.parse(a).tests}catch{a=[]}i.resolve(a),r.running=!1}),i};ac.prototype.stop=function(){var t=this;t.running=!1,t.serverRunner.stop(),t.editor.typeTester.isJavaGraphics()&&(t.__graphics__.removeAll(),t.__graphics__.fullReset())};ac.prototype.showLoading=function(){var t=this;t.serverRunner.showLoading()};ac.prototype.hideLoading=function(){var t=this;t.serverRunner.hideLoading()};ac.prototype.connect=function(t){var e=this;e.serverRunner.connect(t)};ac.prototype.getOutput=function(){var t=this;t.serverRunner.getOutput()};oN.exports=ac});var dN=D((_Ie,lN)=>{"use strict";var Ste=_i(),Ete=xn(),xte=mn(),cN=".elm-destination";function Wv(t){var e=this;e.running=!1,e.editor=t}Ete.inherits(Wv,xte);Wv.prototype.run=function(t){var e=this;e.stop(),e.running=!0,Ste.send({method:"compile_elm",app:"editor",type:"POST",data:{input:t},success:function(r){if(r.status==="ok"){var n=$(cN)[0],i=n.contentDocument;i.open(),i.write(r.result),i.close(),e.running=!1}}})};Wv.prototype.stop=function(){var t=this,e=$(cN)[0],r=e.contentDocument;r.open(),r.writeln(""),r.close(),t.running=!1};lN.exports=Wv});var fN=D((exports,module)=>{"use strict";var oop=xn(),BaseRunner=mn();function ProcessingRunner(){var t=this;t.running=!1,t.canvas=$(".codehs-editor-canvas")[0]}oop.inherits(ProcessingRunner,BaseRunner);ProcessingRunner.prototype.run=function(code){var self=this;self.stop(),self.running=!0;var beginning="void setup() { size(400, 480); ",end="}",wrap=beginning+code+end,compiledJs=Processing.compile(wrap),sourceCode=compiledJs.sourceCode,processingSetupFunction=eval(sourceCode);return self.instance=new Processing(self.canvas,processingSetupFunction),self.instance};ProcessingRunner.prototype.stop=function(){var t=this;t.instance!==void 0&&t.instance.exit(),t.running=!1};module.exports=ProcessingRunner});var pN=D((wIe,Cte)=>{Cte.exports=`function drawPixels() {
    \${studentCode}
}

var pixelCanvas;

/**
 * Start point for program just like our graphics programs. Setups up the
 * canvas and then runs the user's code.
 */
function start() {
    pixelCanvas = new PixelCanvas();
    drawPixels();
}

var red = '#FF0000';
var RED = '#FF0000';
var green = '#00FF00';
var GREEN = '#00FF00';
var blue = '#0000FF';
var BLUE = '#0000FF';
var yellow = '#FFFF00';
var YELLOW = '#FFFF00';
var cyan = '#00FFFF';
var CYAN = '#00FFFF';
var orange = '#FFA500';
var ORANGE = '#FFA500';
var white = '#FFFFFF';
var WHITE = '#FFFFFF';
var black = '#000000';
var BLACK = '#000000';
var gray = '#cccccc';
var GRAY = '#CCCCCC';
var grey = '#cccccc';
var GREY = '#CCCCCC';
var purple = '#9B30FF';
var PURPLE = '#9B30FF';

function PixelCanvas(){
    var LABEL_OFFSET = 20;
    var ROW_LABEL_OFFSET = 56;
    var COL_LABEL_OFFSET = -15;
    var CANVAS_BORDER_OFFSET = 30;
    var CANVAS_BORDER_WIDTH = 2;
    var canvasWidth = getWidth() - CANVAS_BORDER_OFFSET - LABEL_OFFSET * 2;
    var canvasHeight = canvasWidth;
    var canvasBorder;
    var canvas = {
        'canvas': null,
        'canvasBorder': null,
        'columnLabel': null,
        'rowLabel': null,
        'showGrid': true,
        'rows': 5,
        'cols': 5,
        'pixelSize': canvasWidth / 5,
        'gridLines': [],
        'pixels': null,
    };

    setupCanvas();

    /**
     * Sets up the initial canvas state for a user. Mainly this is just the labels.
     * and the border. Also calls redrawCanvas which handles most of the drawing
     * logic.
     */
    function setupCanvas() {
        canvas.columnLabel = new Text('Columns', '14pt Arial');
        add(canvas.columnLabel);

        canvas.rowLabel = new Text('Rows', '14pt Arial');
        canvas.rowLabel.setRotation(270);
        add(canvas.rowLabel);

        canvas.canvasBorder = new Rectangle(canvasWidth + CANVAS_BORDER_WIDTH * 2,
            canvasHeight + CANVAS_BORDER_WIDTH * 2);
        canvas.canvasBorder.setPosition(CANVAS_BORDER_OFFSET, CANVAS_BORDER_OFFSET);
        add(canvas.canvasBorder);

        redrawCanvas(true);
    }

    /**
     * Handles the redraw logic everytime we resize the board or show the grid.
     * @param  {boolean} remakeBoard - True if we've resized the board. Otherwise,
     *                                 false.
     */
    function redrawCanvas(remakeBoard) {
        // Clear out previous grid.
        for (var i = canvas.gridLines.length - 1; i >= 0; i--) {
            remove(canvas.gridLines.pop());
        }

        canvasWidth = getWidth() - CANVAS_BORDER_OFFSET - LABEL_OFFSET * 2 -
            CANVAS_BORDER_WIDTH * 2;
        canvas.pixelSize = canvasWidth / canvas.cols;
        var canvasHeight = canvas.pixelSize * canvas.rows;
        if (canvasHeight > getHeight() - CANVAS_BORDER_OFFSET) {
            canvasHeight = getHeight() - CANVAS_BORDER_OFFSET - LABEL_OFFSET * 2;
            canvas.pixelSize = canvasHeight / canvas.rows;
            canvasWidth = canvas.pixelSize * canvas.cols;
        }
        // // Canvas border
        canvas.canvasBorder.height = canvasHeight + CANVAS_BORDER_WIDTH * 2;
        canvas.canvasBorder.width = canvasWidth + CANVAS_BORDER_WIDTH * 2;

        // Row Label
        canvas.rowLabel.setPosition(LABEL_OFFSET, canvasHeight / 2 +
            ROW_LABEL_OFFSET);

        // Column Label
        canvas.columnLabel.setPosition(canvasWidth / 2 + COL_LABEL_OFFSET,
            LABEL_OFFSET);

        if (remakeBoard) {
            createBoard();
        }

        // Grid drawing
        // This should always be last!
        if (canvas.showGrid) {
            var line;
            var x1;
            var y1;
            var x2;
            var y2;
            for (var j = 1; j < canvas.rows; j++) {
                x1 = CANVAS_BORDER_OFFSET + CANVAS_BORDER_WIDTH;
                y1 = CANVAS_BORDER_OFFSET + canvas.pixelSize * j +
                    CANVAS_BORDER_WIDTH;
                x2 = canvasWidth + CANVAS_BORDER_OFFSET + CANVAS_BORDER_WIDTH;
                y2 = CANVAS_BORDER_OFFSET + canvas.pixelSize * j +
                    CANVAS_BORDER_WIDTH;
                line = new Line(x1, y1, x2, y2);
                add(line);
                canvas.gridLines.push(line);
            }

            for (var k = 1; k < canvas.cols; k++) {
                x1 = CANVAS_BORDER_OFFSET + canvas.pixelSize * k +
                    CANVAS_BORDER_WIDTH;
                y1 = CANVAS_BORDER_OFFSET + CANVAS_BORDER_WIDTH;
                x2 = CANVAS_BORDER_OFFSET + canvas.pixelSize * k +
                    CANVAS_BORDER_WIDTH;
                y2 = canvasHeight + CANVAS_BORDER_OFFSET + CANVAS_BORDER_WIDTH;
                line = new Line(x1, y1, x2, y2);
                add(line);
                canvas.gridLines.push(line);
            }
        }
    }

    /**
     * Creates the pixes that make up the board. These are then attached to the
     * canvas.
     */
    function createBoard() {
        canvas.pixels = new Grid(canvas.cols, canvas.rows);

        for (var i = 0; i < canvas.cols; i++) {
            for (var j = 0; j < canvas.rows; j++) {
                var pixel = new Rectangle(canvas.pixelSize, canvas.pixelSize);
                pixel.setPosition(CANVAS_BORDER_OFFSET + canvas.pixelSize * i + 2,
                    CANVAS_BORDER_OFFSET + canvas.pixelSize * j + 2);
                pixel.setColor(Color.WHITE);
                add(pixel);
                canvas.pixels.set(i, j, pixel);
            }
        }
    }

    /**
     * Clears the grid of all pixels. Should always be used if we're resizing the
     * grid.
     */
    function clearGrid() {
        for (var i = 0; i < canvas.cols; i++) {
            for (var j = 0; j < canvas.rows; j++) {
                remove(canvas.pixels.get(i, j));
            }
        }
    }

    //
    // Public methods
    //

    /**
     * Set's the dimensions of the pixel. This will resize the canvas.
     * @param {int} rows - The number of pixel rows.
     * @param {int} cols - The number of pixel columns.
     */
    this.setDimensions = function(rows, cols) {
        clearGrid();
        canvas.rows = rows;
        canvas.cols = cols;
        redrawCanvas(true);
    };

    /**
     * Get the number of pixel rows.
     * @return {int} - Number of pixel rows.
     */
    this.getRows = function() {
        return canvas.rows;
    };

    /**
     * Set the number of pixel rows. This will resize the canvas.
     * @param {int} rows - The new number of pixel rows.
     */
    this.setRows = function(rows) {
        clearGrid();
        canvas.rows = rows;
        redrawCanvas(true);
    };

    /**
     * Get the number of pixel columns.
     * @return {int} - Number of pixel columns.
     */
    this.getCols = function() {
        return canvas.cols;
    };

    /**
     * Set the number of pixel columns. This will resize the canvas.
     * @param {int} cols - The new number of pixel columns.
     */
    this.setCols = function(cols) {
        clearGrid();
        canvas.cols = cols;
        redrawCanvas(true);
    };

    /**
     * Set whether to show the grid lines or not.
     * @param  {boolean} bool - True means grid lines will show. False means no
     *                          gridlines.
     */
    this.showGrid = function(bool) {
        canvas.showGrid = bool;
        redrawCanvas(false);
    };

    /**
     * Set the pixel color at a particular row or column.
     * @param {int} row      - Row to set pixel color
     * @param {int} col      - Column to set pixel color
     * @param {string} color - The color to set. This can either be 'green',
     *                         '#00FF00', or Color.GREEN.
     */
    this.setPixel = function(row, col, color) {
        canvas.pixels.get(col, row).setColor(color);
    };

    /**
     * Set the pixel color at a particular row and column to an RGB value.
     * @param {int} row - Row to set pixel color
     * @param {int} col - Column to set pixel color
     * @param {int} r   - Red value of RGB color
     * @param {int} g   - Green value of RGB color
     * @param {int} b   - Blue value of RGB color
     */
    this.setPixelRGB = function(row, col, r, g, b) {
        canvas.pixels.get(col, row).setColor(Color.createFromRGB(r, g, b));
    };
}

/**
 * Sets up input checking and calls the canvas's setDimensions method.
 * @param {int} rows - The number of pixel rows.
 * @param {int} cols - The number of pixel columns.
 */
function setDimensions(rows, cols) {
    if (arguments.length !== 2) {
        throw new Error('You should pass exactly 2 arguments to <span ' +
            'class="code">setDimensions(rows, cols)</span>');
    }
    if (typeof rows !== 'number' || !isFinite(rows) || rows < 1) {
        throw new TypeError('Invalid value for <span class="code">rows' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setDimensions(rows, cols)</span>. Did you ' +
            'perform a calculation on a variable that is not a number?');
    }
    if (typeof cols !== 'number' || !isFinite(cols) || cols < 1) {
        throw new TypeError('Invalid value for <span class="code">cols' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setDimensions(rows, cols)</span>. Did you ' +
            'perform a calculation on a variable that is not a number?');
    }
    pixelCanvas.setDimensions(rows, cols);
}

/**
 * Sets up input checking and calls the canvas's getRows method.
 * @return {int} - Number of pixel rows.
 */
function getRows() {
    if (arguments.length !== 0) {
        throw new Error('You should pass no arguments to <span class="code">' +
            'getRows()</span>');
    }
    return pixelCanvas.getRows();
}

/**
 * Sets up input checking and calls the canvas's setRows method.
 * @param {int} rows - The new number of pixel rows.
 */
function setRows(rows) {
    if (arguments.length !== 1) {
        throw new Error('You should pass exactly 1 argument to <span ' +
            'class="code">setRows(rows)</span>');
    }
    if (typeof rows !== 'number' || !isFinite(rows) || rows < 1) {
        throw new TypeError('Invalid value for <span class="code">rows' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setRows(rows)</span>. Did you perform ' +
            'a calculation on a variable that is not a number?');
    }
    pixelCanvas.setRows();
}

/**
 * Sets up input checking and calls the canvas's getCols method.
 * @return {int} - Number of pixel columns.
 */
function getCols() {
    if (arguments.length !== 0) {
        throw new Error('You should pass no arguments to <span class="code">' +
            'getCols()</span>');
    }
    return pixelCanvas.getCols();
}

/**
 * Sets up input checking and calls the canvas's setCols method.
 * @param {int} cols - The new number of pixel columns.
 */
function setCols(cols) {
    if (arguments.length !== 1) {
        throw new Error('You should pass exactly 1 argument to <span ' +
            'class="code">setCols(cols)</span>');
    }
    if (typeof cols !== 'number' || !isFinite(cols) || cols < 1) {
        throw new TypeError('Invalid value for <span class="code">cols' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setCols(cols)</span>. Did you perform ' +
            'a calculation on a variable that is not a number?');
    }
    pixelCanvas.setCols(cols);
}

/**
 * Sets up input checking and calls the canvas's showGrid method.
 * @param  {boolean} bool - True means grid lines will show. False means no
 *                          gridlines.
 */
function showGrid(bool) {
    if (arguments.length !== 1) {
        throw new Error('You should pass exactly 1 argument to <span ' +
            'class="code">showGrid(bool)</span>');
    }
    if (typeof bool !== 'boolean') {
        throw new TypeError('Invalid value for <span class="code">cols' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">showGrid(cool)</span>. Did you perform ' +
            'a calculation on a variable that is not a number?');
    }
    pixelCanvas.showGrid(bool);
}

/**
 * Sets up input checking and calls the canvas's setPixel method.
 * @param {int} row      - Row to set pixel color
 * @param {int} col      - Column to set pixel color
 * @param {string} color - The color to set. This can either be 'green',
 *                         '#00FF00', or Color.GREEN.
 */
function setPixel(row, col, color) {
    if (arguments.length !== 3) {
        throw new Error('You should pass exactly 3 arguments to <span ' +
            'class="code">setPixel(row, col, color)</span>');
    }
    if (typeof row !== 'number' || !isFinite(row)) {
        throw new TypeError('Invalid value for <span class="code">row' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setPixel(row, col, color)</span>. Did you ' +
            'perform a calculation on a variable that is not a number?');
    }
    if (row < 0 || row >= pixelCanvas.getRows()) {
        throw new RangeError('Invalid value for <span class="code">row</span>' +
            ' in <span class="code">setPixel(row, col, color)</span>' +
            'Your <span class="code">row</span> must be between 0 and ' +
            (canvas.rows - 1) + '.');
    }
    if (typeof col !== 'number' || !isFinite(col)) {
        throw new TypeError('Invalid value for <span class="code">col' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setPixel(row, col, color)</span>. Did you ' +
            'perform a calculation on a variable that is not a number?');
    }
    if (col < 0 || col >= pixelCanvas.getCols()) {
        throw new RangeError('Invalid value for <span class="code">row</span>' +
            ' in <span class="code">setPixel(row, col, color)</span>' +
            'Your <span class="code">row</span> must be between 0 and ' +
            (canvas.cols - 1) + '.');
    }
    if (color === undefined) {
        throw new TypeError('Invalid color');
    }
    pixelCanvas.setPixel(row, col, color);
}

/**
 * Sets up input checking and calls the canvas's setPixelRGB method.
 * @param {int} row - Row to set pixel color
 * @param {int} col - Column to set pixel color
 * @param {int} r   - Red value of RGB color
 * @param {int} g   - Green value of RGB color
 * @param {int} b   - Blue value of RGB color
 */
function setPixelRGB(row, col, r, g, b) {
    if (arguments.length !== 5) {
        throw new Error('You should pass exactly 5 argument to <span ' +
            'class="code">setPixelRGB(row, col, r, g, b)</span>');
    }
    if (typeof row !== 'number' || !isFinite(row)) {
        throw new TypeError('Invalid value for <span class="code">row' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setPixelRGB(row, col, r, g, b)</span>. Did ' +
            'you perform a calculation on a variable that is not a number?');
    }
    if (row < 0 || row >= pixelCanvas.getRows()) {
        throw new RangeError('Invalid value for <span class="code">row</span>' +
            ' in <span class="code">setPixelRGB(row, col, r, g, b)</span>' +
            'Your <span class="code">row</span> must be between 0 and ' +
            (pixelCanvas.rows - 1) + '.');
    }
    if (typeof col !== 'number' || !isFinite(col)) {
        throw new TypeError('Invalid value for <span class="code">col' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setPixelRGB(row, col, r, g, b)</span>. Did ' +
            'you perform a calculation on a variable that is not a number?');
    }
    if (col < 0 || col >= pixelCanvas.getCols()) {
        throw new RangeError('Invalid value for <span class="code">col</span>' +
            ' in <span class="code">setPixelRGB(row, col, r, g, b)</span>' +
            'Your <span class="code">col</span> must be between 0 and ' +
            (pixelCanvas.cols - 1) + '.');
    }
    if (typeof r !== 'number' || !isFinite(r)) {
        throw new TypeError('Invalid value for <span class="code">r' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setPixelRGB(row, col, r, g, b)</span>. Did ' +
            'you perform a calculation on a variable that is not a number?');
    }
    if (r < 0 || r > 255) {
        throw new RangeError('Invalid value for <span class="code">r</span>' +
            ' in <span class="code">setPixelRGB(row, col, r, g, b)</span>' +
            'Your <span class="code">r</span> must be between 0 and 255.');
    }
    if (typeof g !== 'number' || !isFinite(g)) {
        throw new TypeError('Invalid value for <span class="code">g' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setPixelRGB(row, col, r, g, b)</span>. Did ' +
            'you perform a calculation on a variable that is not a number?');
    }
    if (g < 0 || g > 255) {
        throw new RangeError('Invalid value for <span class="code">g</span>' +
            ' in <span class="code">setPixelRGB(row, col, r, g, b)</span>' +
            'Your <span class="code">g</span> must be between 0 and 255.');
    }
    if (typeof b !== 'number' || !isFinite(b)) {
        throw new TypeError('Invalid value for <span class="code">b' +
            '</span>. Make sure you are passing finite positive numbers to ' +
            '<span class="code">setPixelRGB(row, col, r, g, b)</span>. Did ' +
            'you perform a calculation on a variable that is not a number?');
    }
    if (b < 0 || b > 255) {
        throw new RangeError('Invalid value for <span class="code">b</span>' +
            ' in <span class="code">setPixelRGB(row, col, r, g, b)</span>' +
            'Your <span class="code">b</span> must be between 0 and 255.');
    }
    pixelCanvas.setPixelRGB(row, col, r, g, b);
}
`});var gN=D((TIe,hN)=>{"use strict";var Ate=Zg(),Ite=xn(),kte=mn(),Ote=KT(),Pte=pN();function Kv(){var t=this;t.running=!1,t.graphicsRunner=new Ote}Ite.inherits(Kv,kte);Kv.prototype.run=function(t){var e=this;t=Ate(Pte,{studentCode:t}),e.graphicsRunner.run(t)};Kv.prototype.stop=function(){var t=this;t.graphicsRunner.stop()};hN.exports=Kv});var aS=D((SIe,mN)=>{var Rte=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Dte=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];mN.exports=function(e){var r=e,n=e.indexOf("["),i=e.indexOf("]");n!=-1&&i!=-1&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));for(var a=Rte.exec(e||""),s={},o=14;o--;)s[Dte[o]]=a[o]||"";return n!=-1&&i!=-1&&(s.source=r,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}});var yN=D((EIe,vN)=>{var mh=1e3,vh=mh*60,yh=vh*60,bh=yh*24,Lte=bh*365.25;vN.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Nte(t);if(r==="number"&&isNaN(t)===!1)return e.long?$te(t):Mte(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Nte(t){if(t=String(t),!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Lte;case"days":case"day":case"d":return r*bh;case"hours":case"hour":case"hrs":case"hr":case"h":return r*yh;case"minutes":case"minute":case"mins":case"min":case"m":return r*vh;case"seconds":case"second":case"secs":case"sec":case"s":return r*mh;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Mte(t){return t>=bh?Math.round(t/bh)+"d":t>=yh?Math.round(t/yh)+"h":t>=vh?Math.round(t/vh)+"m":t>=mh?Math.round(t/mh)+"s":t+"ms"}function $te(t){return Xv(t,bh,"day")||Xv(t,yh,"hour")||Xv(t,vh,"minute")||Xv(t,mh,"second")||t+" ms"}function Xv(t,e,r){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}});var wN=D((di,_N)=>{di=_N.exports=bN.debug=bN;di.coerce=Hte;di.disable=qte;di.enable=Bte;di.enabled=jte;di.humanize=yN();di.names=[];di.skips=[];di.formatters={};var Ute=0,sS;function Fte(){return di.colors[Ute++%di.colors.length]}function bN(t){function e(){}e.enabled=!1;function r(){var i=r,a=+new Date,s=a-(sS||a);i.diff=s,i.prev=sS,i.curr=a,sS=a,i.useColors==null&&(i.useColors=di.useColors()),i.color==null&&i.useColors&&(i.color=Fte());for(var o=new Array(arguments.length),c=0;c<o.length;c++)o[c]=arguments[c];o[0]=di.coerce(o[0]),typeof o[0]!="string"&&(o=["%o"].concat(o));var l=0;o[0]=o[0].replace(/%([a-z%])/g,function(g,m){if(g==="%%")return g;l++;var y=di.formatters[m];if(typeof y=="function"){var A=o[l];g=y.call(i,A),o.splice(l,1),l--}return g}),o=di.formatArgs.apply(i,o);var f=r.log||di.log||console.log.bind(console);f.apply(i,o)}r.enabled=!0;var n=di.enabled(t)?r:e;return n.namespace=t,n}function Bte(t){di.save(t);for(var e=(t||"").split(/[\s,]+/),r=e.length,n=0;n<r;n++)e[n]&&(t=e[n].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),t[0]==="-"?di.skips.push(new RegExp("^"+t.substr(1)+"$")):di.names.push(new RegExp("^"+t+"$")))}function qte(){di.enable("")}function jte(t){var e,r;for(e=0,r=di.skips.length;e<r;e++)if(di.skips[e].test(t))return!1;for(e=0,r=di.names.length;e<r;e++)if(di.names[e].test(t))return!0;return!1}function Hte(t){return t instanceof Error?t.stack||t.message:t}});var _h=D((Ta,SN)=>{Ta=SN.exports=wN();Ta.log=zte;Ta.formatArgs=Vte;Ta.save=Wte;Ta.load=TN;Ta.useColors=Gte;Ta.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:Kte();Ta.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function Gte(){return typeof document<"u"&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}Ta.formatters.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};function Vte(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+Ta.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var n=0,i=0;return t[0].replace(/%[a-z%]/g,function(a){a!=="%%"&&(n++,a==="%c"&&(i=n))}),t.splice(i,0,r),t}function zte(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function Wte(t){try{t==null?Ta.storage.removeItem("debug"):Ta.storage.debug=t}catch{}}function TN(){var t;try{return Ta.storage.debug}catch{}if(typeof process<"u"&&"env"in process)return!1}Ta.enable(TN());function Kte(){try{return window.localStorage}catch{}}});var CN=D((xIe,xN)=>{var Xte=aS(),EN=_h()("socket.io-client:url");xN.exports=Yte;function Yte(t,e){var r=t;e=e||window.location,t==null&&(t=e.protocol+"//"+e.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=e.protocol+t:t=e.host+t),/^(https?|wss?):\/\//.test(t)||(EN("protocol-less url %s",t),typeof e<"u"?t=e.protocol+"//"+t:t="https://"+t),EN("parse %s",t),r=Xte(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var n=r.host.indexOf(":")!==-1,i=n?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port,r.href=r.protocol+"://"+i+(e&&e.port===r.port?"":":"+r.port),r}});var IN=D((CIe,AN)=>{var wh=1e3,Th=wh*60,Sh=Th*60,Eh=Sh*24,Jte=Eh*365.25;AN.exports=function(t,e){return e=e||{},typeof t=="string"?Qte(t):e.long?ere(t):Zte(t)};function Qte(t){if(t=""+t,!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Jte;case"days":case"day":case"d":return r*Eh;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Sh;case"minutes":case"minute":case"mins":case"min":case"m":return r*Th;case"seconds":case"second":case"secs":case"sec":case"s":return r*wh;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r}}}}function Zte(t){return t>=Eh?Math.round(t/Eh)+"d":t>=Sh?Math.round(t/Sh)+"h":t>=Th?Math.round(t/Th)+"m":t>=wh?Math.round(t/wh)+"s":t+"ms"}function ere(t){return Yv(t,Eh,"day")||Yv(t,Sh,"hour")||Yv(t,Th,"minute")||Yv(t,wh,"second")||t+" ms"}function Yv(t,e,r){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}});var ON=D((ni,kN)=>{ni=kN.exports=ire;ni.coerce=ore;ni.disable=are;ni.enable=nre;ni.enabled=sre;ni.humanize=IN();ni.names=[];ni.skips=[];ni.formatters={};var tre=0,oS;function rre(){return ni.colors[tre++%ni.colors.length]}function ire(t){function e(){}e.enabled=!1;function r(){var i=r,a=+new Date,s=a-(oS||a);i.diff=s,i.prev=oS,i.curr=a,oS=a,i.useColors==null&&(i.useColors=ni.useColors()),i.color==null&&i.useColors&&(i.color=rre());var o=Array.prototype.slice.call(arguments);o[0]=ni.coerce(o[0]),typeof o[0]!="string"&&(o=["%o"].concat(o));var c=0;o[0]=o[0].replace(/%([a-z%])/g,function(f,g){if(f==="%%")return f;c++;var m=ni.formatters[g];if(typeof m=="function"){var y=o[c];f=m.call(i,y),o.splice(c,1),c--}return f}),typeof ni.formatArgs=="function"&&(o=ni.formatArgs.apply(i,o));var l=r.log||ni.log||console.log.bind(console);l.apply(i,o)}r.enabled=!0;var n=ni.enabled(t)?r:e;return n.namespace=t,n}function nre(t){ni.save(t);for(var e=(t||"").split(/[\s,]+/),r=e.length,n=0;n<r;n++)e[n]&&(t=e[n].replace(/\*/g,".*?"),t[0]==="-"?ni.skips.push(new RegExp("^"+t.substr(1)+"$")):ni.names.push(new RegExp("^"+t+"$")))}function are(){ni.enable("")}function sre(t){var e,r;for(e=0,r=ni.skips.length;e<r;e++)if(ni.skips[e].test(t))return!1;for(e=0,r=ni.names.length;e<r;e++)if(ni.names[e].test(t))return!0;return!1}function ore(t){return t instanceof Error?t.stack||t.message:t}});var DN=D((Sa,RN)=>{Sa=RN.exports=ON();Sa.log=lre;Sa.formatArgs=cre;Sa.save=dre;Sa.load=PN;Sa.useColors=ure;Sa.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:fre();Sa.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function ure(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}Sa.formatters.j=function(t){return JSON.stringify(t)};function cre(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+Sa.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var n=0,i=0;return t[0].replace(/%[a-z%]/g,function(a){a!=="%%"&&(n++,a==="%c"&&(i=n))}),t.splice(i,0,r),t}function lre(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function dre(t){try{t==null?Sa.storage.removeItem("debug"):Sa.storage.debug=t}catch{}}function PN(){var t;try{t=Sa.storage.debug}catch{}return t}Sa.enable(PN());function fre(){try{return window.localStorage}catch{}}});var LN=D((qd,Jv)=>{(function(){var t=typeof define=="function"&&define.amd,e={function:!0,object:!0},r=e[typeof qd]&&qd&&!qd.nodeType&&qd,n=e[typeof window]&&window||this,i=r&&e[typeof Jv]&&Jv&&!Jv.nodeType&&typeof window=="object"&&window;i&&(i.global===i||i.window===i||i.self===i)&&(n=i);function a(f,g){f||(f=n.Object()),g||(g=n.Object());var m=f.Number||n.Number,y=f.String||n.String,A=f.Object||n.Object,k=f.Date||n.Date,I=f.SyntaxError||n.SyntaxError,F=f.TypeError||n.TypeError,J=f.Math||n.Math,pe=f.JSON||n.JSON;typeof pe=="object"&&pe&&(g.stringify=pe.stringify,g.parse=pe.parse);var L=A.prototype,H=L.toString,j,X,V,ie=new k(-0xc782b5b800cec);try{ie=ie.getUTCFullYear()==-109252&&ie.getUTCMonth()===0&&ie.getUTCDate()===1&&ie.getUTCHours()==10&&ie.getUTCMinutes()==37&&ie.getUTCSeconds()==6&&ie.getUTCMilliseconds()==708}catch{}function fe(Ge){if(fe[Ge]!==V)return fe[Ge];var at;if(Ge=="bug-string-char-index")at=!1;else if(Ge=="json")at=fe("json-stringify")&&fe("json-parse");else{var Ve,Ae='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(Ge=="json-stringify"){var lt=g.stringify,Bt=typeof lt=="function"&&ie;if(Bt){(Ve=function(){return 1}).toJSON=Ve;try{Bt=lt(0)==="0"&&lt(new m)==="0"&&lt(new y)=='""'&&lt(H)===V&&lt(V)===V&&lt()===V&&lt(Ve)==="1"&&lt([Ve])=="[1]"&&lt([V])=="[null]"&&lt(null)=="null"&&lt([V,H,null])=="[null,null,null]"&&lt({a:[Ve,!0,!1,null,`\0\b
\f\r	`]})==Ae&&lt(null,Ve)==="1"&&lt([1,2],null,1)==`[
 1,
 2
]`&&lt(new k(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&lt(new k(864e13))=='"+275760-09-13T00:00:00.000Z"'&&lt(new k(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&lt(new k(-1))=='"1969-12-31T23:59:59.999Z"'}catch{Bt=!1}}at=Bt}if(Ge=="json-parse"){var ct=g.parse;if(typeof ct=="function")try{if(ct("0")===0&&!ct(!1)){Ve=ct(Ae);var _t=Ve.a.length==5&&Ve.a[0]===1;if(_t){try{_t=!ct('"	"')}catch{}if(_t)try{_t=ct("01")!==1}catch{}if(_t)try{_t=ct("1.")!==1}catch{}}}}catch{_t=!1}at=_t}}return fe[Ge]=!!at}if(!fe("json")){var Re="[object Function]",ye="[object Date]",ze="[object Number]",Ue="[object String]",de="[object Array]",Q="[object Boolean]",Fe=fe("bug-string-char-index");if(!ie)var We=J.floor,tt=[0,31,59,90,120,151,181,212,243,273,304,334],Le=function(Ge,at){return tt[at]+365*(Ge-1970)+We((Ge-1969+(at=+(at>1)))/4)-We((Ge-1901+at)/100)+We((Ge-1601+at)/400)};if((j=L.hasOwnProperty)||(j=function(Ge){var at={},Ve;return(at.__proto__=null,at.__proto__={toString:1},at).toString!=H?j=function(Ae){var lt=this.__proto__,Bt=Ae in(this.__proto__=null,this);return this.__proto__=lt,Bt}:(Ve=at.constructor,j=function(Ae){var lt=(this.constructor||Ve).prototype;return Ae in this&&!(Ae in lt&&this[Ae]===lt[Ae])}),at=null,j.call(this,Ge)}),X=function(Ge,at){var Ve=0,Ae,lt,Bt;(Ae=function(){this.valueOf=0}).prototype.valueOf=0,lt=new Ae;for(Bt in lt)j.call(lt,Bt)&&Ve++;return Ae=lt=null,Ve?Ve==2?X=function(ct,_t){var re={},te=H.call(ct)==Re,be;for(be in ct)!(te&&be=="prototype")&&!j.call(re,be)&&(re[be]=1)&&j.call(ct,be)&&_t(be)}:X=function(ct,_t){var re=H.call(ct)==Re,te,be;for(te in ct)!(re&&te=="prototype")&&j.call(ct,te)&&!(be=te==="constructor")&&_t(te);(be||j.call(ct,te="constructor"))&&_t(te)}:(lt=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],X=function(ct,_t){var re=H.call(ct)==Re,te,be,De=!re&&typeof ct.constructor!="function"&&e[typeof ct.hasOwnProperty]&&ct.hasOwnProperty||j;for(te in ct)!(re&&te=="prototype")&&De.call(ct,te)&&_t(te);for(be=lt.length;te=lt[--be];De.call(ct,te)&&_t(te));}),X(Ge,at)},!fe("json-stringify")){var Tt={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},It="000000",St=function(Ge,at){return(It+(at||0)).slice(-Ge)},Zt="\\u00",Ze=function(Ge){for(var at='"',Ve=0,Ae=Ge.length,lt=!Fe||Ae>10,Bt=lt&&(Fe?Ge.split(""):Ge);Ve<Ae;Ve++){var ct=Ge.charCodeAt(Ve);switch(ct){case 8:case 9:case 10:case 12:case 13:case 34:case 92:at+=Tt[ct];break;default:if(ct<32){at+=Zt+St(2,ct.toString(16));break}at+=lt?Bt[Ve]:Ge.charAt(Ve)}}return at+'"'},Z=function(Ge,at,Ve,Ae,lt,Bt,ct){var _t,re,te,be,De,dt,K,le,U,Ne,Ye,ft,kt,Et,Ie,Jt;try{_t=at[Ge]}catch{}if(typeof _t=="object"&&_t)if(re=H.call(_t),re==ye&&!j.call(_t,"toJSON"))if(_t>-1/0&&_t<1/0){if(Le){for(De=We(_t/864e5),te=We(De/365.2425)+1970-1;Le(te+1,0)<=De;te++);for(be=We((De-Le(te,0))/30.42);Le(te,be+1)<=De;be++);De=1+De-Le(te,be),dt=(_t%864e5+864e5)%864e5,K=We(dt/36e5)%24,le=We(dt/6e4)%60,U=We(dt/1e3)%60,Ne=dt%1e3}else te=_t.getUTCFullYear(),be=_t.getUTCMonth(),De=_t.getUTCDate(),K=_t.getUTCHours(),le=_t.getUTCMinutes(),U=_t.getUTCSeconds(),Ne=_t.getUTCMilliseconds();_t=(te<=0||te>=1e4?(te<0?"-":"+")+St(6,te<0?-te:te):St(4,te))+"-"+St(2,be+1)+"-"+St(2,De)+"T"+St(2,K)+":"+St(2,le)+":"+St(2,U)+"."+St(3,Ne)+"Z"}else _t=null;else typeof _t.toJSON=="function"&&(re!=ze&&re!=Ue&&re!=de||j.call(_t,"toJSON"))&&(_t=_t.toJSON(Ge));if(Ve&&(_t=Ve.call(at,Ge,_t)),_t===null)return"null";if(re=H.call(_t),re==Q)return""+_t;if(re==ze)return _t>-1/0&&_t<1/0?""+_t:"null";if(re==Ue)return Ze(""+_t);if(typeof _t=="object"){for(Et=ct.length;Et--;)if(ct[Et]===_t)throw F();if(ct.push(_t),Ye=[],Ie=Bt,Bt+=lt,re==de){for(kt=0,Et=_t.length;kt<Et;kt++)ft=Z(kt,_t,Ve,Ae,lt,Bt,ct),Ye.push(ft===V?"null":ft);Jt=Ye.length?lt?`[
`+Bt+Ye.join(`,
`+Bt)+`
`+Ie+"]":"["+Ye.join(",")+"]":"[]"}else X(Ae||_t,function(Nt){var Ot=Z(Nt,_t,Ve,Ae,lt,Bt,ct);Ot!==V&&Ye.push(Ze(Nt)+":"+(lt?" ":"")+Ot)}),Jt=Ye.length?lt?`{
`+Bt+Ye.join(`,
`+Bt)+`
`+Ie+"}":"{"+Ye.join(",")+"}":"{}";return ct.pop(),Jt}};g.stringify=function(Ge,at,Ve){var Ae,lt,Bt,ct;if(e[typeof at]&&at){if((ct=H.call(at))==Re)lt=at;else if(ct==de){Bt={};for(var _t=0,re=at.length,te;_t<re;te=at[_t++],ct=H.call(te),(ct==Ue||ct==ze)&&(Bt[te]=1));}}if(Ve)if((ct=H.call(Ve))==ze){if((Ve-=Ve%1)>0)for(Ae="",Ve>10&&(Ve=10);Ae.length<Ve;Ae+=" ");}else ct==Ue&&(Ae=Ve.length<=10?Ve:Ve.slice(0,10));return Z("",(te={},te[""]=Ge,te),lt,Bt,Ae,"",[])}}if(!fe("json-parse")){var me=y.fromCharCode,ke={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:`
`,102:"\f",114:"\r"},we,st,bt=function(){throw we=st=null,I()},vt=function(){for(var Ge=st,at=Ge.length,Ve,Ae,lt,Bt,ct;we<at;)switch(ct=Ge.charCodeAt(we),ct){case 9:case 10:case 13:case 32:we++;break;case 123:case 125:case 91:case 93:case 58:case 44:return Ve=Fe?Ge.charAt(we):Ge[we],we++,Ve;case 34:for(Ve="@",we++;we<at;)if(ct=Ge.charCodeAt(we),ct<32)bt();else if(ct==92)switch(ct=Ge.charCodeAt(++we),ct){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:Ve+=ke[ct],we++;break;case 117:for(Ae=++we,lt=we+4;we<lt;we++)ct=Ge.charCodeAt(we),ct>=48&&ct<=57||ct>=97&&ct<=102||ct>=65&&ct<=70||bt();Ve+=me("0x"+Ge.slice(Ae,we));break;default:bt()}else{if(ct==34)break;for(ct=Ge.charCodeAt(we),Ae=we;ct>=32&&ct!=92&&ct!=34;)ct=Ge.charCodeAt(++we);Ve+=Ge.slice(Ae,we)}if(Ge.charCodeAt(we)==34)return we++,Ve;bt();default:if(Ae=we,ct==45&&(Bt=!0,ct=Ge.charCodeAt(++we)),ct>=48&&ct<=57){for(ct==48&&(ct=Ge.charCodeAt(we+1),ct>=48&&ct<=57)&&bt(),Bt=!1;we<at&&(ct=Ge.charCodeAt(we),ct>=48&&ct<=57);we++);if(Ge.charCodeAt(we)==46){for(lt=++we;lt<at&&(ct=Ge.charCodeAt(lt),ct>=48&&ct<=57);lt++);lt==we&&bt(),we=lt}if(ct=Ge.charCodeAt(we),ct==101||ct==69){for(ct=Ge.charCodeAt(++we),(ct==43||ct==45)&&we++,lt=we;lt<at&&(ct=Ge.charCodeAt(lt),ct>=48&&ct<=57);lt++);lt==we&&bt(),we=lt}return+Ge.slice(Ae,we)}if(Bt&&bt(),Ge.slice(we,we+4)=="true")return we+=4,!0;if(Ge.slice(we,we+5)=="false")return we+=5,!1;if(Ge.slice(we,we+4)=="null")return we+=4,null;bt()}return"$"},Ee=function(Ge){var at,Ve;if(Ge=="$"&&bt(),typeof Ge=="string"){if((Fe?Ge.charAt(0):Ge[0])=="@")return Ge.slice(1);if(Ge=="["){for(at=[];Ge=vt(),Ge!="]";Ve||(Ve=!0))Ve&&(Ge==","?(Ge=vt(),Ge=="]"&&bt()):bt()),Ge==","&&bt(),at.push(Ee(Ge));return at}else if(Ge=="{"){for(at={};Ge=vt(),Ge!="}";Ve||(Ve=!0))Ve&&(Ge==","?(Ge=vt(),Ge=="}"&&bt()):bt()),(Ge==","||typeof Ge!="string"||(Fe?Ge.charAt(0):Ge[0])!="@"||vt()!=":")&&bt(),at[Ge.slice(1)]=Ee(vt());return at}bt()}return Ge},He=function(Ge,at,Ve){var Ae=zt(Ge,at,Ve);Ae===V?delete Ge[at]:Ge[at]=Ae},zt=function(Ge,at,Ve){var Ae=Ge[at],lt;if(typeof Ae=="object"&&Ae)if(H.call(Ae)==de)for(lt=Ae.length;lt--;)He(Ae,lt,Ve);else X(Ae,function(Bt){He(Ae,Bt,Ve)});return Ve.call(Ge,at,Ae)};g.parse=function(Ge,at){var Ve,Ae;return we=0,st=""+Ge,Ve=Ee(vt()),vt()!="$"&&bt(),we=st=null,at&&H.call(at)==Re?zt((Ae={},Ae[""]=Ve,Ae),"",at):Ve}}}return g.runInContext=a,g}if(r&&!t)a(n,r);else{var s=n.JSON,o=n.JSON3,c=!1,l=a(n,n.JSON3={noConflict:function(){return c||(c=!0,n.JSON=s,n.JSON3=o,s=o=null),l}});n.JSON={parse:l.parse,stringify:l.stringify}}t&&define(function(){return l})}).call(qd)});var MN=D((AIe,NN)=>{NN.exports=as;function as(t){if(t)return pre(t)}function pre(t){for(var e in as.prototype)t[e]=as.prototype[e];return t}as.prototype.on=as.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks[t]=this._callbacks[t]||[]).push(e),this};as.prototype.once=function(t,e){var r=this;this._callbacks=this._callbacks||{};function n(){r.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};as.prototype.off=as.prototype.removeListener=as.prototype.removeAllListeners=as.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks[t];if(!r)return this;if(arguments.length==1)return delete this._callbacks[t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return this};as.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks[t];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};as.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks[t]||[]};as.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var UN=D((IIe,$N)=>{$N.exports=Array.isArray||function(t){return Object.prototype.toString.call(t)=="[object Array]"}});var uS=D((kIe,FN)=>{FN.exports=hre;function hre(t){return window.Buffer&&window.Buffer.isBuffer(t)||window.ArrayBuffer&&t instanceof ArrayBuffer}});var qN=D(Qv=>{var cS=UN(),BN=uS();Qv.deconstructPacket=function(t){var e=[],r=t.data;function n(a){if(!a)return a;if(BN(a)){var s={_placeholder:!0,num:e.length};return e.push(a),s}else if(cS(a)){for(var o=new Array(a.length),c=0;c<a.length;c++)o[c]=n(a[c]);return o}else if(typeof a=="object"&&!(a instanceof Date)){var o={};for(var l in a)o[l]=n(a[l]);return o}return a}var i=t;return i.data=n(r),i.attachments=e.length,{packet:i,buffers:e}};Qv.reconstructPacket=function(t,e){var r=0;function n(i){if(i&&i._placeholder){var a=e[i.num];return a}else if(cS(i)){for(var s=0;s<i.length;s++)i[s]=n(i[s]);return i}else if(i&&typeof i=="object"){for(var o in i)i[o]=n(i[o]);return i}return i}return t.data=n(t.data),t.attachments=void 0,t};Qv.removeBlobs=function(t,e){function r(a,s,o){if(!a)return a;if(window.Blob&&a instanceof Blob||window.File&&a instanceof File){n++;var c=new FileReader;c.onload=function(){o?o[s]=this.result:i=this.result,--n||e(i)},c.readAsArrayBuffer(a)}else if(cS(a))for(var l=0;l<a.length;l++)r(a[l],l,a);else if(a&&typeof a=="object"&&!BN(a))for(var f in a)r(a[f],f,a)}var n=0,i=t;r(i),n||e(i)}});var ey=D(zi=>{var dS=DN()("socket.io-parser"),jN=LN(),gre=MN(),lS=qN(),mre=uS();zi.protocol=4;zi.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"];zi.CONNECT=0;zi.DISCONNECT=1;zi.EVENT=2;zi.ACK=3;zi.ERROR=4;zi.BINARY_EVENT=5;zi.BINARY_ACK=6;zi.Encoder=HN;zi.Decoder=Zv;function HN(){}HN.prototype.encode=function(t,e){if(dS("encoding packet %j",t),zi.BINARY_EVENT==t.type||zi.BINARY_ACK==t.type)vre(t,e);else{var r=GN(t);e([r])}};function GN(t){var e="",r=!1;return e+=t.type,(zi.BINARY_EVENT==t.type||zi.BINARY_ACK==t.type)&&(e+=t.attachments,e+="-"),t.nsp&&t.nsp!="/"&&(r=!0,e+=t.nsp),t.id!=null&&(r&&(e+=",",r=!1),e+=t.id),t.data!=null&&(r&&(e+=","),e+=jN.stringify(t.data)),dS("encoded %j as %s",t,e),e}function vre(t,e){function r(n){var i=lS.deconstructPacket(n),a=GN(i.packet),s=i.buffers;s.unshift(a),e(s)}lS.removeBlobs(t,r)}function Zv(){this.reconstructor=null}gre(Zv.prototype);Zv.prototype.add=function(t){var e;if(typeof t=="string")e=yre(t),zi.BINARY_EVENT==e.type||zi.BINARY_ACK==e.type?(this.reconstructor=new fS(e),this.reconstructor.reconPack.attachments===0&&this.emit("decoded",e)):this.emit("decoded",e);else if(mre(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,this.emit("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)};function yre(t){var e={},r=0;if(e.type=Number(t.charAt(0)),zi.types[e.type]==null)return VN();if(zi.BINARY_EVENT==e.type||zi.BINARY_ACK==e.type){for(var n="";t.charAt(++r)!="-"&&(n+=t.charAt(r),r!=t.length););if(n!=Number(n)||t.charAt(r)!="-")throw new Error("Illegal attachments");e.attachments=Number(n)}if(t.charAt(r+1)=="/")for(e.nsp="";++r;){var i=t.charAt(r);if(i==","||(e.nsp+=i,r==t.length))break}else e.nsp="/";var a=t.charAt(r+1);if(a!==""&&Number(a)==a){for(e.id="";++r;){var i=t.charAt(r);if(i==null||Number(i)!=i){--r;break}if(e.id+=t.charAt(r),r==t.length)break}e.id=Number(e.id)}return t.charAt(++r)&&(e=bre(e,t.substr(r))),dS("decoded %s as %j",t,e),e}function bre(t,e){try{t.data=jN.parse(e)}catch{return VN()}return t}Zv.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};function fS(t){this.reconPack=t,this.buffers=[]}fS.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length==this.reconPack.attachments){var e=lS.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null};fS.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]};function VN(t){return{type:zi.ERROR,data:"parser error"}}});var zN=D((RIe,pS)=>{try{pS.exports=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{pS.exports=!1}});var ty=D((DIe,WN)=>{var _re=zN();WN.exports=function(t){var e=t.xdomain,r=t.xscheme,n=t.enablesXDR;try{if(typeof XMLHttpRequest<"u"&&(!e||_re))return new XMLHttpRequest}catch{}try{if(typeof XDomainRequest<"u"&&!r&&n)return new XDomainRequest}catch{}if(!e)try{return new window[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}});var XN=D((LIe,KN)=>{KN.exports=Object.keys||function(e){var r=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&r.push(i);return r}});var JN=D((NIe,YN)=>{YN.exports=Array.isArray||function(t){return Object.prototype.toString.call(t)=="[object Array]"}});var hS=D((MIe,QN)=>{var wre=JN();QN.exports=Tre;function Tre(t){function e(r){if(!r)return!1;if(window.Buffer&&window.Buffer.isBuffer&&window.Buffer.isBuffer(r)||window.ArrayBuffer&&r instanceof ArrayBuffer||window.Blob&&r instanceof Blob||window.File&&r instanceof File)return!0;if(wre(r)){for(var n=0;n<r.length;n++)if(e(r[n]))return!0}else if(r&&typeof r=="object"){r.toJSON&&typeof r.toJSON=="function"&&(r=r.toJSON());for(var i in r)if(Object.prototype.hasOwnProperty.call(r,i)&&e(r[i]))return!0}return!1}return e(t)}});var eM=D(($Ie,ZN)=>{ZN.exports=function(t,e,r){var n=t.byteLength;if(e=e||0,r=r||n,t.slice)return t.slice(e,r);if(e<0&&(e+=n),r<0&&(r+=n),r>n&&(r=n),e>=n||e>=r||n===0)return new ArrayBuffer(0);for(var i=new Uint8Array(t),a=new Uint8Array(r-e),s=e,o=0;s<r;s++,o++)a[o]=i[s];return a.buffer}});var rM=D((UIe,tM)=>{tM.exports=Sre;function Sre(t,e,r){var n=!1;return r=r||Ere,i.count=t,t===0?e():i;function i(a,s){if(i.count<=0)throw new Error("after called too many times");--i.count,a?(n=!0,e(a),e=r):i.count===0&&!n&&e(null,s)}}function Ere(){}});var iM=D((ry,xh)=>{(function(t){var e=typeof ry=="object"&&ry,r=typeof xh=="object"&&xh&&xh.exports==e&&xh,n=typeof window=="object"&&window;(n.global===n||n.window===n)&&(t=n);var i=String.fromCharCode;function a(L){for(var H=[],j=0,X=L.length,V,ie;j<X;)V=L.charCodeAt(j++),V>=55296&&V<=56319&&j<X?(ie=L.charCodeAt(j++),(ie&64512)==56320?H.push(((V&1023)<<10)+(ie&1023)+65536):(H.push(V),j--)):H.push(V);return H}function s(L){for(var H=L.length,j=-1,X,V="";++j<H;)X=L[j],X>65535&&(X-=65536,V+=i(X>>>10&1023|55296),X=56320|X&1023),V+=i(X);return V}function o(L,H){return i(L>>H&63|128)}function c(L){if((L&4294967168)==0)return i(L);var H="";return(L&4294965248)==0?H=i(L>>6&31|192):(L&4294901760)==0?(H=i(L>>12&15|224),H+=o(L,6)):(L&4292870144)==0&&(H=i(L>>18&7|240),H+=o(L,12),H+=o(L,6)),H+=i(L&63|128),H}function l(L){for(var H=a(L),j=H.length,X=-1,V,ie="";++X<j;)V=H[X],ie+=c(V);return ie}function f(){if(A>=y)throw Error("Invalid byte index");var L=m[A]&255;if(A++,(L&192)==128)return L&63;throw Error("Invalid continuation byte")}function g(){var L,H,j,X,V;if(A>y)throw Error("Invalid byte index");if(A==y)return!1;if(L=m[A]&255,A++,(L&128)==0)return L;if((L&224)==192){var H=f();if(V=(L&31)<<6|H,V>=128)return V;throw Error("Invalid continuation byte")}if((L&240)==224){if(H=f(),j=f(),V=(L&15)<<12|H<<6|j,V>=2048)return V;throw Error("Invalid continuation byte")}if((L&248)==240&&(H=f(),j=f(),X=f(),V=(L&15)<<18|H<<12|j<<6|X,V>=65536&&V<=1114111))return V;throw Error("Invalid WTF-8 detected")}var m,y,A;function k(L){m=a(L),y=m.length,A=0;for(var H=[],j;(j=g())!==!1;)H.push(j);return s(H)}var I={version:"1.0.0",encode:l,decode:k};if(typeof define=="function"&&typeof define.amd=="object"&&define.amd)define(function(){return I});else if(e&&!e.nodeType)if(r)r.exports=I;else{var F={},J=F.hasOwnProperty;for(var pe in I)J.call(I,pe)&&(e[pe]=I[pe])}else t.wtf8=I})(ry)});var nM=D(gS=>{(function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),r=0;r<t.length;r++)e[t.charCodeAt(r)]=r;gS.encode=function(n){var i=new Uint8Array(n),a,s=i.length,o="";for(a=0;a<s;a+=3)o+=t[i[a]>>2],o+=t[(i[a]&3)<<4|i[a+1]>>4],o+=t[(i[a+1]&15)<<2|i[a+2]>>6],o+=t[i[a+2]&63];return s%3===2?o=o.substring(0,o.length-1)+"=":s%3===1&&(o=o.substring(0,o.length-2)+"=="),o},gS.decode=function(n){var i=n.length*.75,a=n.length,s,o=0,c,l,f,g;n[n.length-1]==="="&&(i--,n[n.length-2]==="="&&i--);var m=new ArrayBuffer(i),y=new Uint8Array(m);for(s=0;s<a;s+=4)c=e[n.charCodeAt(s)],l=e[n.charCodeAt(s+1)],f=e[n.charCodeAt(s+2)],g=e[n.charCodeAt(s+3)],y[o++]=c<<2|l>>4,y[o++]=(l&15)<<4|f>>2,y[o++]=(f&3)<<6|g&63;return m}})()});var uM=D((BIe,oM)=>{var iy=window.BlobBuilder||window.WebKitBlobBuilder||window.MSBlobBuilder||window.MozBlobBuilder,aM=function(){try{var t=new Blob(["hi"]);return t.size===2}catch{return!1}}(),xre=aM&&function(){try{var t=new Blob([new Uint8Array([1,2])]);return t.size===2}catch{return!1}}(),Cre=iy&&iy.prototype.append&&iy.prototype.getBlob;function sM(t){for(var e=0;e<t.length;e++){var r=t[e];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var i=new Uint8Array(r.byteLength);i.set(new Uint8Array(n,r.byteOffset,r.byteLength)),n=i.buffer}t[e]=n}}}function Are(t,e){e=e||{};var r=new iy;sM(t);for(var n=0;n<t.length;n++)r.append(t[n]);return e.type?r.getBlob(e.type):r.getBlob()}function Ire(t,e){return sM(t),new Blob(t,e||{})}oM.exports=function(){return aM?xre?window.Blob:Ire:Cre?Are:void 0}()});var ml=D(ai=>{var kre=XN(),Ore=hS(),ny=eM(),Pre=rM(),cM=iM(),mS;window&&window.ArrayBuffer&&(mS=nM());var Rre=typeof navigator<"u"&&/Android/i.test(navigator.userAgent),Dre=typeof navigator<"u"&&/PhantomJS/i.test(navigator.userAgent),lM=Rre||Dre;ai.protocol=3;var ay=ai.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},Ch=kre(ay),Gs={type:"error",data:"parser error"},Vs=uM();ai.encodePacket=function(t,e,r,n){typeof e=="function"&&(n=e,e=!1),typeof r=="function"&&(n=r,r=null);var i=t.data===void 0?void 0:t.data.buffer||t.data;if(window.ArrayBuffer&&i instanceof ArrayBuffer)return Nre(t,e,n);if(Vs&&i instanceof window.Blob)return $re(t,e,n);if(i&&i.base64)return Lre(t,n);var a=ay[t.type];return t.data!==void 0&&(a+=r?cM.encode(String(t.data)):String(t.data)),n(""+a)};function Lre(t,e){var r="b"+ai.packets[t.type]+t.data.data;return e(r)}function Nre(t,e,r){if(!e)return ai.encodeBase64Packet(t,r);var n=t.data,i=new Uint8Array(n),a=new Uint8Array(1+n.byteLength);a[0]=ay[t.type];for(var s=0;s<i.length;s++)a[s+1]=i[s];return r(a.buffer)}function Mre(t,e,r){if(!e)return ai.encodeBase64Packet(t,r);var n=new FileReader;return n.onload=function(){t.data=n.result,ai.encodePacket(t,e,!0,r)},n.readAsArrayBuffer(t.data)}function $re(t,e,r){if(!e)return ai.encodeBase64Packet(t,r);if(lM)return Mre(t,e,r);var n=new Uint8Array(1);n[0]=ay[t.type];var i=new Vs([n.buffer,t.data]);return r(i)}ai.encodeBase64Packet=function(t,e){var r="b"+ai.packets[t.type];if(Vs&&t.data instanceof window.Blob){var n=new FileReader;return n.onload=function(){var c=n.result.split(",")[1];e(r+c)},n.readAsDataURL(t.data)}var i;try{i=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch{for(var a=new Uint8Array(t.data),s=new Array(a.length),o=0;o<a.length;o++)s[o]=a[o];i=String.fromCharCode.apply(null,s)}return r+=window.btoa(i),e(r)};ai.decodePacket=function(t,e,r){if(t===void 0)return Gs;if(typeof t=="string"){if(t.charAt(0)=="b")return ai.decodeBase64Packet(t.substr(1),e);if(r&&(t=Ure(t),t===!1))return Gs;var i=t.charAt(0);return Number(i)!=i||!Ch[i]?Gs:t.length>1?{type:Ch[i],data:t.substring(1)}:{type:Ch[i]}}var n=new Uint8Array(t),i=n[0],a=ny(t,1);return Vs&&e==="blob"&&(a=new Vs([a])),{type:Ch[i],data:a}};function Ure(t){try{t=cM.decode(t)}catch{return!1}return t}ai.decodeBase64Packet=function(t,e){var r=Ch[t.charAt(0)];if(!mS)return{type:r,data:{base64:!0,data:t.substr(1)}};var n=mS.decode(t.substr(1));return e==="blob"&&Vs&&(n=new Vs([n])),{type:r,data:n}};ai.encodePayload=function(t,e,r){typeof e=="function"&&(r=e,e=null);var n=Ore(t);if(e&&n)return Vs&&!lM?ai.encodePayloadAsBlob(t,r):ai.encodePayloadAsArrayBuffer(t,r);if(!t.length)return r("0:");function i(s){return s.length+":"+s}function a(s,o){ai.encodePacket(s,n?e:!1,!0,function(c){o(null,i(c))})}vS(t,a,function(s,o){return r(o.join(""))})};function vS(t,e,r){for(var n=new Array(t.length),i=Pre(t.length,r),a=function(o,c,l){e(c,function(f,g){n[o]=g,l(f,n)})},s=0;s<t.length;s++)a(s,t[s],i)}ai.decodePayload=function(t,e,r){if(typeof t!="string")return ai.decodePayloadAsBinary(t,e,r);typeof e=="function"&&(r=e,e=null);var n;if(t=="")return r(Gs,0,1);for(var i="",a,s,o=0,c=t.length;o<c;o++){var l=t.charAt(o);if(l!=":")i+=l;else{if(i==""||i!=(a=Number(i))||(s=t.substr(o+1,a),i!=s.length))return r(Gs,0,1);if(s.length){if(n=ai.decodePacket(s,e,!0),Gs.type==n.type&&Gs.data==n.data)return r(Gs,0,1);var f=r(n,o+a,c);if(f===!1)return}o+=a,i=""}}if(i!="")return r(Gs,0,1)};ai.encodePayloadAsArrayBuffer=function(t,e){if(!t.length)return e(new ArrayBuffer(0));function r(n,i){ai.encodePacket(n,!0,!0,function(a){return i(null,a)})}vS(t,r,function(n,i){var a=i.reduce(function(c,l){var f;return typeof l=="string"?f=l.length:f=l.byteLength,c+f.toString().length+f+2},0),s=new Uint8Array(a),o=0;return i.forEach(function(c){var l=typeof c=="string",f=c;if(l){for(var y=new Uint8Array(c.length),g=0;g<c.length;g++)y[g]=c.charCodeAt(g);f=y.buffer}l?s[o++]=0:s[o++]=1;for(var m=f.byteLength.toString(),g=0;g<m.length;g++)s[o++]=parseInt(m[g]);s[o++]=255;for(var y=new Uint8Array(f),g=0;g<y.length;g++)s[o++]=y[g]}),e(s.buffer)})};ai.encodePayloadAsBlob=function(t,e){function r(n,i){ai.encodePacket(n,!0,!0,function(a){var s=new Uint8Array(1);if(s[0]=1,typeof a=="string"){for(var o=new Uint8Array(a.length),c=0;c<a.length;c++)o[c]=a.charCodeAt(c);a=o.buffer,s[0]=0}for(var l=a instanceof ArrayBuffer?a.byteLength:a.size,f=l.toString(),g=new Uint8Array(f.length+1),c=0;c<f.length;c++)g[c]=parseInt(f[c]);if(g[f.length]=255,Vs){var m=new Vs([s.buffer,g.buffer,a]);i(null,m)}})}vS(t,r,function(n,i){return e(new Vs(i))})};ai.decodePayloadAsBinary=function(t,e,r){typeof e=="function"&&(r=e,e=null);for(var n=t,i=[],a=!1;n.byteLength>0;){for(var s=new Uint8Array(n),o=s[0]===0,c="",l=1;s[l]!=255;l++){if(c.length>310){a=!0;break}c+=s[l]}if(a)return r(Gs,0,1);n=ny(n,2+c.length),c=parseInt(c);var f=ny(n,0,c);if(o)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch{var g=new Uint8Array(f);f="";for(var l=0;l<g.length;l++)f+=String.fromCharCode(g[l])}i.push(f),n=ny(n,c)}var m=i.length;i.forEach(function(y,A){r(ai.decodePacket(y,e,!0),A,m)})}});var sy=D((jIe,yS)=>{typeof yS<"u"&&(yS.exports=ss);function ss(t){if(t)return Fre(t)}function Fre(t){for(var e in ss.prototype)t[e]=ss.prototype[e];return t}ss.prototype.on=ss.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};ss.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};ss.prototype.off=ss.prototype.removeListener=ss.prototype.removeAllListeners=ss.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return this};ss.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};ss.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};ss.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var oy=D((HIe,dM)=>{var Bre=ml(),qre=sy();dM.exports=_o;function _o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}qre(_o.prototype);_o.prototype.onError=function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,this.emit("error",r),this};_o.prototype.open=function(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this};_o.prototype.close=function(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this};_o.prototype.send=function(t){if(this.readyState==="open")this.write(t);else throw new Error("Transport not open")};_o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")};_o.prototype.onData=function(t){var e=Bre.decodePacket(t,this.socket.binaryType);this.onPacket(e)};_o.prototype.onPacket=function(t){this.emit("packet",t)};_o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}});var uy=D(bS=>{bS.encode=function(t){var e="";for(var r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e};bS.decode=function(t){for(var e={},r=t.split("&"),n=0,i=r.length;n<i;n++){var a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}});var Ah=D((VIe,fM)=>{fM.exports=function(t,e){var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}});var TS=D((zIe,vM)=>{"use strict";var gM="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),cy=64,mM={},pM=0,sc=0,hM;function _S(t){var e="";do e=gM[t%cy]+e,t=Math.floor(t/cy);while(t>0);return e}function jre(t){var e=0;for(sc=0;sc<t.length;sc++)e=e*cy+mM[t.charAt(sc)];return e}function wS(){var t=_S(+new Date);return t!==hM?(pM=0,hM=t):t+"."+_S(pM++)}for(;sc<cy;sc++)mM[gM[sc]]=sc;wS.encode=_S;wS.decode=jre;vM.exports=wS});var bM=D((WIe,yM)=>{var Ih=1e3,kh=Ih*60,Oh=kh*60,Ph=Oh*24,Hre=Ph*365.25;yM.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Gre(t);if(r==="number"&&isNaN(t)===!1)return e.long?zre(t):Vre(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Gre(t){if(t=String(t),!(t.length>1e4)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Hre;case"days":case"day":case"d":return r*Ph;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Oh;case"minutes":case"minute":case"mins":case"min":case"m":return r*kh;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ih;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Vre(t){return t>=Ph?Math.round(t/Ph)+"d":t>=Oh?Math.round(t/Oh)+"h":t>=kh?Math.round(t/kh)+"m":t>=Ih?Math.round(t/Ih)+"s":t+"ms"}function zre(t){return ly(t,Ph,"day")||ly(t,Oh,"hour")||ly(t,kh,"minute")||ly(t,Ih,"second")||t+" ms"}function ly(t,e,r){if(!(t<e))return t<e*1.5?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}});var TM=D((fi,wM)=>{fi=wM.exports=_M.debug=_M;fi.coerce=Qre;fi.disable=Yre;fi.enable=Xre;fi.enabled=Jre;fi.humanize=bM();fi.names=[];fi.skips=[];fi.formatters={};var Wre=0,SS;function Kre(){return fi.colors[Wre++%fi.colors.length]}function _M(t){function e(){}e.enabled=!1;function r(){var i=r,a=+new Date,s=a-(SS||a);i.diff=s,i.prev=SS,i.curr=a,SS=a,i.useColors==null&&(i.useColors=fi.useColors()),i.color==null&&i.useColors&&(i.color=Kre());for(var o=new Array(arguments.length),c=0;c<o.length;c++)o[c]=arguments[c];o[0]=fi.coerce(o[0]),typeof o[0]!="string"&&(o=["%o"].concat(o));var l=0;o[0]=o[0].replace(/%([a-z%])/g,function(g,m){if(g==="%%")return g;l++;var y=fi.formatters[m];if(typeof y=="function"){var A=o[l];g=y.call(i,A),o.splice(l,1),l--}return g}),o=fi.formatArgs.apply(i,o);var f=r.log||fi.log||console.log.bind(console);f.apply(i,o)}r.enabled=!0;var n=fi.enabled(t)?r:e;return n.namespace=t,n}function Xre(t){fi.save(t);for(var e=(t||"").split(/[\s,]+/),r=e.length,n=0;n<r;n++)e[n]&&(t=e[n].replace(/[\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*?"),t[0]==="-"?fi.skips.push(new RegExp("^"+t.substr(1)+"$")):fi.names.push(new RegExp("^"+t+"$")))}function Yre(){fi.enable("")}function Jre(t){var e,r;for(e=0,r=fi.skips.length;e<r;e++)if(fi.skips[e].test(t))return!1;for(e=0,r=fi.names.length;e<r;e++)if(fi.names[e].test(t))return!0;return!1}function Qre(t){return t instanceof Error?t.stack||t.message:t}});var Rh=D((Ea,EM)=>{Ea=EM.exports=TM();Ea.log=tie;Ea.formatArgs=eie;Ea.save=rie;Ea.load=SM;Ea.useColors=Zre;Ea.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:iie();Ea.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function Zre(){return typeof document<"u"&&"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}Ea.formatters.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};function eie(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+Ea.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var n=0,i=0;return t[0].replace(/%[a-z%]/g,function(a){a!=="%%"&&(n++,a==="%c"&&(i=n))}),t.splice(i,0,r),t}function tie(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function rie(t){try{t==null?Ea.storage.removeItem("debug"):Ea.storage.debug=t}catch{}}function SM(){var t;try{return Ea.storage.debug}catch{}if(typeof process<"u"&&"env"in process)return!1}Ea.enable(SM());function iie(){try{return window.localStorage}catch{}}});var ES=D((KIe,AM)=>{var xM=oy(),nie=uy(),CM=ml(),aie=Ah(),sie=TS(),zs=Rh()("engine.io-client:polling");AM.exports=wo;var oie=function(){var t=ty(),e=new t({xdomain:!1});return e.responseType!=null}();function wo(t){var e=t&&t.forceBase64;(!oie||e)&&(this.supportsBinary=!1),xM.call(this,t)}aie(wo,xM);wo.prototype.name="polling";wo.prototype.doOpen=function(){this.poll()};wo.prototype.pause=function(t){var e=this;this.readyState="pausing";function r(){zs("paused"),e.readyState="paused",t()}if(this.polling||!this.writable){var n=0;this.polling&&(zs("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){zs("pre-pause polling complete"),--n||r()})),this.writable||(zs("we are currently writing - waiting to pause"),n++,this.once("drain",function(){zs("pre-pause writing complete"),--n||r()}))}else r()};wo.prototype.poll=function(){zs("polling"),this.polling=!0,this.doPoll(),this.emit("poll")};wo.prototype.onData=function(t){var e=this;zs("polling got data %s",t);var r=function(n,i,a){if(e.readyState==="opening"&&e.onOpen(),n.type==="close")return e.onClose(),!1;e.onPacket(n)};CM.decodePayload(t,this.socket.binaryType,r),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():zs('ignoring poll - transport state "%s"',this.readyState))};wo.prototype.doClose=function(){var t=this;function e(){zs("writing close packet"),t.write([{type:"close"}])}this.readyState==="open"?(zs("transport open - closing"),e()):(zs("transport not open - deferring close"),this.once("open",e))};wo.prototype.write=function(t){var e=this;this.writable=!1;var r=function(){e.writable=!0,e.emit("drain")};CM.encodePayload(t,this.supportsBinary,function(n){e.doWrite(n,r)})};wo.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",r="";this.timestampRequests!==!1&&(t[this.timestampParam]=sie()),!this.supportsBinary&&!t.sid&&(t.b64=1),t=nie.encode(t),this.port&&(e==="https"&&Number(this.port)!==443||e==="http"&&Number(this.port)!==80)&&(r=":"+this.port),t.length&&(t="?"+t);var n=this.hostname.indexOf(":")!==-1;return e+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+t}});var PM=D((XIe,CS)=>{var uie=ty(),OM=ES(),cie=sy(),lie=Ah(),xS=Rh()("engine.io-client:polling-xhr");CS.exports=jd;CS.exports.Request=yn;function IM(){}function jd(t){if(OM.call(this,t),this.requestTimeout=t.requestTimeout,window.location){var e=location.protocol==="https:",r=location.port;r||(r=e?443:80),this.xd=t.hostname!==window.location.hostname||r!==t.port,this.xs=t.secure!==e}else this.extraHeaders=t.extraHeaders}lie(jd,OM);jd.prototype.supportsBinary=!0;jd.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new yn(t)};jd.prototype.doWrite=function(t,e){var r=typeof t!="string"&&t!==void 0,n=this.request({method:"POST",data:t,isBinary:r}),i=this;n.on("success",e),n.on("error",function(a){i.onError("xhr post error",a)}),this.sendXhr=n};jd.prototype.doPoll=function(){xS("xhr poll");var t=this.request(),e=this;t.on("data",function(r){e.onData(r)}),t.on("error",function(r){e.onError("xhr poll error",r)}),this.pollXhr=t};function yn(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}cie(yn.prototype);yn.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new uie(t),r=this;try{xS("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders){e.setDisableHeaderCheck(!0);for(var n in this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&e.setRequestHeader(n,this.extraHeaders[n])}}catch{}if(this.supportsBinary&&(e.responseType="arraybuffer"),this.method==="POST")try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{e.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in e&&(e.withCredentials=!0),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){r.onLoad()},e.onerror=function(){r.onError(e.responseText)}):e.onreadystatechange=function(){e.readyState===4&&(e.status===200||e.status===1223?r.onLoad():setTimeout(function(){r.onError(e.status)},0))},xS("xhr data %s",this.data),e.send(this.data)}catch(i){setTimeout(function(){r.onError(i)},0);return}window.document&&(this.index=yn.requestsCount++,yn.requests[this.index]=this)};yn.prototype.onSuccess=function(){this.emit("success"),this.cleanup()};yn.prototype.onData=function(t){this.emit("data",t),this.onSuccess()};yn.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)};yn.prototype.cleanup=function(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=IM:this.xhr.onreadystatechange=IM,t)try{this.xhr.abort()}catch{}window.document&&delete yn.requests[this.index],this.xhr=null}};yn.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch{}if(e==="application/octet-stream")t=this.xhr.response||this.xhr.responseText;else if(!this.supportsBinary)t=this.xhr.responseText;else try{t=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch{for(var r=new Uint8Array(this.xhr.response),n=[],i=0,a=r.length;i<a;i++)n.push(r[i]);t=String.fromCharCode.apply(null,n)}}catch(s){this.onError(s)}t!=null&&this.onData(t)};yn.prototype.hasXDR=function(){return typeof window.XDomainRequest<"u"&&!this.xs&&this.enablesXDR};yn.prototype.abort=function(){this.cleanup()};yn.requestsCount=0;yn.requests={};window.document&&(window.attachEvent?window.attachEvent("onunload",kM):window.addEventListener&&window.addEventListener("beforeunload",kM,!1));function kM(){for(var t in yn.requests)yn.requests.hasOwnProperty(t)&&yn.requests[t].abort()}});var DM=D((YIe,RM)=>{var AS=ES(),die=Ah();RM.exports=Hd;var fie=/\n/g,pie=/\\n/g,dy;function hie(){}function Hd(t){AS.call(this,t),this.query=this.query||{},dy||(window.___eio||(window.___eio=[]),dy=window.___eio),this.index=dy.length;var e=this;dy.push(function(r){e.onData(r)}),this.query.j=this.index,window.document&&window.addEventListener&&window.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=hie)},!1)}die(Hd,AS);Hd.prototype.supportsBinary=!1;Hd.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),AS.prototype.doClose.call(this)};Hd.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(i){t.onError("jsonp poll error",i)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e;var n=typeof navigator<"u"&&/gecko/i.test(navigator.userAgent);n&&setTimeout(function(){var i=document.createElement("iframe");document.body.appendChild(i),document.body.removeChild(i)},100)};Hd.prototype.doWrite=function(t,e){var r=this;if(!this.form){var n=document.createElement("form"),i=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index,s;n.className="socketio",n.style.position="absolute",n.style.top="-1000px",n.style.left="-1000px",n.target=a,n.method="POST",n.setAttribute("accept-charset","utf-8"),i.name="d",n.appendChild(i),document.body.appendChild(n),this.form=n,this.area=i}this.form.action=this.uri();function o(){c(),e()}function c(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(f){r.onError("jsonp polling iframe removal error",f)}try{var l='<iframe src="javascript:0" name="'+r.iframeId+'">';s=document.createElement(l)}catch{s=document.createElement("iframe"),s.name=r.iframeId,s.src="javascript:0"}s.id=r.iframeId,r.form.appendChild(s),r.iframe=s}c(),t=t.replace(pie,`\\
`),this.area.value=t.replace(fie,"\\n");try{this.form.submit()}catch{}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){r.iframe.readyState==="complete"&&o()}:this.iframe.onload=o}});var LM=D(()=>{});var $M=D((ZIe,MM)=>{var IS=oy(),gie=ml(),mie=uy(),vie=Ah(),yie=TS(),bie=Rh()("engine.io-client:websocket"),NM=window.WebSocket||window.MozWebSocket,kS;if(typeof window>"u")try{kS=LM()}catch{}var vl=NM;!vl&&typeof window>"u"&&(vl=kS);MM.exports=_s;function _s(t){var e=t&&t.forceBase64;e&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=NM&&!t.forceNode,this.usingBrowserWebSocket||(vl=kS),IS.call(this,t)}vie(_s,IS);_s.prototype.name="websocket";_s.prototype.supportsBinary=!0;_s.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=void 0,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?new vl(t):new vl(t,e,r)}catch(n){return this.emit("error",n)}this.ws.binaryType===void 0&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}};_s.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}};_s.prototype.write=function(t){var e=this;this.writable=!1;for(var r=t.length,n=0,i=r;n<i;n++)(function(s){gie.encodePacket(s,e.supportsBinary,function(o){if(!e.usingBrowserWebSocket){var c={};if(s.options&&(c.compress=s.options.compress),e.perMessageDeflate){var l=typeof o=="string"?window.Buffer.byteLength(o):o.length;l<e.perMessageDeflate.threshold&&(c.compress=!1)}}try{e.usingBrowserWebSocket?e.ws.send(o):e.ws.send(o,c)}catch{bie("websocket closed before onclose event")}--r||a()})})(t[n]);function a(){e.emit("flush"),setTimeout(function(){e.writable=!0,e.emit("drain")},0)}};_s.prototype.onClose=function(){IS.prototype.onClose.call(this)};_s.prototype.doClose=function(){typeof this.ws<"u"&&this.ws.close()};_s.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",r="";this.port&&(e==="wss"&&Number(this.port)!==443||e==="ws"&&Number(this.port)!==80)&&(r=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=yie()),this.supportsBinary||(t.b64=1),t=mie.encode(t),t.length&&(t="?"+t);var n=this.hostname.indexOf(":")!==-1;return e+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+t};_s.prototype.check=function(){return!!vl&&!("__initialize"in vl&&this.name===_s.prototype.name)}});var PS=D(OS=>{var _ie=ty(),wie=PM(),Tie=DM(),Sie=$M();OS.polling=Eie;OS.websocket=Sie;function Eie(t){var e,r=!1,n=!1,i=t.jsonp!==!1;if(window.location){var a=location.protocol==="https:",s=location.port;s||(s=a?443:80),r=t.hostname!==location.hostname||s!==t.port,n=t.secure!==a}if(t.xdomain=r,t.xscheme=n,e=new _ie(t),"open"in e&&!t.forceJSONP)return new wie(t);if(!i)throw new Error("JSONP disabled");return new Tie(t)}});var FM=D((tke,UM)=>{var xie=/^[\],:{}\s]*$/,Cie=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,Aie=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Iie=/(?:^|:|,)(?:\s*\[)+/g,kie=/^\s+/,Oie=/\s+$/;UM.exports=function(e){if(typeof e!="string"||!e)return null;if(e=e.replace(kie,"").replace(Oie,""),window.JSON&&JSON.parse)return JSON.parse(e);if(xie.test(e.replace(Cie,"@").replace(Aie,"]").replace(Iie,"")))return new Function("return "+e)()}});var HM=D((rke,jM)=>{var Pie=PS(),Rie=sy(),sn=Rh()("engine.io-client:socket"),Die=Ev(),qM=ml(),BM=aS(),Lie=FM(),Nie=uy();jM.exports=_r;function _r(t,e){if(!(this instanceof _r))return new _r(t,e);e=e||{},t&&typeof t=="object"&&(e=t,t=null),t?(t=BM(t),e.hostname=t.host,e.secure=t.protocol==="https"||t.protocol==="wss",e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=BM(e.host).host),this.secure=e.secure!=null?e.secure:window.location&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||(window.location?location.hostname:"localhost"),this.port=e.port||(window.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},typeof this.query=="string"&&(this.query=Nie.decode(this.query)),this.upgrade=e.upgrade!==!1,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=e.jsonp!==!1,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=e.perMessageDeflate!==!1?e.perMessageDeflate||{}:!1,this.perMessageDeflate===!0&&(this.perMessageDeflate={}),this.perMessageDeflate&&this.perMessageDeflate.threshold==null&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=e.rejectUnauthorized===void 0?null:e.rejectUnauthorized,this.forceNode=!!e.forceNode;var r=typeof window=="object"&&window;r.global===r&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}_r.priorWebsocketSuccess=!1;Rie(_r.prototype);_r.protocol=qM.protocol;_r.Socket=_r;_r.Transport=oy();_r.transports=PS();_r.parser=ml();_r.prototype.createTransport=function(t){sn('creating transport "%s"',t);var e=Mie(this.query);e.EIO=qM.protocol,e.transport=t,this.id&&(e.sid=this.id);var r=new Pie[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders,forceNode:this.forceNode,localAddress:this.localAddress});return r};function Mie(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}_r.prototype.open=function(){var t;if(this.rememberUpgrade&&_r.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){var e=this;setTimeout(function(){e.emit("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)};_r.prototype.setTransport=function(t){sn("setting transport %s",t.name);var e=this;this.transport&&(sn("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(r){e.onPacket(r)}).on("error",function(r){e.onError(r)}).on("close",function(){e.onClose("transport close")})};_r.prototype.probe=function(t){sn('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),r=!1,n=this;_r.priorWebsocketSuccess=!1;function i(){if(n.onlyBinaryUpgrades){var g=!this.supportsBinary&&n.transport.supportsBinary;r=r||g}r||(sn('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",function(m){if(!r)if(m.type==="pong"&&m.data==="probe"){if(sn('probe transport "%s" pong',t),n.upgrading=!0,n.emit("upgrading",e),!e)return;_r.priorWebsocketSuccess=e.name==="websocket",sn('pausing current transport "%s"',n.transport.name),n.transport.pause(function(){r||n.readyState!=="closed"&&(sn("changing transport and sending upgrade packet"),f(),n.setTransport(e),e.send([{type:"upgrade"}]),n.emit("upgrade",e),e=null,n.upgrading=!1,n.flush())})}else{sn('probe transport "%s" failed',t);var y=new Error("probe error");y.transport=e.name,n.emit("upgradeError",y)}}))}function a(){r||(r=!0,f(),e.close(),e=null)}function s(g){var m=new Error("probe error: "+g);m.transport=e.name,a(),sn('probe transport "%s" failed because of error: %s',t,g),n.emit("upgradeError",m)}function o(){s("transport closed")}function c(){s("socket closed")}function l(g){e&&g.name!==e.name&&(sn('"%s" works - aborting "%s"',g.name,e.name),a())}function f(){e.removeListener("open",i),e.removeListener("error",s),e.removeListener("close",o),n.removeListener("close",c),n.removeListener("upgrading",l)}e.once("open",i),e.once("error",s),e.once("close",o),this.once("close",c),this.once("upgrading",l),e.open()};_r.prototype.onOpen=function(){if(sn("socket open"),this.readyState="open",_r.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.upgrade&&this.transport.pause){sn("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}};_r.prototype.onPacket=function(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(sn('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(Lie(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data);break}else sn('packet received with socket readyState "%s"',this.readyState)};_r.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),this.readyState!=="closed"&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};_r.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){e.readyState!=="closed"&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)};_r.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){sn("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)};_r.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})};_r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()};_r.prototype.flush=function(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(sn("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};_r.prototype.write=_r.prototype.send=function(t,e,r){return this.sendPacket("message",t,e,r),this};_r.prototype.sendPacket=function(t,e,r,n){if(typeof e=="function"&&(n=e,e=void 0),typeof r=="function"&&(n=r,r=null),!(this.readyState==="closing"||this.readyState==="closed")){r=r||{},r.compress=r.compress!==!1;var i={type:t,data:e,options:r};this.emit("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}};_r.prototype.close=function(){if(this.readyState==="opening"||this.readyState==="open"){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}function e(){t.onClose("forced close"),sn("socket closing - telling transport to close"),t.transport.close()}function r(){t.removeListener("upgrade",r),t.removeListener("upgradeError",r),e()}function n(){t.once("upgrade",r),t.once("upgradeError",r)}return this};_r.prototype.onError=function(t){sn("socket error %j",t),_r.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)};_r.prototype.onClose=function(t,e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){sn('socket close with reason: "%s"',t);var r=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),r.writeBuffer=[],r.prevBufferLen=0}};_r.prototype.filterUpgrades=function(t){for(var e=[],r=0,n=t.length;r<n;r++)~Die(this.transports,t[r])&&e.push(t[r]);return e}});var GM=D((ike,RS)=>{RS.exports=HM();RS.exports.parser=ml()});var zM=D((nke,VM)=>{VM.exports=GM()});var LS=D((ake,DS)=>{typeof DS<"u"&&(DS.exports=os);function os(t){if(t)return $ie(t)}function $ie(t){for(var e in os.prototype)t[e]=os.prototype[e];return t}os.prototype.on=os.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};os.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};os.prototype.off=os.prototype.removeListener=os.prototype.removeAllListeners=os.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return this};os.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};os.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};os.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var KM=D((ske,WM)=>{WM.exports=Uie;function Uie(t,e){var r=[];e=e||0;for(var n=e||0;n<t.length;n++)r[n-e]=t[n];return r}});var NS=D((oke,XM)=>{XM.exports=Fie;function Fie(t,e,r){return t.on(e,r),{destroy:function(){t.removeListener(e,r)}}}});var MS=D((uke,JM)=>{var YM=[].slice;JM.exports=function(t,e){if(typeof e=="string"&&(e=t[e]),typeof e!="function")throw new Error("bind() requires a function");var r=YM.call(arguments,2);return function(){return e.apply(t,r.concat(YM.call(arguments)))}}});var qS=D((e$,t$)=>{var qa=ey(),QM=LS(),FS=KM(),$S=NS(),US=MS(),To=_h()("socket.io-client:socket"),ZM=hS();t$.exports=e$=en;var Bie={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},BS=QM.prototype.emit;function en(t,e,r){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}QM(en.prototype);en.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[$S(t,"open",US(this,"onopen")),$S(t,"packet",US(this,"onpacket")),$S(t,"close",US(this,"onclose"))]}};en.prototype.open=en.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),this.io.readyState==="open"&&this.onopen(),this.emit("connecting"),this)};en.prototype.send=function(){var t=FS(arguments);return t.unshift("message"),this.emit.apply(this,t),this};en.prototype.emit=function(t){if(Bie.hasOwnProperty(t))return BS.apply(this,arguments),this;var e=FS(arguments),r=qa.EVENT;ZM(e)&&(r=qa.BINARY_EVENT);var n={type:r,data:e};return n.options={},n.options.compress=!this.flags||this.flags.compress!==!1,typeof e[e.length-1]=="function"&&(To("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this};en.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)};en.prototype.onopen=function(){To("transport is open - connecting"),this.nsp!=="/"&&(this.query?this.packet({type:qa.CONNECT,query:this.query}):this.packet({type:qa.CONNECT}))};en.prototype.onclose=function(t){To("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)};en.prototype.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case qa.CONNECT:this.onconnect();break;case qa.EVENT:this.onevent(t);break;case qa.BINARY_EVENT:this.onevent(t);break;case qa.ACK:this.onack(t);break;case qa.BINARY_ACK:this.onack(t);break;case qa.DISCONNECT:this.ondisconnect();break;case qa.ERROR:this.emit("error",t.data);break}};en.prototype.onevent=function(t){var e=t.data||[];To("emitting event %j",e),t.id!=null&&(To("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?BS.apply(this,e):this.receiveBuffer.push(e)};en.prototype.ack=function(t){var e=this,r=!1;return function(){if(!r){r=!0;var n=FS(arguments);To("sending ack %j",n);var i=ZM(n)?qa.BINARY_ACK:qa.ACK;e.packet({type:i,id:t,data:n})}}};en.prototype.onack=function(t){var e=this.acks[t.id];typeof e=="function"?(To("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):To("bad ack %s",t.id)};en.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()};en.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)BS.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]};en.prototype.ondisconnect=function(){To("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")};en.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)};en.prototype.close=en.prototype.disconnect=function(){return this.connected&&(To("performing disconnect (%s)",this.nsp),this.packet({type:qa.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this};en.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this}});var i$=D((cke,r$)=>{r$.exports=Gd;function Gd(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Gd.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};Gd.prototype.reset=function(){this.attempts=0};Gd.prototype.setMin=function(t){this.ms=t};Gd.prototype.setMax=function(t){this.max=t};Gd.prototype.setJitter=function(t){this.jitter=t}});var jS=D((lke,o$)=>{var qie=zM(),jie=qS(),Hie=LS(),n$=ey(),oc=NS(),Vd=MS(),oa=_h()("socket.io-client:manager"),a$=Ev(),Gie=i$(),s$=Object.prototype.hasOwnProperty;o$.exports=$r;function $r(t,e){if(!(this instanceof $r))return new $r(t,e);t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new Gie({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new n$.Encoder,this.decoder=new n$.Decoder,this.autoConnect=e.autoConnect!==!1,this.autoConnect&&this.open()}$r.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)s$.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)};$r.prototype.updateSocketIds=function(){for(var t in this.nsps)s$.call(this.nsps,t)&&(this.nsps[t].id=this.engine.id)};Hie($r.prototype);$r.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection};$r.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts};$r.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay};$r.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor};$r.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax};$r.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout};$r.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()};$r.prototype.open=$r.prototype.connect=function(t,e){if(oa("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;oa("opening %s",this.uri),this.engine=qie(this.uri,this.opts);var r=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var i=oc(r,"open",function(){n.onopen(),t&&t()}),a=oc(r,"error",function(c){if(oa("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",c),t){var l=new Error("Connection error");l.data=c,t(l)}else n.maybeReconnectOnOpen()});if(this._timeout!==!1){var s=this._timeout;oa("connect attempt will timeout after %d",s);var o=setTimeout(function(){oa("connect attempt timed out after %d",s),i.destroy(),r.close(),r.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(o)}})}return this.subs.push(i),this.subs.push(a),this};$r.prototype.onopen=function(){oa("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(oc(t,"data",Vd(this,"ondata"))),this.subs.push(oc(t,"ping",Vd(this,"onping"))),this.subs.push(oc(t,"pong",Vd(this,"onpong"))),this.subs.push(oc(t,"error",Vd(this,"onerror"))),this.subs.push(oc(t,"close",Vd(this,"onclose"))),this.subs.push(oc(this.decoder,"decoded",Vd(this,"ondecoded")))};$r.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")};$r.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};$r.prototype.ondata=function(t){this.decoder.add(t)};$r.prototype.ondecoded=function(t){this.emit("packet",t)};$r.prototype.onerror=function(t){oa("error",t),this.emitAll("error",t)};$r.prototype.socket=function(t,e){var r=this.nsps[t];if(!r){r=new jie(this,t,e),this.nsps[t]=r;var n=this;r.on("connecting",i),r.on("connect",function(){r.id=n.engine.id}),this.autoConnect&&i()}function i(){~a$(n.connecting,r)||n.connecting.push(r)}return r};$r.prototype.destroy=function(t){var e=a$(this.connecting,t);~e&&this.connecting.splice(e,1),!this.connecting.length&&this.close()};$r.prototype.packet=function(t){oa("writing packet %j",t);var e=this;t.query&&t.type===0&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(r){for(var n=0;n<r.length;n++)e.engine.write(r[n],t.options);e.encoding=!1,e.processPacketQueue()}))};$r.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}};$r.prototype.cleanup=function(){oa("cleanup");for(var t=this.subs.length,e=0;e<t;e++){var r=this.subs.shift();r.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()};$r.prototype.close=$r.prototype.disconnect=function(){oa("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,this.readyState==="opening"&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()};$r.prototype.onclose=function(t){oa("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()};$r.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)oa("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();oa("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var r=setTimeout(function(){t.skipReconnect||(oa("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),!t.skipReconnect&&t.open(function(n){n?(oa("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",n.data)):(oa("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(r)}})}};$r.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}});var HS=D((yl,d$)=>{var Vie=CN(),zie=ey(),u$=jS(),c$=_h()("socket.io-client");d$.exports=yl=l$;var Dh=yl.managers={};function l$(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};var r=Vie(t),n=r.source,i=r.id,a=r.path,s=Dh[i]&&a in Dh[i].nsps,o=e.forceNew||e["force new connection"]||e.multiplex===!1||s,c;return o?(c$("ignoring socket cache for %s",n),c=u$(n,e)):(Dh[i]||(c$("new io instance for %s",n),Dh[i]=u$(n,e)),c=Dh[i]),r.query&&!e.query?e.query=r.query:e&&typeof e.query=="object"&&(e.query=Wie(e.query)),c.socket(r.path,e)}function Wie(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e.join("&")}yl.protocol=zie.protocol;yl.connect=l$;yl.Manager=jS();yl.Socket=qS()});var p$=D((dke,f$)=>{"use strict";var Kie=HS(),VS={transform:function(t){var e=new RegExp(["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|"),"g");return t.replace(e,"")}},GS=!1,Xie=xn(),on=Cr(),Yie=gh(),mu=Nr(),Jie=Ni().getInstallCommand,Qie=Ni().getPDBCommand,Zie=mn(),ene=gl(),zS=".jqconsole-cursor",fy;function tne(t){function e(n){console.log("Connected")}function r(n){n.detail.clean?console.log("Disconnected"):console.log("Something went wrong, connection is closed")}fy=new window.RFB(document.getElementById("screen"),t,{}),fy.addEventListener("connect",e),fy.addEventListener("disconnect",r)}function Ws(t,e){var r=this;r.replConsole=ene({welcomeString:"",promptLabel:""}),$(zS).css("visibility","hidden"),r.running=!1,r.debugging=!1,r.editor=t,r.q=[],r.output="",r.connected=!1,r.attemptReconnection=!0,r.numRetries=0,r.connection,r.confirmedConnection=$.Deferred().reject(),r.spawnUUID,r.execUUID,r.lang=e,r.editor.typeTester.isJava()&&(r.javaErrorChecker=new Yie(t)),r.isGraphics=r.editor.typeTester.isPythonGraphics()||r.editor.typeTester.isJavaServerGraphics()||r.editor.typeTester.isPygame()||r.editor.typeTester.isPythonProcessing()||r.editor.typeTester.isJavaProcessing(),r.docker_image=t.itemDockerImage,r.url="scalinghub.codehs.com",r.confirmConnection=function(){return(!r.connection||!r.connection.connected)&&r.attemptReconnection?r.reconnect():r.confirmedConnection},r.reconnect=function(){return r.confirmedConnection=$.Deferred(),r.setupConnection().then(function(){r.numRetries=0,setTimeout(function(){r.setupSocket().then(function(i){r.confirmedConnection.resolve(i)})},1e3)}),r.confirmedConnection},r.setupSocket=function(){var i=$.Deferred();return r.attemptReconnection=!0,r.connection=Kie(GS?"ws://localhost:443":"wss://"+r.url+":443/",{path:"/user/"+r.uuid+"/spawn",reconnection:!1}).on("connect",function(a){r.isGraphics&&tne((GS?"ws://localhost":"wss://"+r.url)+":443/user/"+r.uuid+"/graphics/"),r.connected=!0,i.resolve(a),r.q.length>0&&(r.q.forEach(function(s){s.type==="spawn"?r.spawn(s.code,s.options):s.type==="install"?r.install(s.file):s.type==="transfer"?r.transfer(s.code):s.type==="resize"&&r.resize()}),r.q=[]),r.running||(on.trigger("utils:enableButton",".run_code"),on.trigger("utils:enableButton","button.grade_code"))}).on("error",function(){r.attemptReconnection=!0}).on("disconnect",function(){if(r.connected=!1,this.disconnect(),r.attemptReconnection)return r.reconnect()}).on("stdout",function(a){on.trigger("ProgramRun:successful",Date.now());var s=VS.transform(a);r.debugging&&(s=r.parseDebuggerOutput(s)),r.replConsole.writeToConsole(s,!0),r.output+=s}).on("stderr",function(a){var s=VS.transform(a);r.replConsole.writeToConsole("stderr: "+s,!0),r.output+=s}).on("exit",function(a){on.trigger("ProgramRun:successful",Date.now()),on.trigger("utils:enableButton",".run_code"),on.trigger("utils:enableButton","button.grade_code"),$(zS).css("visibility","hidden"),r.output.length>0&&r.editor.typeTester.isJava()&&r.javaErrorChecker&&r.javaErrorChecker.check(r.output.split(`
`),r.codeTree)}).on("fs:change",function(a){r.editor.updateCodeExternally(a)}),i},r.setupConnection=function(){return r.uuid=Math.floor(Math.random()*1e4),r.attemptReconnection=!1,new Promise(function(i,a){fetch((GS?"http://localhost:443":"https://"+r.url)+"/hub/api/spinup/"+r.uuid+(r.docker_image&&r.isGraphics?"/config/"+r.docker_image:""),{method:"GET",headers:{Authorization:"token 8ec61780cf6896f2f8efbd8a6ce14aa9a25b397052aafae926823805b30bd037"},credentials:"include"}).then(function(s){if(s.status===202||s.status===201)i();else{if(s.statusText==="Conflict")return r.setupConnection().then(function(){r.numRetries=0,i()});setTimeout(function(){document.cookie="AWSALB= ; expires = Thu, 01 Jan 1970 00:00:00 GMT",r.numRetries++,r.numRetries=Math.min(5,r.numRetries),r.setupConnection().then(function(){r.numRetries=0,i()})},1e3*(Math.pow(2,r.numRetries)-1))}}).catch(function(s){setTimeout(function(){document.cookie="AWSALB= ; expires = Thu, 01 Jan 1970 00:00:00 GMT",r.numRetries++,r.numRetries=Math.min(5,r.numRetries),r.setupConnection().then(function(){r.numRetries=0,i()})},1e3*(Math.pow(2,r.numRetries)-1))})})},(!r.connection||!r.connection.connected)&&r.reconnect();var n=function(){r.attemptReconnection=!1,r.isGraphics&&fy.disconnect(),r.connection.emit("disconnect"),r.connection.disconnect()};$(window).on("beforeunload",n),$(document).one("turbolinks:before-render",function(){n(),$(window).off("beforeunload",n)})}Xie.inherits(Ws,Zie);Ws.prototype.exec=function(t,e,r){var n=this;return new Promise(function(i,a){on.trigger("utils:disableButton",".run_code"),on.trigger("utils:disableButton","button.grade_code"),on.trigger("utils:disableButton","#grading-unit-test-run"),n.confirmConnection().then(function(){on.trigger("ProgramRun:create",{userId:r.codeUserID,itemId:r.itemID,usesHub:!0,startTime:Date.now()}),n.connection.once("exec_result",function(s){if(on.trigger("utils:enableButton",".run_code"),on.trigger("utils:enableButton","button.grade_code"),on.trigger("utils:enableButton","#grading-unit-test-run"),n.output+=s,on.trigger("ProgramRun:successful",Date.now()),n.editor.typeTester.isJava()&&n.javaErrorChecker){var o={name:"karel"},c=[];for(var l in e)if(e.hasOwnProperty(l)){var f={};f.name=l,f.contents=e[l],c.push(f)}o.contents=c,n.javaErrorChecker.check(n.output.split(`
`),o)}i(VS.transform(n.output))}).once("exec_stderr",function(s){s&&(n.output+=s)}),n.output="",n.connection.emit("exec",{cmd:t,files:e})})})};Ws.prototype.run=function(t,e){var r=this;if(e.installPackages)r.install(t);else{var n=Jie(t,r.lang);n&&(e.installCommand=n),e.pythonDebugger&&(e.pdbCommand=Qie(r.editor.getBreakpoints())),on.trigger("ProgramRun:create",{userId:e.codeUserID,itemId:e.itemID,usesHub:!0,startTime:Date.now()}),r.spawn(t,e)}};Ws.prototype.install=function(t){var e=this;return new Promise(function(r,n){!e.connected||!e.connection.connected?(e.q.push({type:"install",file:t}),e.attemptReconnection&&e.setupConnection().then(function(){e.numRetries=0,e.setupSocket().done(function(){r()})})):(e.connection.emit("transfer",t),e.lang==="python3"?e.connection.emit("spawn",{cmd:"sh",args:["-c",'pip3 install -r requirements.txt --user && echo "Requirements installed."']}):e.lang==="node"?e.connection.emit("spawn",{cmd:"sh",args:["-c","npm install"]}):alert("I WAS UNPREPARED FOR THIS"),r())})};Ws.prototype.resize=function(){var t=this;if(!t.connected||!t.connection.connected){t.q.push({type:"resize"}),t.attemptReconnection&&t.setupConnection().then(function(){t.numRetries=0,t.setupSocket()});return}else{var e=document.getElementById("screen").getBoundingClientRect(),r={w:e.width,h:e.height};t.connection.emit("resize",r)}};Ws.prototype.transfer=function(t){var e=this;if(!e.connected||!e.connection.connected){e.q.push({type:"transfer",code:t}),e.attemptReconnection&&e.setupConnection().then(function(){e.numRetries=0,e.setupSocket()});return}else t=Object.entries(t).reduce(function(r,n){var i=n[0],a=n[1];return i.endsWith("/.")||(r[i]=a),r},{}),e.connection.emit("transfer",t)};Ws.prototype.spawn=function(t,e){var r=this;if(r.running=!0,on.trigger("utils:disableButton",".run_code"),on.trigger("utils:disableButton","button.grade_code"),!r.connected||!r.connection.connected){r.q.push({type:"spawn",code:t,options:e}),r.attemptReconnection&&r.setupConnection().then(function(){r.numRetries=0,r.setupSocket()});return}else{r.isGraphics&&r.resize(),r.output="",r.codeTree={name:"karel"};var n=[];for(var i in t)if(t.hasOwnProperty(i)){var a={};a.name=i,a.contents=t[i],n.push(a)}r.codeTree.contents=n,r.replConsole.reset(),function s(){$(zS).css("visibility","visible"),r.replConsole.promptForInput(function(o){r.connection.emit("stdin",o+`
`),s()})}(),r.transfer(t),r.connection.off("transferComplete"),r.connection.on("transferComplete",function(){var s;if("run.sh"in t&&r.connection.emit("spawn",{cmd:"sh",args:["run.sh"]}),r.lang=="c")r.connection.emit("spawn",{cmd:"sh",args:["-c","gcc *.c -o main && ./main"]});else if(r.lang=="c++")s=r.editor.progType===mu.ProgramType.CPP_FUNCTION?"scratchpad.cpp":"*.cpp",r.connection.emit("spawn",{cmd:"sh",args:["-c","gcc "+s+" -lstdc++ -o main && ./main"]});else if(r.lang=="scheme")r.connection.emit("spawn",{cmd:"sh",args:["-c","scheme"]});else if(r.lang=="bash")r.connection.emit("spawn",{cmd:"sh",args:["-c","sh"]});else if(r.lang=="python2")r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"python2 main.py"]});else if(r.editor.progType===mu.ProgramType.PYTHON_PROCESSING)r.connection.emit("spawn",{cmd:"sh",args:["-c","java -jar /app/processing-py.jar main.py"]});else if(r.lang=="python3")s=r.editor.progType===mu.ProgramType.PYTHON3_FUNCTION?"scratchpad.py":"main.py",e.pythonDebugger&&e.pdbCommand?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"python3 -m "+e.pdbCommand+s]})):r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"python3 "+s]});else if(r.editor.progType===mu.ProgramType.JAVA_PROCESSING){var o=Object.keys(t).filter(function(c){return c.endsWith(".java")}).join(" ");r.connection.emit("spawn",{cmd:"sh",args:["-c",'echo "Compiling..." && javac -cp .:/app/processing-jars/* '+o+" && java -cp .:/app/processing-jars/* "+e.mainClass]})}else r.lang=="java"?r.spawnJava(t,e):r.lang=="node"&&r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"node default.js"]})})}};Ws.prototype.stop=function(){var t=this;t.connection.emit("kill"),t.replConsole.reset(),on.trigger("utils:enableButton",".run_code"),on.trigger("utils:enableButton","button.grade_code"),on.trigger("utils:enableButton","#grading-unit-test-run"),(!t.connected||!t.connection.connected)&&t.reconnect()};Ws.prototype.spawnJava=function(t,e){var r=this;function n(o){var c=!1;Object.keys(o).forEach(function(l){if(l.endsWith(".java")){var f=l.substr(0,l.length-5);Object.keys(o[l]).forEach(function(g){c=!0,r.connection.emit("stdin","stop at "+f+":"+g+`
`)})}}),c||(r.editor.progType===mu.ProgramType.JAVA_CONSOLE||r.editor.progType===mu.ProgramType.JAVA_METHOD?r.connection.emit("stdin","stop in "+e.mainClass+`.run
`):r.connection.emit("stdin","stop in "+e.mainClass+`.main
`))}var i=Object.keys(t).filter(function(o){return o.endsWith(".java")}).join(" "),a=r.editor.getBreakpoints(),s=Object.keys(t).filter(function(o){return o.endsWith(".jar")}).join(":./");r.editor.progType===mu.ProgramType.JAVA_CONSOLE?e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch ConsoleProgram "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac "+i+" && java ConsoleProgram "+e.mainClass]}):r.editor.progType===mu.ProgramType.JAVA_METHOD?e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch ConsoleProgram "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" "+i+" && java -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" ConsoleProgram "+e.mainClass]}):r.editor.progType===mu.ProgramType.JAVA_METHOD_MAIN?e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" "+i+" && java -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" "+e.mainClass]}):e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac "+(s?"-cp .:"+s+" ":"")+i+" && java "+(s?"-cp .:"+s+" ":"")+e.mainClass]})};Ws.prototype.parseDebuggerOutput=function(t){var e=this,r=t,n,i,a,s,o;if(e.language=="python3"){n=/\/home\/karel\/([\w\d\/_]+\.py)\(([\d]+)\)/gm,a=n.exec(t),a&&a.length>=3&&(o=a[1],i=a[2],s=$('[data-filename="'+o+'"]'),e.editor.editorColumns.activateFile(s),e.editor.highlightLine(i,!0,o));var c=t.indexOf("> /home/karel/");c!=-1&&(r=t.substring(0,c)),r=r.replaceAll("(Pdb) ","")}else if(e.language=="java"){var l="VM Started: No frames on the current call stack";if(t.indexOf(l)!=-1)return e.connection.emit("stdin",`cont
`),"";n=/"thread=main", ([\w\d\/_$]+)\..*, line=([\d]+)\s/gm,a=n.exec(t),a&&a.length>=3&&(o=a[1]+".java",i=a[2],s=$('[data-filename="'+o+'"]'),e.editor.editorColumns.activateFile(s),e.editor.highlightLine(i,!0,o));for(var f=t.split(`
`),g=0,m=0;m<f.length;m++)f[m].indexOf('"thread=main"')!=-1&&(g=m);g!=0&&(r=f.splice(0,g-1).join(`
`)+f.splice(g+2).join(`
`)),r=r.replaceAll("main[1] ","").trim(),r.startsWith(">")&&(r=r.substring(1).trim()),r.length&&(r+=`
`)}return r};f$.exports=Ws});var g$=D((fke,h$)=>{"use strict";var rne=HS(),ine=function(t){return Promise.resolve(t)===t},KS={transform:function(t){var e=new RegExp(["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|"),"g");return t.replace(e,"")}},WS=!1,nne=xn(),un=Cr(),ane=gh(),vu=Nr(),sne=Ni().getInstallCommand,one=Ni().getPDBCommand,une=mn(),cne=gl(),XS=".jqconsole-cursor",lne=".jqconsole + div textarea",bl;window.LOGGING=!1;var Ks=function(t){window.LOGGING&&console.info(t)};function dne(t,e){function r(a){t.resize()}function n(a){a.detail.clean||setTimeout(i,500)}function i(){bl&&(bl.removeEventListener("connect",r),bl.removeEventListener("disconnect",n),clearInterval(i)),bl=new window.RFB(document.getElementById("screen"),e,{}),bl.addEventListener("connect",r),bl.addEventListener("disconnect",n)}i()}function Xs(t,e){var r=this;r.replConsole=cne({welcomeString:"",promptLabel:""}),$(XS).css("visibility","hidden"),$(lne).attr("tabindex","-1"),r.running=!1,r.debugging=!1,r.editor=t,r.q=[],r.output="",r.connected=!1,r.numRetries=0,r.connection,r.socketInProgress=null,r.spinupInProgress=null,r.spawnUUID,r.execUUID,r.language=e,r.editor.typeTester.isJava()&&(r.javaErrorChecker=new ane(t)),r.isGraphics=r.editor.typeTester.isPythonGraphics()||r.editor.typeTester.isJavaServerGraphics()||r.editor.typeTester.isPygame()||r.editor.typeTester.isPythonProcessing()||r.editor.typeTester.isJavaProcessing()||r.editor.typeTester.isPythonDataScienceGraphics(),r.docker_image=t.itemDockerImage,r.url="scalinghub.codehs.com";var n=function(a){return new Promise(function(s){setTimeout(s,a)})},i=function(a,s,o){return o=o||500,s().catch(function(c){return a>0?n(o).then(function(){return i(a-1,s,o*2)}):Promise.reject(c)})};r.makeConnection=function(){return i(5,function(){return new Promise(function(a,s){r.connection&&r.connection.connected?a():ine(r.socketInProgress)?r.socketInProgress.then(a).catch(s):r.spinupInProgress!==null?r.spinupInProgress.then(function(){return r.connectSocket()}).then(a).catch(s):r.spinup().then(function(){return r.connectSocket()}).then(a).catch(s)})},500).catch(function(){r.replConsole.writeToConsole(`Couldnt connect to code servers.
If this persists, please contact support@codehs.com.`,!0)})},r.spinup=function(){r.uuid=Math.floor(Math.random()*1e4);var a=Date.now();return r.spinupInProgress=new Promise(function(s,o){fetch((WS?"http://localhost:443":"https://"+r.url)+"/hub/api/spinup/"+r.uuid+(r.docker_image&&r.docker_image!="default"?"/config/"+r.docker_image:""),{method:"GET",credentials:"include"}).then(function(c){if(c.status===202||c.status===201){var l=Date.now();Ks("Confirmed spinup for "+r.uuid+" in "+(l-a)+"ms."),s(),Ks("Spinup no longer in progress."),r.spinupInProgress=null}else c.statusText==="Conflict"?(Ks("Name conflict for "+r.uuid),r.spinup().then(function(){r.numRetries=0,s()})):(Ks("HTTPS: "+c.status+". error for "+r.uuid),o(),r.spinupInProgress=null)}).catch(function(c){Ks("HTTPS error for "+r.uuid),o(),r.spinupInProgress=null})}),r.spinupInProgress},r.connectSocket=function(){return Ks("Setting up socket for "+r.uuid),r.connected=!1,r.socketInProgress=new Promise(function(a,s){r.connection=rne(WS?"ws://localhost:443":"wss://"+r.url+":443/",{path:"/user/"+r.uuid+"/spawn",reconnectionAttempts:3,transports:["websocket"]}).on("reconnect_failed",function(){r.connected=!1,s("reconnect_failed"),r.socketInProgress=null,r.spinupInProgress=null,Ks("Socket no longer in progress.")}).on("connect",function(o){Ks("Socket connected for "+r.uuid),r.isGraphics&&dne(r,(WS?"ws://localhost":"wss://"+r.url)+":443/user/"+r.uuid+"/graphics/"),r.connected=!0,r.q.length>0&&(r.q.forEach(function(c){c.type==="spawn"?r.spawn(c.code,c.options):c.type==="install"?r.install(c.file):c.type==="transfer"?r.transfer(c.code):c.type==="resize"&&r.resize()}),r.q=[]),r.running||(un.trigger("utils:enableButton",".run_code"),un.trigger("utils:enableButton","button.grade_code")),a(o),r.socketInProgress=null,Ks("Socket no longer in progress.")}).on("error",function(){Ks("Socket error for "+r.uuid),r.connected=!1}).on("connect_error",function(){Ks("Socket connect error for "+r.uuid),r.connected=!1}).on("disconnect",function(){this.disconnect(),r.connected=!1}).on("stdout",function(o){un.trigger("ProgramRun:successful",Date.now());var c=KS.transform(o);r.debugging&&(c=r.parseDebuggerOutput(c)),r.replConsole.writeToConsole(c,!0),r.output+=c}).on("stderr",function(o){var c=KS.transform(o);r.replConsole.writeToConsole("stderr: "+c,!0),r.output+=c}).on("exit",function(o){un.trigger("ProgramRun:successful",Date.now()),un.trigger("utils:enableButton",".run_code"),un.trigger("utils:enableButton","button.grade_code"),$(XS).css("visibility","hidden"),r.output.length>0&&r.editor.typeTester.isJava()&&r.javaErrorChecker&&r.javaErrorChecker.check(r.output.split(`
`),r.codeTree)}).on("fs:change",function(o){})}),r.socketInProgress},r.cleanup=function(){r.isGraphics&&bl.disconnect(),r.connection.emit("disconnect"),r.connection.disconnect()},(!r.connection||!r.connection.connected)&&r.makeConnection(),$(window).on("beforeunload",r.cleanup),$(document).one("turbolinks:before-render",function(){r.cleanup(),$(window).off("beforeunload",r.cleanup)})}nne.inherits(Xs,une);Xs.prototype.exec=function(t,e,r){var n=this;return new Promise(function(i,a){un.trigger("utils:disableButton",".run_code"),un.trigger("utils:disableButton","button.grade_code"),un.trigger("utils:disableButton","#grading-unit-test-run"),n.makeConnection().then(function(){un.trigger("ProgramRun:create",{userId:r.codeUserID,itemId:r.itemID,usesHub:!0,startTime:Date.now()}),n.connection.once("exec_result",function(s){if(un.trigger("utils:enableButton",".run_code"),un.trigger("utils:enableButton","button.grade_code"),un.trigger("utils:enableButton","#grading-unit-test-run"),n.output+=s,un.trigger("ProgramRun:successful",Date.now()),n.editor.typeTester.isJava()&&n.javaErrorChecker){var o={name:"karel"},c=[];for(var l in e)if(e.hasOwnProperty(l)){var f={};f.name=l,f.contents=e[l],c.push(f)}o.contents=c,n.javaErrorChecker.check(n.output.split(`
`),o)}i(KS.transform(n.output))}).once("exec_stderr",function(s){s&&(n.output+=s)}),n.output="",n.connection.emit("exec",{cmd:t,files:e})})})};Xs.prototype.run=function(t,e){var r=this;if(e.installPackages)r.install(t);else{r.numRetries=0;var n=sne(t,r.language);n&&(e.installCommand=n),e.pythonDebugger&&(e.pdbCommand=one(r.editor.getBreakpoints())),un.trigger("ProgramRun:create",{userId:e.codeUserID,itemId:e.itemID,usesHub:!0,startTime:Date.now()}),r.spawn(t,e)}};Xs.prototype.resize=function(){var t=this;t.makeConnection().then(function(){var e=document.getElementById("screen").getBoundingClientRect(),r={w:e.width,h:e.height};t.connection.emit("resize",r)})};Xs.prototype.transfer=function(t){var e=this;e.makeConnection().then(function(){t=Object.entries(t).reduce(function(r,n){var i=n[0],a=n[1];return i.endsWith("/.")||(r[i]=a),r},{}),e.connection.emit("transfer",t)})};Xs.prototype.spawn=function(t,e){var r=this;r.running=!0,un.trigger("utils:disableButton",".run_code"),un.trigger("utils:disableButton","button.grade_code"),r.makeConnection().then(function(){r.isGraphics&&r.resize(),r.output="",r.codeTree={name:"karel"};var n=[];for(var i in t)if(t.hasOwnProperty(i)){var a={};a.name=i,a.contents=t[i],n.push(a)}r.codeTree.contents=n,r.replConsole.reset(),function s(){$(XS).css("visibility","visible"),r.replConsole.promptForInput(function(o){r.connection.emit("stdin",o+`
`),s()})}(),r.transfer(t),r.connection.off("transferComplete"),r.connection.on("transferComplete",function(){var s;if("run.sh"in t&&r.connection.emit("spawn",{cmd:"sh",args:["run.sh"]}),r.language=="c")r.connection.emit("spawn",{cmd:"sh",args:["-c","gcc *.c -o main && ./main"]});else if(r.language=="c++")s=r.editor.progType===vu.ProgramType.CPP_FUNCTION?"scratchpad.cpp":"*.cpp",r.connection.emit("spawn",{cmd:"sh",args:["-c","gcc "+s+" -lstdc++ -lm -o main && ./main"]});else if(r.language=="scheme")r.connection.emit("spawn",{cmd:"sh",args:["-c","scheme < main.scm"]});else if(r.language=="bash")r.connection.emit("spawn",{cmd:"sh",args:["-c","sh"]});else if(r.language=="python2")r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"python2 main.py"]});else if(r.editor.progType===vu.ProgramType.PYTHON_PROCESSING)r.connection.emit("spawn",{cmd:"sh",args:["-c","java -jar /app/processing-py.jar main.py"]});else if(r.language=="python3")s=r.editor.progType===vu.ProgramType.PYTHON3_FUNCTION?"scratchpad.py":"main.py",e.pythonDebugger&&e.pdbCommand?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"python3 -m "+e.pdbCommand+s]})):r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"python3 "+s]});else if(r.editor.progType===vu.ProgramType.JAVA_PROCESSING){var o=Object.keys(t).filter(function(c){return c.endsWith(".java")}).join(" ");r.connection.emit("spawn",{cmd:"sh",args:["-c",'echo "Compiling..." && javac -cp .:/app/processing-jars/* '+o+" && java -cp .:/app/processing-jars/* "+e.mainClass]})}else r.language=="java"?r.spawnJava(t,e):r.language=="node"?r.connection.emit("spawn",{cmd:"sh",args:["-c",(e.installCommand?e.installCommand+" && ":"")+"node default.js"]}):r.language==="swift"&&r.connection.emit("spawn",{cmd:"sh",args:["-c","swiftc -o main *.swift && ./main"]})})})};Xs.prototype.install=function(t,e){var r=this;return new Promise(function(n,i){r.makeConnection().then(function(){r.connection.emit("transfer",t),r.language==="python3"?r.connection.emit("spawn",{cmd:"sh",args:["-c","pip3 install "+(e?"-q ":"")+"-r requirements.txt --user "+(e?"":'&& echo "Requirements installed."')]}):r.language==="node"?r.connection.emit("spawn",{cmd:"sh",args:["-c","npm install "+e?"-s":""]}):alert("I WAS UNPREPARED FOR THIS"),n()})})};Xs.prototype.stop=function(){var t=this;t.connection.emit("kill"),t.replConsole.reset(),un.trigger("utils:enableButton",".run_code"),un.trigger("utils:enableButton","button.grade_code"),un.trigger("utils:enableButton","#grading-unit-test-run")};Xs.prototype.spawnJava=function(t,e){var r=this;function n(o){var c=!1;Object.keys(o).forEach(function(l){if(l.endsWith(".java")){var f=l.substr(0,l.length-5);Object.keys(o[l]).forEach(function(g){c=!0,r.connection.emit("stdin","stop at "+f+":"+g+`
`)})}}),c||(r.editor.progType===vu.ProgramType.JAVA_CONSOLE||r.editor.progType===vu.ProgramType.JAVA_METHOD?r.connection.emit("stdin","stop in "+e.mainClass+`.run
`):r.connection.emit("stdin","stop in "+e.mainClass+`.main
`))}var i=Object.keys(t).filter(function(o){return o.endsWith(".java")}).join(" "),a=r.editor.getBreakpoints(),s=Object.keys(t).filter(function(o){return o.endsWith(".jar")}).join(":./");r.editor.progType===vu.ProgramType.JAVA_CONSOLE?e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch ConsoleProgram "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac "+i+" && java ConsoleProgram "+e.mainClass]}):r.editor.progType===vu.ProgramType.JAVA_METHOD?e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch ConsoleProgram "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" "+i+" && java -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" ConsoleProgram "+e.mainClass]}):r.editor.progType===vu.ProgramType.JAVA_METHOD_MAIN?e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" "+i+" && java -cp .:/app/json.jar:/app/java-util-1.19.3.jar:"+s+" "+e.mainClass]}):e.javaDebugger?(r.debugging=!0,r.connection.emit("spawn",{cmd:"sh",args:["-c","javac -g "+i+" && jdb -launch "+e.mainClass]}),n(a)):r.connection.emit("spawn",{cmd:"sh",args:["-c","javac "+(s?"-cp .:"+s+" ":"")+i+" && java "+(s?"-cp .:"+s+" ":"")+e.mainClass]})};Xs.prototype.parseDebuggerOutput=function(t){var e=this,r=t,n,i,a,s,o;if(e.language=="python3"){n=/\/home\/karel\/([\w\d\/_]+\.py)\(([\d]+)\)/gm,a=n.exec(t),a&&a.length>=3&&(o=a[1],i=a[2],s=$('[data-filename="'+o+'"]'),e.editor.editorColumns.activateFile(s),e.editor.highlightLine(i,!0,o));var c=t.indexOf("> /home/karel/");c!=-1&&(r=t.substring(0,c)),r=r.replaceAll("(Pdb) ","")}else if(e.language=="java"){var l="VM Started: No frames on the current call stack";if(t.indexOf(l)!=-1)return e.connection.emit("stdin",`cont
`),"";n=/"thread=main", ([\w\d\/_$]+)\..*, line=([\d]+)\s/gm,a=n.exec(t),a&&a.length>=3&&(o=a[1]+".java",i=a[2],s=$('[data-filename="'+o+'"]'),e.editor.editorColumns.activateFile(s),e.editor.highlightLine(i,!0,o));for(var f=t.split(`
`),g=0,m=0;m<f.length;m++)f[m].indexOf('"thread=main"')!=-1&&(g=m);g!=0&&(r=f.splice(0,g-1).join(`
`)+f.splice(g+2).join(`
`)),r=r.replaceAll("main[1] ","").trim(),r.startsWith(">")&&(r=r.substring(1).trim()),r.length&&(r+=`
`)}return r};h$.exports=Xs});var b$=D((pke,y$)=>{"use strict";var m$=Zg(),fne=xn(),pne=mn(),hne=Gv(),gne=Ni().safeSkulpt,v$=qA();function zd(t,e){var r=this;r.running=!1,r.pythonRunner=new hne(t,e),r.runCompleted=$.Deferred().resolve(),(Sk.TurtleGraphics||(Sk.TurtleGraphics={})).target="python-canvas"}fne.inherits(zd,pne);zd.prototype.init=function(){this._publish("updateCanvas")};zd.prototype.quickDraw=function(t){var e=this;return t=_.defaults(t,{width:400,height:400,oldTarget:"python-canvas",animate:!0,canvasCoordinates:[]}),e.runCompleted=e.runCompleted.then(function(){var r=$.Deferred(),n=window.Sk.TurtleGraphics.width||400,i=window.Sk.TurtleGraphics.height||400;window.Sk.TurtleGraphics.target=t.target,window.Sk.TurtleGraphics.width=t.width,window.Sk.TurtleGraphics.height=t.height,window.Sk.TurtleGraphics.animate=t.animate;var a=m$(v$,{coords:t.canvasCoordinates.join(", ")}),s=a+`__turtle.tracer(0,0)
`+t.code+`
__turtle.update()`,o=gne("<stdin>",!1,s,!0);return o.then(function(){window.Sk.TurtleGraphics.target=t.oldTarget,window.Sk.TurtleGraphics.width=n,window.Sk.TurtleGraphics.height=i,window.Sk.TurtleGraphics.animate=!0,r.resolve()}),r})};zd.prototype.run=function(t){var e=this,r=m$(v$,{coords:""});return e.runCompleted=e.runCompleted.then(function(){return t=r+t,e.pythonRunner.run(t)})};zd.prototype.stop=function(){var t=this;t.pythonRunner.stop()};y$.exports=zd});var _$=D((hke,mne)=>{mne.exports=`class Karel:
    INFINITE_LOOP = -4
    ERROR_NO_BEEPERS = -3
    ERROR_CRASH_INTO_WALL = -2
    ERROR = -1
    EAST = 0
    NORTH = 1
    WEST = 2
    SOUTH = 3
    NUM_DIRS = 4

    DIRECTIONS = {}
    DIRECTIONS[0] = "EAST"
    DIRECTIONS[1] = "NORTH"
    DIRECTIONS[2] = "WEST"
    DIRECTIONS[3] = "SOUTH"

    DIRS = {}
    DIRS["EAST"] = 0
    DIRS["NORTH"] = 1
    DIRS["WEST"] = 2
    DIRS["SOUTH"] = 3

    MOVE = 5
    PUT_BALL = 6
    TAKE_BALL = 7
    TURN_LEFT = 8
    TURN_RIGHT = 9
    TURN_AROUND = 10

    FRONT_IS_CLEAR = 11
    LEFT_IS_CLEAR = 12
    RIGHT_IS_CLEAR = 13

    BALLS_PRESENT = 14

    FACING_NORTH = 15
    FACING_SOUTH = 16
    FACING_EAST = 17
    FACING_WEST = 18

    FUNCTION = 19
    PROGRAM_COMPLETE = 20

    PAINT = 21

    RANDOM_CHANCE = 22

    RANDOM_INT = 23

    COLOR_IS = 24

    BARK = 25

    FOR_LOOP = 26

    INFINITE_LOOP_COUNTER_MAX = 500

command_list = []

class KarelState():
    rows = \${rows}
    cols = \${cols}

    dir_string = "\${dir}"
    dir = Karel.DIRS[dir_string]

    balls = \${balls}
    ball_grid = {row: {
        col: 0
        for col in range(cols)
    } for row in range(rows)}
    for row, col, num in balls:
        ball_grid[row][col] = num

    walls = \${walls}

    colors = \${colors}

    # this part needs to be after the ball_grid setup
    start = \${start}
    row = int(start['row'])
    col = int(start['col'])

def _frontIsClear():
    if KarelState.dir == Karel.EAST:
        next_row = KarelState.row
        next_col = KarelState.col + 1
    if KarelState.dir == Karel.WEST:
        next_row = KarelState.row
        next_col = KarelState.col - 1
    if KarelState.dir == Karel.NORTH:
        next_row = KarelState.row + 1
        next_col = KarelState.col
    if KarelState.dir == Karel.SOUTH:
        next_row = KarelState.row - 1
        next_col = KarelState.col

    if KarelState.dir == Karel.SOUTH or KarelState.dir == Karel.WEST:
        possible_wall = [next_row, next_col, KarelState.row, KarelState.col]
    else:
        possible_wall = [KarelState.row, KarelState.col, next_row, next_col]

    if next_row < 0 or next_col < 0:
        return False
    if next_row >= KarelState.rows or next_col >= KarelState.cols:
        return False
    return possible_wall not in KarelState.walls

def front_is_clear(secret, line):
    command_list.append({
        'c': Karel.FRONT_IS_CLEAR,
        'l': line
    })
    return _frontIsClear()

def right_is_clear(secret, line):
    command_list.append({
        'c': Karel.RIGHT_IS_CLEAR,
        'l': line
    })
    # turn right for a second
    KarelState.dir = (KarelState.dir + 3) % Karel.NUM_DIRS
    clear = _frontIsClear()
    # turn back
    KarelState.dir = (KarelState.dir + 1) % Karel.NUM_DIRS
    return clear

def left_is_clear(secret, line):
    command_list.append({
        'c': Karel.LEFT_IS_CLEAR,
        'l': line
    })
    # turn left for a second
    KarelState.dir = (KarelState.dir + 1) % Karel.NUM_DIRS
    clear = _frontIsClear()
    # turn back
    KarelState.dir = (KarelState.dir + 3) % Karel.NUM_DIRS
    return clear

def front_is_blocked(secret, line):
    return not front_is_clear(secret, line)

def left_is_blocked(secret, line):
    return not left_is_clear(secret, line)

def right_is_blocked(secret, line):
    return not right_is_clear(secret, line)

def move(secret, line):
    if not _frontIsClear():
        command_list.append({
            'c': Karel.ERROR_CRASH_INTO_WALL,
            'l': line
        })
    else:
        if KarelState.dir == Karel.EAST:
            KarelState.col += 1
        if KarelState.dir == Karel.WEST:
            KarelState.col -= 1
        if KarelState.dir == Karel.NORTH:
            KarelState.row += 1
        if KarelState.dir == Karel.SOUTH:
            KarelState.row -= 1
        command_list.append({
            'c': Karel.MOVE,
            'l': line
        })


def put_ball(secret, line):
    command_list.append({
        'c': Karel.PUT_BALL,
        'l': line
    })
    KarelState.ball_grid[KarelState.row][KarelState.col] += 1


def take_ball(secret, line):
    num_balls = KarelState.ball_grid[KarelState.row][KarelState.col]
    if num_balls > 0:
        KarelState.ball_grid[KarelState.row][KarelState.col] = num_balls - 1
        command_list.append({
            'c': Karel.TAKE_BALL,
            'l': line
        })
    else:
        command_list.append({
            'c': Karel.ERROR_NO_BEEPERS,
            'l': line
        })


def turn_left(secret, line):
    KarelState.dir = (KarelState.dir + 1) % Karel.NUM_DIRS
    command_list.append({
        'c': Karel.TURN_LEFT,
        'l': line
    })

def balls_present(secret, line):
    command_list.append({
        'c': Karel.BALLS_PRESENT,
        'l': line
    })
    num_balls = KarelState.ball_grid[KarelState.row][KarelState.col]
    return num_balls > 0

def no_balls_present(secret, line):
    return not balls_present(secret, line)

def facing_north(secret, line):
    command_list.append({
        'c': Karel.FACING_NORTH,
        'l': line
    })
    return KarelState.dir == Karel.NORTH

def not_facing_north(secret, line):
    command_list.append({
        'c': Karel.FACING_NORTH,
        'l': line
    })
    return KarelState.dir != Karel.NORTH

def facing_west(secret, line):
    command_list.append({
        'c': Karel.FACING_WEST,
        'l': line
    })
    return KarelState.dir == Karel.WEST

def not_facing_west(secret, line):
    command_list.append({
        'c': Karel.FACING_WEST,
        'l': line
    })
    return KarelState.dir != Karel.WEST

def facing_south(secret, line):
    command_list.append({
        'c': Karel.FACING_SOUTH,
        'l': line
    })
    return KarelState.dir == Karel.SOUTH

def not_facing_south(secret, line):
    command_list.append({
        'c': Karel.FACING_SOUTH,
        'l': line
    })
    return KarelState.dir != Karel.SOUTH

def facing_east(secret, line):
    command_list.append({
        'c': Karel.FACING_EAST,
        'l': line
    })
    return KarelState.dir == Karel.EAST

def not_facing_east(secret, line):
    command_list.append({
        'c': Karel.FACING_EAST,
        'l': line
    })
    return KarelState.dir != Karel.EAST

def highlight_line(secret, line):
    command_list.append({
        'c': Karel.FUNCTION,
        'l': line
    })
    return

\${superKarelAddons}

\${ultraKarelAddons}

\${studentCode}

print command_list
`});var w$=D((gke,vne)=>{vne.exports=`def turn_right(secret, line):
    KarelState.dir = (KarelState.dir - 1) % Karel.NUM_DIRS
    command_list.append({
        'c': Karel.TURN_RIGHT,
        'l': line
    })

def turn_around(secret, line):
    KarelState.dir = (KarelState.dir - 2) % Karel.NUM_DIRS
    command_list.append({
        'c': Karel.TURN_AROUND,
        'l': line
    })
`});var T$=D((mke,yne)=>{yne.exports=`def random_chance(chance, secret, line):
    command_list.append({
        'c': Karel.RANDOM_CHANCE,
        'l': line
    })
    import random
    return random.random() < chance

def color_is(test_color, secret, line):
    command_list.append({
        'c': Karel.COLOR_IS,
        'l': line
    })

    current_color = KarelState.colors[KarelState.row][KarelState.col]

    return (
        test_color == current_color or
        (
            test_color in color and
            color[test_color] == current_color
        ) or
        (
            current_color in color and
            color[current_color] == test_color
        )
    )

def paint(color, secret, line):
    command_list.append({
        'c': Karel.PAINT,
        'color': color,
        'l': line
    })
    KarelState.colors[KarelState.row][KarelState.col] = color

color = {
    'red': '#FF0000',
    'RED': '#FF0000',
    'green': '#00FF00',
    'GREEN': '#00FF00',
    'blue': '#0000FF',
    'BLUE': '#0000FF',
    'yellow': '#FFFF00',
    'YELLOW': '#FFFF00',
    'cyan': '#00FFFF',
    'CYAN': '#00FFFF',
    'orange': '#FFA500',
    'ORANGE': '#FFA500',
    'white': '#FFFFFF',
    'WHITE': '#FFFFFF',
    'black': '#000000',
    'BLACK': '#000000',
    'gray': '#cccccc',
    'GRAY': '#CCCCCC',
    'grey': '#cccccc',
    'GREY': '#CCCCCC',
    'purple': '#9B30FF',
    'PURPLE': '#9B30FF'
}
`});var S$=D((exports,module)=>{"use strict";var template=Zg(),oop=xn(),KarelUtils=Lc(),C=Nr(),BaseRunner=mn(),PythonRunner=Gv(),KarelRunner=JT(),karelPythonTemplate=_$(),superKarelAddonsPythonTemplate=w$(),ultraKarelAddonsPythonTemplate=T$();function PythonKarelRunner(t,e){var r=this;r.running=!1,r.editor=t,r.worlds=t.worlds.concat(t.user_worlds),r.pythonRunner=new PythonRunner(t,e),r.karelRunner=new KarelRunner(t),r.karelRunner.init(e),r.tester=r.karelRunner.tester}oop.inherits(PythonKarelRunner,BaseRunner);PythonKarelRunner.prototype.run=function(t){var e=this,r=$.Deferred();return e.pythonRunner.run(t,{preprocess:!0}).then(function(){var n=e.getCommandList(t),i=e.karelRunner.run(t,{pythonCommandList:n});r.resolve(i)}).catch(function(n){n.__proto__.tp$name!=="NameError"&&r.reject()}),r};PythonKarelRunner.prototype.getCommandList=function(code){var self=this,world=self.karelRunner.getWorld(),usingUltraKarel=self.editor.getProgramType()==C.ProgramType.PYTHON_ULTRA_KAREL,usingSuperKarel=usingUltraKarel||self.editor.getProgramType()==C.ProgramType.PYTHON_SUPER_KAREL,processedCode=KarelUtils.preprocessWithLineNums({code,usingSuperKarel,usingUltraKarel,usingPython:!0}),superKarelAddons="",ultraKarelAddons="";usingSuperKarel&&(superKarelAddons=template(superKarelAddonsPythonTemplate,{})),usingUltraKarel&&(ultraKarelAddons=template(ultraKarelAddonsPythonTemplate,{})),code=template(karelPythonTemplate,{studentCode:processedCode,rows:world.info.rows,cols:world.info.cols,start:JSON.stringify(world.info.start),startRow:world.karelStartRow,startCol:world.karelStartCol,dir:world.info.dir,balls:JSON.stringify(world.info.beepers||[]),walls:JSON.stringify(world.info.walls||[]),world:JSON.stringify(world.info),colors:JSON.stringify(world.colors.grid.map(function(t){return t.map(function(e){return e===null?0:e})})||[]),superKarelAddons,ultraKarelAddons}),self.pythonRunner.run(code,{stripHighlightLines:!0});var fullOutput=self.pythonRunner.getOutput();window.fullOutput=fullOutput;var output=eval(fullOutput[fullOutput.length-2]);return window.theOutput=output,output};PythonKarelRunner.prototype.stepForward=function(t){var e=this;e.karelRunner.commandListGenerated()||(e.karelRunner.commands=e.getCommandList(t)),e.karelRunner.stepForward(t)};PythonKarelRunner.prototype.stepBackward=function(t){var e=this;e.karelRunner.stepBackward(t)};PythonKarelRunner.prototype.restart=function(){var t=this;t.karelRunner.restart()};PythonKarelRunner.prototype.pause=function(){var t=this;t.karelRunner.pause()};PythonKarelRunner.prototype.unpause=function(){var t=this;t.karelRunner.unpause()};PythonKarelRunner.prototype.setGradingMode=function(t){var e=this;e.karelRunner.setGradingMode(t)};PythonKarelRunner.prototype.getWorld=function(){var t=this;return t.karelRunner.getWorld()};PythonKarelRunner.prototype.loadWorld=function(t){var e=this;e.karelRunner.loadWorld(t)};PythonKarelRunner.prototype.loadWorldById=function(t){var e=this;return e.karelRunner.loadWorldById(t)};PythonKarelRunner.prototype.stop=function(){var t=this;t.pythonRunner.stop(),t.karelRunner.stop()};module.exports=PythonKarelRunner});var C$=D((yke,x$)=>{"use strict";var vke=Nr(),E$=Cr(),bne=xn(),E$=Cr(),_ne=mn();function py(t){var e=this;e.editor=t}bne.inherits(py,_ne);py.prototype.run=function(t){var e=this;e.running=!0;var r=t;$("#markdown-runner-destination").attr("data-markdown",r),E$.trigger("CHS.Utils.markdown:setup")};py.prototype.stop=function(){$("#markdown-runner-destination").data("markdown",""),$("#markdown-runner-destination").html("")};x$.exports=py});var YS=D((bke,A$)=>{"use strict";var wne=xn(),Tne=mn(),Sne=`
import React, { Component } from 'react';
import { AppRegistry, Text, View, StyleSheet } from 'react-native';
import { Constants } from 'expo';

export default class App extends Component {
    render() {
        return (
            <View style={styles.container}>
                <Text style={styles.paragraph}>
                    Press <b>Run Code</b> to see changes
                </Text>
            </View>
        );
    }
}

const styles = StyleSheet.create({
    container: {
        flex: 1,
        alignItems: 'center',
        justifyContent: 'center',
        paddingTop: 5,
        backgroundColor: '#ecf0f1',
    },
    paragraph: {
        margin: 24,
        fontSize: 18,
        fontWeight: 'bold',
        textAlign: 'center',
        color: '#34495e',
    },
});
`;function hy(t){var e=this;e.running=!1,e.editor=t;var r=".jqconsole-cursor";$(r).css("visibility","hidden"),e.runWebPlayer=function(n,i){var a=$("#editor-react-web-player").attr("src"),s=n.replace("paddingTop: Constants.statusBarHeight,","");$(".error-message").remove();var o=encodeURIComponent(s);o.search("AppRegistry")==-1&&$(".simulator-instructions").append('<p class="error-message" style="color:red">Looks like you forgot to import AppRegistry on line 2!</p>'),o+='%0AAppRegistry.registerComponent("App"%2C%20()%20%3D%3E%20App)%3B';var c=a.search("&code=");c!==-1&&(a=a.substring(0,c));var l=(n.match(/Image/g)||[]).length;l>1&&(a+="&scale=0.75"),a+="&code="+o,$("#editor-react-web-player").remove();var f=$("<iframe>");f.attr("width",480).attr("height",425).attr("frameborder",0).attr("src",a).attr("id","editor-react-web-player"),$(".react-native-player-section").append(f)},e.runWebPlayer(Sne)}wne.inherits(hy,Tne);hy.prototype.run=function(t){var e=this;e.running=!0,e.editor.typeTester.isReactNative()&&(e.runWebPlayer(t,!1),e.editor.updateReactNativeQR(t))};hy.prototype.stop=function(){var t=this;t.running=!1};A$.exports=hy});var k$=D((_ke,I$)=>{"use strict";var Ene=xn(),xne=mn(),gy="#js-echo-sim-iframe-1",Cne="#js-echo-sim-button-1",JS="#js-echo-sim-iframe-2",Ane="#js-echo-sim-button-2",QS="#js-echo-sim-iframe-3",Ine="#js-echo-sim-button-3",kne="#js-mirror-buttons";function my(t){var e=this;e.running=!1,e.editor=t,$(Cne).on("click",function(){$(gy).show(),$(JS).hide(),$(QS).hide()}),$(Ane).on("click",function(){$(gy).hide(),$(JS).show(),$(QS).hide()}),$(Ine).on("click",function(){$(gy).hide(),$(JS).hide(),$(QS).show()})}Ene.inherits(my,xne);my.prototype.run=function(t){var e=this;e.running=!0,$(gy).show(),$(kne).show(),e.running=!1};my.prototype.stop=function(){var t=this;t.running=!1};I$.exports=my});var vy=D((wke,R$)=>{"use strict";var One=mn(),Pne=KT(),Rne=IL(),ZS=OL(),Dne=JT(),O$=Gv(),Lne=eS(),Nne=uN(),Mne=yz(),$ne=dN(),Une=fN(),Fne=gN(),Bne=p$(),qne=g$(),jne=b$(),Hne=S$(),Gne=C$(),Vne=YS(),zne=k$();function P$(t){this.editor=t}function xa(t,e){return t.socketIOTransportType==="long-polling"?new Bne(t,e):new qne(t,e)}P$.prototype.create=function(){return this.editor.typeTester.isGraphics()?new Pne(this.editor):this.editor.typeTester.isPixel()?new Fne(this.editor):this.editor.typeTester.isHTML()?new Rne(this.editor):this.editor.typeTester.isConsole()?new ZS(this.editor):this.editor.typeTester.isVanillaJS()?new ZS(this.editor):this.editor.typeTester.isPythonKarel()?new Hne(this.editor):this.editor.typeTester.isKarel()?new Dne(this.editor):this.editor.typeTester.isTurtle()?new jne(this.editor):this.editor.typeTester.isPythonTutor()?new Lne(this.editor):this.editor.typeTester.isPython()?new O$(this.editor):this.editor.typeTester.codeHubJava()?this.editor.graderExec?void 0:new xa(this.editor,"java"):this.editor.typeTester.isJava()?new Nne(this.editor):this.editor.typeTester.isC()?this.editor.graderExec?void 0:new xa(this.editor,"c"):this.editor.typeTester.isUnitTestCpp()?this.editor.graderExec?void 0:new xa(this.editor,"c++"):this.editor.typeTester.isCpp()?this.editor.graderExec?void 0:new xa(this.editor,"c++"):this.editor.typeTester.isPython2()?this.editor.graderExec?void 0:new xa(this.editor,"python2"):this.editor.typeTester.isPython3()?this.editor.graderExec?void 0:new xa(this.editor,"python3"):this.editor.typeTester.isPythonGraphics()?this.editor.graderExec?void 0:new xa(this.editor,"python3"):this.editor.typeTester.isPythonProcessing()?this.editor.graderExec?void 0:new xa(this.editor,"python3"):this.editor.typeTester.isPygame()?this.editor.graderExec?void 0:new xa(this.editor,"python3"):this.editor.typeTester.isPythonDataScience()?this.editor.graderExec?void 0:new xa(this.editor,"python3"):this.editor.typeTester.isScheme()?this.editor.graderExec?void 0:new xa(this.editor,"scheme"):this.editor.typeTester.isBash()?this.editor.graderExec?void 0:new xa(this.editor,"bash"):this.editor.typeTester.isSQL()?new Mne(this.editor):this.editor.typeTester.isUnitTestJavascript()?new ZS(this.editor):this.editor.typeTester.isUnitTestPython3()?this.editor.graderExec?void 0:new xa(this.editor,"python3"):this.editor.typeTester.isUnitTestPython()?new O$(this.editor):this.editor.typeTester.isElm()?new $ne(this.editor):this.editor.typeTester.isProcessing()?new Une(this.editor):this.editor.typeTester.isMarkdown()?new Gne(this.editor):this.editor.typeTester.isReactNative()?new Vne(this.editor):this.editor.typeTester.isAlexa()?new zne(this.editor):this.editor.typeTester.isSwift()?this.editor.graderExec?void 0:new xa(this.editor,"swift"):this.editor.typeTester.isNode()?this.editor.graderExec?void 0:new xa(this.editor,"node"):new One};R$.exports=P$});var yy=D((Tke,Wne)=>{Wne.exports=`inputs = []
current_input = 0

def input(*args):
    return readOverwrite()

def readOverwrite():
    global current_input
    global inputs
    try:
        val = inputs[current_input]
    except IndexError:
        val = 0
    else:
        current_input += 1
    return val
`});var D$=D(uc=>{"use strict";Object.defineProperty(uc,"__esModule",{value:!0});uc.newestSdkVersion=uc.oldestSdkVersion=uc.defaultSdkVersion=void 0;uc.defaultSdkVersion="53.0.0";uc.oldestSdkVersion="50.0.0";uc.newestSdkVersion="53.0.0"});var Lh=D((Eke,L$)=>{"use strict";var Kne="2.0.0",Xne=Number.MAX_SAFE_INTEGER||9007199254740991,Yne=16,Jne=250,Qne=["major","premajor","minor","preminor","patch","prepatch","prerelease"];L$.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Yne,MAX_SAFE_BUILD_LENGTH:Jne,MAX_SAFE_INTEGER:Xne,RELEASE_TYPES:Qne,SEMVER_SPEC_VERSION:Kne,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Nh=D((xke,N$)=>{"use strict";var Zne=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};N$.exports=Zne});var Wd=D((So,M$)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:eE,MAX_SAFE_BUILD_LENGTH:eae,MAX_LENGTH:tae}=Lh(),rae=Nh();So=M$.exports={};var iae=So.re=[],nae=So.safeRe=[],Mt=So.src=[],aae=So.safeSrc=[],$t=So.t={},sae=0,tE="[a-zA-Z0-9-]",oae=[["\\s",1],["\\d",tae],[tE,eae]],uae=t=>{for(let[e,r]of oae)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},sr=(t,e,r)=>{let n=uae(e),i=sae++;rae(t,i,e),$t[t]=i,Mt[i]=e,aae[i]=n,iae[i]=new RegExp(e,r?"g":void 0),nae[i]=new RegExp(n,r?"g":void 0)};sr("NUMERICIDENTIFIER","0|[1-9]\\d*");sr("NUMERICIDENTIFIERLOOSE","\\d+");sr("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${tE}*`);sr("MAINVERSION",`(${Mt[$t.NUMERICIDENTIFIER]})\\.(${Mt[$t.NUMERICIDENTIFIER]})\\.(${Mt[$t.NUMERICIDENTIFIER]})`);sr("MAINVERSIONLOOSE",`(${Mt[$t.NUMERICIDENTIFIERLOOSE]})\\.(${Mt[$t.NUMERICIDENTIFIERLOOSE]})\\.(${Mt[$t.NUMERICIDENTIFIERLOOSE]})`);sr("PRERELEASEIDENTIFIER",`(?:${Mt[$t.NONNUMERICIDENTIFIER]}|${Mt[$t.NUMERICIDENTIFIER]})`);sr("PRERELEASEIDENTIFIERLOOSE",`(?:${Mt[$t.NONNUMERICIDENTIFIER]}|${Mt[$t.NUMERICIDENTIFIERLOOSE]})`);sr("PRERELEASE",`(?:-(${Mt[$t.PRERELEASEIDENTIFIER]}(?:\\.${Mt[$t.PRERELEASEIDENTIFIER]})*))`);sr("PRERELEASELOOSE",`(?:-?(${Mt[$t.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Mt[$t.PRERELEASEIDENTIFIERLOOSE]})*))`);sr("BUILDIDENTIFIER",`${tE}+`);sr("BUILD",`(?:\\+(${Mt[$t.BUILDIDENTIFIER]}(?:\\.${Mt[$t.BUILDIDENTIFIER]})*))`);sr("FULLPLAIN",`v?${Mt[$t.MAINVERSION]}${Mt[$t.PRERELEASE]}?${Mt[$t.BUILD]}?`);sr("FULL",`^${Mt[$t.FULLPLAIN]}$`);sr("LOOSEPLAIN",`[v=\\s]*${Mt[$t.MAINVERSIONLOOSE]}${Mt[$t.PRERELEASELOOSE]}?${Mt[$t.BUILD]}?`);sr("LOOSE",`^${Mt[$t.LOOSEPLAIN]}$`);sr("GTLT","((?:<|>)?=?)");sr("XRANGEIDENTIFIERLOOSE",`${Mt[$t.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);sr("XRANGEIDENTIFIER",`${Mt[$t.NUMERICIDENTIFIER]}|x|X|\\*`);sr("XRANGEPLAIN",`[v=\\s]*(${Mt[$t.XRANGEIDENTIFIER]})(?:\\.(${Mt[$t.XRANGEIDENTIFIER]})(?:\\.(${Mt[$t.XRANGEIDENTIFIER]})(?:${Mt[$t.PRERELEASE]})?${Mt[$t.BUILD]}?)?)?`);sr("XRANGEPLAINLOOSE",`[v=\\s]*(${Mt[$t.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Mt[$t.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Mt[$t.XRANGEIDENTIFIERLOOSE]})(?:${Mt[$t.PRERELEASELOOSE]})?${Mt[$t.BUILD]}?)?)?`);sr("XRANGE",`^${Mt[$t.GTLT]}\\s*${Mt[$t.XRANGEPLAIN]}$`);sr("XRANGELOOSE",`^${Mt[$t.GTLT]}\\s*${Mt[$t.XRANGEPLAINLOOSE]}$`);sr("COERCEPLAIN",`(^|[^\\d])(\\d{1,${eE}})(?:\\.(\\d{1,${eE}}))?(?:\\.(\\d{1,${eE}}))?`);sr("COERCE",`${Mt[$t.COERCEPLAIN]}(?:$|[^\\d])`);sr("COERCEFULL",Mt[$t.COERCEPLAIN]+`(?:${Mt[$t.PRERELEASE]})?(?:${Mt[$t.BUILD]})?(?:$|[^\\d])`);sr("COERCERTL",Mt[$t.COERCE],!0);sr("COERCERTLFULL",Mt[$t.COERCEFULL],!0);sr("LONETILDE","(?:~>?)");sr("TILDETRIM",`(\\s*)${Mt[$t.LONETILDE]}\\s+`,!0);So.tildeTrimReplace="$1~";sr("TILDE",`^${Mt[$t.LONETILDE]}${Mt[$t.XRANGEPLAIN]}$`);sr("TILDELOOSE",`^${Mt[$t.LONETILDE]}${Mt[$t.XRANGEPLAINLOOSE]}$`);sr("LONECARET","(?:\\^)");sr("CARETTRIM",`(\\s*)${Mt[$t.LONECARET]}\\s+`,!0);So.caretTrimReplace="$1^";sr("CARET",`^${Mt[$t.LONECARET]}${Mt[$t.XRANGEPLAIN]}$`);sr("CARETLOOSE",`^${Mt[$t.LONECARET]}${Mt[$t.XRANGEPLAINLOOSE]}$`);sr("COMPARATORLOOSE",`^${Mt[$t.GTLT]}\\s*(${Mt[$t.LOOSEPLAIN]})$|^$`);sr("COMPARATOR",`^${Mt[$t.GTLT]}\\s*(${Mt[$t.FULLPLAIN]})$|^$`);sr("COMPARATORTRIM",`(\\s*)${Mt[$t.GTLT]}\\s*(${Mt[$t.LOOSEPLAIN]}|${Mt[$t.XRANGEPLAIN]})`,!0);So.comparatorTrimReplace="$1$2$3";sr("HYPHENRANGE",`^\\s*(${Mt[$t.XRANGEPLAIN]})\\s+-\\s+(${Mt[$t.XRANGEPLAIN]})\\s*$`);sr("HYPHENRANGELOOSE",`^\\s*(${Mt[$t.XRANGEPLAINLOOSE]})\\s+-\\s+(${Mt[$t.XRANGEPLAINLOOSE]})\\s*$`);sr("STAR","(<|>)?=?\\s*\\*");sr("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");sr("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var by=D((Cke,$$)=>{"use strict";var cae=Object.freeze({loose:!0}),lae=Object.freeze({}),dae=t=>t?typeof t!="object"?cae:t:lae;$$.exports=dae});var rE=D((Ake,B$)=>{"use strict";var U$=/^[0-9]+$/,F$=(t,e)=>{let r=U$.test(t),n=U$.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},fae=(t,e)=>F$(e,t);B$.exports={compareIdentifiers:F$,rcompareIdentifiers:fae}});var ua=D((Ike,j$)=>{"use strict";var _y=Nh(),{MAX_LENGTH:q$,MAX_SAFE_INTEGER:wy}=Lh(),{safeRe:Ty,t:Sy}=Wd(),pae=by(),{compareIdentifiers:Kd}=rE(),iE=class t{constructor(e,r){if(r=pae(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>q$)throw new TypeError(`version is longer than ${q$} characters`);_y("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?Ty[Sy.LOOSE]:Ty[Sy.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>wy||this.major<0)throw new TypeError("Invalid major version");if(this.minor>wy||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>wy||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let a=+i;if(a>=0&&a<wy)return a}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(_y("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),Kd(this.major,e.major)||Kd(this.minor,e.minor)||Kd(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],i=e.prerelease[r];if(_y("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Kd(n,i)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],i=e.build[r];if(_y("build compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Kd(n,i)}while(++r)}inc(e,r,n){if(e.startsWith("pre")){if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let i=`-${r}`.match(this.options.loose?Ty[Sy.PRERELEASELOOSE]:Ty[Sy.PRERELEASE]);if(!i||i[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(r){let a=[r,i];n===!1&&(a=[r]),Kd(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};j$.exports=iE});var _l=D((kke,G$)=>{"use strict";var H$=ua(),hae=(t,e,r=!1)=>{if(t instanceof H$)return t;try{return new H$(t,e)}catch(n){if(!r)return null;throw n}};G$.exports=hae});var z$=D((Oke,V$)=>{"use strict";var gae=_l(),mae=(t,e)=>{let r=gae(t,e);return r?r.version:null};V$.exports=mae});var K$=D((Pke,W$)=>{"use strict";var vae=_l(),yae=(t,e)=>{let r=vae(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};W$.exports=yae});var J$=D((Rke,Y$)=>{"use strict";var X$=ua(),bae=(t,e,r,n,i)=>{typeof r=="string"&&(i=n,n=r,r=void 0);try{return new X$(t instanceof X$?t.version:t,r).inc(e,n,i).version}catch{return null}};Y$.exports=bae});var eU=D((Dke,Z$)=>{"use strict";var Q$=_l(),_ae=(t,e)=>{let r=Q$(t,null,!0),n=Q$(e,null,!0),i=r.compare(n);if(i===0)return null;let a=i>0,s=a?r:n,o=a?n:r,c=!!s.prerelease.length;if(!!o.prerelease.length&&!c){if(!o.patch&&!o.minor)return"major";if(o.compareMain(s)===0)return o.minor&&!o.patch?"minor":"patch"}let f=c?"pre":"";return r.major!==n.major?f+"major":r.minor!==n.minor?f+"minor":r.patch!==n.patch?f+"patch":"prerelease"};Z$.exports=_ae});var rU=D((Lke,tU)=>{"use strict";var wae=ua(),Tae=(t,e)=>new wae(t,e).major;tU.exports=Tae});var nU=D((Nke,iU)=>{"use strict";var Sae=ua(),Eae=(t,e)=>new Sae(t,e).minor;iU.exports=Eae});var sU=D((Mke,aU)=>{"use strict";var xae=ua(),Cae=(t,e)=>new xae(t,e).patch;aU.exports=Cae});var uU=D(($ke,oU)=>{"use strict";var Aae=_l(),Iae=(t,e)=>{let r=Aae(t,e);return r&&r.prerelease.length?r.prerelease:null};oU.exports=Iae});var ws=D((Uke,lU)=>{"use strict";var cU=ua(),kae=(t,e,r)=>new cU(t,r).compare(new cU(e,r));lU.exports=kae});var fU=D((Fke,dU)=>{"use strict";var Oae=ws(),Pae=(t,e,r)=>Oae(e,t,r);dU.exports=Pae});var hU=D((Bke,pU)=>{"use strict";var Rae=ws(),Dae=(t,e)=>Rae(t,e,!0);pU.exports=Dae});var Ey=D((qke,mU)=>{"use strict";var gU=ua(),Lae=(t,e,r)=>{let n=new gU(t,r),i=new gU(e,r);return n.compare(i)||n.compareBuild(i)};mU.exports=Lae});var yU=D((jke,vU)=>{"use strict";var Nae=Ey(),Mae=(t,e)=>t.sort((r,n)=>Nae(r,n,e));vU.exports=Mae});var _U=D((Hke,bU)=>{"use strict";var $ae=Ey(),Uae=(t,e)=>t.sort((r,n)=>$ae(n,r,e));bU.exports=Uae});var Mh=D((Gke,wU)=>{"use strict";var Fae=ws(),Bae=(t,e,r)=>Fae(t,e,r)>0;wU.exports=Bae});var xy=D((Vke,TU)=>{"use strict";var qae=ws(),jae=(t,e,r)=>qae(t,e,r)<0;TU.exports=jae});var nE=D((zke,SU)=>{"use strict";var Hae=ws(),Gae=(t,e,r)=>Hae(t,e,r)===0;SU.exports=Gae});var aE=D((Wke,EU)=>{"use strict";var Vae=ws(),zae=(t,e,r)=>Vae(t,e,r)!==0;EU.exports=zae});var Cy=D((Kke,xU)=>{"use strict";var Wae=ws(),Kae=(t,e,r)=>Wae(t,e,r)>=0;xU.exports=Kae});var Ay=D((Xke,CU)=>{"use strict";var Xae=ws(),Yae=(t,e,r)=>Xae(t,e,r)<=0;CU.exports=Yae});var sE=D((Yke,AU)=>{"use strict";var Jae=nE(),Qae=aE(),Zae=Mh(),ese=Cy(),tse=xy(),rse=Ay(),ise=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return Jae(t,r,n);case"!=":return Qae(t,r,n);case">":return Zae(t,r,n);case">=":return ese(t,r,n);case"<":return tse(t,r,n);case"<=":return rse(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};AU.exports=ise});var kU=D((Jke,IU)=>{"use strict";var nse=ua(),ase=_l(),{safeRe:Iy,t:ky}=Wd(),sse=(t,e)=>{if(t instanceof nse)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?Iy[ky.COERCEFULL]:Iy[ky.COERCE]);else{let c=e.includePrerelease?Iy[ky.COERCERTLFULL]:Iy[ky.COERCERTL],l;for(;(l=c.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||l.index+l[0].length!==r.index+r[0].length)&&(r=l),c.lastIndex=l.index+l[1].length+l[2].length;c.lastIndex=-1}if(r===null)return null;let n=r[2],i=r[3]||"0",a=r[4]||"0",s=e.includePrerelease&&r[5]?`-${r[5]}`:"",o=e.includePrerelease&&r[6]?`+${r[6]}`:"";return ase(`${n}.${i}.${a}${s}${o}`,e)};IU.exports=sse});var PU=D((Qke,OU)=>{"use strict";var oE=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,r)}return this}};OU.exports=oE});var Ts=D((Zke,NU)=>{"use strict";var ose=/\s+/g,uE=class t{constructor(e,r){if(r=cse(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof cE)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(ose," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!DU(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&mse(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let n=0;n<r.length;n++)n>0&&(this.formatted+=" "),this.formatted+=r[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&hse)|(this.options.loose&&gse))+":"+e,i=RU.get(n);if(i)return i;let a=this.options.loose,s=a?ja[Ca.HYPHENRANGELOOSE]:ja[Ca.HYPHENRANGE];e=e.replace(s,Cse(this.options.includePrerelease)),Ei("hyphen replace",e),e=e.replace(ja[Ca.COMPARATORTRIM],dse),Ei("comparator trim",e),e=e.replace(ja[Ca.TILDETRIM],fse),Ei("tilde trim",e),e=e.replace(ja[Ca.CARETTRIM],pse),Ei("caret trim",e);let o=e.split(" ").map(g=>vse(g,this.options)).join(" ").split(/\s+/).map(g=>xse(g,this.options));a&&(o=o.filter(g=>(Ei("loose invalid filter",g,this.options),!!g.match(ja[Ca.COMPARATORLOOSE])))),Ei("range list",o);let c=new Map,l=o.map(g=>new cE(g,this.options));for(let g of l){if(DU(g))return[g];c.set(g.value,g)}c.size>1&&c.has("")&&c.delete("");let f=[...c.values()];return RU.set(n,f),f}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>LU(n,r)&&e.set.some(i=>LU(i,r)&&n.every(a=>i.every(s=>a.intersects(s,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new lse(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Ase(this.set[r],e,this.options))return!0;return!1}};NU.exports=uE;var use=PU(),RU=new use,cse=by(),cE=$h(),Ei=Nh(),lse=ua(),{safeRe:ja,t:Ca,comparatorTrimReplace:dse,tildeTrimReplace:fse,caretTrimReplace:pse}=Wd(),{FLAG_INCLUDE_PRERELEASE:hse,FLAG_LOOSE:gse}=Lh(),DU=t=>t.value==="<0.0.0-0",mse=t=>t.value==="",LU=(t,e)=>{let r=!0,n=t.slice(),i=n.pop();for(;r&&n.length;)r=n.every(a=>i.intersects(a,e)),i=n.pop();return r},vse=(t,e)=>(Ei("comp",t,e),t=_se(t,e),Ei("caret",t),t=yse(t,e),Ei("tildes",t),t=Tse(t,e),Ei("xrange",t),t=Ese(t,e),Ei("stars",t),t),Aa=t=>!t||t.toLowerCase()==="x"||t==="*",yse=(t,e)=>t.trim().split(/\s+/).map(r=>bse(r,e)).join(" "),bse=(t,e)=>{let r=e.loose?ja[Ca.TILDELOOSE]:ja[Ca.TILDE];return t.replace(r,(n,i,a,s,o)=>{Ei("tilde",t,n,i,a,s,o);let c;return Aa(i)?c="":Aa(a)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:Aa(s)?c=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:o?(Ei("replaceTilde pr",o),c=`>=${i}.${a}.${s}-${o} <${i}.${+a+1}.0-0`):c=`>=${i}.${a}.${s} <${i}.${+a+1}.0-0`,Ei("tilde return",c),c})},_se=(t,e)=>t.trim().split(/\s+/).map(r=>wse(r,e)).join(" "),wse=(t,e)=>{Ei("caret",t,e);let r=e.loose?ja[Ca.CARETLOOSE]:ja[Ca.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(i,a,s,o,c)=>{Ei("caret",t,i,a,s,o,c);let l;return Aa(a)?l="":Aa(s)?l=`>=${a}.0.0${n} <${+a+1}.0.0-0`:Aa(o)?a==="0"?l=`>=${a}.${s}.0${n} <${a}.${+s+1}.0-0`:l=`>=${a}.${s}.0${n} <${+a+1}.0.0-0`:c?(Ei("replaceCaret pr",c),a==="0"?s==="0"?l=`>=${a}.${s}.${o}-${c} <${a}.${s}.${+o+1}-0`:l=`>=${a}.${s}.${o}-${c} <${a}.${+s+1}.0-0`:l=`>=${a}.${s}.${o}-${c} <${+a+1}.0.0-0`):(Ei("no pr"),a==="0"?s==="0"?l=`>=${a}.${s}.${o}${n} <${a}.${s}.${+o+1}-0`:l=`>=${a}.${s}.${o}${n} <${a}.${+s+1}.0-0`:l=`>=${a}.${s}.${o} <${+a+1}.0.0-0`),Ei("caret return",l),l})},Tse=(t,e)=>(Ei("replaceXRanges",t,e),t.split(/\s+/).map(r=>Sse(r,e)).join(" ")),Sse=(t,e)=>{t=t.trim();let r=e.loose?ja[Ca.XRANGELOOSE]:ja[Ca.XRANGE];return t.replace(r,(n,i,a,s,o,c)=>{Ei("xRange",t,n,i,a,s,o,c);let l=Aa(a),f=l||Aa(s),g=f||Aa(o),m=g;return i==="="&&m&&(i=""),c=e.includePrerelease?"-0":"",l?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&m?(f&&(s=0),o=0,i===">"?(i=">=",f?(a=+a+1,s=0,o=0):(s=+s+1,o=0)):i==="<="&&(i="<",f?a=+a+1:s=+s+1),i==="<"&&(c="-0"),n=`${i+a}.${s}.${o}${c}`):f?n=`>=${a}.0.0${c} <${+a+1}.0.0-0`:g&&(n=`>=${a}.${s}.0${c} <${a}.${+s+1}.0-0`),Ei("xRange return",n),n})},Ese=(t,e)=>(Ei("replaceStars",t,e),t.trim().replace(ja[Ca.STAR],"")),xse=(t,e)=>(Ei("replaceGTE0",t,e),t.trim().replace(ja[e.includePrerelease?Ca.GTE0PRE:Ca.GTE0],"")),Cse=t=>(e,r,n,i,a,s,o,c,l,f,g,m)=>(Aa(n)?r="":Aa(i)?r=`>=${n}.0.0${t?"-0":""}`:Aa(a)?r=`>=${n}.${i}.0${t?"-0":""}`:s?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,Aa(l)?c="":Aa(f)?c=`<${+l+1}.0.0-0`:Aa(g)?c=`<${l}.${+f+1}.0-0`:m?c=`<=${l}.${f}.${g}-${m}`:t?c=`<${l}.${f}.${+g+1}-0`:c=`<=${c}`,`${r} ${c}`.trim()),Ase=(t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(Ei(t[n].semver),t[n].semver!==cE.ANY&&t[n].semver.prerelease.length>0){let i=t[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var $h=D((eOe,qU)=>{"use strict";var Uh=Symbol("SemVer ANY"),fE=class t{static get ANY(){return Uh}constructor(e,r){if(r=MU(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),dE("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===Uh?this.value="":this.value=this.operator+this.semver.version,dE("comp",this)}parse(e){let r=this.options.loose?$U[UU.COMPARATORLOOSE]:$U[UU.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new FU(n[2],this.options.loose):this.semver=Uh}toString(){return this.value}test(e){if(dE("Comparator.test",e,this.options.loose),this.semver===Uh||e===Uh)return!0;if(typeof e=="string")try{e=new FU(e,this.options)}catch{return!1}return lE(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new BU(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new BU(this.value,r).test(e.semver):(r=MU(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||lE(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||lE(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};qU.exports=fE;var MU=by(),{safeRe:$U,t:UU}=Wd(),lE=sE(),dE=Nh(),FU=ua(),BU=Ts()});var Fh=D((tOe,jU)=>{"use strict";var Ise=Ts(),kse=(t,e,r)=>{try{e=new Ise(e,r)}catch{return!1}return e.test(t)};jU.exports=kse});var GU=D((rOe,HU)=>{"use strict";var Ose=Ts(),Pse=(t,e)=>new Ose(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));HU.exports=Pse});var zU=D((iOe,VU)=>{"use strict";var Rse=ua(),Dse=Ts(),Lse=(t,e,r)=>{let n=null,i=null,a=null;try{a=new Dse(e,r)}catch{return null}return t.forEach(s=>{a.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new Rse(n,r))}),n};VU.exports=Lse});var KU=D((nOe,WU)=>{"use strict";var Nse=ua(),Mse=Ts(),$se=(t,e,r)=>{let n=null,i=null,a=null;try{a=new Mse(e,r)}catch{return null}return t.forEach(s=>{a.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new Nse(n,r))}),n};WU.exports=$se});var JU=D((aOe,YU)=>{"use strict";var pE=ua(),Use=Ts(),XU=Mh(),Fse=(t,e)=>{t=new Use(t,e);let r=new pE("0.0.0");if(t.test(r)||(r=new pE("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let i=t.set[n],a=null;i.forEach(s=>{let o=new pE(s.semver.version);switch(s.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!a||XU(o,a))&&(a=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),a&&(!r||XU(r,a))&&(r=a)}return r&&t.test(r)?r:null};YU.exports=Fse});var ZU=D((sOe,QU)=>{"use strict";var Bse=Ts(),qse=(t,e)=>{try{return new Bse(t,e).range||"*"}catch{return null}};QU.exports=qse});var Oy=D((oOe,iF)=>{"use strict";var jse=ua(),rF=$h(),{ANY:Hse}=rF,Gse=Ts(),Vse=Fh(),eF=Mh(),tF=xy(),zse=Ay(),Wse=Cy(),Kse=(t,e,r,n)=>{t=new jse(t,n),e=new Gse(e,n);let i,a,s,o,c;switch(r){case">":i=eF,a=zse,s=tF,o=">",c=">=";break;case"<":i=tF,a=Wse,s=eF,o="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Vse(t,e,n))return!1;for(let l=0;l<e.set.length;++l){let f=e.set[l],g=null,m=null;if(f.forEach(y=>{y.semver===Hse&&(y=new rF(">=0.0.0")),g=g||y,m=m||y,i(y.semver,g.semver,n)?g=y:s(y.semver,m.semver,n)&&(m=y)}),g.operator===o||g.operator===c||(!m.operator||m.operator===o)&&a(t,m.semver))return!1;if(m.operator===c&&s(t,m.semver))return!1}return!0};iF.exports=Kse});var aF=D((uOe,nF)=>{"use strict";var Xse=Oy(),Yse=(t,e,r)=>Xse(t,e,">",r);nF.exports=Yse});var oF=D((cOe,sF)=>{"use strict";var Jse=Oy(),Qse=(t,e,r)=>Jse(t,e,"<",r);sF.exports=Qse});var lF=D((lOe,cF)=>{"use strict";var uF=Ts(),Zse=(t,e,r)=>(t=new uF(t,r),e=new uF(e,r),t.intersects(e,r));cF.exports=Zse});var fF=D((dOe,dF)=>{"use strict";var eoe=Fh(),toe=ws();dF.exports=(t,e,r)=>{let n=[],i=null,a=null,s=t.sort((f,g)=>toe(f,g,r));for(let f of s)eoe(f,e,r)?(a=f,i||(i=f)):(a&&n.push([i,a]),a=null,i=null);i&&n.push([i,null]);let o=[];for(let[f,g]of n)f===g?o.push(f):!g&&f===s[0]?o.push("*"):g?f===s[0]?o.push(`<=${g}`):o.push(`${f} - ${g}`):o.push(`>=${f}`);let c=o.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var yF=D((fOe,vF)=>{"use strict";var pF=Ts(),gE=$h(),{ANY:hE}=gE,Bh=Fh(),mE=ws(),roe=(t,e,r={})=>{if(t===e)return!0;t=new pF(t,r),e=new pF(e,r);let n=!1;e:for(let i of t.set){for(let a of e.set){let s=noe(i,a,r);if(n=n||s!==null,s)continue e}if(n)return!1}return!0},ioe=[new gE(">=0.0.0-0")],hF=[new gE(">=0.0.0")],noe=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===hE){if(e.length===1&&e[0].semver===hE)return!0;r.includePrerelease?t=ioe:t=hF}if(e.length===1&&e[0].semver===hE){if(r.includePrerelease)return!0;e=hF}let n=new Set,i,a;for(let y of t)y.operator===">"||y.operator===">="?i=gF(i,y,r):y.operator==="<"||y.operator==="<="?a=mF(a,y,r):n.add(y.semver);if(n.size>1)return null;let s;if(i&&a){if(s=mE(i.semver,a.semver,r),s>0)return null;if(s===0&&(i.operator!==">="||a.operator!=="<="))return null}for(let y of n){if(i&&!Bh(y,String(i),r)||a&&!Bh(y,String(a),r))return null;for(let A of e)if(!Bh(y,String(A),r))return!1;return!0}let o,c,l,f,g=a&&!r.includePrerelease&&a.semver.prerelease.length?a.semver:!1,m=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1;g&&g.prerelease.length===1&&a.operator==="<"&&g.prerelease[0]===0&&(g=!1);for(let y of e){if(f=f||y.operator===">"||y.operator===">=",l=l||y.operator==="<"||y.operator==="<=",i){if(m&&y.semver.prerelease&&y.semver.prerelease.length&&y.semver.major===m.major&&y.semver.minor===m.minor&&y.semver.patch===m.patch&&(m=!1),y.operator===">"||y.operator===">="){if(o=gF(i,y,r),o===y&&o!==i)return!1}else if(i.operator===">="&&!Bh(i.semver,String(y),r))return!1}if(a){if(g&&y.semver.prerelease&&y.semver.prerelease.length&&y.semver.major===g.major&&y.semver.minor===g.minor&&y.semver.patch===g.patch&&(g=!1),y.operator==="<"||y.operator==="<="){if(c=mF(a,y,r),c===y&&c!==a)return!1}else if(a.operator==="<="&&!Bh(a.semver,String(y),r))return!1}if(!y.operator&&(a||i)&&s!==0)return!1}return!(i&&l&&!a&&s!==0||a&&f&&!i&&s!==0||m||g)},gF=(t,e,r)=>{if(!t)return e;let n=mE(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},mF=(t,e,r)=>{if(!t)return e;let n=mE(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};vF.exports=roe});var TF=D((pOe,wF)=>{"use strict";var vE=Wd(),bF=Lh(),aoe=ua(),_F=rE(),soe=_l(),ooe=z$(),uoe=K$(),coe=J$(),loe=eU(),doe=rU(),foe=nU(),poe=sU(),hoe=uU(),goe=ws(),moe=fU(),voe=hU(),yoe=Ey(),boe=yU(),_oe=_U(),woe=Mh(),Toe=xy(),Soe=nE(),Eoe=aE(),xoe=Cy(),Coe=Ay(),Aoe=sE(),Ioe=kU(),koe=$h(),Ooe=Ts(),Poe=Fh(),Roe=GU(),Doe=zU(),Loe=KU(),Noe=JU(),Moe=ZU(),$oe=Oy(),Uoe=aF(),Foe=oF(),Boe=lF(),qoe=fF(),joe=yF();wF.exports={parse:soe,valid:ooe,clean:uoe,inc:coe,diff:loe,major:doe,minor:foe,patch:poe,prerelease:hoe,compare:goe,rcompare:moe,compareLoose:voe,compareBuild:yoe,sort:boe,rsort:_oe,gt:woe,lt:Toe,eq:Soe,neq:Eoe,gte:xoe,lte:Coe,cmp:Aoe,coerce:Ioe,Comparator:koe,Range:Ooe,satisfies:Poe,toComparators:Roe,maxSatisfying:Doe,minSatisfying:Loe,minVersion:Noe,validRange:Moe,outside:$oe,gtr:Uoe,ltr:Foe,intersects:Boe,simplifyRange:qoe,subset:joe,SemVer:aoe,re:vE.re,src:vE.src,tokens:vE.t,SEMVER_SPEC_VERSION:bF.SEMVER_SPEC_VERSION,RELEASE_TYPES:bF.RELEASE_TYPES,compareIdentifiers:_F.compareIdentifiers,rcompareIdentifiers:_F.rcompareIdentifiers}});var bE=D(yE=>{"use strict";Object.defineProperty(yE,"__esModule",{value:!0});var Xd={"@expo/snack-static/react-native-logo.png":"*"},Hoe={"48.0.0":{version:"^48.0.0",coreModules:{...Xd,expo:"~48.0.17",react:"18.2.0","react-dom":"*","react-native":"0.71.8","react-native-web":"*","@shopify/react-native-skia/lib/module/web":"*"},bundledModules:{"expo-asset":"*","expo-font":"*","react-native-gesture-handler":"*","react-native-safe-area-context":"*","@expo/vector-icons":"*","expo-constants":"*","expo-file-system":"*","expo-updates":"*","@react-native-async-storage/async-storage":"*","react-native-reanimated":"*","expo-router":"*","expo-router/stack":"*","expo-router/tabs":"*","expo-router/drawer":"*","expo-router/html":"*","expo-router/head":"*","expo-router/entry":"*","react-native-pager-view":"*"},deprecatedModules:{}},"49.0.0":{version:"^49.0.0",coreModules:{...Xd,expo:"~49.0.10",react:"18.2.0","react-dom":"*","react-native":"0.72.4","react-native-web":"*","@shopify/react-native-skia/lib/module/web":"*"},bundledModules:{"expo-asset":"*","expo-font":"*","react-native-gesture-handler":"*","react-native-safe-area-context":"*","@expo/vector-icons":"*","expo-constants":"*","expo-file-system":"*","expo-updates":"*","@react-native-async-storage/async-storage":"*","react-native-reanimated":"*","expo-router":"*","expo-router/stack":"*","expo-router/tabs":"*","expo-router/drawer":"*","expo-router/html":"*","expo-router/head":"*","expo-router/entry":"*","react-native-pager-view":"*"},deprecatedModules:{}},"50.0.0":{version:"^50.0.0",coreModules:{...Xd,expo:"~50.0.17",react:"18.2.0","react-dom":"*","react-native":"0.73.6","react-native-web":"*","@shopify/react-native-skia/lib/module/web":"*"},bundledModules:{"expo-asset":"*","expo-font":"*","react-native-gesture-handler":"*","react-native-safe-area-context":"*","@expo/vector-icons":"*","expo-constants":"*","expo-file-system":"*","expo-updates":"*","expo-modules-core":"*","@react-native-async-storage/async-storage":"*","react-native-reanimated":"*","expo-router":"*","expo-router/stack":"*","expo-router/tabs":"*","expo-router/drawer":"*","expo-router/html":"*","expo-router/head":"*","expo-router/entry":"*","react-native-pager-view":"*"},deprecatedModules:{}},"51.0.0":{version:"^51.0.0",coreModules:{...Xd,expo:"~51.0.31",react:"18.2.0","react-dom":"*","react-native":"0.74.5","react-native-web":"*","@shopify/react-native-skia/lib/module/web":"*"},bundledModules:{"expo-asset":"*","expo-font":"*","react-native-gesture-handler":"*","react-native-safe-area-context":"*","@expo/vector-icons":"*","expo-constants":"*","expo-file-system":"*","expo-updates":"*","@react-native-async-storage/async-storage":"*","react-native-reanimated":"*","expo-router":"*","expo-router/stack":"*","expo-router/tabs":"*","expo-router/drawer":"*","expo-router/html":"*","expo-router/head":"*","expo-router/entry":"*","react-native-pager-view":"*"},deprecatedModules:{}},"52.0.0":{version:"^52.0.0",coreModules:{...Xd,expo:"~52.0.2",react:"18.3.1","react-dom":"18.3.1","react-native":"0.76.3","react-native-web":"*","@shopify/react-native-skia/lib/module/web":"*"},bundledModules:{"expo-asset":"*","expo-font":"*","react-native-gesture-handler":"*","react-native-safe-area-context":"*","@expo/vector-icons":"*","expo-constants":"*","expo-file-system":"*","expo-updates":"*","@react-native-async-storage/async-storage":"*","react-native-reanimated":"*","expo-router":"*","expo-router/stack":"*","expo-router/tabs":"*","expo-router/drawer":"*","expo-router/html":"*","expo-router/head":"*","expo-router/entry":"*","react-native-pager-view":"*"},deprecatedModules:{}},"53.0.0":{version:"^53.0.0",coreModules:{...Xd,expo:"~53.0.7",react:"19.0.0","react-dom":"19.0.0","react-native":"0.79.2","react-native-web":"*","@shopify/react-native-skia/lib/module/web":"*"},bundledModules:{"expo-asset":"*","expo-font":"*","react-native-gesture-handler":"*","react-native-safe-area-context":"*","@expo/vector-icons":"*","expo-constants":"*","expo-file-system":"*","expo-updates":"*","@react-native-async-storage/async-storage":"*","react-native-reanimated":"*","expo-router":"*","expo-router/stack":"*","expo-router/tabs":"*","expo-router/drawer":"*","expo-router/html":"*","expo-router/head":"*","expo-router/entry":"*","react-native-pager-view":"*"},deprecatedModules:{}}};yE.default=Hoe});var SF=D(_E=>{"use strict";Object.defineProperty(_E,"__esModule",{value:!0});var Goe={MULTIPLE_FILES:"21.0.0",PROJECT_DEPENDENCIES:"25.0.0",TYPESCRIPT:"31.0.0",UNIMODULE_IMPORTS:"33.0.0",POSTMESSAGE_TRANSPORT:"35.0.0",VERSIONED_SNACKAGER:"37.0.0"};_E.default=Goe});var CF=D(cn=>{"use strict";var wE=cn&&cn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(cn,"__esModule",{value:!0});cn.standardizeDependencies=cn.isFeatureSupported=cn.isValidSemver=cn.getSupportedSDKVersions=cn.getDeprecatedModule=cn.validateSDKVersion=cn.getPreloadedModules=cn.isModulePreloaded=void 0;var xF=wE(TF()),Yd=wE(bE()),EF=wE(SF());function Voe(t,e,r){let n=Yd.default[e];return n?!!(n.coreModules[t]||!r&&n.bundledModules[t]):!1}cn.isModulePreloaded=Voe;function zoe(t,e){let r=Yd.default[t];return r?e?r.coreModules:{...r.coreModules,...r.bundledModules}:{}}cn.getPreloadedModules=zoe;function Woe(t){if(Object.keys(Yd.default).indexOf(t)<0)throw new Error(`Invalid SDKVersion, the following versions are supported: ${Object.keys(Yd.default)}`);return t}cn.validateSDKVersion=Woe;function Koe(t,e){var r,n;return(n=(r=Yd.default[e])===null||r===void 0?void 0:r.deprecatedModules)===null||n===void 0?void 0:n[t]}cn.getDeprecatedModule=Koe;function Xoe(){return Object.keys(Yd.default)}cn.getSupportedSDKVersions=Xoe;function Yoe(t){return t==="latest"||!!xF.default.validRange(t)}cn.isValidSemver=Yoe;function Joe(t,e){let r=EF.default[t];if(!r)throw new Error(`Invalid SDKFeature, the following versions are supported: ${Object.keys(EF.default)}`);return xF.default.gte(e,r)}cn.isFeatureSupported=Joe;function Qoe(t){let e=t;for(let r in t){let n=t[r];if(typeof n=="string")e=e===t?{...t}:e,e[r]={version:n};else if(typeof n=="object"){let i=Zoe(n.peerDependencies);n.peerDependencies!==i&&(e=e===t?{...t}:e,e[r]={...n,peerDependencies:i})}else e=e===t?{...t}:e,delete e[r]}return e}cn.standardizeDependencies=Qoe;function Zoe(t){if(!t)return t;let e=t;for(let r in t){let n=t[r];typeof n=="string"||n===null||(typeof n=="object"&&typeof n.version=="string"?(e=e===t?{...t}:e,e[r]=n.version):(e=e===t?{...t}:e,delete e[r]))}return e}});var IF=D(AF=>{"use strict";Object.defineProperty(AF,"__esModule",{value:!0})});var kF=D(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.parseRuntimeUrl=Ss.createRuntimeUrl=Ss.SNACK_RUNTIME_URL_PROTOCOL=Ss.SNACK_RUNTIME_URL_ENDPOINT=void 0;Ss.SNACK_RUNTIME_URL_ENDPOINT="u.expo.dev/933fd9c0-1666-11e7-afca-d980795c5824";Ss.SNACK_RUNTIME_URL_PROTOCOL="exp";function eue(t){let e=t.protocol||Ss.SNACK_RUNTIME_URL_PROTOCOL,r=t.endpoint||Ss.SNACK_RUNTIME_URL_ENDPOINT,n=new URLSearchParams;return n.set("runtime-version",`exposdk:${t.sdkVersion}`),n.set("channel-name","production"),t.snack&&n.set("snack",t.snack),t.channel&&n.set("snack-channel",t.channel),`${e}://${r}?${n}`}Ss.createRuntimeUrl=eue;function tue(t){var e,r,n;let i=typeof t=="string"?new URL(t.replace(/^[a-zA-Z]+:/,"http:")):t,a=(e=i.searchParams.get("snack"))!==null&&e!==void 0?e:void 0,s=(r=i.searchParams.get("snack-channel"))!==null&&r!==void 0?r:void 0,o=i.searchParams.get("runtime-version"),[,c]=(n=o?.match(/(?:exposdk:)?([0-9]+\.[0-9]+\.[0-9]+)/))!==null&&n!==void 0?n:[];return c?{sdkVersion:c,snack:a,channel:s}:null}Ss.parseRuntimeUrl=tue});var yu=D(Ha=>{"use strict";var rue=Ha&&Ha.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Py=Ha&&Ha.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&rue(e,t,r)},iue=Ha&&Ha.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ha,"__esModule",{value:!0});Ha.sdks=void 0;Py(D$(),Ha);Py(CF(),Ha);var nue=bE();Object.defineProperty(Ha,"sdks",{enumerable:!0,get:function(){return iue(nue).default}});Py(IF(),Ha);Py(kF(),Ha)});var TE=D((_Oe,OF)=>{var aue=typeof window=="object"&&window&&window.Object===Object&&window;OF.exports=aue});var Eo=D((wOe,PF)=>{var sue=TE(),oue=typeof self=="object"&&self&&self.Object===Object&&self,uue=sue||oue||Function("return this")();PF.exports=uue});var qh=D((TOe,RF)=>{var cue=Eo(),lue=cue.Symbol;RF.exports=lue});var MF=D((SOe,NF)=>{var DF=qh(),LF=Object.prototype,due=LF.hasOwnProperty,fue=LF.toString,jh=DF?DF.toStringTag:void 0;function pue(t){var e=due.call(t,jh),r=t[jh];try{t[jh]=void 0;var n=!0}catch{}var i=fue.call(t);return n&&(e?t[jh]=r:delete t[jh]),i}NF.exports=pue});var UF=D((EOe,$F)=>{var hue=Object.prototype,gue=hue.toString;function mue(t){return gue.call(t)}$F.exports=mue});var Jd=D((xOe,qF)=>{var FF=qh(),vue=MF(),yue=UF(),bue="[object Null]",_ue="[object Undefined]",BF=FF?FF.toStringTag:void 0;function wue(t){return t==null?t===void 0?_ue:bue:BF&&BF in Object(t)?vue(t):yue(t)}qF.exports=wue});var Ry=D((COe,jF)=>{function Tue(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}jF.exports=Tue});var SE=D((AOe,HF)=>{var Sue=Jd(),Eue=Ry(),xue="[object AsyncFunction]",Cue="[object Function]",Aue="[object GeneratorFunction]",Iue="[object Proxy]";function kue(t){if(!Eue(t))return!1;var e=Sue(t);return e==Cue||e==Aue||e==xue||e==Iue}HF.exports=kue});var VF=D((IOe,GF)=>{var Oue=Eo(),Pue=Oue["__core-js_shared__"];GF.exports=Pue});var KF=D((kOe,WF)=>{var EE=VF(),zF=function(){var t=/[^.]+$/.exec(EE&&EE.keys&&EE.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Rue(t){return!!zF&&zF in t}WF.exports=Rue});var xE=D((OOe,XF)=>{var Due=Function.prototype,Lue=Due.toString;function Nue(t){if(t!=null){try{return Lue.call(t)}catch{}try{return t+""}catch{}}return""}XF.exports=Nue});var JF=D((POe,YF)=>{var Mue=SE(),$ue=KF(),Uue=Ry(),Fue=xE(),Bue=/[\\^$.*+?()[\]{}|]/g,que=/^\[object .+?Constructor\]$/,jue=Function.prototype,Hue=Object.prototype,Gue=jue.toString,Vue=Hue.hasOwnProperty,zue=RegExp("^"+Gue.call(Vue).replace(Bue,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Wue(t){if(!Uue(t)||$ue(t))return!1;var e=Mue(t)?zue:que;return e.test(Fue(t))}YF.exports=Wue});var ZF=D((ROe,QF)=>{function Kue(t,e){return t?.[e]}QF.exports=Kue});var cc=D((DOe,eB)=>{var Xue=JF(),Yue=ZF();function Jue(t,e){var r=Yue(t,e);return Xue(r)?r:void 0}eB.exports=Jue});var rB=D((LOe,tB)=>{var Que=cc(),Zue=function(){try{var t=Que(Object,"defineProperty");return t({},"",{}),t}catch{}}();tB.exports=Zue});var aB=D((NOe,nB)=>{var iB=rB();function ece(t,e,r){e=="__proto__"&&iB?iB(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}nB.exports=ece});var oB=D((MOe,sB)=>{function tce(t){return function(e,r,n){for(var i=-1,a=Object(e),s=n(e),o=s.length;o--;){var c=s[t?o:++i];if(r(a[c],c,a)===!1)break}return e}}sB.exports=tce});var cB=D(($Oe,uB)=>{var rce=oB(),ice=rce();uB.exports=ice});var dB=D((UOe,lB)=>{function nce(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}lB.exports=nce});var Qd=D((FOe,fB)=>{function sce(t){return t!=null&&typeof t=="object"}fB.exports=sce});var hB=D((BOe,pB)=>{var oce=Jd(),uce=Qd(),cce="[object Arguments]";function lce(t){return uce(t)&&oce(t)==cce}pB.exports=lce});var CE=D((qOe,vB)=>{var gB=hB(),dce=Qd(),mB=Object.prototype,fce=mB.hasOwnProperty,pce=mB.propertyIsEnumerable,hce=gB(function(){return arguments}())?gB:function(t){return dce(t)&&fce.call(t,"callee")&&!pce.call(t,"callee")};vB.exports=hce});var bu=D((jOe,yB)=>{var gce=Array.isArray;yB.exports=gce});var _B=D((HOe,bB)=>{function mce(){return!1}bB.exports=mce});var AE=D((Hh,Zd)=>{var vce=Eo(),yce=_B(),SB=typeof Hh=="object"&&Hh&&!Hh.nodeType&&Hh,wB=SB&&typeof Zd=="object"&&Zd&&!Zd.nodeType&&Zd,bce=wB&&wB.exports===SB,TB=bce?vce.Buffer:void 0,_ce=TB?TB.isBuffer:void 0,wce=_ce||yce;Zd.exports=wce});var IE=D((GOe,EB)=>{var Tce=9007199254740991,Sce=/^(?:0|[1-9]\d*)$/;function Ece(t,e){var r=typeof t;return e=e??Tce,!!e&&(r=="number"||r!="symbol"&&Sce.test(t))&&t>-1&&t%1==0&&t<e}EB.exports=Ece});var Dy=D((VOe,xB)=>{var xce=9007199254740991;function Cce(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=xce}xB.exports=Cce});var AB=D((zOe,CB)=>{var Ace=Jd(),Ice=Dy(),kce=Qd(),Oce="[object Arguments]",Pce="[object Array]",Rce="[object Boolean]",Dce="[object Date]",Lce="[object Error]",Nce="[object Function]",Mce="[object Map]",$ce="[object Number]",Uce="[object Object]",Fce="[object RegExp]",Bce="[object Set]",qce="[object String]",jce="[object WeakMap]",Hce="[object ArrayBuffer]",Gce="[object DataView]",Vce="[object Float32Array]",zce="[object Float64Array]",Wce="[object Int8Array]",Kce="[object Int16Array]",Xce="[object Int32Array]",Yce="[object Uint8Array]",Jce="[object Uint8ClampedArray]",Qce="[object Uint16Array]",Zce="[object Uint32Array]",xi={};xi[Vce]=xi[zce]=xi[Wce]=xi[Kce]=xi[Xce]=xi[Yce]=xi[Jce]=xi[Qce]=xi[Zce]=!0;xi[Oce]=xi[Pce]=xi[Hce]=xi[Rce]=xi[Gce]=xi[Dce]=xi[Lce]=xi[Nce]=xi[Mce]=xi[$ce]=xi[Uce]=xi[Fce]=xi[Bce]=xi[qce]=xi[jce]=!1;function ele(t){return kce(t)&&Ice(t.length)&&!!xi[Ace(t)]}CB.exports=ele});var kB=D((WOe,IB)=>{function tle(t){return function(e){return t(e)}}IB.exports=tle});var PB=D((Gh,ef)=>{var rle=TE(),OB=typeof Gh=="object"&&Gh&&!Gh.nodeType&&Gh,Vh=OB&&typeof ef=="object"&&ef&&!ef.nodeType&&ef,ile=Vh&&Vh.exports===OB,kE=ile&&rle.process,nle=function(){try{var t=Vh&&Vh.require&&Vh.require("util").types;return t||kE&&kE.binding&&kE.binding("util")}catch{}}();ef.exports=nle});var OE=D((KOe,LB)=>{var ale=AB(),sle=kB(),RB=PB(),DB=RB&&RB.isTypedArray,ole=DB?sle(DB):ale;LB.exports=ole});var MB=D((XOe,NB)=>{var ule=dB(),cle=CE(),lle=bu(),dle=AE(),fle=IE(),ple=OE(),hle=Object.prototype,gle=hle.hasOwnProperty;function mle(t,e){var r=lle(t),n=!r&&cle(t),i=!r&&!n&&dle(t),a=!r&&!n&&!i&&ple(t),s=r||n||i||a,o=s?ule(t.length,String):[],c=o.length;for(var l in t)(e||gle.call(t,l))&&!(s&&(l=="length"||i&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||fle(l,c)))&&o.push(l);return o}NB.exports=mle});var UB=D((YOe,$B)=>{var vle=Object.prototype;function yle(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||vle;return t===r}$B.exports=yle});var BB=D((JOe,FB)=>{function ble(t,e){return function(r){return t(e(r))}}FB.exports=ble});var jB=D((QOe,qB)=>{var _le=BB(),wle=_le(Object.keys,Object);qB.exports=wle});var GB=D((ZOe,HB)=>{var Tle=UB(),Sle=jB(),Ele=Object.prototype,xle=Ele.hasOwnProperty;function Cle(t){if(!Tle(t))return Sle(t);var e=[];for(var r in Object(t))xle.call(t,r)&&r!="constructor"&&e.push(r);return e}HB.exports=Cle});var zB=D((ePe,VB)=>{var Ale=SE(),Ile=Dy();function kle(t){return t!=null&&Ile(t.length)&&!Ale(t)}VB.exports=kle});var Ly=D((tPe,WB)=>{var Ole=MB(),Ple=GB(),Rle=zB();function Dle(t){return Rle(t)?Ole(t):Ple(t)}WB.exports=Dle});var XB=D((rPe,KB)=>{var Lle=cB(),Nle=Ly();function Mle(t,e){return t&&Lle(t,e,Nle)}KB.exports=Mle});var JB=D((iPe,YB)=>{function $le(){this.__data__=[],this.size=0}YB.exports=$le});var PE=D((nPe,QB)=>{function Ule(t,e){return t===e||t!==t&&e!==e}QB.exports=Ule});var zh=D((aPe,ZB)=>{var Fle=PE();function Ble(t,e){for(var r=t.length;r--;)if(Fle(t[r][0],e))return r;return-1}ZB.exports=Ble});var t2=D((sPe,e2)=>{var qle=zh(),jle=Array.prototype,Hle=jle.splice;function Gle(t){var e=this.__data__,r=qle(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Hle.call(e,r,1),--this.size,!0}e2.exports=Gle});var i2=D((oPe,r2)=>{var Vle=zh();function zle(t){var e=this.__data__,r=Vle(e,t);return r<0?void 0:e[r][1]}r2.exports=zle});var a2=D((uPe,n2)=>{var Wle=zh();function Kle(t){return Wle(this.__data__,t)>-1}n2.exports=Kle});var o2=D((cPe,s2)=>{var Xle=zh();function Yle(t,e){var r=this.__data__,n=Xle(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}s2.exports=Yle});var Wh=D((lPe,u2)=>{var Jle=JB(),Qle=t2(),Zle=i2(),ede=a2(),tde=o2();function tf(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}tf.prototype.clear=Jle;tf.prototype.delete=Qle;tf.prototype.get=Zle;tf.prototype.has=ede;tf.prototype.set=tde;u2.exports=tf});var l2=D((dPe,c2)=>{var rde=Wh();function ide(){this.__data__=new rde,this.size=0}c2.exports=ide});var f2=D((fPe,d2)=>{function nde(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}d2.exports=nde});var h2=D((pPe,p2)=>{function ade(t){return this.__data__.get(t)}p2.exports=ade});var m2=D((hPe,g2)=>{function sde(t){return this.__data__.has(t)}g2.exports=sde});var Ny=D((gPe,v2)=>{var ode=cc(),ude=Eo(),cde=ode(ude,"Map");v2.exports=cde});var Kh=D((mPe,y2)=>{var lde=cc(),dde=lde(Object,"create");y2.exports=dde});var w2=D((vPe,_2)=>{var b2=Kh();function fde(){this.__data__=b2?b2(null):{},this.size=0}_2.exports=fde});var S2=D((yPe,T2)=>{function pde(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}T2.exports=pde});var x2=D((bPe,E2)=>{var hde=Kh(),gde="__lodash_hash_undefined__",mde=Object.prototype,vde=mde.hasOwnProperty;function yde(t){var e=this.__data__;if(hde){var r=e[t];return r===gde?void 0:r}return vde.call(e,t)?e[t]:void 0}E2.exports=yde});var A2=D((_Pe,C2)=>{var bde=Kh(),_de=Object.prototype,wde=_de.hasOwnProperty;function Tde(t){var e=this.__data__;return bde?e[t]!==void 0:wde.call(e,t)}C2.exports=Tde});var k2=D((wPe,I2)=>{var Sde=Kh(),Ede="__lodash_hash_undefined__";function xde(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Sde&&e===void 0?Ede:e,this}I2.exports=xde});var P2=D((TPe,O2)=>{var Cde=w2(),Ade=S2(),Ide=x2(),kde=A2(),Ode=k2();function rf(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}rf.prototype.clear=Cde;rf.prototype.delete=Ade;rf.prototype.get=Ide;rf.prototype.has=kde;rf.prototype.set=Ode;O2.exports=rf});var L2=D((SPe,D2)=>{var R2=P2(),Pde=Wh(),Rde=Ny();function Dde(){this.size=0,this.__data__={hash:new R2,map:new(Rde||Pde),string:new R2}}D2.exports=Dde});var M2=D((EPe,N2)=>{function Lde(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}N2.exports=Lde});var Xh=D((xPe,$2)=>{var Nde=M2();function Mde(t,e){var r=t.__data__;return Nde(e)?r[typeof e=="string"?"string":"hash"]:r.map}$2.exports=Mde});var F2=D((CPe,U2)=>{var $de=Xh();function Ude(t){var e=$de(this,t).delete(t);return this.size-=e?1:0,e}U2.exports=Ude});var q2=D((APe,B2)=>{var Fde=Xh();function Bde(t){return Fde(this,t).get(t)}B2.exports=Bde});var H2=D((IPe,j2)=>{var qde=Xh();function jde(t){return qde(this,t).has(t)}j2.exports=jde});var V2=D((kPe,G2)=>{var Hde=Xh();function Gde(t,e){var r=Hde(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}G2.exports=Gde});var My=D((OPe,z2)=>{var Vde=L2(),zde=F2(),Wde=q2(),Kde=H2(),Xde=V2();function nf(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}nf.prototype.clear=Vde;nf.prototype.delete=zde;nf.prototype.get=Wde;nf.prototype.has=Kde;nf.prototype.set=Xde;z2.exports=nf});var K2=D((PPe,W2)=>{var Yde=Wh(),Jde=Ny(),Qde=My(),Zde=200;function efe(t,e){var r=this.__data__;if(r instanceof Yde){var n=r.__data__;if(!Jde||n.length<Zde-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Qde(n)}return r.set(t,e),this.size=r.size,this}W2.exports=efe});var RE=D((RPe,X2)=>{var tfe=Wh(),rfe=l2(),ife=f2(),nfe=h2(),afe=m2(),sfe=K2();function af(t){var e=this.__data__=new tfe(t);this.size=e.size}af.prototype.clear=rfe;af.prototype.delete=ife;af.prototype.get=nfe;af.prototype.has=afe;af.prototype.set=sfe;X2.exports=af});var J2=D((DPe,Y2)=>{var ofe="__lodash_hash_undefined__";function ufe(t){return this.__data__.set(t,ofe),this}Y2.exports=ufe});var Z2=D((LPe,Q2)=>{function cfe(t){return this.__data__.has(t)}Q2.exports=cfe});var tq=D((NPe,eq)=>{var lfe=My(),dfe=J2(),ffe=Z2();function $y(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new lfe;++e<r;)this.add(t[e])}$y.prototype.add=$y.prototype.push=dfe;$y.prototype.has=ffe;eq.exports=$y});var iq=D((MPe,rq)=>{function pfe(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}rq.exports=pfe});var aq=D(($Pe,nq)=>{function hfe(t,e){return t.has(e)}nq.exports=hfe});var DE=D((UPe,sq)=>{var gfe=tq(),mfe=iq(),vfe=aq(),yfe=1,bfe=2;function _fe(t,e,r,n,i,a){var s=r&yfe,o=t.length,c=e.length;if(o!=c&&!(s&&c>o))return!1;var l=a.get(t),f=a.get(e);if(l&&f)return l==e&&f==t;var g=-1,m=!0,y=r&bfe?new gfe:void 0;for(a.set(t,e),a.set(e,t);++g<o;){var A=t[g],k=e[g];if(n)var I=s?n(k,A,g,e,t,a):n(A,k,g,t,e,a);if(I!==void 0){if(I)continue;m=!1;break}if(y){if(!mfe(e,function(F,J){if(!vfe(y,J)&&(A===F||i(A,F,r,n,a)))return y.push(J)})){m=!1;break}}else if(!(A===k||i(A,k,r,n,a))){m=!1;break}}return a.delete(t),a.delete(e),m}sq.exports=_fe});var uq=D((FPe,oq)=>{var wfe=Eo(),Tfe=wfe.Uint8Array;oq.exports=Tfe});var lq=D((BPe,cq)=>{function Sfe(t){var e=-1,r=Array(t.size);return t.forEach(function(n,i){r[++e]=[i,n]}),r}cq.exports=Sfe});var fq=D((qPe,dq)=>{function Efe(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}dq.exports=Efe});var vq=D((jPe,mq)=>{var pq=qh(),hq=uq(),xfe=PE(),Cfe=DE(),Afe=lq(),Ife=fq(),kfe=1,Ofe=2,Pfe="[object Boolean]",Rfe="[object Date]",Dfe="[object Error]",Lfe="[object Map]",Nfe="[object Number]",Mfe="[object RegExp]",$fe="[object Set]",Ufe="[object String]",Ffe="[object Symbol]",Bfe="[object ArrayBuffer]",qfe="[object DataView]",gq=pq?pq.prototype:void 0,LE=gq?gq.valueOf:void 0;function jfe(t,e,r,n,i,a,s){switch(r){case qfe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Bfe:return!(t.byteLength!=e.byteLength||!a(new hq(t),new hq(e)));case Pfe:case Rfe:case Nfe:return xfe(+t,+e);case Dfe:return t.name==e.name&&t.message==e.message;case Mfe:case Ufe:return t==e+"";case Lfe:var o=Afe;case $fe:var c=n&kfe;if(o||(o=Ife),t.size!=e.size&&!c)return!1;var l=s.get(t);if(l)return l==e;n|=Ofe,s.set(t,e);var f=Cfe(o(t),o(e),n,i,a,s);return s.delete(t),f;case Ffe:if(LE)return LE.call(t)==LE.call(e)}return!1}mq.exports=jfe});var bq=D((HPe,yq)=>{function Hfe(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}yq.exports=Hfe});var wq=D((GPe,_q)=>{var Gfe=bq(),Vfe=bu();function zfe(t,e,r){var n=e(t);return Vfe(t)?n:Gfe(n,r(t))}_q.exports=zfe});var Sq=D((VPe,Tq)=>{function Wfe(t,e){for(var r=-1,n=t==null?0:t.length,i=0,a=[];++r<n;){var s=t[r];e(s,r,t)&&(a[i++]=s)}return a}Tq.exports=Wfe});var xq=D((zPe,Eq)=>{function Kfe(){return[]}Eq.exports=Kfe});var Iq=D((WPe,Aq)=>{var Xfe=Sq(),Yfe=xq(),Jfe=Object.prototype,Qfe=Jfe.propertyIsEnumerable,Cq=Object.getOwnPropertySymbols,Zfe=Cq?function(t){return t==null?[]:(t=Object(t),Xfe(Cq(t),function(e){return Qfe.call(t,e)}))}:Yfe;Aq.exports=Zfe});var Oq=D((KPe,kq)=>{var epe=wq(),tpe=Iq(),rpe=Ly();function ipe(t){return epe(t,rpe,tpe)}kq.exports=ipe});var Dq=D((XPe,Rq)=>{var Pq=Oq(),npe=1,ape=Object.prototype,spe=ape.hasOwnProperty;function ope(t,e,r,n,i,a){var s=r&npe,o=Pq(t),c=o.length,l=Pq(e),f=l.length;if(c!=f&&!s)return!1;for(var g=c;g--;){var m=o[g];if(!(s?m in e:spe.call(e,m)))return!1}var y=a.get(t),A=a.get(e);if(y&&A)return y==e&&A==t;var k=!0;a.set(t,e),a.set(e,t);for(var I=s;++g<c;){m=o[g];var F=t[m],J=e[m];if(n)var pe=s?n(J,F,m,e,t,a):n(F,J,m,t,e,a);if(!(pe===void 0?F===J||i(F,J,r,n,a):pe)){k=!1;break}I||(I=m=="constructor")}if(k&&!I){var L=t.constructor,H=e.constructor;L!=H&&"constructor"in t&&"constructor"in e&&!(typeof L=="function"&&L instanceof L&&typeof H=="function"&&H instanceof H)&&(k=!1)}return a.delete(t),a.delete(e),k}Rq.exports=ope});var Nq=D((YPe,Lq)=>{var upe=cc(),cpe=Eo(),lpe=upe(cpe,"DataView");Lq.exports=lpe});var $q=D((JPe,Mq)=>{var dpe=cc(),fpe=Eo(),ppe=dpe(fpe,"Promise");Mq.exports=ppe});var Fq=D((QPe,Uq)=>{var hpe=cc(),gpe=Eo(),mpe=hpe(gpe,"Set");Uq.exports=mpe});var qq=D((ZPe,Bq)=>{var vpe=cc(),ype=Eo(),bpe=vpe(ype,"WeakMap");Bq.exports=bpe});var Xq=D((e1e,Kq)=>{var NE=Nq(),ME=Ny(),$E=$q(),UE=Fq(),FE=qq(),Wq=Jd(),sf=xE(),jq="[object Map]",_pe="[object Object]",Hq="[object Promise]",Gq="[object Set]",Vq="[object WeakMap]",zq="[object DataView]",wpe=sf(NE),Tpe=sf(ME),Spe=sf($E),Epe=sf(UE),xpe=sf(FE),wl=Wq;(NE&&wl(new NE(new ArrayBuffer(1)))!=zq||ME&&wl(new ME)!=jq||$E&&wl($E.resolve())!=Hq||UE&&wl(new UE)!=Gq||FE&&wl(new FE)!=Vq)&&(wl=function(t){var e=Wq(t),r=e==_pe?t.constructor:void 0,n=r?sf(r):"";if(n)switch(n){case wpe:return zq;case Tpe:return jq;case Spe:return Hq;case Epe:return Gq;case xpe:return Vq}return e});Kq.exports=wl});var ij=D((t1e,rj)=>{var BE=RE(),Cpe=DE(),Ape=vq(),Ipe=Dq(),Yq=Xq(),Jq=bu(),Qq=AE(),kpe=OE(),Ope=1,Zq="[object Arguments]",ej="[object Array]",Uy="[object Object]",Ppe=Object.prototype,tj=Ppe.hasOwnProperty;function Rpe(t,e,r,n,i,a){var s=Jq(t),o=Jq(e),c=s?ej:Yq(t),l=o?ej:Yq(e);c=c==Zq?Uy:c,l=l==Zq?Uy:l;var f=c==Uy,g=l==Uy,m=c==l;if(m&&Qq(t)){if(!Qq(e))return!1;s=!0,f=!1}if(m&&!f)return a||(a=new BE),s||kpe(t)?Cpe(t,e,r,n,i,a):Ape(t,e,c,r,n,i,a);if(!(r&Ope)){var y=f&&tj.call(t,"__wrapped__"),A=g&&tj.call(e,"__wrapped__");if(y||A){var k=y?t.value():t,I=A?e.value():e;return a||(a=new BE),i(k,I,r,n,a)}}return m?(a||(a=new BE),Ipe(t,e,r,n,i,a)):!1}rj.exports=Rpe});var Fy=D((r1e,sj)=>{var Dpe=ij(),nj=Qd();function aj(t,e,r,n,i){return t===e?!0:t==null||e==null||!nj(t)&&!nj(e)?t!==t&&e!==e:Dpe(t,e,r,n,aj,i)}sj.exports=aj});var uj=D((i1e,oj)=>{var Lpe=RE(),Npe=Fy(),Mpe=1,$pe=2;function Upe(t,e,r,n){var i=r.length,a=i,s=!n;if(t==null)return!a;for(t=Object(t);i--;){var o=r[i];if(s&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<a;){o=r[i];var c=o[0],l=t[c],f=o[1];if(s&&o[2]){if(l===void 0&&!(c in t))return!1}else{var g=new Lpe;if(n)var m=n(l,f,c,t,e,g);if(!(m===void 0?Npe(f,l,Mpe|$pe,n,g):m))return!1}}return!0}oj.exports=Upe});var qE=D((n1e,cj)=>{var Fpe=Ry();function Bpe(t){return t===t&&!Fpe(t)}cj.exports=Bpe});var dj=D((a1e,lj)=>{var qpe=qE(),jpe=Ly();function Hpe(t){for(var e=jpe(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,qpe(i)]}return e}lj.exports=Hpe});var jE=D((s1e,fj)=>{function Gpe(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}fj.exports=Gpe});var hj=D((o1e,pj)=>{var Vpe=uj(),zpe=dj(),Wpe=jE();function Kpe(t){var e=zpe(t);return e.length==1&&e[0][2]?Wpe(e[0][0],e[0][1]):function(r){return r===t||Vpe(r,t,e)}}pj.exports=Kpe});var By=D((u1e,gj)=>{var Xpe=Jd(),Ype=Qd(),Jpe="[object Symbol]";function Qpe(t){return typeof t=="symbol"||Ype(t)&&Xpe(t)==Jpe}gj.exports=Qpe});var qy=D((c1e,mj)=>{var Zpe=bu(),ehe=By(),the=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rhe=/^\w*$/;function ihe(t,e){if(Zpe(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||ehe(t)?!0:rhe.test(t)||!the.test(t)||e!=null&&t in Object(e)}mj.exports=ihe});var bj=D((l1e,yj)=>{var vj=My(),nhe="Expected a function";function HE(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(nhe);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var s=t.apply(this,n);return r.cache=a.set(i,s)||a,s};return r.cache=new(HE.Cache||vj),r}HE.Cache=vj;yj.exports=HE});var wj=D((d1e,_j)=>{var ahe=bj(),she=500;function ohe(t){var e=ahe(t,function(n){return r.size===she&&r.clear(),n}),r=e.cache;return e}_j.exports=ohe});var Sj=D((f1e,Tj)=>{var uhe=wj(),che=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lhe=/\\(\\)?/g,dhe=uhe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(che,function(r,n,i,a){e.push(i?a.replace(lhe,"$1"):n||r)}),e});Tj.exports=dhe});var xj=D((p1e,Ej)=>{function fhe(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}Ej.exports=fhe});var Pj=D((h1e,Oj)=>{var Cj=qh(),phe=xj(),hhe=bu(),ghe=By(),mhe=1/0,Aj=Cj?Cj.prototype:void 0,Ij=Aj?Aj.toString:void 0;function kj(t){if(typeof t=="string")return t;if(hhe(t))return phe(t,kj)+"";if(ghe(t))return Ij?Ij.call(t):"";var e=t+"";return e=="0"&&1/t==-mhe?"-0":e}Oj.exports=kj});var Dj=D((g1e,Rj)=>{var vhe=Pj();function yhe(t){return t==null?"":vhe(t)}Rj.exports=yhe});var GE=D((m1e,Lj)=>{var bhe=bu(),_he=qy(),whe=Sj(),The=Dj();function She(t,e){return bhe(t)?t:_he(t,e)?[t]:whe(The(t))}Lj.exports=She});var Yh=D((v1e,Nj)=>{var Ehe=By(),xhe=1/0;function Che(t){if(typeof t=="string"||Ehe(t))return t;var e=t+"";return e=="0"&&1/t==-xhe?"-0":e}Nj.exports=Che});var VE=D((y1e,Mj)=>{var Ahe=GE(),Ihe=Yh();function khe(t,e){e=Ahe(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Ihe(e[r++])];return r&&r==n?t:void 0}Mj.exports=khe});var Uj=D((b1e,$j)=>{var Ohe=VE();function Phe(t,e,r){var n=t==null?void 0:Ohe(t,e);return n===void 0?r:n}$j.exports=Phe});var Bj=D((_1e,Fj)=>{function Rhe(t,e){return t!=null&&e in Object(t)}Fj.exports=Rhe});var jj=D((w1e,qj)=>{var Dhe=GE(),Lhe=CE(),Nhe=bu(),Mhe=IE(),$he=Dy(),Uhe=Yh();function Fhe(t,e,r){e=Dhe(e,t);for(var n=-1,i=e.length,a=!1;++n<i;){var s=Uhe(e[n]);if(!(a=t!=null&&r(t,s)))break;t=t[s]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&$he(i)&&Mhe(s,i)&&(Nhe(t)||Lhe(t)))}qj.exports=Fhe});var Gj=D((T1e,Hj)=>{var Bhe=Bj(),qhe=jj();function jhe(t,e){return t!=null&&qhe(t,e,Bhe)}Hj.exports=jhe});var zj=D((S1e,Vj)=>{var Hhe=Fy(),Ghe=Uj(),Vhe=Gj(),zhe=qy(),Whe=qE(),Khe=jE(),Xhe=Yh(),Yhe=1,Jhe=2;function Qhe(t,e){return zhe(t)&&Whe(e)?Khe(Xhe(t),e):function(r){var n=Ghe(r,t);return n===void 0&&n===e?Vhe(r,t):Hhe(e,n,Yhe|Jhe)}}Vj.exports=Qhe});var Kj=D((E1e,Wj)=>{function Zhe(t){return t}Wj.exports=Zhe});var Yj=D((x1e,Xj)=>{function ege(t){return function(e){return e?.[t]}}Xj.exports=ege});var Qj=D((C1e,Jj)=>{var tge=VE();function rge(t){return function(e){return tge(e,t)}}Jj.exports=rge});var eH=D((A1e,Zj)=>{var ige=Yj(),nge=Qj(),age=qy(),sge=Yh();function oge(t){return age(t)?ige(sge(t)):nge(t)}Zj.exports=oge});var rH=D((I1e,tH)=>{var uge=hj(),cge=zj(),lge=Kj(),dge=bu(),fge=eH();function pge(t){return typeof t=="function"?t:t==null?lge:typeof t=="object"?dge(t)?cge(t[0],t[1]):uge(t):fge(t)}tH.exports=pge});var nH=D((k1e,iH)=>{var hge=aB(),gge=XB(),mge=rH();function vge(t,e){var r={};return e=mge(e,3),gge(t,function(n,i,a){hge(r,i,e(n,i,a))}),r}iH.exports=vge});var sH=D((O1e,jy)=>{"use strict";function aH(t,e){if(t!=null)return t;var r=new Error(e!==void 0?e:"Got unexpected "+t);throw r.framesToPop=1,r}jy.exports=aH;jy.exports.default=aH;Object.defineProperty(jy.exports,"__esModule",{value:!0})});var Jh=D((P1e,oH)=>{"use strict";var yge="2.0.0",bge=Number.MAX_SAFE_INTEGER||9007199254740991,_ge=16,wge=250,Tge=["major","premajor","minor","preminor","patch","prepatch","prerelease"];oH.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:_ge,MAX_SAFE_BUILD_LENGTH:wge,MAX_SAFE_INTEGER:bge,RELEASE_TYPES:Tge,SEMVER_SPEC_VERSION:yge,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Qh=D((R1e,uH)=>{"use strict";var Sge=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};uH.exports=Sge});var of=D((xo,cH)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:zE,MAX_SAFE_BUILD_LENGTH:Ege,MAX_LENGTH:xge}=Jh(),Cge=Qh();xo=cH.exports={};var Age=xo.re=[],Ige=xo.safeRe=[],Ut=xo.src=[],kge=xo.safeSrc=[],Ft=xo.t={},Oge=0,WE="[a-zA-Z0-9-]",Pge=[["\\s",1],["\\d",xge],[WE,Ege]],Rge=t=>{for(let[e,r]of Pge)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},or=(t,e,r)=>{let n=Rge(e),i=Oge++;Cge(t,i,e),Ft[t]=i,Ut[i]=e,kge[i]=n,Age[i]=new RegExp(e,r?"g":void 0),Ige[i]=new RegExp(n,r?"g":void 0)};or("NUMERICIDENTIFIER","0|[1-9]\\d*");or("NUMERICIDENTIFIERLOOSE","\\d+");or("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${WE}*`);or("MAINVERSION",`(${Ut[Ft.NUMERICIDENTIFIER]})\\.(${Ut[Ft.NUMERICIDENTIFIER]})\\.(${Ut[Ft.NUMERICIDENTIFIER]})`);or("MAINVERSIONLOOSE",`(${Ut[Ft.NUMERICIDENTIFIERLOOSE]})\\.(${Ut[Ft.NUMERICIDENTIFIERLOOSE]})\\.(${Ut[Ft.NUMERICIDENTIFIERLOOSE]})`);or("PRERELEASEIDENTIFIER",`(?:${Ut[Ft.NONNUMERICIDENTIFIER]}|${Ut[Ft.NUMERICIDENTIFIER]})`);or("PRERELEASEIDENTIFIERLOOSE",`(?:${Ut[Ft.NONNUMERICIDENTIFIER]}|${Ut[Ft.NUMERICIDENTIFIERLOOSE]})`);or("PRERELEASE",`(?:-(${Ut[Ft.PRERELEASEIDENTIFIER]}(?:\\.${Ut[Ft.PRERELEASEIDENTIFIER]})*))`);or("PRERELEASELOOSE",`(?:-?(${Ut[Ft.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Ut[Ft.PRERELEASEIDENTIFIERLOOSE]})*))`);or("BUILDIDENTIFIER",`${WE}+`);or("BUILD",`(?:\\+(${Ut[Ft.BUILDIDENTIFIER]}(?:\\.${Ut[Ft.BUILDIDENTIFIER]})*))`);or("FULLPLAIN",`v?${Ut[Ft.MAINVERSION]}${Ut[Ft.PRERELEASE]}?${Ut[Ft.BUILD]}?`);or("FULL",`^${Ut[Ft.FULLPLAIN]}$`);or("LOOSEPLAIN",`[v=\\s]*${Ut[Ft.MAINVERSIONLOOSE]}${Ut[Ft.PRERELEASELOOSE]}?${Ut[Ft.BUILD]}?`);or("LOOSE",`^${Ut[Ft.LOOSEPLAIN]}$`);or("GTLT","((?:<|>)?=?)");or("XRANGEIDENTIFIERLOOSE",`${Ut[Ft.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);or("XRANGEIDENTIFIER",`${Ut[Ft.NUMERICIDENTIFIER]}|x|X|\\*`);or("XRANGEPLAIN",`[v=\\s]*(${Ut[Ft.XRANGEIDENTIFIER]})(?:\\.(${Ut[Ft.XRANGEIDENTIFIER]})(?:\\.(${Ut[Ft.XRANGEIDENTIFIER]})(?:${Ut[Ft.PRERELEASE]})?${Ut[Ft.BUILD]}?)?)?`);or("XRANGEPLAINLOOSE",`[v=\\s]*(${Ut[Ft.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Ut[Ft.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Ut[Ft.XRANGEIDENTIFIERLOOSE]})(?:${Ut[Ft.PRERELEASELOOSE]})?${Ut[Ft.BUILD]}?)?)?`);or("XRANGE",`^${Ut[Ft.GTLT]}\\s*${Ut[Ft.XRANGEPLAIN]}$`);or("XRANGELOOSE",`^${Ut[Ft.GTLT]}\\s*${Ut[Ft.XRANGEPLAINLOOSE]}$`);or("COERCEPLAIN",`(^|[^\\d])(\\d{1,${zE}})(?:\\.(\\d{1,${zE}}))?(?:\\.(\\d{1,${zE}}))?`);or("COERCE",`${Ut[Ft.COERCEPLAIN]}(?:$|[^\\d])`);or("COERCEFULL",Ut[Ft.COERCEPLAIN]+`(?:${Ut[Ft.PRERELEASE]})?(?:${Ut[Ft.BUILD]})?(?:$|[^\\d])`);or("COERCERTL",Ut[Ft.COERCE],!0);or("COERCERTLFULL",Ut[Ft.COERCEFULL],!0);or("LONETILDE","(?:~>?)");or("TILDETRIM",`(\\s*)${Ut[Ft.LONETILDE]}\\s+`,!0);xo.tildeTrimReplace="$1~";or("TILDE",`^${Ut[Ft.LONETILDE]}${Ut[Ft.XRANGEPLAIN]}$`);or("TILDELOOSE",`^${Ut[Ft.LONETILDE]}${Ut[Ft.XRANGEPLAINLOOSE]}$`);or("LONECARET","(?:\\^)");or("CARETTRIM",`(\\s*)${Ut[Ft.LONECARET]}\\s+`,!0);xo.caretTrimReplace="$1^";or("CARET",`^${Ut[Ft.LONECARET]}${Ut[Ft.XRANGEPLAIN]}$`);or("CARETLOOSE",`^${Ut[Ft.LONECARET]}${Ut[Ft.XRANGEPLAINLOOSE]}$`);or("COMPARATORLOOSE",`^${Ut[Ft.GTLT]}\\s*(${Ut[Ft.LOOSEPLAIN]})$|^$`);or("COMPARATOR",`^${Ut[Ft.GTLT]}\\s*(${Ut[Ft.FULLPLAIN]})$|^$`);or("COMPARATORTRIM",`(\\s*)${Ut[Ft.GTLT]}\\s*(${Ut[Ft.LOOSEPLAIN]}|${Ut[Ft.XRANGEPLAIN]})`,!0);xo.comparatorTrimReplace="$1$2$3";or("HYPHENRANGE",`^\\s*(${Ut[Ft.XRANGEPLAIN]})\\s+-\\s+(${Ut[Ft.XRANGEPLAIN]})\\s*$`);or("HYPHENRANGELOOSE",`^\\s*(${Ut[Ft.XRANGEPLAINLOOSE]})\\s+-\\s+(${Ut[Ft.XRANGEPLAINLOOSE]})\\s*$`);or("STAR","(<|>)?=?\\s*\\*");or("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");or("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var Hy=D((D1e,lH)=>{"use strict";var Dge=Object.freeze({loose:!0}),Lge=Object.freeze({}),Nge=t=>t?typeof t!="object"?Dge:t:Lge;lH.exports=Nge});var KE=D((L1e,pH)=>{"use strict";var dH=/^[0-9]+$/,fH=(t,e)=>{let r=dH.test(t),n=dH.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},Mge=(t,e)=>fH(e,t);pH.exports={compareIdentifiers:fH,rcompareIdentifiers:Mge}});var ca=D((N1e,gH)=>{"use strict";var Gy=Qh(),{MAX_LENGTH:hH,MAX_SAFE_INTEGER:Vy}=Jh(),{safeRe:zy,t:Wy}=of(),$ge=Hy(),{compareIdentifiers:uf}=KE(),XE=class t{constructor(e,r){if(r=$ge(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>hH)throw new TypeError(`version is longer than ${hH} characters`);Gy("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?zy[Wy.LOOSE]:zy[Wy.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Vy||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Vy||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Vy||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let a=+i;if(a>=0&&a<Vy)return a}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Gy("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),uf(this.major,e.major)||uf(this.minor,e.minor)||uf(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],i=e.prerelease[r];if(Gy("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return uf(n,i)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],i=e.build[r];if(Gy("build compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return uf(n,i)}while(++r)}inc(e,r,n){if(e.startsWith("pre")){if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let i=`-${r}`.match(this.options.loose?zy[Wy.PRERELEASELOOSE]:zy[Wy.PRERELEASE]);if(!i||i[1]!==r)throw new Error(`invalid identifier: ${r}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let a=this.prerelease.length;for(;--a>=0;)typeof this.prerelease[a]=="number"&&(this.prerelease[a]++,a=-2);if(a===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(r){let a=[r,i];n===!1&&(a=[r]),uf(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};gH.exports=XE});var Tl=D((M1e,vH)=>{"use strict";var mH=ca(),Uge=(t,e,r=!1)=>{if(t instanceof mH)return t;try{return new mH(t,e)}catch(n){if(!r)return null;throw n}};vH.exports=Uge});var bH=D(($1e,yH)=>{"use strict";var Fge=Tl(),Bge=(t,e)=>{let r=Fge(t,e);return r?r.version:null};yH.exports=Bge});var wH=D((U1e,_H)=>{"use strict";var qge=Tl(),jge=(t,e)=>{let r=qge(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};_H.exports=jge});var EH=D((F1e,SH)=>{"use strict";var TH=ca(),Hge=(t,e,r,n,i)=>{typeof r=="string"&&(i=n,n=r,r=void 0);try{return new TH(t instanceof TH?t.version:t,r).inc(e,n,i).version}catch{return null}};SH.exports=Hge});var AH=D((B1e,CH)=>{"use strict";var xH=Tl(),Gge=(t,e)=>{let r=xH(t,null,!0),n=xH(e,null,!0),i=r.compare(n);if(i===0)return null;let a=i>0,s=a?r:n,o=a?n:r,c=!!s.prerelease.length;if(!!o.prerelease.length&&!c){if(!o.patch&&!o.minor)return"major";if(o.compareMain(s)===0)return o.minor&&!o.patch?"minor":"patch"}let f=c?"pre":"";return r.major!==n.major?f+"major":r.minor!==n.minor?f+"minor":r.patch!==n.patch?f+"patch":"prerelease"};CH.exports=Gge});var kH=D((q1e,IH)=>{"use strict";var Vge=ca(),zge=(t,e)=>new Vge(t,e).major;IH.exports=zge});var PH=D((j1e,OH)=>{"use strict";var Wge=ca(),Kge=(t,e)=>new Wge(t,e).minor;OH.exports=Kge});var DH=D((H1e,RH)=>{"use strict";var Xge=ca(),Yge=(t,e)=>new Xge(t,e).patch;RH.exports=Yge});var NH=D((G1e,LH)=>{"use strict";var Jge=Tl(),Qge=(t,e)=>{let r=Jge(t,e);return r&&r.prerelease.length?r.prerelease:null};LH.exports=Qge});var Es=D((V1e,$H)=>{"use strict";var MH=ca(),Zge=(t,e,r)=>new MH(t,r).compare(new MH(e,r));$H.exports=Zge});var FH=D((z1e,UH)=>{"use strict";var eme=Es(),tme=(t,e,r)=>eme(e,t,r);UH.exports=tme});var qH=D((W1e,BH)=>{"use strict";var rme=Es(),ime=(t,e)=>rme(t,e,!0);BH.exports=ime});var Ky=D((K1e,HH)=>{"use strict";var jH=ca(),nme=(t,e,r)=>{let n=new jH(t,r),i=new jH(e,r);return n.compare(i)||n.compareBuild(i)};HH.exports=nme});var VH=D((X1e,GH)=>{"use strict";var ame=Ky(),sme=(t,e)=>t.sort((r,n)=>ame(r,n,e));GH.exports=sme});var WH=D((Y1e,zH)=>{"use strict";var ome=Ky(),ume=(t,e)=>t.sort((r,n)=>ome(n,r,e));zH.exports=ume});var Zh=D((J1e,KH)=>{"use strict";var cme=Es(),lme=(t,e,r)=>cme(t,e,r)>0;KH.exports=lme});var Xy=D((Q1e,XH)=>{"use strict";var dme=Es(),fme=(t,e,r)=>dme(t,e,r)<0;XH.exports=fme});var YE=D((Z1e,YH)=>{"use strict";var pme=Es(),hme=(t,e,r)=>pme(t,e,r)===0;YH.exports=hme});var JE=D((eRe,JH)=>{"use strict";var gme=Es(),mme=(t,e,r)=>gme(t,e,r)!==0;JH.exports=mme});var Yy=D((tRe,QH)=>{"use strict";var vme=Es(),yme=(t,e,r)=>vme(t,e,r)>=0;QH.exports=yme});var Jy=D((rRe,ZH)=>{"use strict";var bme=Es(),_me=(t,e,r)=>bme(t,e,r)<=0;ZH.exports=_me});var QE=D((iRe,e3)=>{"use strict";var wme=YE(),Tme=JE(),Sme=Zh(),Eme=Yy(),xme=Xy(),Cme=Jy(),Ame=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return wme(t,r,n);case"!=":return Tme(t,r,n);case">":return Sme(t,r,n);case">=":return Eme(t,r,n);case"<":return xme(t,r,n);case"<=":return Cme(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};e3.exports=Ame});var r3=D((nRe,t3)=>{"use strict";var Ime=ca(),kme=Tl(),{safeRe:Qy,t:Zy}=of(),Ome=(t,e)=>{if(t instanceof Ime)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?Qy[Zy.COERCEFULL]:Qy[Zy.COERCE]);else{let c=e.includePrerelease?Qy[Zy.COERCERTLFULL]:Qy[Zy.COERCERTL],l;for(;(l=c.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||l.index+l[0].length!==r.index+r[0].length)&&(r=l),c.lastIndex=l.index+l[1].length+l[2].length;c.lastIndex=-1}if(r===null)return null;let n=r[2],i=r[3]||"0",a=r[4]||"0",s=e.includePrerelease&&r[5]?`-${r[5]}`:"",o=e.includePrerelease&&r[6]?`+${r[6]}`:"";return kme(`${n}.${i}.${a}${s}${o}`,e)};t3.exports=Ome});var n3=D((aRe,i3)=>{"use strict";var ZE=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,r)}return this}};i3.exports=ZE});var xs=D((sRe,u3)=>{"use strict";var Pme=/\s+/g,ex=class t{constructor(e,r){if(r=Dme(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof tx)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(Pme," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!s3(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&Bme(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let n=0;n<r.length;n++)n>0&&(this.formatted+=" "),this.formatted+=r[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&Ume)|(this.options.loose&&Fme))+":"+e,i=a3.get(n);if(i)return i;let a=this.options.loose,s=a?Ga[Ia.HYPHENRANGELOOSE]:Ga[Ia.HYPHENRANGE];e=e.replace(s,Yme(this.options.includePrerelease)),Ci("hyphen replace",e),e=e.replace(Ga[Ia.COMPARATORTRIM],Nme),Ci("comparator trim",e),e=e.replace(Ga[Ia.TILDETRIM],Mme),Ci("tilde trim",e),e=e.replace(Ga[Ia.CARETTRIM],$me),Ci("caret trim",e);let o=e.split(" ").map(g=>qme(g,this.options)).join(" ").split(/\s+/).map(g=>Xme(g,this.options));a&&(o=o.filter(g=>(Ci("loose invalid filter",g,this.options),!!g.match(Ga[Ia.COMPARATORLOOSE])))),Ci("range list",o);let c=new Map,l=o.map(g=>new tx(g,this.options));for(let g of l){if(s3(g))return[g];c.set(g.value,g)}c.size>1&&c.has("")&&c.delete("");let f=[...c.values()];return a3.set(n,f),f}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>o3(n,r)&&e.set.some(i=>o3(i,r)&&n.every(a=>i.every(s=>a.intersects(s,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new Lme(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(Jme(this.set[r],e,this.options))return!0;return!1}};u3.exports=ex;var Rme=n3(),a3=new Rme,Dme=Hy(),tx=eg(),Ci=Qh(),Lme=ca(),{safeRe:Ga,t:Ia,comparatorTrimReplace:Nme,tildeTrimReplace:Mme,caretTrimReplace:$me}=of(),{FLAG_INCLUDE_PRERELEASE:Ume,FLAG_LOOSE:Fme}=Jh(),s3=t=>t.value==="<0.0.0-0",Bme=t=>t.value==="",o3=(t,e)=>{let r=!0,n=t.slice(),i=n.pop();for(;r&&n.length;)r=n.every(a=>i.intersects(a,e)),i=n.pop();return r},qme=(t,e)=>(Ci("comp",t,e),t=Gme(t,e),Ci("caret",t),t=jme(t,e),Ci("tildes",t),t=zme(t,e),Ci("xrange",t),t=Kme(t,e),Ci("stars",t),t),ka=t=>!t||t.toLowerCase()==="x"||t==="*",jme=(t,e)=>t.trim().split(/\s+/).map(r=>Hme(r,e)).join(" "),Hme=(t,e)=>{let r=e.loose?Ga[Ia.TILDELOOSE]:Ga[Ia.TILDE];return t.replace(r,(n,i,a,s,o)=>{Ci("tilde",t,n,i,a,s,o);let c;return ka(i)?c="":ka(a)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:ka(s)?c=`>=${i}.${a}.0 <${i}.${+a+1}.0-0`:o?(Ci("replaceTilde pr",o),c=`>=${i}.${a}.${s}-${o} <${i}.${+a+1}.0-0`):c=`>=${i}.${a}.${s} <${i}.${+a+1}.0-0`,Ci("tilde return",c),c})},Gme=(t,e)=>t.trim().split(/\s+/).map(r=>Vme(r,e)).join(" "),Vme=(t,e)=>{Ci("caret",t,e);let r=e.loose?Ga[Ia.CARETLOOSE]:Ga[Ia.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(i,a,s,o,c)=>{Ci("caret",t,i,a,s,o,c);let l;return ka(a)?l="":ka(s)?l=`>=${a}.0.0${n} <${+a+1}.0.0-0`:ka(o)?a==="0"?l=`>=${a}.${s}.0${n} <${a}.${+s+1}.0-0`:l=`>=${a}.${s}.0${n} <${+a+1}.0.0-0`:c?(Ci("replaceCaret pr",c),a==="0"?s==="0"?l=`>=${a}.${s}.${o}-${c} <${a}.${s}.${+o+1}-0`:l=`>=${a}.${s}.${o}-${c} <${a}.${+s+1}.0-0`:l=`>=${a}.${s}.${o}-${c} <${+a+1}.0.0-0`):(Ci("no pr"),a==="0"?s==="0"?l=`>=${a}.${s}.${o}${n} <${a}.${s}.${+o+1}-0`:l=`>=${a}.${s}.${o}${n} <${a}.${+s+1}.0-0`:l=`>=${a}.${s}.${o} <${+a+1}.0.0-0`),Ci("caret return",l),l})},zme=(t,e)=>(Ci("replaceXRanges",t,e),t.split(/\s+/).map(r=>Wme(r,e)).join(" ")),Wme=(t,e)=>{t=t.trim();let r=e.loose?Ga[Ia.XRANGELOOSE]:Ga[Ia.XRANGE];return t.replace(r,(n,i,a,s,o,c)=>{Ci("xRange",t,n,i,a,s,o,c);let l=ka(a),f=l||ka(s),g=f||ka(o),m=g;return i==="="&&m&&(i=""),c=e.includePrerelease?"-0":"",l?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&m?(f&&(s=0),o=0,i===">"?(i=">=",f?(a=+a+1,s=0,o=0):(s=+s+1,o=0)):i==="<="&&(i="<",f?a=+a+1:s=+s+1),i==="<"&&(c="-0"),n=`${i+a}.${s}.${o}${c}`):f?n=`>=${a}.0.0${c} <${+a+1}.0.0-0`:g&&(n=`>=${a}.${s}.0${c} <${a}.${+s+1}.0-0`),Ci("xRange return",n),n})},Kme=(t,e)=>(Ci("replaceStars",t,e),t.trim().replace(Ga[Ia.STAR],"")),Xme=(t,e)=>(Ci("replaceGTE0",t,e),t.trim().replace(Ga[e.includePrerelease?Ia.GTE0PRE:Ia.GTE0],"")),Yme=t=>(e,r,n,i,a,s,o,c,l,f,g,m)=>(ka(n)?r="":ka(i)?r=`>=${n}.0.0${t?"-0":""}`:ka(a)?r=`>=${n}.${i}.0${t?"-0":""}`:s?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,ka(l)?c="":ka(f)?c=`<${+l+1}.0.0-0`:ka(g)?c=`<${l}.${+f+1}.0-0`:m?c=`<=${l}.${f}.${g}-${m}`:t?c=`<${l}.${f}.${+g+1}-0`:c=`<=${c}`,`${r} ${c}`.trim()),Jme=(t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(Ci(t[n].semver),t[n].semver!==tx.ANY&&t[n].semver.prerelease.length>0){let i=t[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var eg=D((oRe,h3)=>{"use strict";var tg=Symbol("SemVer ANY"),nx=class t{static get ANY(){return tg}constructor(e,r){if(r=c3(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),ix("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===tg?this.value="":this.value=this.operator+this.semver.version,ix("comp",this)}parse(e){let r=this.options.loose?l3[d3.COMPARATORLOOSE]:l3[d3.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new f3(n[2],this.options.loose):this.semver=tg}toString(){return this.value}test(e){if(ix("Comparator.test",e,this.options.loose),this.semver===tg||e===tg)return!0;if(typeof e=="string")try{e=new f3(e,this.options)}catch{return!1}return rx(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new p3(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new p3(this.value,r).test(e.semver):(r=c3(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||rx(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||rx(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};h3.exports=nx;var c3=Hy(),{safeRe:l3,t:d3}=of(),rx=QE(),ix=Qh(),f3=ca(),p3=xs()});var rg=D((uRe,g3)=>{"use strict";var Qme=xs(),Zme=(t,e,r)=>{try{e=new Qme(e,r)}catch{return!1}return e.test(t)};g3.exports=Zme});var v3=D((cRe,m3)=>{"use strict";var eve=xs(),tve=(t,e)=>new eve(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));m3.exports=tve});var b3=D((lRe,y3)=>{"use strict";var rve=ca(),ive=xs(),nve=(t,e,r)=>{let n=null,i=null,a=null;try{a=new ive(e,r)}catch{return null}return t.forEach(s=>{a.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new rve(n,r))}),n};y3.exports=nve});var w3=D((dRe,_3)=>{"use strict";var ave=ca(),sve=xs(),ove=(t,e,r)=>{let n=null,i=null,a=null;try{a=new sve(e,r)}catch{return null}return t.forEach(s=>{a.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new ave(n,r))}),n};_3.exports=ove});var E3=D((fRe,S3)=>{"use strict";var ax=ca(),uve=xs(),T3=Zh(),cve=(t,e)=>{t=new uve(t,e);let r=new ax("0.0.0");if(t.test(r)||(r=new ax("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let i=t.set[n],a=null;i.forEach(s=>{let o=new ax(s.semver.version);switch(s.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!a||T3(o,a))&&(a=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),a&&(!r||T3(r,a))&&(r=a)}return r&&t.test(r)?r:null};S3.exports=cve});var C3=D((pRe,x3)=>{"use strict";var lve=xs(),dve=(t,e)=>{try{return new lve(t,e).range||"*"}catch{return null}};x3.exports=dve});var eb=D((hRe,O3)=>{"use strict";var fve=ca(),k3=eg(),{ANY:pve}=k3,hve=xs(),gve=rg(),A3=Zh(),I3=Xy(),mve=Jy(),vve=Yy(),yve=(t,e,r,n)=>{t=new fve(t,n),e=new hve(e,n);let i,a,s,o,c;switch(r){case">":i=A3,a=mve,s=I3,o=">",c=">=";break;case"<":i=I3,a=vve,s=A3,o="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(gve(t,e,n))return!1;for(let l=0;l<e.set.length;++l){let f=e.set[l],g=null,m=null;if(f.forEach(y=>{y.semver===pve&&(y=new k3(">=0.0.0")),g=g||y,m=m||y,i(y.semver,g.semver,n)?g=y:s(y.semver,m.semver,n)&&(m=y)}),g.operator===o||g.operator===c||(!m.operator||m.operator===o)&&a(t,m.semver))return!1;if(m.operator===c&&s(t,m.semver))return!1}return!0};O3.exports=yve});var R3=D((gRe,P3)=>{"use strict";var bve=eb(),_ve=(t,e,r)=>bve(t,e,">",r);P3.exports=_ve});var L3=D((mRe,D3)=>{"use strict";var wve=eb(),Tve=(t,e,r)=>wve(t,e,"<",r);D3.exports=Tve});var $3=D((vRe,M3)=>{"use strict";var N3=xs(),Sve=(t,e,r)=>(t=new N3(t,r),e=new N3(e,r),t.intersects(e,r));M3.exports=Sve});var F3=D((yRe,U3)=>{"use strict";var Eve=rg(),xve=Es();U3.exports=(t,e,r)=>{let n=[],i=null,a=null,s=t.sort((f,g)=>xve(f,g,r));for(let f of s)Eve(f,e,r)?(a=f,i||(i=f)):(a&&n.push([i,a]),a=null,i=null);i&&n.push([i,null]);let o=[];for(let[f,g]of n)f===g?o.push(f):!g&&f===s[0]?o.push("*"):g?f===s[0]?o.push(`<=${g}`):o.push(`${f} - ${g}`):o.push(`>=${f}`);let c=o.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var V3=D((bRe,G3)=>{"use strict";var B3=xs(),ox=eg(),{ANY:sx}=ox,ig=rg(),ux=Es(),Cve=(t,e,r={})=>{if(t===e)return!0;t=new B3(t,r),e=new B3(e,r);let n=!1;e:for(let i of t.set){for(let a of e.set){let s=Ive(i,a,r);if(n=n||s!==null,s)continue e}if(n)return!1}return!0},Ave=[new ox(">=0.0.0-0")],q3=[new ox(">=0.0.0")],Ive=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===sx){if(e.length===1&&e[0].semver===sx)return!0;r.includePrerelease?t=Ave:t=q3}if(e.length===1&&e[0].semver===sx){if(r.includePrerelease)return!0;e=q3}let n=new Set,i,a;for(let y of t)y.operator===">"||y.operator===">="?i=j3(i,y,r):y.operator==="<"||y.operator==="<="?a=H3(a,y,r):n.add(y.semver);if(n.size>1)return null;let s;if(i&&a){if(s=ux(i.semver,a.semver,r),s>0)return null;if(s===0&&(i.operator!==">="||a.operator!=="<="))return null}for(let y of n){if(i&&!ig(y,String(i),r)||a&&!ig(y,String(a),r))return null;for(let A of e)if(!ig(y,String(A),r))return!1;return!0}let o,c,l,f,g=a&&!r.includePrerelease&&a.semver.prerelease.length?a.semver:!1,m=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1;g&&g.prerelease.length===1&&a.operator==="<"&&g.prerelease[0]===0&&(g=!1);for(let y of e){if(f=f||y.operator===">"||y.operator===">=",l=l||y.operator==="<"||y.operator==="<=",i){if(m&&y.semver.prerelease&&y.semver.prerelease.length&&y.semver.major===m.major&&y.semver.minor===m.minor&&y.semver.patch===m.patch&&(m=!1),y.operator===">"||y.operator===">="){if(o=j3(i,y,r),o===y&&o!==i)return!1}else if(i.operator===">="&&!ig(i.semver,String(y),r))return!1}if(a){if(g&&y.semver.prerelease&&y.semver.prerelease.length&&y.semver.major===g.major&&y.semver.minor===g.minor&&y.semver.patch===g.patch&&(g=!1),y.operator==="<"||y.operator==="<="){if(c=H3(a,y,r),c===y&&c!==a)return!1}else if(a.operator==="<="&&!ig(a.semver,String(y),r))return!1}if(!y.operator&&(a||i)&&s!==0)return!1}return!(i&&l&&!a&&s!==0||a&&f&&!i&&s!==0||m||g)},j3=(t,e,r)=>{if(!t)return e;let n=ux(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},H3=(t,e,r)=>{if(!t)return e;let n=ux(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};G3.exports=Cve});var X3=D((_Re,K3)=>{"use strict";var cx=of(),z3=Jh(),kve=ca(),W3=KE(),Ove=Tl(),Pve=bH(),Rve=wH(),Dve=EH(),Lve=AH(),Nve=kH(),Mve=PH(),$ve=DH(),Uve=NH(),Fve=Es(),Bve=FH(),qve=qH(),jve=Ky(),Hve=VH(),Gve=WH(),Vve=Zh(),zve=Xy(),Wve=YE(),Kve=JE(),Xve=Yy(),Yve=Jy(),Jve=QE(),Qve=r3(),Zve=eg(),eye=xs(),tye=rg(),rye=v3(),iye=b3(),nye=w3(),aye=E3(),sye=C3(),oye=eb(),uye=R3(),cye=L3(),lye=$3(),dye=F3(),fye=V3();K3.exports={parse:Ove,valid:Pve,clean:Rve,inc:Dve,diff:Lve,major:Nve,minor:Mve,patch:$ve,prerelease:Uve,compare:Fve,rcompare:Bve,compareLoose:qve,compareBuild:jve,sort:Hve,rsort:Gve,gt:Vve,lt:zve,eq:Wve,neq:Kve,gte:Xve,lte:Yve,cmp:Jve,coerce:Qve,Comparator:Zve,Range:eye,satisfies:tye,toComparators:rye,maxSatisfying:iye,minSatisfying:nye,minVersion:aye,validRange:sye,outside:oye,gtr:uye,ltr:cye,intersects:lye,simplifyRange:dye,subset:fye,SemVer:kve,re:cx.re,src:cx.src,tokens:cx.t,SEMVER_SPEC_VERSION:z3.SEMVER_SPEC_VERSION,RELEASE_TYPES:z3.RELEASE_TYPES,compareIdentifiers:W3.compareIdentifiers,rcompareIdentifiers:W3.rcompareIdentifiers}});var Y3=D((wRe,pye)=>{pye.exports=["assert","buffer","child_process","cluster","console","constants","crypto","dgram","dns","domain","events","fs","http","https","module","net","os","path","process","punycode","querystring","readline","repl","stream","string_decoder","timers","tls","tty","url","util","v8","vm","zlib"]});var Z3=D((TRe,Q3)=>{"use strict";var J3=new RegExp("^(?:@([^/]+?)[/])?([^/]+?)$"),hye=Y3(),gye=["node_modules","favicon.ico"],mye=Q3.exports=function(t){var e=[],r=[];if(t===null)return r.push("name cannot be null"),ng(e,r);if(t===void 0)return r.push("name cannot be undefined"),ng(e,r);if(typeof t!="string")return r.push("name must be a string"),ng(e,r);if(t.length||r.push("name length must be greater than zero"),t.match(/^\./)&&r.push("name cannot start with a period"),t.match(/^_/)&&r.push("name cannot start with an underscore"),t.trim()!==t&&r.push("name cannot contain leading or trailing spaces"),gye.forEach(function(s){t.toLowerCase()===s&&r.push(s+" is a blacklisted name")}),hye.forEach(function(s){t.toLowerCase()===s&&e.push(s+" is a core module name")}),t.length>214&&e.push("name can no longer contain more than 214 characters"),t.toLowerCase()!==t&&e.push("name can no longer contain capital letters"),/[~'!()*]/.test(t.split("/").slice(-1)[0])&&e.push(`name can no longer contain special characters ("~'!()*")`),encodeURIComponent(t)!==t){var n=t.match(J3);if(n){var i=n[1],a=n[2];if(encodeURIComponent(i)===i&&encodeURIComponent(a)===a)return ng(e,r)}r.push("name can only contain URL-friendly characters")}return ng(e,r)};mye.scopedPackagePattern=J3;var ng=function(t,e){var r={validForNewPackages:e.length===0&&t.length===0,validForOldPackages:e.length===0,warnings:t,errors:e};return r.warnings.length||delete r.warnings,r.errors.length||delete r.errors,r}});var e4=D((ag,lx)=>{(function(t){"use strict";function e(r){var n=r&&r.Promise||t.Promise,i=r&&r.XMLHttpRequest||t.XMLHttpRequest;return function(){var a=Object.create(t,{fetch:{value:void 0,writable:!0}});return function(s,o){typeof ag=="object"&&typeof lx<"u"?o(ag):typeof define=="function"&&define.amd?define(["exports"],o):o(s.WHATWGFetch={})}(this,function(s){"use strict";var o=typeof a<"u"&&a||typeof self<"u"&&self||typeof o<"u"&&o,c={searchParams:"URLSearchParams"in o,iterable:"Symbol"in o&&"iterator"in Symbol,blob:"FileReader"in o&&"Blob"in o&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in o,arrayBuffer:"ArrayBuffer"in o};function l(de){return de&&DataView.prototype.isPrototypeOf(de)}if(c.arrayBuffer)var f=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=ArrayBuffer.isView||function(de){return de&&f.indexOf(Object.prototype.toString.call(de))>-1};function m(de){if(typeof de!="string"&&(de=String(de)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(de)||de==="")throw new TypeError("Invalid character in header field name");return de.toLowerCase()}function y(de){return typeof de!="string"&&(de=String(de)),de}function A(de){var Q={next:function(){var Fe=de.shift();return{done:Fe===void 0,value:Fe}}};return c.iterable&&(Q[Symbol.iterator]=function(){return Q}),Q}function k(de){this.map={},de instanceof k?de.forEach(function(Q,Fe){this.append(Fe,Q)},this):Array.isArray(de)?de.forEach(function(Q){this.append(Q[0],Q[1])},this):de&&Object.getOwnPropertyNames(de).forEach(function(Q){this.append(Q,de[Q])},this)}k.prototype.append=function(de,Q){de=m(de),Q=y(Q);var Fe=this.map[de];this.map[de]=Fe?Fe+", "+Q:Q},k.prototype.delete=function(de){delete this.map[m(de)]},k.prototype.get=function(de){return de=m(de),this.has(de)?this.map[de]:null},k.prototype.has=function(de){return this.map.hasOwnProperty(m(de))},k.prototype.set=function(de,Q){this.map[m(de)]=y(Q)},k.prototype.forEach=function(de,Q){for(var Fe in this.map)this.map.hasOwnProperty(Fe)&&de.call(Q,this.map[Fe],Fe,this)},k.prototype.keys=function(){var de=[];return this.forEach(function(Q,Fe){de.push(Fe)}),A(de)},k.prototype.values=function(){var de=[];return this.forEach(function(Q){de.push(Q)}),A(de)},k.prototype.entries=function(){var de=[];return this.forEach(function(Q,Fe){de.push([Fe,Q])}),A(de)},c.iterable&&(k.prototype[Symbol.iterator]=k.prototype.entries);function I(de){if(de.bodyUsed)return n.reject(new TypeError("Already read"));de.bodyUsed=!0}function F(de){return new n(function(Q,Fe){de.onload=function(){Q(de.result)},de.onerror=function(){Fe(de.error)}})}function J(de){var Q=new FileReader,Fe=F(Q);return Q.readAsArrayBuffer(de),Fe}function pe(de){var Q=new FileReader,Fe=F(Q);return Q.readAsText(de),Fe}function L(de){for(var Q=new Uint8Array(de),Fe=new Array(Q.length),We=0;We<Q.length;We++)Fe[We]=String.fromCharCode(Q[We]);return Fe.join("")}function H(de){if(de.slice)return de.slice(0);var Q=new Uint8Array(de.byteLength);return Q.set(new Uint8Array(de)),Q.buffer}function j(){return this.bodyUsed=!1,this._initBody=function(de){this.bodyUsed=this.bodyUsed,this._bodyInit=de,de?typeof de=="string"?this._bodyText=de:c.blob&&Blob.prototype.isPrototypeOf(de)?this._bodyBlob=de:c.formData&&FormData.prototype.isPrototypeOf(de)?this._bodyFormData=de:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(de)?this._bodyText=de.toString():c.arrayBuffer&&c.blob&&l(de)?(this._bodyArrayBuffer=H(de.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(de)||g(de))?this._bodyArrayBuffer=H(de):this._bodyText=de=Object.prototype.toString.call(de):this._bodyText="",this.headers.get("content-type")||(typeof de=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(de)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var de=I(this);if(de)return de;if(this._bodyBlob)return n.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return n.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return n.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var de=I(this);return de||(ArrayBuffer.isView(this._bodyArrayBuffer)?n.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):n.resolve(this._bodyArrayBuffer))}else return this.blob().then(J)}),this.text=function(){var de=I(this);if(de)return de;if(this._bodyBlob)return pe(this._bodyBlob);if(this._bodyArrayBuffer)return n.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return n.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(fe)}),this.json=function(){return this.text().then(JSON.parse)},this}var X=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function V(de){var Q=de.toUpperCase();return X.indexOf(Q)>-1?Q:de}function ie(de,Q){if(!(this instanceof ie))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');Q=Q||{};var Fe=Q.body;if(de instanceof ie){if(de.bodyUsed)throw new TypeError("Already read");this.url=de.url,this.credentials=de.credentials,Q.headers||(this.headers=new k(de.headers)),this.method=de.method,this.mode=de.mode,this.signal=de.signal,!Fe&&de._bodyInit!=null&&(Fe=de._bodyInit,de.bodyUsed=!0)}else this.url=String(de);if(this.credentials=Q.credentials||this.credentials||"same-origin",(Q.headers||!this.headers)&&(this.headers=new k(Q.headers)),this.method=V(Q.method||this.method||"GET"),this.mode=Q.mode||this.mode||null,this.signal=Q.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Fe)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(Fe),(this.method==="GET"||this.method==="HEAD")&&(Q.cache==="no-store"||Q.cache==="no-cache")){var We=/([?&])_=[^&]*/;if(We.test(this.url))this.url=this.url.replace(We,"$1_="+new Date().getTime());else{var tt=/\?/;this.url+=(tt.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}ie.prototype.clone=function(){return new ie(this,{body:this._bodyInit})};function fe(de){var Q=new FormData;return de.trim().split("&").forEach(function(Fe){if(Fe){var We=Fe.split("="),tt=We.shift().replace(/\+/g," "),Le=We.join("=").replace(/\+/g," ");Q.append(decodeURIComponent(tt),decodeURIComponent(Le))}}),Q}function Re(de){var Q=new k,Fe=de.replace(/\r?\n[\t ]+/g," ");return Fe.split("\r").map(function(We){return We.indexOf(`
`)===0?We.substr(1,We.length):We}).forEach(function(We){var tt=We.split(":"),Le=tt.shift().trim();if(Le){var Tt=tt.join(":").trim();Q.append(Le,Tt)}}),Q}j.call(ie.prototype);function ye(de,Q){if(!(this instanceof ye))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');Q||(Q={}),this.type="default",this.status=Q.status===void 0?200:Q.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Q?Q.statusText:"",this.headers=new k(Q.headers),this.url=Q.url||"",this._initBody(de)}j.call(ye.prototype),ye.prototype.clone=function(){return new ye(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new k(this.headers),url:this.url})},ye.error=function(){var de=new ye(null,{status:0,statusText:""});return de.type="error",de};var ze=[301,302,303,307,308];ye.redirect=function(de,Q){if(ze.indexOf(Q)===-1)throw new RangeError("Invalid status code");return new ye(null,{status:Q,headers:{location:de}})},s.DOMException=o.DOMException;try{new s.DOMException}catch{s.DOMException=function(Q,Fe){this.message=Q,this.name=Fe;var We=Error(Q);this.stack=We.stack},s.DOMException.prototype=Object.create(Error.prototype),s.DOMException.prototype.constructor=s.DOMException}function Ue(de,Q){return new n(function(Fe,We){var tt=new ie(de,Q);if(tt.signal&&tt.signal.aborted)return We(new s.DOMException("Aborted","AbortError"));var Le=new i;function Tt(){Le.abort()}Le.onload=function(){var St={status:Le.status,statusText:Le.statusText,headers:Re(Le.getAllResponseHeaders()||"")};St.url="responseURL"in Le?Le.responseURL:St.headers.get("X-Request-URL");var Zt="response"in Le?Le.response:Le.responseText;setTimeout(function(){Fe(new ye(Zt,St))},0)},Le.onerror=function(){setTimeout(function(){We(new TypeError("Network request failed"))},0)},Le.ontimeout=function(){setTimeout(function(){We(new TypeError("Network request failed"))},0)},Le.onabort=function(){setTimeout(function(){We(new s.DOMException("Aborted","AbortError"))},0)};function It(St){try{return St===""&&o.location.href?o.location.href:St}catch{return St}}Le.open(tt.method,It(tt.url),!0),tt.credentials==="include"?Le.withCredentials=!0:tt.credentials==="omit"&&(Le.withCredentials=!1),"responseType"in Le&&(c.blob?Le.responseType="blob":c.arrayBuffer&&tt.headers.get("Content-Type")&&tt.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(Le.responseType="arraybuffer")),Q&&typeof Q.headers=="object"&&!(Q.headers instanceof k)?Object.getOwnPropertyNames(Q.headers).forEach(function(St){Le.setRequestHeader(St,y(Q.headers[St]))}):tt.headers.forEach(function(St,Zt){Le.setRequestHeader(Zt,St)}),tt.signal&&(tt.signal.addEventListener("abort",Tt),Le.onreadystatechange=function(){Le.readyState===4&&tt.signal.removeEventListener("abort",Tt)}),Le.send(typeof tt._bodyInit>"u"?null:tt._bodyInit)})}Ue.polyfill=!0,o.fetch||(o.fetch=Ue,o.Headers=k,o.Request=ie,o.Response=ye),s.Headers=k,s.Request=ie,s.Response=ye,s.fetch=Ue,Object.defineProperty(s,"__esModule",{value:!0})}),{fetch:a.fetch,Headers:a.Headers,Request:a.Request,Response:a.Response,DOMException:a.DOMException}}()}typeof define=="function"&&define.amd?define(function(){return e}):typeof ag=="object"?lx.exports=e:t.fetchPonyfill=e})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ag)});var t4,r4=FA(()=>{t4="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"});var a4={};pz(a4,{customAlphabet:()=>vye,customRandom:()=>n4,nanoid:()=>yye,random:()=>i4,urlAlphabet:()=>t4});var i4,n4,vye,yye,s4=FA(()=>{r4();i4=t=>crypto.getRandomValues(new Uint8Array(t)),n4=(t,e,r)=>{let n=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*n*e/t.length);return(a=e)=>{let s="";for(;;){let o=r(i),c=i;for(;c--;)if(s+=t[o[c]&n]||"",s.length===a)return s}}},vye=(t,e=21)=>n4(t,e,i4),yye=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"")});var cf=D(Va=>{"use strict";var bye=Va&&Va.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Va,"__esModule",{value:!0});Va.createUserHeader=Va.createError=Va.createURL=Va.createChannel=Va.fetch=void 0;var _ye=bye(e4()),wye=(s4(),hz(a4)),Tye=yu(),Sye=_ye.default().fetch;Va.fetch=Sye;var o4="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",Eye=wye.customAlphabet(o4,10);function xye(t){if(t=t??Eye(),t.length<6)throw new Error("Please use a channel id with more characters (entropy)");if(t.length>128)throw new Error("Channel id too long, use a channel id thats shorter than 128 characters");for(var e=0,r=t;e<r.length;e++){var n=r[e];if(o4.indexOf(n)<0)throw new Error('Channel id contains an invalid character "'+n+'", only "[0-9a-zA-Z]" are allowed')}return t}Va.createChannel=xye;function Cye(t,e,r,n){return Tye.createRuntimeUrl({endpoint:t,channel:r,sdkVersion:e,snack:n})}Va.createURL=Cye;function Aye(t){var e=new Error(t.message);return t.name&&(e.name=t.name),t.fileName&&(e.fileName=t.fileName),t.lineNumber&&(e.lineNumber=t.lineNumber),t.columnNumber&&(e.columnNumber=t.columnNumber),t.stack&&(e.stack=t.stack),e}Va.createError=Aye;function Iye(t){return t?.sessionSecret?{"Expo-Session":t.sessionSecret}:t?.accessToken?{Authorization:"Bearer "+t.accessToken}:{}}Va.createUserHeader=Iye});var p4=D(Bn=>{"use strict";var u4=Bn&&Bn.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},c4=Bn&&Bn.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},kye=Bn&&Bn.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n},d4=Bn&&Bn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.getPackageName=Bn.verifyDependency=Bn.getMissingDependencies=void 0;var dx=d4(X3()),f4=yu(),fx=d4(Z3()),tb=cf();function l4(t,e){return e?t+"@"+e:t}var Oye=function(){function t(e){this.status={},this.snackagerURL=e.snackagerURL,this.logger=e.logger,this.callback=e.callback}return t.prototype.add=function(e,r,n){var i=l4(e,r);return this.status[i]=this.status[i]||this.resolve(i,e,r,n),this.status[i]},t.prototype.remove=function(e,r,n){delete this.status[l4(e,r)]},t.prototype.waitForCompletion=function(){return u4(this,void 0,void 0,function(){var e;return c4(this,function(r){switch(r.label){case 0:e=Object.values(this.status),r.label=1;case 1:return e.length?[4,Promise.all(e)]:[3,3];case 2:return r.sent(),e=Object.values(this.status),[3,1];case 3:return[2]}})})},t.prototype.resolve=function(e,r,n,i){var a,s,o,c;return u4(this,void 0,void 0,function(){var l,f,g,m,y,k,A,k,I;return c4(this,function(F){switch(F.label){case 0:l=i>="37.0.0"?"version_snackager=true&":"",f=this.snackagerURL+"/bundle/"+e+"?"+l+"sdkVersion="+i+"&platforms=ios,android,web",(a=this.logger)===null||a===void 0||a.module("Resolving dependency",e,"..."),F.label=1;case 1:F.trys.push([1,12,,13]),g=0,F.label=2;case 2:return g<30?[4,tb.fetch(f)]:[3,11];case 3:return m=F.sent(),this.status[e]?m.status!==200?[3,8]:[4,m.json()]:[2];case 4:return y=F.sent(),y.pending?((s=this.logger)===null||s===void 0||s.module("Dependency is still being bundled",e,"trying again shortly"),[4,new Promise(function(J){return setTimeout(J,5e3)})]):[3,6];case 5:return F.sent(),this.status[e]?[3,7]:[2];case 6:(o=this.logger)===null||o===void 0||o.module("Resolved dependency",e,y),delete this.status[e];try{return this.callback({name:r,version:n,sdkVersion:i},y),[2]}catch(J){return[2,Promise.reject(J)]}F.label=7;case 7:return[3,10];case 8:return[4,m.text()];case 9:throw k=F.sent(),new Error(k);case 10:return g++,[3,2];case 11:return[3,13];case 12:return A=F.sent(),k=tb.createError({message:"Failed to resolve dependency '"+e+"' ("+A.message+")",fileName:e}),(c=this.logger)===null||c===void 0||c.error(k),I=!!this.status[e],I&&(delete this.status[e],this.callback({name:r,version:n,sdkVersion:i},void 0,k)),[3,13];case 13:return[2]}})})},t}();Bn.default=Oye;function Pye(t,e,r){var n,i,a={};for(var s in t){var o=t[s];if(o.peerDependencies){for(var c in o.peerDependencies)if(!f4.isModulePreloaded(c,e,!0)&&!t[c])if(!a[c])a[c]={dependents:[s],wantedVersion:(i=(n=r?.[c])!==null&&n!==void 0?n:o.peerDependencies[c])!==null&&i!==void 0?i:"*"};else{var l=r?.[c];if(!l){l=a[c].wantedVersion;var f=o.peerDependencies[c]||"*";(l==="*"||f==="latest"&&l==="latest"||f!=="*"&&f!=="latest"&&(l==="latest"||dx.default.gt(dx.default.coerce(f),dx.default.coerce(l))))&&(l=f)}a[c]={dependents:kye(a[c].dependents,[s]),wantedVersion:l}}}}return a}Bn.getMissingDependencies=Pye;function Rye(t,e){var r=fx.default(t),n=r.validForOldPackages,i=r.errors;if(!n){var a=t.split("/");if(a.length>=2&&!t.startsWith("@")){var s=fx.default(a[0]);n=s.validForNewPackages,i=s.errors}else if(a.length>=2&&t.startsWith("@")){var s=fx.default(a[0]+"/"+a[1]);n=s.validForNewPackages,i=s.errors}if(!n)return tb.createError({message:"Invalid dependency '"+t+"' "+(i?.length?"("+i[0]+")":""),fileName:t})}if(!f4.isValidSemver(e))return tb.createError({message:"Invalid dependency '"+t+"' (version '"+e+"' is not a valid semver)",fileName:t})}Bn.verifyDependency=Rye;function Dye(t){var e=t.split("/");return e[0].startsWith("@")&&e.length>=2?e[0]+"/"+e[1]:e[0]}Bn.getPackageName=Dye});var v4=D(Ys=>{"use strict";var lc=Ys&&Ys.__assign||function(){return lc=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},lc.apply(this,arguments)},h4=Ys&&Ys.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},g4=Ys&&Ys.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},m4=Ys&&Ys.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};Object.defineProperty(Ys,"__esModule",{value:!0});var px=cf(),Lye=function(){function t(e){this.apiURL=e.apiURL,this.logger=e.logger,this.onSendBeaconCloseRequest=e.onSendBeaconCloseRequest}return t.prototype.setState=function(e,r){var n=r.user&&(!e.online||e.url!==r.url||e.user!==r.user),i=r.deviceId&&(!e.online||e.url!==r.url||e.deviceId!==r.deviceId);r.online&&(n||i)&&this.close(r.url,n?r.user:void 0,i?r.deviceId:void 0),(e.user!==r.user||e.online!==r.online||e.url!==r.url||e.deviceId!==r.deviceId||e.onlineName!==r.onlineName)&&this.notify(e)},t.prototype.setFocus=function(e){this.notify(e,!0)},t.prototype.getRequest=function(e,r,n){var i=n?"?deviceId="+n:"",a=e?"notify-close":"notify-alive",s=this.apiURL+"/--/api/v2/development-sessions/"+a+i;return{url:s,method:"post",headers:lc({"Content-Type":"application/json"},px.createUserHeader(r))}},t.prototype.notify=function(e,r){var n,i;return h4(this,void 0,void 0,function(){var a,s,o,c,l,f,g,m,y,A,k;return g4(this,function(I){switch(I.label){case 0:if(a=e.user,s=e.online,o=e.url,c=e.deviceId,l=e.onlineName,!s||!a&&!c)return this.focusedAt=void 0,[2];(!this.focusedAt||r)&&(this.focusedAt=Date.now()),I.label=1;case 1:return I.trys.push([1,4,,5]),f=this.getRequest(!1,a,c),g=f.url,m=m4(f,["url"]),[4,px.fetch(g,lc(lc({},m),{body:JSON.stringify({data:{session:{description:l,hostname:"snack",config:{},url:o,source:"snack",openedAt:this.focusedAt}}})}))];case 2:if(y=I.sent(),!y.ok)throw Error(y.statusText);return[4,y.json()];case 3:return A=I.sent(),this.onSendBeaconCloseRequest({url:this.getRequest(!0,void 0,c).url,data:new Blob([JSON.stringify(lc({session:{url:o}},!((n=A.data)===null||n===void 0)&&n.auth?{auth:A.data.auth}:{}))],{type:"text/plain"})}),[3,5];case 4:return k=I.sent(),(i=this.logger)===null||i===void 0||i.error("Failed to advertise",k),[3,5];case 5:return[2]}})})},t.prototype.close=function(e,r,n){var i;return h4(this,void 0,void 0,function(){var a,s,o,c,l;return g4(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),a=this.getRequest(!0,r,n),s=a.url,o=m4(a,["url"]),[4,px.fetch(s,lc(lc({},o),{body:JSON.stringify({session:{url:e}})}))];case 1:if(c=f.sent(),!c.ok)throw Error(c.statusText);return[3,3];case 2:return l=f.sent(),(i=this.logger)===null||i===void 0||i.error("Failed to advertise close",l),[3,3];case 3:return[2]}})})},t}();Ys.default=Lye});var hx=D(Sl=>{"use strict";var y4=Sl&&Sl.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},b4=Sl&&Sl.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Sl,"__esModule",{value:!0});var _4=cf(),Nye=function(){function t(e){this.status={},this.apiURL=e.apiURL,this.callback=e.callback,this.logger=e.logger}return t.prototype.add=function(e,r){var n=this.status[e];return n&&n.file===r?n.promise:(this.status[e]={file:r,promise:this.upload(e,r)},this.status[e].promise)},t.prototype.remove=function(e,r){var n;(!r||((n=this.status[e])===null||n===void 0?void 0:n.file)===r)&&delete this.status[e]},t.prototype.waitForCompletion=function(){return y4(this,void 0,void 0,function(){var e;return b4(this,function(r){switch(r.label){case 0:e=Object.values(this.status).map(function(n){return n.promise}),r.label=1;case 1:return e.length?[4,Promise.all(e)]:[3,3];case 2:return r.sent(),e=Object.values(this.status).map(function(n){return n.promise}),[3,1];case 3:return[2]}})})},t.prototype.upload=function(e,r){var n,i,a,s,o,c,l;return y4(this,void 0,void 0,function(){var f,g,m,y,A,k,I,F,J;return b4(this,function(pe){switch(pe.label){case 0:switch(pe.trys.push([0,5,,6]),(n=this.logger)===null||n===void 0||n.module("Uploading file",e,"..."),f=void 0,g=void 0,r.type){case"CODE":f=this.apiURL+"/--/api/v2/snack/uploadCode",g={method:"POST",body:JSON.stringify({code:r.contents}),headers:{"Content-Type":"application/json"}};break;case"ASSET":if(f=this.apiURL+"/--/api/v2/snack/uploadAsset",typeof FormData<"u"&&r.contents instanceof FormData||typeof r.contents=="object"&&((i=r.contents.constructor)===null||i===void 0?void 0:i.name)==="FormData")g={method:"POST",body:r.contents};else if(typeof FormData<"u")m=new FormData,m.append("asset",r.contents,((a=r.contents)===null||a===void 0?void 0:a.name)||e),g={method:"POST",body:m};else throw new Error("Uploading assets is not supported in this environment. Make sure FormData is polyfilled or provide the data as a FormData object");break;default:throw new Error("Invalid file type "+r.type)}return[4,_4.fetch(f,g)];case 1:return y=pe.sent(),y.ok?[3,3]:[4,y.text()];case 2:throw A=pe.sent(),new Error(A);case 3:return[4,y.json()];case 4:if(k=pe.sent(),I=k.url,((s=this.status[e])===null||s===void 0?void 0:s.file)===r){(o=this.logger)===null||o===void 0||o.module("Uploaded file",e,I),delete this.status[e];try{this.callback({path:e,file:r},I)}catch(L){return[2,Promise.reject(L)]}}return[3,6];case 5:return F=pe.sent(),J=_4.createError({message:"Failed to upload file "+e+" ("+F.message+")",fileName:e}),(c=this.logger)===null||c===void 0||c.error(J),((l=this.status[e])===null||l===void 0?void 0:l.file)===r&&(delete this.status[e],this.callback({path:e,file:r},void 0,J)),[3,6];case 6:return[2]}})})},t}();Sl.default=Nye});var gx=D(df=>{"use strict";var Mye=df&&df.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,i++)n[i]=a[s];return n};Object.defineProperty(df,"__esModule",{value:!0});df.createLogger=void 0;function lf(t,e,r,n){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];t&&console.log.apply(console,Mye(["%c "+e.toUpperCase()+" ","background: "+r+"; color: "+(n??"#fff")],i))}}function $ye(t){return{info:lf(t,"info","#2196f3"),warn:lf(t,"warn","#FF9800"),error:lf(t,"error","#f44336"),comm:lf(t,"comm","#DBD64E"),comm_recv:lf(t,"comm","#DBD64E","#000"),module:lf(t,"module","#DB14C7")}}df.createLogger=$ye});var T4=D((ORe,w4)=>{var Uye=Fy();function Fye(t,e){return Uye(t,e)}w4.exports=Fye});var C4=D(Wi=>{"use strict";var ff=Wi&&Wi.__assign||function(){return ff=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},ff.apply(this,arguments)},Bye=Wi&&Wi.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.isUnsaved=Wi.isCodeChanged=Wi.isBusy=Wi.updateObjects=Wi.removeObject=Wi.removeObjects=Wi.addObject=Wi.addObjects=void 0;var S4=Bye(T4()),qye=yu();function E4(t,e,r){var n=null;for(var i in e)(r?r(e[i],t[i]):!S4.default(e[i],t[i]))&&(n=n??ff({},t),n[i]=e[i]);return n??t}Wi.addObjects=E4;function jye(t,e,r,n){var i;return E4(t,(i={},i[e]=r,i),n)}Wi.addObject=jye;function x4(t,e){if(!e.length)return t;var r=null;return e.forEach(function(n){t[n]&&(r=r??ff({},t),delete r[n])}),r??t}Wi.removeObjects=x4;function Hye(t,e){return x4(t,[e])}Wi.removeObject=Hye;function Gye(t,e,r){r===void 0&&(r=S4.default);var n=null;for(var i in e){var a=e[i];a===null?t[i]&&(n=n??ff({},t),delete n[i]):r(a,t[i])||(n=n??ff({},t),n[i]=a)}return n??t}Wi.updateObjects=Gye;function Vye(t){return!!Object.keys(t.dependencies).find(function(e){return!t.dependencies[e].handle&&!qye.isModulePreloaded(e,t.sdkVersion)})||!!Object.values(t.files).find(function(e){return e.type==="ASSET"&&typeof e.contents!="string"})}Wi.isBusy=Vye;function zye(t,e){return t.dependencies!==e.dependencies||t.files!==e.files||t.sdkVersion!==e.sdkVersion}Wi.isCodeChanged=zye;function Wye(t,e){return t.dependencies!==e.dependencies||t.files!==e.files||t.sdkVersion!==e.sdkVersion||t.name!==e.name||t.description!==e.description}Wi.isUnsaved=Wye});var I4=D(Co=>{"use strict";var El=Co&&Co.__assign||function(){return El=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},El.apply(this,arguments)},Kye=Co&&Co.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},Xye=Co&&Co.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Co,"__esModule",{value:!0});Co.WantedDependencyVersions=void 0;var Yye=yu(),A4=cf(),Jye=function(){function t(e){this.apiUrl=e.apiUrl,this.logger=e.logger,this.callback=e.callback,this.promise=Promise.resolve()}return t.prototype.setSDKVersion=function(e){this.sdkVersion!==e&&(this.sdkVersion=e,this.promise=this.fetchModules(e))},t.prototype.waitForCompletion=function(){return this.promise},t.prototype.fetchModules=function(e){var r,n,i,a;return Kye(this,void 0,void 0,function(){var s,o,c,l,f,g;return Xye(this,function(m){switch(m.label){case 0:if(this.sdkVersion!==e)return[2];m.label=1;case 1:return m.trys.push([1,3,,4]),(r=this.logger)===null||r===void 0||r.module("fetching versioned modules for SDK",e,"..."),s=((n=Yye.sdks[e])===null||n===void 0?void 0:n.version)||e,[4,Promise.all([this.fetchRemoteVersionedModules(s),this.fetchBundledNativeModules(s)])];case 2:return o=m.sent(),c=o[0],l=o[1],f=El(El({},c),l),this.sdkVersion===e&&((i=this.logger)===null||i===void 0||i.module("fetched versioned modules for SDK",e,f),this.callback(e,f)),[3,4];case 3:return g=m.sent(),this.sdkVersion===e&&((a=this.logger)===null||a===void 0||a.error(g),this.callback(e,void 0,g)),[3,4];case 4:return[2]}})})},t.prototype.fetchBundledNativeModules=function(e){var r=encodeURIComponent(e);return A4.fetch("https://cdn.jsdelivr.net/npm/expo@"+r+"/bundledNativeModules.json").then(function(n){return n.json()}).then(function(n){return n||{}})},t.prototype.fetchRemoteVersionedModules=function(e){var r=this;return A4.fetch(this.apiUrl+"/--/api/v2/versions/latest").then(function(n){return n.json()}).then(function(n){return r.normalizeRemoteVersionResponse(e,n)})},t.prototype.normalizeRemoteVersionResponse=function(e,r){var n,i;r===void 0&&(r={});var a=(i=(n=r?.data)===null||n===void 0?void 0:n.sdkVersions)===null||i===void 0?void 0:i[e];if(!a)return{};var s=a.relatedPackages,o=a.facebookReactVersion,c=a.facebookReactNativeVersion,l=o?{react:o,"react-dom":o}:void 0;return El(El(El({},s),l),{"react-native":c})},t}();Co.WantedDependencyVersions=Jye});var rb=D(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.SnackIdentityState=qn.webPlayerURL=qn.snackpubURL=qn.snackagerURL=qn.apiURL=void 0;var k4=yu();qn.apiURL="https://exp.host";qn.snackagerURL="https://snackager.expo.io";qn.snackpubURL="https://snackpub.expo.dev";qn.webPlayerURL="https://snack-web-player.s3.us-west-1.amazonaws.com/v2/%%SDK_VERSION%%";qn.SnackIdentityState={sdkVersion:k4.defaultSdkVersion,name:"",description:"",dependencies:{},missingDependencies:{},files:{},connectedClients:{},transports:{},disabled:!1,unsaved:!1,online:!1,url:"",channel:""};var Qye={apiURL:qn.apiURL,snackagerURL:qn.snackagerURL,snackpubURL:qn.snackpubURL,sdkVersion:k4.defaultSdkVersion,webPlayerURL:qn.webPlayerURL};qn.default=Qye});var O4=D((mx,vx)=>{(function(t,e){typeof mx=="object"&&typeof vx<"u"?vx.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self).PubNub=e()})(mx,function(){"use strict";var t=function(d,u){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,v){p.__proto__=v}||function(p,v){for(var w in v)Object.prototype.hasOwnProperty.call(v,w)&&(p[w]=v[w])},t(d,u)};function e(d,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");function p(){this.constructor=d}t(d,u),d.prototype=u===null?Object.create(u):(p.prototype=u.prototype,new p)}var r=function(){return r=Object.assign||function(d){for(var u,p=1,v=arguments.length;p<v;p++)for(var w in u=arguments[p])Object.prototype.hasOwnProperty.call(u,w)&&(d[w]=u[w]);return d},r.apply(this,arguments)};function n(d,u){var p={};for(var v in d)Object.prototype.hasOwnProperty.call(d,v)&&u.indexOf(v)<0&&(p[v]=d[v]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function"){var w=0;for(v=Object.getOwnPropertySymbols(d);w<v.length;w++)u.indexOf(v[w])<0&&Object.prototype.propertyIsEnumerable.call(d,v[w])&&(p[v[w]]=d[v[w]])}return p}function i(d,u,p,v){return new(p||(p=Promise))(function(w,T){function P(G){try{z(v.next(G))}catch(Y){T(Y)}}function M(G){try{z(v.throw(G))}catch(Y){T(Y)}}function z(G){var Y;G.done?w(G.value):(Y=G.value,Y instanceof p?Y:new p(function(B){B(Y)})).then(P,M)}z((v=v.apply(d,u||[])).next())})}function a(d,u){var p,v,w,T,P={label:0,sent:function(){if(1&w[0])throw w[1];return w[1]},trys:[],ops:[]};return T={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(T[Symbol.iterator]=function(){return this}),T;function M(z){return function(G){return function(Y){if(p)throw new TypeError("Generator is already executing.");for(;P;)try{if(p=1,v&&(w=2&Y[0]?v.return:Y[0]?v.throw||((w=v.return)&&w.call(v),0):v.next)&&!(w=w.call(v,Y[1])).done)return w;switch(v=0,w&&(Y=[2&Y[0],w.value]),Y[0]){case 0:case 1:w=Y;break;case 4:return P.label++,{value:Y[1],done:!1};case 5:P.label++,v=Y[1],Y=[0];continue;case 7:Y=P.ops.pop(),P.trys.pop();continue;default:if(w=P.trys,!((w=w.length>0&&w[w.length-1])||Y[0]!==6&&Y[0]!==2)){P=0;continue}if(Y[0]===3&&(!w||Y[1]>w[0]&&Y[1]<w[3])){P.label=Y[1];break}if(Y[0]===6&&P.label<w[1]){P.label=w[1],w=Y;break}if(w&&P.label<w[2]){P.label=w[2],P.ops.push(Y);break}w[2]&&P.ops.pop(),P.trys.pop();continue}Y=u.call(d,P)}catch(B){Y=[6,B],v=0}finally{p=w=0}if(5&Y[0])throw Y[1];return{value:Y[0]?Y[1]:void 0,done:!0}}([z,G])}}}function s(d){var u=typeof Symbol=="function"&&Symbol.iterator,p=u&&d[u],v=0;if(p)return p.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&v>=d.length&&(d=void 0),{value:d&&d[v++],done:!d}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(d,u){var p=typeof Symbol=="function"&&d[Symbol.iterator];if(!p)return d;var v,w,T=p.call(d),P=[];try{for(;(u===void 0||u-- >0)&&!(v=T.next()).done;)P.push(v.value)}catch(M){w={error:M}}finally{try{v&&!v.done&&(p=T.return)&&p.call(T)}finally{if(w)throw w.error}}return P}function c(d,u,p){if(p||arguments.length===2)for(var v,w=0,T=u.length;w<T;w++)!v&&w in u||(v||(v=Array.prototype.slice.call(u,0,w)),v[w]=u[w]);return d.concat(v||Array.prototype.slice.call(u))}var l=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:{};function f(d){if(d.__esModule)return d;var u=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(d).forEach(function(p){var v=Object.getOwnPropertyDescriptor(d,p);Object.defineProperty(u,p,v.get?v:{enumerable:!0,get:function(){return d[p]}})}),u}var g={exports:{}};(function(d){(function(u,p){var v=Math.pow(2,-24),w=Math.pow(2,32),T=Math.pow(2,53),P={encode:function(M){var z,G=new ArrayBuffer(256),Y=new DataView(G),B=0;function he(ut){for(var rt=G.byteLength,ge=B+ut;rt<ge;)rt*=2;if(rt!==G.byteLength){var Be=Y;G=new ArrayBuffer(rt),Y=new DataView(G);for(var Pe=B+3>>2,et=0;et<Pe;++et)Y.setUint32(4*et,Be.getUint32(4*et))}return z=ut,Y}function se(){B+=z}function ne(ut){se(he(1).setUint8(B,ut))}function oe(ut){for(var rt=he(ut.length),ge=0;ge<ut.length;++ge)rt.setUint8(B+ge,ut[ge]);se()}function ue(ut,rt){rt<24?ne(ut<<5|rt):rt<256?(ne(ut<<5|24),ne(rt)):rt<65536?(ne(ut<<5|25),function(ge){se(he(2).setUint16(B,ge))}(rt)):rt<4294967296?(ne(ut<<5|26),function(ge){se(he(4).setUint32(B,ge))}(rt)):(ne(ut<<5|27),function(ge){var Be=ge%w,Pe=(ge-Be)/w,et=he(8);et.setUint32(B,Pe),et.setUint32(B+4,Be),se()}(rt))}if(function ut(rt){var ge;if(rt===!1)return ne(244);if(rt===!0)return ne(245);if(rt===null)return ne(246);if(rt===p)return ne(247);switch(typeof rt){case"number":if(Math.floor(rt)===rt){if(0<=rt&&rt<=T)return ue(0,rt);if(-T<=rt&&rt<0)return ue(1,-(rt+1))}return ne(251),function(ve){se(he(8).setFloat64(B,ve))}(rt);case"string":var Be=[];for(ge=0;ge<rt.length;++ge){var Pe=rt.charCodeAt(ge);Pe<128?Be.push(Pe):Pe<2048?(Be.push(192|Pe>>6),Be.push(128|63&Pe)):Pe<55296?(Be.push(224|Pe>>12),Be.push(128|Pe>>6&63),Be.push(128|63&Pe)):(Pe=(1023&Pe)<<10,Pe|=1023&rt.charCodeAt(++ge),Pe+=65536,Be.push(240|Pe>>18),Be.push(128|Pe>>12&63),Be.push(128|Pe>>6&63),Be.push(128|63&Pe))}return ue(3,Be.length),oe(Be);default:var et;if(Array.isArray(rt))for(ue(4,et=rt.length),ge=0;ge<et;++ge)ut(rt[ge]);else if(rt instanceof Uint8Array)ue(2,rt.length),oe(rt);else{var Me=Object.keys(rt);for(ue(5,et=Me.length),ge=0;ge<et;++ge){var qe=Me[ge];ut(qe),ut(rt[qe])}}}}(M),"slice"in G)return G.slice(0,B);for(var Ce=new ArrayBuffer(B),Xe=new DataView(Ce),it=0;it<B;++it)Xe.setUint8(it,Y.getUint8(it));return Ce},decode:function(M,z,G){var Y=new DataView(M),B=0;function he(ge,Be){return B+=Be,ge}function se(ge){return he(new Uint8Array(M,B,ge),ge)}function ne(){return he(Y.getUint8(B),1)}function oe(){return he(Y.getUint16(B),2)}function ue(){return he(Y.getUint32(B),4)}function Ce(){return Y.getUint8(B)===255&&(B+=1,!0)}function Xe(ge){if(ge<24)return ge;if(ge===24)return ne();if(ge===25)return oe();if(ge===26)return ue();if(ge===27)return ue()*w+ue();if(ge===31)return-1;throw"Invalid length encoding"}function it(ge){var Be=ne();if(Be===255)return-1;var Pe=Xe(31&Be);if(Pe<0||Be>>5!==ge)throw"Invalid indefinite length element";return Pe}function ut(ge,Be){for(var Pe=0;Pe<Be;++Pe){var et=ne();128&et&&(et<224?(et=(31&et)<<6|63&ne(),Be-=1):et<240?(et=(15&et)<<12|(63&ne())<<6|63&ne(),Be-=2):(et=(15&et)<<18|(63&ne())<<12|(63&ne())<<6|63&ne(),Be-=3)),et<65536?ge.push(et):(et-=65536,ge.push(55296|et>>10),ge.push(56320|1023&et))}}typeof z!="function"&&(z=function(ge){return ge}),typeof G!="function"&&(G=function(){return p});var rt=function ge(){var Be,Pe,et=ne(),Me=et>>5,qe=31&et;if(Me===7)switch(qe){case 25:return function(){var Di=new ArrayBuffer(4),Li=new DataView(Di),Go=oe(),Fu=32768&Go,gs=31744&Go,lo=1023&Go;if(gs===31744)gs=261120;else if(gs!==0)gs+=114688;else if(lo!==0)return lo*v;return Li.setUint32(0,Fu<<16|gs<<13|lo<<13),Li.getFloat32(0)}();case 26:return he(Y.getFloat32(B),4);case 27:return he(Y.getFloat64(B),8)}if((Pe=Xe(qe))<0&&(Me<2||6<Me))throw"Invalid length";switch(Me){case 0:return Pe;case 1:return-1-Pe;case 2:if(Pe<0){for(var ve=[],ot=0;(Pe=it(Me))>=0;)ot+=Pe,ve.push(se(Pe));var je=new Uint8Array(ot),Je=0;for(Be=0;Be<ve.length;++Be)je.set(ve[Be],Je),Je+=ve[Be].length;return je}return se(Pe);case 3:var nt=[];if(Pe<0)for(;(Pe=it(Me))>=0;)ut(nt,Pe);else ut(nt,Pe);return String.fromCharCode.apply(null,nt);case 4:var gt;if(Pe<0)for(gt=[];!Ce();)gt.push(ge());else for(gt=new Array(Pe),Be=0;Be<Pe;++Be)gt[Be]=ge();return gt;case 5:var wr={};for(Be=0;Be<Pe||Pe<0&&!Ce();++Be)wr[ge()]=ge();return wr;case 6:return z(ge(),Pe);case 7:switch(Pe){case 20:return!1;case 21:return!0;case 22:return null;case 23:return p;default:return G(Pe)}}}();if(B!==M.byteLength)throw"Remaining bytes";return rt}};d.exports?d.exports=P:u.CBOR||(u.CBOR=P)})(l)})(g);var m=g.exports,y={exports:{}};(function(d,u){(function(p){var v="0.1.0",w={3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};function T(){var M,z,G="";for(M=0;M<32;M++)z=16*Math.random()|0,M!==8&&M!==12&&M!==16&&M!==20||(G+="-"),G+=(M===12?4:M===16?3&z|8:z).toString(16);return G}function P(M,z){var G=w[z||"all"];return G&&G.test(M)||!1}T.isUUID=P,T.VERSION=v,p.uuid=T,p.isUUID=P})(u),d!==null&&(d.exports=u.uuid)})(y,y.exports);var A=y.exports,k=function(){return A.uuid?A.uuid():A()},I=function(){function d(u){var p,v,w,T,P=u.setup;if(this._PNSDKSuffix={},this.instanceId="pn-".concat(k()),this.secretKey=P.secretKey||P.secret_key,this.subscribeKey=P.subscribeKey||P.subscribe_key,this.publishKey=P.publishKey||P.publish_key,this.sdkName=P.sdkName,this.sdkFamily=P.sdkFamily,this.partnerId=P.partnerId,this.setAuthKey(P.authKey),this.cryptoModule=P.cryptoModule,this.setFilterExpression(P.filterExpression),typeof P.origin!="string"&&!Array.isArray(P.origin)&&P.origin!==void 0)throw new Error("Origin must be either undefined, a string or a list of strings.");if(this.origin=P.origin||Array.from({length:20},function(M,z){return"ps".concat(z+1,".pndsn.com")}),this.secure=P.ssl||!1,this.restore=P.restore||!1,this.proxy=P.proxy,this.keepAlive=P.keepAlive,this.keepAliveSettings=P.keepAliveSettings,this.autoNetworkDetection=P.autoNetworkDetection||!1,this.dedupeOnSubscribe=P.dedupeOnSubscribe||!1,this.maximumCacheSize=P.maximumCacheSize||100,this.customEncrypt=P.customEncrypt,this.customDecrypt=P.customDecrypt,this.fileUploadPublishRetryLimit=(p=P.fileUploadPublishRetryLimit)!==null&&p!==void 0?p:5,this.useRandomIVs=(v=P.useRandomIVs)===null||v===void 0||v,this.enableEventEngine=(w=P.enableEventEngine)!==null&&w!==void 0&&w,this.maintainPresenceState=(T=P.maintainPresenceState)===null||T===void 0||T,typeof location<"u"&&location.protocol==="https:"&&(this.secure=!0),this.logVerbosity=P.logVerbosity||!1,this.suppressLeaveEvents=P.suppressLeaveEvents||!1,this.announceFailedHeartbeats=P.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=P.announceSuccessfulHeartbeats||!1,this.useInstanceId=P.useInstanceId||!1,this.useRequestId=P.useRequestId||!1,this.requestMessageCountThreshold=P.requestMessageCountThreshold,P.retryConfiguration&&this._setRetryConfiguration(P.retryConfiguration),this.setTransactionTimeout(P.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(P.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(P.useSendBeacon||!0),P.presenceTimeout?this.setPresenceTimeout(P.presenceTimeout):this._presenceTimeout=300,P.heartbeatInterval!=null&&this.setHeartbeatInterval(P.heartbeatInterval),typeof P.userId=="string"){if(typeof P.uuid=="string")throw new Error("Only one of the following configuration options has to be provided: `uuid` or `userId`");this.setUserId(P.userId)}else{if(typeof P.uuid!="string")throw new Error("One of the following configuration options has to be provided: `uuid` or `userId`");this.setUUID(P.uuid)}this.setCipherKey(P.cipherKey,P)}return d.prototype.getAuthKey=function(){return this.authKey},d.prototype.setAuthKey=function(u){return this.authKey=u,this},d.prototype.setCipherKey=function(u,p,v){var w;return this.cipherKey=u,this.cipherKey&&(this.cryptoModule=(w=p.cryptoModule)!==null&&w!==void 0?w:p.initCryptoModule({cipherKey:this.cipherKey,useRandomIVs:this.useRandomIVs}),v&&(v.cryptoModule=this.cryptoModule)),this},d.prototype.getUUID=function(){return this.UUID},d.prototype.setUUID=function(u){if(!u||typeof u!="string"||u.trim().length===0)throw new Error("Missing uuid parameter. Provide a valid string uuid");return this.UUID=u,this},d.prototype.getUserId=function(){return this.UUID},d.prototype.setUserId=function(u){if(!u||typeof u!="string"||u.trim().length===0)throw new Error("Missing or invalid userId parameter. Provide a valid string userId");return this.UUID=u,this},d.prototype.getFilterExpression=function(){return this.filterExpression},d.prototype.setFilterExpression=function(u){return this.filterExpression=u,this},d.prototype.getPresenceTimeout=function(){return this._presenceTimeout},d.prototype.setPresenceTimeout=function(u){return u>=20?this._presenceTimeout=u:(this._presenceTimeout=20,console.log("WARNING: Presence timeout is less than the minimum. Using minimum value: ",this._presenceTimeout)),this.setHeartbeatInterval(this._presenceTimeout/2-1),this},d.prototype.setProxy=function(u){this.proxy=u},d.prototype.getHeartbeatInterval=function(){return this._heartbeatInterval},d.prototype.setHeartbeatInterval=function(u){return this._heartbeatInterval=u,this},d.prototype.getSubscribeTimeout=function(){return this._subscribeRequestTimeout},d.prototype.setSubscribeTimeout=function(u){return this._subscribeRequestTimeout=u,this},d.prototype.getTransactionTimeout=function(){return this._transactionalRequestTimeout},d.prototype.setTransactionTimeout=function(u){return this._transactionalRequestTimeout=u,this},d.prototype.isSendBeaconEnabled=function(){return this._useSendBeacon},d.prototype.setSendBeaconConfig=function(u){return this._useSendBeacon=u,this},d.prototype.getVersion=function(){return"7.6.3"},d.prototype._setRetryConfiguration=function(u){if(u.minimumdelay<2)throw new Error("Minimum delay can not be set less than 2 seconds for retry");if(u.maximumDelay>150)throw new Error("Maximum delay can not be set more than 150 seconds for retry");if(u.maximumDelay&&maximumRetry>6)throw new Error("Maximum retry for exponential retry policy can not be more than 6");if(u.maximumRetry>10)throw new Error("Maximum retry for linear retry policy can not be more than 10");this.retryConfiguration=u},d.prototype._addPnsdkSuffix=function(u,p){this._PNSDKSuffix[u]=p},d.prototype._getPnsdkSuffix=function(u){var p=this;return Object.keys(this._PNSDKSuffix).reduce(function(v,w){return v+u+p._PNSDKSuffix[w]},"")},d}();function F(d){var u=d.replace(/==?$/,""),p=Math.floor(u.length/4*3),v=new ArrayBuffer(p),w=new Uint8Array(v),T=0;function P(){var oe=u.charAt(T++),ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(oe);if(ue===-1)throw new Error("Illegal character at ".concat(T,": ").concat(u.charAt(T-1)));return ue}for(var M=0;M<p;M+=3){var z=P(),G=P(),Y=P(),B=P(),he=(63&z)<<2|G>>4,se=(15&G)<<4|Y>>2,ne=(3&Y)<<6|B>>0;w[M]=he,Y!=64&&(w[M+1]=se),B!=64&&(w[M+2]=ne)}return v}function J(d){for(var u,p="",v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=new Uint8Array(d),T=w.byteLength,P=T%3,M=T-P,z=0;z<M;z+=3)p+=v[(16515072&(u=w[z]<<16|w[z+1]<<8|w[z+2]))>>18]+v[(258048&u)>>12]+v[(4032&u)>>6]+v[63&u];return P==1?p+=v[(252&(u=w[M]))>>2]+v[(3&u)<<4]+"==":P==2&&(p+=v[(64512&(u=w[M]<<8|w[M+1]))>>10]+v[(1008&u)>>4]+v[(15&u)<<2]+"="),p}var pe,L,H,j,X,V=V||function(d,u){var p={},v=p.lib={},w=function(){},T=v.Base={extend:function(se){w.prototype=this;var ne=new w;return se&&ne.mixIn(se),ne.hasOwnProperty("init")||(ne.init=function(){ne.$super.init.apply(this,arguments)}),ne.init.prototype=ne,ne.$super=this,ne},create:function(){var se=this.extend();return se.init.apply(se,arguments),se},init:function(){},mixIn:function(se){for(var ne in se)se.hasOwnProperty(ne)&&(this[ne]=se[ne]);se.hasOwnProperty("toString")&&(this.toString=se.toString)},clone:function(){return this.init.prototype.extend(this)}},P=v.WordArray=T.extend({init:function(se,ne){se=this.words=se||[],this.sigBytes=ne??4*se.length},toString:function(se){return(se||z).stringify(this)},concat:function(se){var ne=this.words,oe=se.words,ue=this.sigBytes;if(se=se.sigBytes,this.clamp(),ue%4)for(var Ce=0;Ce<se;Ce++)ne[ue+Ce>>>2]|=(oe[Ce>>>2]>>>24-Ce%4*8&255)<<24-(ue+Ce)%4*8;else if(65535<oe.length)for(Ce=0;Ce<se;Ce+=4)ne[ue+Ce>>>2]=oe[Ce>>>2];else ne.push.apply(ne,oe);return this.sigBytes+=se,this},clamp:function(){var se=this.words,ne=this.sigBytes;se[ne>>>2]&=4294967295<<32-ne%4*8,se.length=d.ceil(ne/4)},clone:function(){var se=T.clone.call(this);return se.words=this.words.slice(0),se},random:function(se){for(var ne=[],oe=0;oe<se;oe+=4)ne.push(4294967296*d.random()|0);return new P.init(ne,se)}}),M=p.enc={},z=M.Hex={stringify:function(se){var ne=se.words;se=se.sigBytes;for(var oe=[],ue=0;ue<se;ue++){var Ce=ne[ue>>>2]>>>24-ue%4*8&255;oe.push((Ce>>>4).toString(16)),oe.push((15&Ce).toString(16))}return oe.join("")},parse:function(se){for(var ne=se.length,oe=[],ue=0;ue<ne;ue+=2)oe[ue>>>3]|=parseInt(se.substr(ue,2),16)<<24-ue%8*4;return new P.init(oe,ne/2)}},G=M.Latin1={stringify:function(se){var ne=se.words;se=se.sigBytes;for(var oe=[],ue=0;ue<se;ue++)oe.push(String.fromCharCode(ne[ue>>>2]>>>24-ue%4*8&255));return oe.join("")},parse:function(se){for(var ne=se.length,oe=[],ue=0;ue<ne;ue++)oe[ue>>>2]|=(255&se.charCodeAt(ue))<<24-ue%4*8;return new P.init(oe,ne)}},Y=M.Utf8={stringify:function(se){try{return decodeURIComponent(escape(G.stringify(se)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(se){return G.parse(unescape(encodeURIComponent(se)))}},B=v.BufferedBlockAlgorithm=T.extend({reset:function(){this._data=new P.init,this._nDataBytes=0},_append:function(se){typeof se=="string"&&(se=Y.parse(se)),this._data.concat(se),this._nDataBytes+=se.sigBytes},_process:function(se){var ne=this._data,oe=ne.words,ue=ne.sigBytes,Ce=this.blockSize,Xe=ue/(4*Ce);if(se=(Xe=se?d.ceil(Xe):d.max((0|Xe)-this._minBufferSize,0))*Ce,ue=d.min(4*se,ue),se){for(var it=0;it<se;it+=Ce)this._doProcessBlock(oe,it);it=oe.splice(0,se),ne.sigBytes-=ue}return new P.init(it,ue)},clone:function(){var se=T.clone.call(this);return se._data=this._data.clone(),se},_minBufferSize:0});v.Hasher=B.extend({cfg:T.extend(),init:function(se){this.cfg=this.cfg.extend(se),this.reset()},reset:function(){B.reset.call(this),this._doReset()},update:function(se){return this._append(se),this._process(),this},finalize:function(se){return se&&this._append(se),this._doFinalize()},blockSize:16,_createHelper:function(se){return function(ne,oe){return new se.init(oe).finalize(ne)}},_createHmacHelper:function(se){return function(ne,oe){return new he.HMAC.init(se,oe).finalize(ne)}}});var he=p.algo={};return p}(Math);(function(d){for(var u=V,p=(w=u.lib).WordArray,v=w.Hasher,w=u.algo,T=[],P=[],M=function(ne){return 4294967296*(ne-(0|ne))|0},z=2,G=0;64>G;){var Y;e:{Y=z;for(var B=d.sqrt(Y),he=2;he<=B;he++)if(!(Y%he)){Y=!1;break e}Y=!0}Y&&(8>G&&(T[G]=M(d.pow(z,.5))),P[G]=M(d.pow(z,1/3)),G++),z++}var se=[];w=w.SHA256=v.extend({_doReset:function(){this._hash=new p.init(T.slice(0))},_doProcessBlock:function(ne,oe){for(var ue=this._hash.words,Ce=ue[0],Xe=ue[1],it=ue[2],ut=ue[3],rt=ue[4],ge=ue[5],Be=ue[6],Pe=ue[7],et=0;64>et;et++){if(16>et)se[et]=0|ne[oe+et];else{var Me=se[et-15],qe=se[et-2];se[et]=((Me<<25|Me>>>7)^(Me<<14|Me>>>18)^Me>>>3)+se[et-7]+((qe<<15|qe>>>17)^(qe<<13|qe>>>19)^qe>>>10)+se[et-16]}Me=Pe+((rt<<26|rt>>>6)^(rt<<21|rt>>>11)^(rt<<7|rt>>>25))+(rt&ge^~rt&Be)+P[et]+se[et],qe=((Ce<<30|Ce>>>2)^(Ce<<19|Ce>>>13)^(Ce<<10|Ce>>>22))+(Ce&Xe^Ce&it^Xe&it),Pe=Be,Be=ge,ge=rt,rt=ut+Me|0,ut=it,it=Xe,Xe=Ce,Ce=Me+qe|0}ue[0]=ue[0]+Ce|0,ue[1]=ue[1]+Xe|0,ue[2]=ue[2]+it|0,ue[3]=ue[3]+ut|0,ue[4]=ue[4]+rt|0,ue[5]=ue[5]+ge|0,ue[6]=ue[6]+Be|0,ue[7]=ue[7]+Pe|0},_doFinalize:function(){var ne=this._data,oe=ne.words,ue=8*this._nDataBytes,Ce=8*ne.sigBytes;return oe[Ce>>>5]|=128<<24-Ce%32,oe[14+(Ce+64>>>9<<4)]=d.floor(ue/4294967296),oe[15+(Ce+64>>>9<<4)]=ue,ne.sigBytes=4*oe.length,this._process(),this._hash},clone:function(){var ne=v.clone.call(this);return ne._hash=this._hash.clone(),ne}}),u.SHA256=v._createHelper(w),u.HmacSHA256=v._createHmacHelper(w)})(Math),L=(pe=V).enc.Utf8,pe.algo.HMAC=pe.lib.Base.extend({init:function(d,u){d=this._hasher=new d.init,typeof u=="string"&&(u=L.parse(u));var p=d.blockSize,v=4*p;u.sigBytes>v&&(u=d.finalize(u)),u.clamp();for(var w=this._oKey=u.clone(),T=this._iKey=u.clone(),P=w.words,M=T.words,z=0;z<p;z++)P[z]^=1549556828,M[z]^=909522486;w.sigBytes=T.sigBytes=v,this.reset()},reset:function(){var d=this._hasher;d.reset(),d.update(this._iKey)},update:function(d){return this._hasher.update(d),this},finalize:function(d){var u=this._hasher;return d=u.finalize(d),u.reset(),u.finalize(this._oKey.clone().concat(d))}}),j=(H=V).lib.WordArray,H.enc.Base64={stringify:function(d){var u=d.words,p=d.sigBytes,v=this._map;d.clamp(),d=[];for(var w=0;w<p;w+=3)for(var T=(u[w>>>2]>>>24-w%4*8&255)<<16|(u[w+1>>>2]>>>24-(w+1)%4*8&255)<<8|u[w+2>>>2]>>>24-(w+2)%4*8&255,P=0;4>P&&w+.75*P<p;P++)d.push(v.charAt(T>>>6*(3-P)&63));if(u=v.charAt(64))for(;d.length%4;)d.push(u);return d.join("")},parse:function(d){var u=d.length,p=this._map;(v=p.charAt(64))&&(v=d.indexOf(v))!=-1&&(u=v);for(var v=[],w=0,T=0;T<u;T++)if(T%4){var P=p.indexOf(d.charAt(T-1))<<T%4*2,M=p.indexOf(d.charAt(T))>>>6-T%4*2;v[w>>>2]|=(P|M)<<24-w%4*8,w++}return j.create(v,w)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(d){function u(B,he,se,ne,oe,ue,Ce){return((B=B+(he&se|~he&ne)+oe+Ce)<<ue|B>>>32-ue)+he}function p(B,he,se,ne,oe,ue,Ce){return((B=B+(he&ne|se&~ne)+oe+Ce)<<ue|B>>>32-ue)+he}function v(B,he,se,ne,oe,ue,Ce){return((B=B+(he^se^ne)+oe+Ce)<<ue|B>>>32-ue)+he}function w(B,he,se,ne,oe,ue,Ce){return((B=B+(se^(he|~ne))+oe+Ce)<<ue|B>>>32-ue)+he}for(var T=V,P=(z=T.lib).WordArray,M=z.Hasher,z=T.algo,G=[],Y=0;64>Y;Y++)G[Y]=4294967296*d.abs(d.sin(Y+1))|0;z=z.MD5=M.extend({_doReset:function(){this._hash=new P.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(B,he){for(var se=0;16>se;se++){var ne=B[oe=he+se];B[oe]=16711935&(ne<<8|ne>>>24)|4278255360&(ne<<24|ne>>>8)}se=this._hash.words;var oe=B[he+0],ue=(ne=B[he+1],B[he+2]),Ce=B[he+3],Xe=B[he+4],it=B[he+5],ut=B[he+6],rt=B[he+7],ge=B[he+8],Be=B[he+9],Pe=B[he+10],et=B[he+11],Me=B[he+12],qe=B[he+13],ve=B[he+14],ot=B[he+15],je=u(je=se[0],gt=se[1],nt=se[2],Je=se[3],oe,7,G[0]),Je=u(Je,je,gt,nt,ne,12,G[1]),nt=u(nt,Je,je,gt,ue,17,G[2]),gt=u(gt,nt,Je,je,Ce,22,G[3]);je=u(je,gt,nt,Je,Xe,7,G[4]),Je=u(Je,je,gt,nt,it,12,G[5]),nt=u(nt,Je,je,gt,ut,17,G[6]),gt=u(gt,nt,Je,je,rt,22,G[7]),je=u(je,gt,nt,Je,ge,7,G[8]),Je=u(Je,je,gt,nt,Be,12,G[9]),nt=u(nt,Je,je,gt,Pe,17,G[10]),gt=u(gt,nt,Je,je,et,22,G[11]),je=u(je,gt,nt,Je,Me,7,G[12]),Je=u(Je,je,gt,nt,qe,12,G[13]),nt=u(nt,Je,je,gt,ve,17,G[14]),je=p(je,gt=u(gt,nt,Je,je,ot,22,G[15]),nt,Je,ne,5,G[16]),Je=p(Je,je,gt,nt,ut,9,G[17]),nt=p(nt,Je,je,gt,et,14,G[18]),gt=p(gt,nt,Je,je,oe,20,G[19]),je=p(je,gt,nt,Je,it,5,G[20]),Je=p(Je,je,gt,nt,Pe,9,G[21]),nt=p(nt,Je,je,gt,ot,14,G[22]),gt=p(gt,nt,Je,je,Xe,20,G[23]),je=p(je,gt,nt,Je,Be,5,G[24]),Je=p(Je,je,gt,nt,ve,9,G[25]),nt=p(nt,Je,je,gt,Ce,14,G[26]),gt=p(gt,nt,Je,je,ge,20,G[27]),je=p(je,gt,nt,Je,qe,5,G[28]),Je=p(Je,je,gt,nt,ue,9,G[29]),nt=p(nt,Je,je,gt,rt,14,G[30]),je=v(je,gt=p(gt,nt,Je,je,Me,20,G[31]),nt,Je,it,4,G[32]),Je=v(Je,je,gt,nt,ge,11,G[33]),nt=v(nt,Je,je,gt,et,16,G[34]),gt=v(gt,nt,Je,je,ve,23,G[35]),je=v(je,gt,nt,Je,ne,4,G[36]),Je=v(Je,je,gt,nt,Xe,11,G[37]),nt=v(nt,Je,je,gt,rt,16,G[38]),gt=v(gt,nt,Je,je,Pe,23,G[39]),je=v(je,gt,nt,Je,qe,4,G[40]),Je=v(Je,je,gt,nt,oe,11,G[41]),nt=v(nt,Je,je,gt,Ce,16,G[42]),gt=v(gt,nt,Je,je,ut,23,G[43]),je=v(je,gt,nt,Je,Be,4,G[44]),Je=v(Je,je,gt,nt,Me,11,G[45]),nt=v(nt,Je,je,gt,ot,16,G[46]),je=w(je,gt=v(gt,nt,Je,je,ue,23,G[47]),nt,Je,oe,6,G[48]),Je=w(Je,je,gt,nt,rt,10,G[49]),nt=w(nt,Je,je,gt,ve,15,G[50]),gt=w(gt,nt,Je,je,it,21,G[51]),je=w(je,gt,nt,Je,Me,6,G[52]),Je=w(Je,je,gt,nt,Ce,10,G[53]),nt=w(nt,Je,je,gt,Pe,15,G[54]),gt=w(gt,nt,Je,je,ne,21,G[55]),je=w(je,gt,nt,Je,ge,6,G[56]),Je=w(Je,je,gt,nt,ot,10,G[57]),nt=w(nt,Je,je,gt,ut,15,G[58]),gt=w(gt,nt,Je,je,qe,21,G[59]),je=w(je,gt,nt,Je,Xe,6,G[60]),Je=w(Je,je,gt,nt,et,10,G[61]),nt=w(nt,Je,je,gt,ue,15,G[62]),gt=w(gt,nt,Je,je,Be,21,G[63]),se[0]=se[0]+je|0,se[1]=se[1]+gt|0,se[2]=se[2]+nt|0,se[3]=se[3]+Je|0},_doFinalize:function(){var B=this._data,he=B.words,se=8*this._nDataBytes,ne=8*B.sigBytes;he[ne>>>5]|=128<<24-ne%32;var oe=d.floor(se/4294967296);for(he[15+(ne+64>>>9<<4)]=16711935&(oe<<8|oe>>>24)|4278255360&(oe<<24|oe>>>8),he[14+(ne+64>>>9<<4)]=16711935&(se<<8|se>>>24)|4278255360&(se<<24|se>>>8),B.sigBytes=4*(he.length+1),this._process(),he=(B=this._hash).words,se=0;4>se;se++)ne=he[se],he[se]=16711935&(ne<<8|ne>>>24)|4278255360&(ne<<24|ne>>>8);return B},clone:function(){var B=M.clone.call(this);return B._hash=this._hash.clone(),B}}),T.MD5=M._createHelper(z),T.HmacMD5=M._createHmacHelper(z)}(Math),function(){var d,u=V,p=(d=u.lib).Base,v=d.WordArray,w=(d=u.algo).EvpKDF=p.extend({cfg:p.extend({keySize:4,hasher:d.MD5,iterations:1}),init:function(T){this.cfg=this.cfg.extend(T)},compute:function(T,P){for(var M=(B=this.cfg).hasher.create(),z=v.create(),G=z.words,Y=B.keySize,B=B.iterations;G.length<Y;){he&&M.update(he);var he=M.update(T).finalize(P);M.reset();for(var se=1;se<B;se++)he=M.finalize(he),M.reset();z.concat(he)}return z.sigBytes=4*Y,z}});u.EvpKDF=function(T,P,M){return w.create(M).compute(T,P)}}(),V.lib.Cipher||function(d){var u=(se=V).lib,p=u.Base,v=u.WordArray,w=u.BufferedBlockAlgorithm,T=se.enc.Base64,P=se.algo.EvpKDF,M=u.Cipher=w.extend({cfg:p.extend(),createEncryptor:function(oe,ue){return this.create(this._ENC_XFORM_MODE,oe,ue)},createDecryptor:function(oe,ue){return this.create(this._DEC_XFORM_MODE,oe,ue)},init:function(oe,ue,Ce){this.cfg=this.cfg.extend(Ce),this._xformMode=oe,this._key=ue,this.reset()},reset:function(){w.reset.call(this),this._doReset()},process:function(oe){return this._append(oe),this._process()},finalize:function(oe){return oe&&this._append(oe),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(oe){return{encrypt:function(ue,Ce,Xe){return(typeof Ce=="string"?ne:he).encrypt(oe,ue,Ce,Xe)},decrypt:function(ue,Ce,Xe){return(typeof Ce=="string"?ne:he).decrypt(oe,ue,Ce,Xe)}}}});u.StreamCipher=M.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var z=se.mode={},G=function(oe,ue,Ce){var Xe=this._iv;Xe?this._iv=void 0:Xe=this._prevBlock;for(var it=0;it<Ce;it++)oe[ue+it]^=Xe[it]},Y=(u.BlockCipherMode=p.extend({createEncryptor:function(oe,ue){return this.Encryptor.create(oe,ue)},createDecryptor:function(oe,ue){return this.Decryptor.create(oe,ue)},init:function(oe,ue){this._cipher=oe,this._iv=ue}})).extend();Y.Encryptor=Y.extend({processBlock:function(oe,ue){var Ce=this._cipher,Xe=Ce.blockSize;G.call(this,oe,ue,Xe),Ce.encryptBlock(oe,ue),this._prevBlock=oe.slice(ue,ue+Xe)}}),Y.Decryptor=Y.extend({processBlock:function(oe,ue){var Ce=this._cipher,Xe=Ce.blockSize,it=oe.slice(ue,ue+Xe);Ce.decryptBlock(oe,ue),G.call(this,oe,ue,Xe),this._prevBlock=it}}),z=z.CBC=Y,Y=(se.pad={}).Pkcs7={pad:function(oe,ue){for(var Ce,Xe=(Ce=(Ce=4*ue)-oe.sigBytes%Ce)<<24|Ce<<16|Ce<<8|Ce,it=[],ut=0;ut<Ce;ut+=4)it.push(Xe);Ce=v.create(it,Ce),oe.concat(Ce)},unpad:function(oe){oe.sigBytes-=255&oe.words[oe.sigBytes-1>>>2]}},u.BlockCipher=M.extend({cfg:M.cfg.extend({mode:z,padding:Y}),reset:function(){M.reset.call(this);var oe=(ue=this.cfg).iv,ue=ue.mode;if(this._xformMode==this._ENC_XFORM_MODE)var Ce=ue.createEncryptor;else Ce=ue.createDecryptor,this._minBufferSize=1;this._mode=Ce.call(ue,this,oe&&oe.words)},_doProcessBlock:function(oe,ue){this._mode.processBlock(oe,ue)},_doFinalize:function(){var oe=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){oe.pad(this._data,this.blockSize);var ue=this._process(!0)}else ue=this._process(!0),oe.unpad(ue);return ue},blockSize:4});var B=u.CipherParams=p.extend({init:function(oe){this.mixIn(oe)},toString:function(oe){return(oe||this.formatter).stringify(this)}}),he=(z=(se.format={}).OpenSSL={stringify:function(oe){var ue=oe.ciphertext;return((oe=oe.salt)?v.create([1398893684,1701076831]).concat(oe).concat(ue):ue).toString(T)},parse:function(oe){var ue=(oe=T.parse(oe)).words;if(ue[0]==1398893684&&ue[1]==1701076831){var Ce=v.create(ue.slice(2,4));ue.splice(0,4),oe.sigBytes-=16}return B.create({ciphertext:oe,salt:Ce})}},u.SerializableCipher=p.extend({cfg:p.extend({format:z}),encrypt:function(oe,ue,Ce,Xe){Xe=this.cfg.extend(Xe);var it=oe.createEncryptor(Ce,Xe);return ue=it.finalize(ue),it=it.cfg,B.create({ciphertext:ue,key:Ce,iv:it.iv,algorithm:oe,mode:it.mode,padding:it.padding,blockSize:oe.blockSize,formatter:Xe.format})},decrypt:function(oe,ue,Ce,Xe){return Xe=this.cfg.extend(Xe),ue=this._parse(ue,Xe.format),oe.createDecryptor(Ce,Xe).finalize(ue.ciphertext)},_parse:function(oe,ue){return typeof oe=="string"?ue.parse(oe,this):oe}})),se=(se.kdf={}).OpenSSL={execute:function(oe,ue,Ce,Xe){return Xe||(Xe=v.random(8)),oe=P.create({keySize:ue+Ce}).compute(oe,Xe),Ce=v.create(oe.words.slice(ue),4*Ce),oe.sigBytes=4*ue,B.create({key:oe,iv:Ce,salt:Xe})}},ne=u.PasswordBasedCipher=he.extend({cfg:he.cfg.extend({kdf:se}),encrypt:function(oe,ue,Ce,Xe){return Ce=(Xe=this.cfg.extend(Xe)).kdf.execute(Ce,oe.keySize,oe.ivSize),Xe.iv=Ce.iv,(oe=he.encrypt.call(this,oe,ue,Ce.key,Xe)).mixIn(Ce),oe},decrypt:function(oe,ue,Ce,Xe){return Xe=this.cfg.extend(Xe),ue=this._parse(ue,Xe.format),Ce=Xe.kdf.execute(Ce,oe.keySize,oe.ivSize,ue.salt),Xe.iv=Ce.iv,he.decrypt.call(this,oe,ue,Ce.key,Xe)}})}(),function(){for(var d=V,u=d.lib.BlockCipher,p=d.algo,v=[],w=[],T=[],P=[],M=[],z=[],G=[],Y=[],B=[],he=[],se=[],ne=0;256>ne;ne++)se[ne]=128>ne?ne<<1:ne<<1^283;var oe=0,ue=0;for(ne=0;256>ne;ne++){var Ce=(Ce=ue^ue<<1^ue<<2^ue<<3^ue<<4)>>>8^255&Ce^99;v[oe]=Ce,w[Ce]=oe;var Xe=se[oe],it=se[Xe],ut=se[it],rt=257*se[Ce]^16843008*Ce;T[oe]=rt<<24|rt>>>8,P[oe]=rt<<16|rt>>>16,M[oe]=rt<<8|rt>>>24,z[oe]=rt,rt=16843009*ut^65537*it^257*Xe^16843008*oe,G[Ce]=rt<<24|rt>>>8,Y[Ce]=rt<<16|rt>>>16,B[Ce]=rt<<8|rt>>>24,he[Ce]=rt,oe?(oe=Xe^se[se[se[ut^Xe]]],ue^=se[se[ue]]):oe=ue=1}var ge=[0,1,2,4,8,16,32,64,128,27,54];p=p.AES=u.extend({_doReset:function(){for(var Be=(et=this._key).words,Pe=et.sigBytes/4,et=4*((this._nRounds=Pe+6)+1),Me=this._keySchedule=[],qe=0;qe<et;qe++)if(qe<Pe)Me[qe]=Be[qe];else{var ve=Me[qe-1];qe%Pe?6<Pe&&qe%Pe==4&&(ve=v[ve>>>24]<<24|v[ve>>>16&255]<<16|v[ve>>>8&255]<<8|v[255&ve]):(ve=v[(ve=ve<<8|ve>>>24)>>>24]<<24|v[ve>>>16&255]<<16|v[ve>>>8&255]<<8|v[255&ve],ve^=ge[qe/Pe|0]<<24),Me[qe]=Me[qe-Pe]^ve}for(Be=this._invKeySchedule=[],Pe=0;Pe<et;Pe++)qe=et-Pe,ve=Pe%4?Me[qe]:Me[qe-4],Be[Pe]=4>Pe||4>=qe?ve:G[v[ve>>>24]]^Y[v[ve>>>16&255]]^B[v[ve>>>8&255]]^he[v[255&ve]]},encryptBlock:function(Be,Pe){this._doCryptBlock(Be,Pe,this._keySchedule,T,P,M,z,v)},decryptBlock:function(Be,Pe){var et=Be[Pe+1];Be[Pe+1]=Be[Pe+3],Be[Pe+3]=et,this._doCryptBlock(Be,Pe,this._invKeySchedule,G,Y,B,he,w),et=Be[Pe+1],Be[Pe+1]=Be[Pe+3],Be[Pe+3]=et},_doCryptBlock:function(Be,Pe,et,Me,qe,ve,ot,je){for(var Je=this._nRounds,nt=Be[Pe]^et[0],gt=Be[Pe+1]^et[1],wr=Be[Pe+2]^et[2],Di=Be[Pe+3]^et[3],Li=4,Go=1;Go<Je;Go++){var Fu=Me[nt>>>24]^qe[gt>>>16&255]^ve[wr>>>8&255]^ot[255&Di]^et[Li++],gs=Me[gt>>>24]^qe[wr>>>16&255]^ve[Di>>>8&255]^ot[255&nt]^et[Li++],lo=Me[wr>>>24]^qe[Di>>>16&255]^ve[nt>>>8&255]^ot[255&gt]^et[Li++];Di=Me[Di>>>24]^qe[nt>>>16&255]^ve[gt>>>8&255]^ot[255&wr]^et[Li++],nt=Fu,gt=gs,wr=lo}Fu=(je[nt>>>24]<<24|je[gt>>>16&255]<<16|je[wr>>>8&255]<<8|je[255&Di])^et[Li++],gs=(je[gt>>>24]<<24|je[wr>>>16&255]<<16|je[Di>>>8&255]<<8|je[255&nt])^et[Li++],lo=(je[wr>>>24]<<24|je[Di>>>16&255]<<16|je[nt>>>8&255]<<8|je[255&gt])^et[Li++],Di=(je[Di>>>24]<<24|je[nt>>>16&255]<<16|je[gt>>>8&255]<<8|je[255&wr])^et[Li++],Be[Pe]=Fu,Be[Pe+1]=gs,Be[Pe+2]=lo,Be[Pe+3]=Di},keySize:8}),d.AES=u._createHelper(p)}(),V.mode.ECB=((X=V.lib.BlockCipherMode.extend()).Encryptor=X.extend({processBlock:function(d,u){this._cipher.encryptBlock(d,u)}}),X.Decryptor=X.extend({processBlock:function(d,u){this._cipher.decryptBlock(d,u)}}),X);var ie=V;function fe(d){var u,p=[];for(u=0;u<d.length;u+=1)p[u/4|0]|=d[u]<<24-8*u;return ie.lib.WordArray.create(p,d.length)}var Re=function(){function d(u){var p=u.config;this._config=p,this._iv="0123456789012345",this._allowedKeyEncodings=["hex","utf8","base64","binary"],this._allowedKeyLengths=[128,256],this._allowedModes=["ecb","cbc"],this._defaultOptions={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}return d.prototype.HMACSHA256=function(u){return ie.HmacSHA256(u,this._config.secretKey).toString(ie.enc.Base64)},d.prototype.SHA256=function(u){return ie.SHA256(u).toString(ie.enc.Hex)},d.prototype._parseOptions=function(u){var p=u||{};return p.hasOwnProperty("encryptKey")||(p.encryptKey=this._defaultOptions.encryptKey),p.hasOwnProperty("keyEncoding")||(p.keyEncoding=this._defaultOptions.keyEncoding),p.hasOwnProperty("keyLength")||(p.keyLength=this._defaultOptions.keyLength),p.hasOwnProperty("mode")||(p.mode=this._defaultOptions.mode),this._allowedKeyEncodings.indexOf(p.keyEncoding.toLowerCase())===-1&&(p.keyEncoding=this._defaultOptions.keyEncoding),this._allowedKeyLengths.indexOf(parseInt(p.keyLength,10))===-1&&(p.keyLength=this._defaultOptions.keyLength),this._allowedModes.indexOf(p.mode.toLowerCase())===-1&&(p.mode=this._defaultOptions.mode),p},d.prototype._decodeKey=function(u,p){return p.keyEncoding==="base64"?ie.enc.Base64.parse(u):p.keyEncoding==="hex"?ie.enc.Hex.parse(u):u},d.prototype._getPaddedKey=function(u,p){return u=this._decodeKey(u,p),p.encryptKey?ie.enc.Utf8.parse(this.SHA256(u).slice(0,32)):u},d.prototype._getMode=function(u){return u.mode==="ecb"?ie.mode.ECB:ie.mode.CBC},d.prototype._getIV=function(u){return u.mode==="cbc"?ie.enc.Utf8.parse(this._iv):null},d.prototype._getRandomIV=function(){return ie.lib.WordArray.random(16)},d.prototype.encrypt=function(u,p,v){return this._config.customEncrypt?this._config.customEncrypt(u):this.pnEncrypt(u,p,v)},d.prototype.decrypt=function(u,p,v){return this._config.customDecrypt?this._config.customDecrypt(u):this.pnDecrypt(u,p,v)},d.prototype.pnEncrypt=function(u,p,v){if(!p&&!this._config.cipherKey)return u;v=this._parseOptions(v);var w=this._getMode(v),T=this._getPaddedKey(p||this._config.cipherKey,v);if(this._config.useRandomIVs){var P=this._getRandomIV(),M=ie.AES.encrypt(u,T,{iv:P,mode:w}).ciphertext;return P.clone().concat(M.clone()).toString(ie.enc.Base64)}var z=this._getIV(v);return ie.AES.encrypt(u,T,{iv:z,mode:w}).ciphertext.toString(ie.enc.Base64)||u},d.prototype.pnDecrypt=function(u,p,v){if(!p&&!this._config.cipherKey)return u;v=this._parseOptions(v);var w=this._getMode(v),T=this._getPaddedKey(p||this._config.cipherKey,v);if(this._config.useRandomIVs){var P=fe((G=new Uint8ClampedArray(F(u))).slice(0,16)),M=fe(G.slice(16));try{var z=ie.AES.decrypt({ciphertext:M},T,{iv:P,mode:w}).toString(ie.enc.Utf8);return JSON.parse(z)}catch{return null}}else{P=this._getIV(v);try{var G=ie.enc.Base64.parse(u);return z=ie.AES.decrypt({ciphertext:G},T,{iv:P,mode:w}).toString(ie.enc.Utf8),JSON.parse(z)}catch{return null}}},d}(),ye=function(){function d(u){var p=u.timeEndpoint;this._timeEndpoint=p}return d.prototype.onReconnection=function(u){this._reconnectionCallback=u},d.prototype.startPolling=function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)},d.prototype.stopPolling=function(){clearInterval(this._timeTimer)},d.prototype._performTimeLoop=function(){var u=this;this._timeEndpoint(function(p){p.error||(clearInterval(u._timeTimer),u._reconnectionCallback())})},d}(),ze=function(){function d(u){var p=u.config;this.hashHistory=[],this._config=p}return d.prototype.getKey=function(u){var p=function(w){var T=0;if(w.length===0)return T;for(var P=0;P<w.length;P+=1)T=(T<<5)-T+w.charCodeAt(P),T&=T;return T}(JSON.stringify(u.payload)).toString(),v=u.publishMetaData.publishTimetoken;return"".concat(v,"-").concat(p)},d.prototype.isDuplicate=function(u){return this.hashHistory.includes(this.getKey(u))},d.prototype.addEntry=function(u){this.hashHistory.length>=this._config.maximumCacheSize&&this.hashHistory.shift(),this.hashHistory.push(this.getKey(u))},d.prototype.clearHistory=function(){this.hashHistory=[]},d}(),Ue={PNNetworkUpCategory:"PNNetworkUpCategory",PNNetworkDownCategory:"PNNetworkDownCategory",PNNetworkIssuesCategory:"PNNetworkIssuesCategory",PNTimeoutCategory:"PNTimeoutCategory",PNBadRequestCategory:"PNBadRequestCategory",PNAccessDeniedCategory:"PNAccessDeniedCategory",PNUnknownCategory:"PNUnknownCategory",PNReconnectedCategory:"PNReconnectedCategory",PNConnectedCategory:"PNConnectedCategory",PNRequestMessageCountExceededCategory:"PNRequestMessageCountExceededCategory",PNDisconnectedCategory:"PNDisconnectedCategory",PNConnectionErrorCategory:"PNConnectionErrorCategory",PNDisconnectedUnexpectedlyCategory:"PNDisconnectedUnexpectedlyCategory"},de=function(){function d(u){var p=u.subscribeEndpoint,v=u.leaveEndpoint,w=u.heartbeatEndpoint,T=u.setStateEndpoint,P=u.timeEndpoint,M=u.getFileUrl,z=u.config,G=u.crypto,Y=u.listenerManager,B=u.cryptoModule,he=u.eventEmitter;this._listenerManager=Y,this._config=z,this._leaveEndpoint=v,this._heartbeatEndpoint=w,this._setStateEndpoint=T,this._subscribeEndpoint=p,this._getFileUrl=M,this._crypto=G,this._cryptoModule=B,this._channels={},this._presenceChannels={},this._heartbeatChannels={},this._heartbeatChannelGroups={},this._channelGroups={},this._presenceChannelGroups={},this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[],this._currentTimetoken=0,this._lastTimetoken=0,this._storedTimetoken=null,this._subscriptionStatusAnnounced=!1,this._isOnline=!0,this._reconnectionManager=new ye({timeEndpoint:P}),this._dedupingManager=new ze({config:z}),this._cryptoModule&&(this._decoder=new TextDecoder),this._eventEmitter=he}return d.prototype.adaptStateChange=function(u,p){var v=this,w=u.state,T=u.channels,P=T===void 0?[]:T,M=u.channelGroups,z=M===void 0?[]:M,G=u.withHeartbeat,Y=G!==void 0&&G;if(P.forEach(function(he){he in v._channels&&(v._channels[he].state=w)}),z.forEach(function(he){he in v._channelGroups&&(v._channelGroups[he].state=w)}),Y){var B={};return P.forEach(function(he){return B[he]=w}),z.forEach(function(he){return B[he]=w}),this._heartbeatEndpoint({channels:P,channelGroups:z,state:B},p)}return this._setStateEndpoint({state:w,channels:P,channelGroups:z},p)},d.prototype.adaptPresenceChange=function(u){var p=this,v=u.connected,w=u.channels,T=w===void 0?[]:w,P=u.channelGroups,M=P===void 0?[]:P;v?(T.forEach(function(z){p._heartbeatChannels[z]={state:{}}}),M.forEach(function(z){p._heartbeatChannelGroups[z]={state:{}}})):(T.forEach(function(z){z in p._heartbeatChannels&&delete p._heartbeatChannels[z]}),M.forEach(function(z){z in p._heartbeatChannelGroups&&delete p._heartbeatChannelGroups[z]}),this._config.suppressLeaveEvents===!1&&this._leaveEndpoint({channels:T,channelGroups:M},function(z){p._listenerManager.announceStatus(z)})),this.reconnect()},d.prototype.adaptSubscribeChange=function(u){var p=this,v=u.timetoken,w=u.channels,T=w===void 0?[]:w,P=u.channelGroups,M=P===void 0?[]:P,z=u.withPresence,G=z!==void 0&&z,Y=u.withHeartbeats,B=Y!==void 0&&Y;this._config.subscribeKey&&this._config.subscribeKey!==""?(v&&(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=v),this._currentTimetoken!=="0"&&this._currentTimetoken!==0&&(this._storedTimetoken=this._currentTimetoken,this._currentTimetoken=0),T.forEach(function(he){p._channels[he]={state:{}},G&&(p._presenceChannels[he]={}),(B||p._config.getHeartbeatInterval())&&(p._heartbeatChannels[he]={}),p._pendingChannelSubscriptions.push(he)}),M.forEach(function(he){p._channelGroups[he]={state:{}},G&&(p._presenceChannelGroups[he]={}),(B||p._config.getHeartbeatInterval())&&(p._heartbeatChannelGroups[he]={}),p._pendingChannelGroupSubscriptions.push(he)}),this._subscriptionStatusAnnounced=!1,this.reconnect()):console&&console.log&&console.log("subscribe key missing; aborting subscribe")},d.prototype.adaptUnsubscribeChange=function(u,p){var v=this,w=u.channels,T=w===void 0?[]:w,P=u.channelGroups,M=P===void 0?[]:P,z=[],G=[];T.forEach(function(Y){Y in v._channels&&(delete v._channels[Y],z.push(Y),Y in v._heartbeatChannels&&delete v._heartbeatChannels[Y]),Y in v._presenceChannels&&(delete v._presenceChannels[Y],z.push(Y))}),M.forEach(function(Y){Y in v._channelGroups&&(delete v._channelGroups[Y],G.push(Y),Y in v._heartbeatChannelGroups&&delete v._heartbeatChannelGroups[Y]),Y in v._presenceChannelGroups&&(delete v._presenceChannelGroups[Y],G.push(Y))}),z.length===0&&G.length===0||(this._config.suppressLeaveEvents!==!1||p||this._leaveEndpoint({channels:z,channelGroups:G},function(Y){Y.affectedChannels=z,Y.affectedChannelGroups=G,Y.currentTimetoken=v._currentTimetoken,Y.lastTimetoken=v._lastTimetoken,v._listenerManager.announceStatus(Y)}),Object.keys(this._channels).length===0&&Object.keys(this._presenceChannels).length===0&&Object.keys(this._channelGroups).length===0&&Object.keys(this._presenceChannelGroups).length===0&&(this._lastTimetoken=0,this._currentTimetoken=0,this._storedTimetoken=null,this._region=null,this._reconnectionManager.stopPolling()),this.reconnect())},d.prototype.unsubscribeAll=function(u){this.adaptUnsubscribeChange({channels:this.getSubscribedChannels(),channelGroups:this.getSubscribedChannelGroups()},u)},d.prototype.getHeartbeatChannels=function(){return Object.keys(this._heartbeatChannels)},d.prototype.getHeartbeatChannelGroups=function(){return Object.keys(this._heartbeatChannelGroups)},d.prototype.getSubscribedChannels=function(){return Object.keys(this._channels)},d.prototype.getSubscribedChannelGroups=function(){return Object.keys(this._channelGroups)},d.prototype.reconnect=function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()},d.prototype.disconnect=function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer(),this._reconnectionManager.stopPolling()},d.prototype._registerHeartbeatTimer=function(){this._stopHeartbeatTimer(),this._config.getHeartbeatInterval()!==0&&this._config.getHeartbeatInterval()!==void 0&&(this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval()))},d.prototype._stopHeartbeatTimer=function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)},d.prototype._performHeartbeatLoop=function(){var u=this,p=this.getHeartbeatChannels(),v=this.getHeartbeatChannelGroups(),w={};(p.length!==0||v.length!==0)&&(this.getSubscribedChannels().forEach(function(T){var P=u._channels[T].state;Object.keys(P).length&&(w[T]=P)}),this.getSubscribedChannelGroups().forEach(function(T){var P=u._channelGroups[T].state;Object.keys(P).length&&(w[T]=P)}),this._heartbeatEndpoint({channels:p,channelGroups:v,state:w},(function(T){T.error&&u._config.announceFailedHeartbeats&&u._listenerManager.announceStatus(T),T.error&&u._config.autoNetworkDetection&&u._isOnline&&(u._isOnline=!1,u.disconnect(),u._listenerManager.announceNetworkDown(),u.reconnect()),!T.error&&u._config.announceSuccessfulHeartbeats&&u._listenerManager.announceStatus(T)}).bind(this)))},d.prototype._startSubscribeLoop=function(){var u=this;this._stopSubscribeLoop();var p={},v=[],w=[];if(Object.keys(this._channels).forEach(function(P){var M=u._channels[P].state;Object.keys(M).length&&(p[P]=M),v.push(P)}),Object.keys(this._presenceChannels).forEach(function(P){v.push("".concat(P,"-pnpres"))}),Object.keys(this._channelGroups).forEach(function(P){var M=u._channelGroups[P].state;Object.keys(M).length&&(p[P]=M),w.push(P)}),Object.keys(this._presenceChannelGroups).forEach(function(P){w.push("".concat(P,"-pnpres"))}),v.length!==0||w.length!==0){var T={channels:v,channelGroups:w,state:p,timetoken:this._currentTimetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoint(T,this._processSubscribeResponse.bind(this))}},d.prototype._processSubscribeResponse=function(u,p){var v=this;if(u.error){if(u.errorData&&u.errorData.message==="Aborted")return;u.category===Ue.PNTimeoutCategory?this._startSubscribeLoop():u.category===Ue.PNNetworkIssuesCategory?(this.disconnect(),u.error&&this._config.autoNetworkDetection&&this._isOnline&&(this._isOnline=!1,this._listenerManager.announceNetworkDown()),this._reconnectionManager.onReconnection(function(){v._config.autoNetworkDetection&&!v._isOnline&&(v._isOnline=!0,v._listenerManager.announceNetworkUp()),v.reconnect(),v._subscriptionStatusAnnounced=!0;var Y={category:Ue.PNReconnectedCategory,operation:u.operation,lastTimetoken:v._lastTimetoken,currentTimetoken:v._currentTimetoken};v._listenerManager.announceStatus(Y)}),this._reconnectionManager.startPolling(),this._listenerManager.announceStatus(u)):u.category===Ue.PNBadRequestCategory?(this._stopHeartbeatTimer(),this._listenerManager.announceStatus(u)):this._listenerManager.announceStatus(u)}else{if(this._storedTimetoken?(this._currentTimetoken=this._storedTimetoken,this._storedTimetoken=null):(this._lastTimetoken=this._currentTimetoken,this._currentTimetoken=p.metadata.timetoken),!this._subscriptionStatusAnnounced){var w={};w.category=Ue.PNConnectedCategory,w.operation=u.operation,w.affectedChannels=this._pendingChannelSubscriptions,w.subscribedChannels=this.getSubscribedChannels(),w.affectedChannelGroups=this._pendingChannelGroupSubscriptions,w.lastTimetoken=this._lastTimetoken,w.currentTimetoken=this._currentTimetoken,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(w),this._pendingChannelSubscriptions=[],this._pendingChannelGroupSubscriptions=[]}var T=p.messages||[],P=this._config,M=P.requestMessageCountThreshold,z=P.dedupeOnSubscribe;if(M&&T.length>=M){var G={};G.category=Ue.PNRequestMessageCountExceededCategory,G.operation=u.operation,this._listenerManager.announceStatus(G)}T.forEach(function(Y){if(Y.channel,Y.subscriptionMatch,z){if(v._dedupingManager.isDuplicate(Y))return;v._dedupingManager.addEntry(Y)}v._eventEmitter.emitEvent(Y)}),this._region=p.metadata.region,this._startSubscribeLoop()}},d.prototype._stopSubscribeLoop=function(){this._subscribeCall&&(typeof this._subscribeCall.abort=="function"&&this._subscribeCall.abort(),this._subscribeCall=null)},d.prototype._renameEvent=function(u){return u==="set"?"updated":"removed"},d.prototype._renameChannelField=function(u){var p=u.channel,v=n(u,["channel"]);return v.spaceId=p,v},d}(),Q={PNTimeOperation:"PNTimeOperation",PNHistoryOperation:"PNHistoryOperation",PNDeleteMessagesOperation:"PNDeleteMessagesOperation",PNFetchMessagesOperation:"PNFetchMessagesOperation",PNMessageCounts:"PNMessageCountsOperation",PNSubscribeOperation:"PNSubscribeOperation",PNUnsubscribeOperation:"PNUnsubscribeOperation",PNPublishOperation:"PNPublishOperation",PNSignalOperation:"PNSignalOperation",PNAddMessageActionOperation:"PNAddActionOperation",PNRemoveMessageActionOperation:"PNRemoveMessageActionOperation",PNGetMessageActionsOperation:"PNGetMessageActionsOperation",PNCreateUserOperation:"PNCreateUserOperation",PNUpdateUserOperation:"PNUpdateUserOperation",PNDeleteUserOperation:"PNDeleteUserOperation",PNGetUserOperation:"PNGetUsersOperation",PNGetUsersOperation:"PNGetUsersOperation",PNCreateSpaceOperation:"PNCreateSpaceOperation",PNUpdateSpaceOperation:"PNUpdateSpaceOperation",PNDeleteSpaceOperation:"PNDeleteSpaceOperation",PNGetSpaceOperation:"PNGetSpacesOperation",PNGetSpacesOperation:"PNGetSpacesOperation",PNGetMembersOperation:"PNGetMembersOperation",PNUpdateMembersOperation:"PNUpdateMembersOperation",PNGetMembershipsOperation:"PNGetMembershipsOperation",PNUpdateMembershipsOperation:"PNUpdateMembershipsOperation",PNListFilesOperation:"PNListFilesOperation",PNGenerateUploadUrlOperation:"PNGenerateUploadUrlOperation",PNPublishFileOperation:"PNPublishFileOperation",PNGetFileUrlOperation:"PNGetFileUrlOperation",PNDownloadFileOperation:"PNDownloadFileOperation",PNGetAllUUIDMetadataOperation:"PNGetAllUUIDMetadataOperation",PNGetUUIDMetadataOperation:"PNGetUUIDMetadataOperation",PNSetUUIDMetadataOperation:"PNSetUUIDMetadataOperation",PNRemoveUUIDMetadataOperation:"PNRemoveUUIDMetadataOperation",PNGetAllChannelMetadataOperation:"PNGetAllChannelMetadataOperation",PNGetChannelMetadataOperation:"PNGetChannelMetadataOperation",PNSetChannelMetadataOperation:"PNSetChannelMetadataOperation",PNRemoveChannelMetadataOperation:"PNRemoveChannelMetadataOperation",PNSetMembersOperation:"PNSetMembersOperation",PNSetMembershipsOperation:"PNSetMembershipsOperation",PNPushNotificationEnabledChannelsOperation:"PNPushNotificationEnabledChannelsOperation",PNRemoveAllPushNotificationsOperation:"PNRemoveAllPushNotificationsOperation",PNWhereNowOperation:"PNWhereNowOperation",PNSetStateOperation:"PNSetStateOperation",PNHereNowOperation:"PNHereNowOperation",PNGetStateOperation:"PNGetStateOperation",PNHeartbeatOperation:"PNHeartbeatOperation",PNChannelGroupsOperation:"PNChannelGroupsOperation",PNRemoveGroupOperation:"PNRemoveGroupOperation",PNChannelsForGroupOperation:"PNChannelsForGroupOperation",PNAddChannelsToGroupOperation:"PNAddChannelsToGroupOperation",PNRemoveChannelsFromGroupOperation:"PNRemoveChannelsFromGroupOperation",PNAccessManagerGrant:"PNAccessManagerGrant",PNAccessManagerGrantToken:"PNAccessManagerGrantToken",PNAccessManagerAudit:"PNAccessManagerAudit",PNAccessManagerRevokeToken:"PNAccessManagerRevokeToken",PNHandshakeOperation:"PNHandshakeOperation",PNReceiveMessagesOperation:"PNReceiveMessagesOperation"},Fe=function(){function d(u){this._maximumSamplesCount=100,this._trackedLatencies={},this._latencies={},this._telemetryExcludeOperations=[Q.PNSubscribeOperation,Q.PNReceiveMessagesOperation,Q.PNHandshakeOperation],this._maximumSamplesCount=u.maximumSamplesCount||this._maximumSamplesCount}return d.prototype.operationsLatencyForRequest=function(){var u=this,p={};return Object.keys(this._latencies).forEach(function(v){var w=u._latencies[v],T=u._averageLatency(w);T>0&&(p["l_".concat(v)]=T)}),p},d.prototype.startLatencyMeasure=function(u,p){!this._telemetryExcludeOperations.includes(u)&&p&&(this._trackedLatencies[p]=Date.now())},d.prototype.stopLatencyMeasure=function(u,p){if(!this._telemetryExcludeOperations.includes(u)&&p){var v=this._endpointName(u),w=this._latencies[v],T=this._trackedLatencies[p];w||(this._latencies[v]=[],w=this._latencies[v]),w.push(Date.now()-T),w.length>this._maximumSamplesCount&&w.splice(0,w.length-this._maximumSamplesCount),delete this._trackedLatencies[p]}},d.prototype._averageLatency=function(u){return Math.floor(u.reduce(function(p,v){return p+v},0)/u.length)},d.prototype._endpointName=function(u){var p=null;switch(u){case Q.PNPublishOperation:p="pub";break;case Q.PNSignalOperation:p="sig";break;case Q.PNHistoryOperation:case Q.PNFetchMessagesOperation:case Q.PNDeleteMessagesOperation:case Q.PNMessageCounts:p="hist";break;case Q.PNUnsubscribeOperation:case Q.PNWhereNowOperation:case Q.PNHereNowOperation:case Q.PNHeartbeatOperation:case Q.PNSetStateOperation:case Q.PNGetStateOperation:p="pres";break;case Q.PNAddChannelsToGroupOperation:case Q.PNRemoveChannelsFromGroupOperation:case Q.PNChannelGroupsOperation:case Q.PNRemoveGroupOperation:case Q.PNChannelsForGroupOperation:p="cg";break;case Q.PNPushNotificationEnabledChannelsOperation:case Q.PNRemoveAllPushNotificationsOperation:p="push";break;case Q.PNCreateUserOperation:case Q.PNUpdateUserOperation:case Q.PNDeleteUserOperation:case Q.PNGetUserOperation:case Q.PNGetUsersOperation:case Q.PNCreateSpaceOperation:case Q.PNUpdateSpaceOperation:case Q.PNDeleteSpaceOperation:case Q.PNGetSpaceOperation:case Q.PNGetSpacesOperation:case Q.PNGetMembersOperation:case Q.PNUpdateMembersOperation:case Q.PNGetMembershipsOperation:case Q.PNUpdateMembershipsOperation:p="obj";break;case Q.PNAddMessageActionOperation:case Q.PNRemoveMessageActionOperation:case Q.PNGetMessageActionsOperation:p="msga";break;case Q.PNAccessManagerGrant:case Q.PNAccessManagerAudit:p="pam";break;case Q.PNAccessManagerGrantToken:case Q.PNAccessManagerRevokeToken:p="pamv3";break;default:p="time"}return p},d}(),We=function(){function d(u,p,v){this._payload=u,this._setDefaultPayloadStructure(),this.title=p,this.body=v}return Object.defineProperty(d.prototype,"payload",{get:function(){return this._payload},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"title",{set:function(u){this._title=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"subtitle",{set:function(u){this._subtitle=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"body",{set:function(u){this._body=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"badge",{set:function(u){this._badge=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"sound",{set:function(u){this._sound=u},enumerable:!1,configurable:!0}),d.prototype._setDefaultPayloadStructure=function(){},d.prototype.toObject=function(){return{}},d}(),tt=function(d){function u(){return d!==null&&d.apply(this,arguments)||this}return e(u,d),Object.defineProperty(u.prototype,"configurations",{set:function(p){p&&p.length&&(this._configurations=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"notification",{get:function(){return this._payload.aps},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"title",{get:function(){return this._title},set:function(p){p&&p.length&&(this._payload.aps.alert.title=p,this._title=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"subtitle",{get:function(){return this._subtitle},set:function(p){p&&p.length&&(this._payload.aps.alert.subtitle=p,this._subtitle=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"body",{get:function(){return this._body},set:function(p){p&&p.length&&(this._payload.aps.alert.body=p,this._body=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"badge",{get:function(){return this._badge},set:function(p){p!=null&&(this._payload.aps.badge=p,this._badge=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"sound",{get:function(){return this._sound},set:function(p){p&&p.length&&(this._payload.aps.sound=p,this._sound=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"silent",{set:function(p){this._isSilent=p},enumerable:!1,configurable:!0}),u.prototype._setDefaultPayloadStructure=function(){this._payload.aps={alert:{}}},u.prototype.toObject=function(){var p=this,v=r({},this._payload),w=v.aps,T=w.alert;if(this._isSilent&&(w["content-available"]=1),this._apnsPushType==="apns2"){if(!this._configurations||!this._configurations.length)throw new ReferenceError("APNS2 configuration is missing");var P=[];this._configurations.forEach(function(M){P.push(p._objectFromAPNS2Configuration(M))}),P.length&&(v.pn_push=P)}return T&&Object.keys(T).length||delete w.alert,this._isSilent&&(delete w.alert,delete w.badge,delete w.sound,T={}),this._isSilent||Object.keys(T).length?v:null},u.prototype._objectFromAPNS2Configuration=function(p){var v=this;if(!p.targets||!p.targets.length)throw new ReferenceError("At least one APNS2 target should be provided");var w=[];p.targets.forEach(function(z){w.push(v._objectFromAPNSTarget(z))});var T=p.collapseId,P=p.expirationDate,M={auth_method:"token",targets:w,version:"v2"};return T&&T.length&&(M.collapse_id=T),P&&(M.expiration=P.toISOString()),M},u.prototype._objectFromAPNSTarget=function(p){if(!p.topic||!p.topic.length)throw new TypeError("Target 'topic' undefined.");var v=p.topic,w=p.environment,T=w===void 0?"development":w,P=p.excludedDevices,M=P===void 0?[]:P,z={topic:v,environment:T};return M.length&&(z.excluded_devices=M),z},u}(We),Le=function(d){function u(){return d!==null&&d.apply(this,arguments)||this}return e(u,d),Object.defineProperty(u.prototype,"backContent",{get:function(){return this._backContent},set:function(p){p&&p.length&&(this._payload.back_content=p,this._backContent=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"backTitle",{get:function(){return this._backTitle},set:function(p){p&&p.length&&(this._payload.back_title=p,this._backTitle=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"count",{get:function(){return this._count},set:function(p){p!=null&&(this._payload.count=p,this._count=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"title",{get:function(){return this._title},set:function(p){p&&p.length&&(this._payload.title=p,this._title=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"type",{get:function(){return this._type},set:function(p){p&&p.length&&(this._payload.type=p,this._type=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"subtitle",{get:function(){return this.backTitle},set:function(p){this.backTitle=p},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"body",{get:function(){return this.backContent},set:function(p){this.backContent=p},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"badge",{get:function(){return this.count},set:function(p){this.count=p},enumerable:!1,configurable:!0}),u.prototype.toObject=function(){return Object.keys(this._payload).length?r({},this._payload):null},u}(We),Tt=function(d){function u(){return d!==null&&d.apply(this,arguments)||this}return e(u,d),Object.defineProperty(u.prototype,"notification",{get:function(){return this._payload.notification},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"data",{get:function(){return this._payload.data},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"title",{get:function(){return this._title},set:function(p){p&&p.length&&(this._payload.notification.title=p,this._title=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"body",{get:function(){return this._body},set:function(p){p&&p.length&&(this._payload.notification.body=p,this._body=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"sound",{get:function(){return this._sound},set:function(p){p&&p.length&&(this._payload.notification.sound=p,this._sound=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"icon",{get:function(){return this._icon},set:function(p){p&&p.length&&(this._payload.notification.icon=p,this._icon=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"tag",{get:function(){return this._tag},set:function(p){p&&p.length&&(this._payload.notification.tag=p,this._tag=p)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"silent",{set:function(p){this._isSilent=p},enumerable:!1,configurable:!0}),u.prototype._setDefaultPayloadStructure=function(){this._payload.notification={},this._payload.data={}},u.prototype.toObject=function(){var p=r({},this._payload.data),v=null,w={};if(Object.keys(this._payload).length>2){var T=this._payload;T.notification,T.data;var P=n(T,["notification","data"]);p=r(r({},p),P)}return this._isSilent?p.notification=this._payload.notification:v=this._payload.notification,Object.keys(p).length&&(w.data=p),v&&Object.keys(v).length&&(w.notification=v),Object.keys(w).length?w:null},u}(We),It=function(){function d(u,p){this._payload={apns:{},mpns:{},fcm:{}},this._title=u,this._body=p,this.apns=new tt(this._payload.apns,u,p),this.mpns=new Le(this._payload.mpns,u,p),this.fcm=new Tt(this._payload.fcm,u,p)}return Object.defineProperty(d.prototype,"debugging",{set:function(u){this._debugging=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"body",{get:function(){return this._body},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"subtitle",{get:function(){return this._subtitle},set:function(u){this._subtitle=u,this.apns.subtitle=u,this.mpns.subtitle=u,this.fcm.subtitle=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"badge",{get:function(){return this._badge},set:function(u){this._badge=u,this.apns.badge=u,this.mpns.badge=u,this.fcm.badge=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"sound",{get:function(){return this._sound},set:function(u){this._sound=u,this.apns.sound=u,this.mpns.sound=u,this.fcm.sound=u},enumerable:!1,configurable:!0}),d.prototype.buildPayload=function(u){var p={};if(u.includes("apns")||u.includes("apns2")){this.apns._apnsPushType=u.includes("apns")?"apns":"apns2";var v=this.apns.toObject();v&&Object.keys(v).length&&(p.pn_apns=v)}if(u.includes("mpns")){var w=this.mpns.toObject();w&&Object.keys(w).length&&(p.pn_mpns=w)}if(u.includes("fcm")){var T=this.fcm.toObject();T&&Object.keys(T).length&&(p.pn_gcm=T)}return Object.keys(p).length&&this._debugging&&(p.pn_debug=!0),p},d}(),St=function(){function d(){this._listeners=[]}return d.prototype.addListener=function(u){this._listeners.includes(u)||this._listeners.push(u)},d.prototype.removeListener=function(u){var p=[];this._listeners.forEach(function(v){v!==u&&p.push(v)}),this._listeners=p},d.prototype.removeAllListeners=function(){this._listeners=[]},d.prototype.announcePresence=function(u){this._listeners.forEach(function(p){p.presence&&p.presence(u)})},d.prototype.announceStatus=function(u){this._listeners.forEach(function(p){p.status&&p.status(u)})},d.prototype.announceMessage=function(u){this._listeners.forEach(function(p){p.message&&p.message(u)})},d.prototype.announceSignal=function(u){this._listeners.forEach(function(p){p.signal&&p.signal(u)})},d.prototype.announceMessageAction=function(u){this._listeners.forEach(function(p){p.messageAction&&p.messageAction(u)})},d.prototype.announceFile=function(u){this._listeners.forEach(function(p){p.file&&p.file(u)})},d.prototype.announceObjects=function(u){this._listeners.forEach(function(p){p.objects&&p.objects(u)})},d.prototype.announceUser=function(u){this._listeners.forEach(function(p){p.user&&p.user(u)})},d.prototype.announceSpace=function(u){this._listeners.forEach(function(p){p.space&&p.space(u)})},d.prototype.announceMembership=function(u){this._listeners.forEach(function(p){p.membership&&p.membership(u)})},d.prototype.announceNetworkUp=function(){var u={};u.category=Ue.PNNetworkUpCategory,this.announceStatus(u)},d.prototype.announceNetworkDown=function(){var u={};u.category=Ue.PNNetworkDownCategory,this.announceStatus(u)},d}(),Zt=function(){function d(u,p){this._config=u,this._cbor=p}return d.prototype.setToken=function(u){u&&u.length>0?this._token=u:this._token=void 0},d.prototype.getToken=function(){return this._token},d.prototype.extractPermissions=function(u){var p={read:!1,write:!1,manage:!1,delete:!1,get:!1,update:!1,join:!1};return(128&u)==128&&(p.join=!0),(64&u)==64&&(p.update=!0),(32&u)==32&&(p.get=!0),(8&u)==8&&(p.delete=!0),(4&u)==4&&(p.manage=!0),(2&u)==2&&(p.write=!0),(1&u)==1&&(p.read=!0),p},d.prototype.parseToken=function(u){var p=this,v=this._cbor.decodeToken(u);if(v!==void 0){var w=v.res.uuid?Object.keys(v.res.uuid):[],T=Object.keys(v.res.chan),P=Object.keys(v.res.grp),M=v.pat.uuid?Object.keys(v.pat.uuid):[],z=Object.keys(v.pat.chan),G=Object.keys(v.pat.grp),Y={version:v.v,timestamp:v.t,ttl:v.ttl,authorized_uuid:v.uuid},B=w.length>0,he=T.length>0,se=P.length>0;(B||he||se)&&(Y.resources={},B&&(Y.resources.uuids={},w.forEach(function(Ce){Y.resources.uuids[Ce]=p.extractPermissions(v.res.uuid[Ce])})),he&&(Y.resources.channels={},T.forEach(function(Ce){Y.resources.channels[Ce]=p.extractPermissions(v.res.chan[Ce])})),se&&(Y.resources.groups={},P.forEach(function(Ce){Y.resources.groups[Ce]=p.extractPermissions(v.res.grp[Ce])})));var ne=M.length>0,oe=z.length>0,ue=G.length>0;return(ne||oe||ue)&&(Y.patterns={},ne&&(Y.patterns.uuids={},M.forEach(function(Ce){Y.patterns.uuids[Ce]=p.extractPermissions(v.pat.uuid[Ce])})),oe&&(Y.patterns.channels={},z.forEach(function(Ce){Y.patterns.channels[Ce]=p.extractPermissions(v.pat.chan[Ce])})),ue&&(Y.patterns.groups={},G.forEach(function(Ce){Y.patterns.groups[Ce]=p.extractPermissions(v.pat.grp[Ce])}))),Object.keys(v.meta).length>0&&(Y.meta=v.meta),Y.signature=v.sig,Y}},d}();function Ze(d){return encodeURIComponent(d).replace(/[!~*'()]/g,function(u){return"%".concat(u.charCodeAt(0).toString(16).toUpperCase())})}function Z(d){return function(u){var p=[];return Object.keys(u).forEach(function(v){return p.push(v)}),p}(d).sort()}var me={signPamFromParams:function(d){return Z(d).map(function(u){return"".concat(u,"=").concat(Ze(d[u]))}).join("&")},endsWith:function(d,u){return d.indexOf(u,this.length-u.length)!==-1},createPromise:function(){var d,u;return{promise:new Promise(function(p,v){d=p,u=v}),reject:u,fulfill:d}},encodeString:Ze,stringToArrayBuffer:function(d){for(var u=new ArrayBuffer(2*d.length),p=new Uint16Array(u),v=0,w=d.length;v<w;v++)p[v]=d.charCodeAt(v);return u},removeSingleOccurance:function(d,u){var p=Object.fromEntries(u.map(function(v){return[v,!1]}));return d.filter(function(v){return!(u.includes(v)&&!p[v])||(p[v]=!0,!1)})},findUniqueCommonElements:function(d,u){return __spreadArray([],__read(d),!1).filter(function(p){return u.includes(p)&&d.indexOf(p)===d.lastIndexOf(p)&&u.indexOf(p)===u.lastIndexOf(p)})}},ke=function(d){function u(p,v){var w=this.constructor,T=d.call(this,p)||this;return T.name=T.constructor.name,T.status=v,T.message=p,Object.setPrototypeOf(T,w.prototype),T}return e(u,d),u}(Error);function we(d){return(u={message:d}).type="validationError",u.error=!0,u;var u}function st(d,u,p){return d.usePost&&d.usePost(u,p)?d.postURL(u,p):d.usePatch&&d.usePatch(u,p)?d.patchURL(u,p):d.useGetFile&&d.useGetFile(u,p)?d.getFileURL(u,p):d.getURL(u,p)}function bt(d){if(d.sdkName)return d.sdkName;var u="PubNub-JS-".concat(d.sdkFamily);d.partnerId&&(u+="-".concat(d.partnerId)),u+="/".concat(d.getVersion());var p=d._getPnsdkSuffix(" ");return p.length>0&&(u+=p),u}function vt(d,u,p){return u.usePost&&u.usePost(d,p)?"POST":u.usePatch&&u.usePatch(d,p)?"PATCH":u.useDelete&&u.useDelete(d,p)?"DELETE":u.useGetFile&&u.useGetFile(d,p)?"GETFILE":"GET"}function Ee(d,u,p,v,w){var T=d.config,P=d.crypto,M=vt(d,w,v);p.timestamp=Math.floor(new Date().getTime()/1e3),w.getOperation()==="PNPublishOperation"&&w.usePost&&w.usePost(d,v)&&(M="GET"),M==="GETFILE"&&(M="GET");var z="".concat(M,`
`).concat(T.publishKey,`
`).concat(u,`
`).concat(me.signPamFromParams(p),`
`);if(M==="POST")z+=typeof(G=w.postPayload(d,v))=="string"?G:JSON.stringify(G);else if(M==="PATCH"){var G;z+=typeof(G=w.patchPayload(d,v))=="string"?G:JSON.stringify(G)}var Y="v2.".concat(P.HMACSHA256(z));Y=(Y=(Y=Y.replace(/\+/g,"-")).replace(/\//g,"_")).replace(/=+$/,""),p.signature=Y}function He(d,u){for(var p=[],v=2;v<arguments.length;v++)p[v-2]=arguments[v];var w=d.networking,T=d.config,P=d.telemetryManager,M=d.tokenManager,z=k(),G=null,Y=null,B={};u.getOperation()===Q.PNTimeOperation||u.getOperation()===Q.PNChannelGroupsOperation?G=p[0]:(B=p[0],G=p[1]),typeof Promise>"u"||G||(Y=me.createPromise());var he=u.validateParams(d,B);if(he)return G?G(we(he)):Y?(Y.reject(new ke("Validation failed, check status for details",we(he))),Y.promise):void 0;var se,ne=u.prepareParams(d,B),oe=st(u,d,B),ue={url:oe,operation:u.getOperation(),timeout:u.getRequestTimeout(d),headers:u.getRequestHeaders?u.getRequestHeaders():{},ignoreBody:typeof u.ignoreBody=="function"&&u.ignoreBody(d),forceBuffered:typeof u.forceBuffered=="function"?u.forceBuffered(d,B):null,abortSignal:typeof u.getAbortSignal=="function"?u.getAbortSignal(d,B):null};ne.uuid=T.UUID,ne.pnsdk=bt(T);var Ce=P.operationsLatencyForRequest();if(Object.keys(Ce).length&&(ne=r(r({},ne),Ce)),T.useInstanceId&&(ne.instanceid=T.instanceId),T.useRequestId&&(ne.requestid=z),u.isAuthSupported()){var Xe=M.getToken()||T.getAuthKey();Xe&&(ne.auth=Xe)}T.secretKey&&Ee(d,oe,ne,B,u);var it=function(rt,ge){if(rt.error)return u.handleError&&u.handleError(d,B,rt),void(G?G(rt):Y&&Y.reject(new ke("PubNub call failed, check status for details",rt)));P.stopLatencyMeasure(u.getOperation(),z);var Be=u.handleResponse(d,ge,B);typeof Be?.then!="function"&&(Be=Promise.resolve(Be)),Be.then(function(Pe){G?G(rt,Pe):Y&&Y.fulfill(Pe)}).catch(function(Pe){if(G){var et=Pe;u.getOperation()===Q.PNSubscribeOperation&&(et={statusCode:400,error:!0,operation:u.getOperation(),errorData:Pe,category:Ue.PNUnknownCategory}),G(et,null)}else Y&&Y.reject(new ke("PubNub call failed, check status for details",Pe))})};if(P.startLatencyMeasure(u.getOperation(),z),vt(d,u,B)==="POST"){var ut=u.postPayload(d,B);se=w.POST(ne,ut,ue,it)}else vt(d,u,B)==="PATCH"?(ut=u.patchPayload(d,B),se=w.PATCH(ne,ut,ue,it)):se=vt(d,u,B)==="DELETE"?w.DELETE(ne,ue,it):vt(d,u,B)==="GETFILE"?w.GETFILE(ne,ue,it):w.GET(ne,ue,it);return u.getOperation()===Q.PNSubscribeOperation?se:Y?Y.promise:void 0}var zt=Object.freeze({__proto__:null,getOperation:function(){return Q.PNAddChannelsToGroupOperation},validateParams:function(d,u){var p=u.channels,v=u.channelGroup,w=d.config;return v?p&&p.length!==0?w.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"},getURL:function(d,u){var p=u.channelGroup,v=d.config;return"/v1/channel-registration/sub-key/".concat(v.subscribeKey,"/channel-group/").concat(me.encodeString(p))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.channels;return{add:(p===void 0?[]:p).join(",")}},handleResponse:function(){return{}}}),Ge=Object.freeze({__proto__:null,getOperation:function(){return Q.PNRemoveChannelsFromGroupOperation},validateParams:function(d,u){var p=u.channels,v=u.channelGroup,w=d.config;return v?p&&p.length!==0?w.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"},getURL:function(d,u){var p=u.channelGroup,v=d.config;return"/v1/channel-registration/sub-key/".concat(v.subscribeKey,"/channel-group/").concat(me.encodeString(p))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.channels;return{remove:(p===void 0?[]:p).join(",")}},handleResponse:function(){return{}}}),at=Object.freeze({__proto__:null,getOperation:function(){return Q.PNRemoveGroupOperation},validateParams:function(d,u){var p=u.channelGroup,v=d.config;return p?v.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"},getURL:function(d,u){var p=u.channelGroup,v=d.config;return"/v1/channel-registration/sub-key/".concat(v.subscribeKey,"/channel-group/").concat(me.encodeString(p),"/remove")},isAuthSupported:function(){return!0},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},prepareParams:function(){return{}},handleResponse:function(){return{}}}),Ve=Object.freeze({__proto__:null,getOperation:function(){return Q.PNChannelGroupsOperation},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d){var u=d.config;return"/v1/channel-registration/sub-key/".concat(u.subscribeKey,"/channel-group")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return{groups:u.payload.groups}}}),Ae=Object.freeze({__proto__:null,getOperation:function(){return Q.PNChannelsForGroupOperation},validateParams:function(d,u){var p=u.channelGroup,v=d.config;return p?v.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"},getURL:function(d,u){var p=u.channelGroup,v=d.config;return"/v1/channel-registration/sub-key/".concat(v.subscribeKey,"/channel-group/").concat(me.encodeString(p))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return{channels:u.payload.channels}}}),lt=Object.freeze({__proto__:null,getOperation:function(){return Q.PNPushNotificationEnabledChannelsOperation},validateParams:function(d,u){var p=u.device,v=u.pushGateway,w=u.channels,T=u.topic,P=d.config;return p?v?v!=="apns2"||T?w&&w.length!==0?P.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(d,u){var p=u.device,v=u.pushGateway,w=d.config;return v==="apns2"?"/v2/push/sub-key/".concat(w.subscribeKey,"/devices-apns2/").concat(p):"/v1/push/sub-key/".concat(w.subscribeKey,"/devices/").concat(p)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.pushGateway,v=u.channels,w=v===void 0?[]:v,T=u.environment,P=T===void 0?"development":T,M=u.topic,z={type:p,add:w.join(",")};return p==="apns2"&&delete(z=r(r({},z),{environment:P,topic:M})).type,z},handleResponse:function(){return{}}}),Bt=Object.freeze({__proto__:null,getOperation:function(){return Q.PNPushNotificationEnabledChannelsOperation},validateParams:function(d,u){var p=u.device,v=u.pushGateway,w=u.channels,T=u.topic,P=d.config;return p?v?v!=="apns2"||T?w&&w.length!==0?P.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(d,u){var p=u.device,v=u.pushGateway,w=d.config;return v==="apns2"?"/v2/push/sub-key/".concat(w.subscribeKey,"/devices-apns2/").concat(p):"/v1/push/sub-key/".concat(w.subscribeKey,"/devices/").concat(p)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.pushGateway,v=u.channels,w=v===void 0?[]:v,T=u.environment,P=T===void 0?"development":T,M=u.topic,z={type:p,remove:w.join(",")};return p==="apns2"&&delete(z=r(r({},z),{environment:P,topic:M})).type,z},handleResponse:function(){return{}}}),ct=Object.freeze({__proto__:null,getOperation:function(){return Q.PNPushNotificationEnabledChannelsOperation},validateParams:function(d,u){var p=u.device,v=u.pushGateway,w=u.topic,T=d.config;return p?v?v!=="apns2"||w?T.subscribeKey?void 0:"Missing Subscribe Key":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(d,u){var p=u.device,v=u.pushGateway,w=d.config;return v==="apns2"?"/v2/push/sub-key/".concat(w.subscribeKey,"/devices-apns2/").concat(p):"/v1/push/sub-key/".concat(w.subscribeKey,"/devices/").concat(p)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.pushGateway,v=u.environment,w=v===void 0?"development":v,T=u.topic,P=u.start,M=u.count,z={type:p};return p==="apns2"&&delete(z=r(r({},z),{environment:w,topic:T})).type,P&&(z.start=P),M&&M>0&&(z.count=M),z},handleResponse:function(d,u){return{channels:u}}}),_t=Object.freeze({__proto__:null,getOperation:function(){return Q.PNRemoveAllPushNotificationsOperation},validateParams:function(d,u){var p=u.device,v=u.pushGateway,w=u.topic,T=d.config;return p?v?v!=="apns2"||w?T.subscribeKey?void 0:"Missing Subscribe Key":"Missing APNS2 topic":"Missing GW Type (pushGateway: gcm, apns or apns2)":"Missing Device ID (device)"},getURL:function(d,u){var p=u.device,v=u.pushGateway,w=d.config;return v==="apns2"?"/v2/push/sub-key/".concat(w.subscribeKey,"/devices-apns2/").concat(p,"/remove"):"/v1/push/sub-key/".concat(w.subscribeKey,"/devices/").concat(p,"/remove")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.pushGateway,v=u.environment,w=v===void 0?"development":v,T=u.topic,P={type:p};return p==="apns2"&&delete(P=r(r({},P),{environment:w,topic:T})).type,P},handleResponse:function(){return{}}}),re=Object.freeze({__proto__:null,getOperation:function(){return Q.PNUnsubscribeOperation},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d,u){var p=d.config,v=u.channels,w=v===void 0?[]:v,T=w.length>0?w.join(","):",";return"/v2/presence/sub-key/".concat(p.subscribeKey,"/channel/").concat(me.encodeString(T),"/leave")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.channelGroups,v=p===void 0?[]:p,w={};return v.length>0&&(w["channel-group"]=v.join(",")),w},handleResponse:function(){return{}}}),te=Object.freeze({__proto__:null,getOperation:function(){return Q.PNWhereNowOperation},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d,u){var p=d.config,v=u.uuid,w=v===void 0?p.UUID:v;return"/v2/presence/sub-key/".concat(p.subscribeKey,"/uuid/").concat(me.encodeString(w))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return u.payload?{channels:u.payload.channels}:{channels:[]}}}),be=Object.freeze({__proto__:null,getOperation:function(){return Q.PNHeartbeatOperation},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d,u){var p=d.config,v=u.channels,w=v===void 0?[]:v,T=w.length>0?w.join(","):",";return"/v2/presence/sub-key/".concat(p.subscribeKey,"/channel/").concat(me.encodeString(T),"/heartbeat")},isAuthSupported:function(){return!0},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},prepareParams:function(d,u){var p=u.channelGroups,v=p===void 0?[]:p,w=u.state,T=d.config,P={};return v.length>0&&(P["channel-group"]=v.join(",")),w&&(P.state=JSON.stringify(w)),P.heartbeat=T.getPresenceTimeout(),P},handleResponse:function(){return{}}}),De=Object.freeze({__proto__:null,getOperation:function(){return Q.PNGetStateOperation},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d,u){var p=d.config,v=u.uuid,w=v===void 0?p.UUID:v,T=u.channels,P=T===void 0?[]:T,M=P.length>0?P.join(","):",";return"/v2/presence/sub-key/".concat(p.subscribeKey,"/channel/").concat(me.encodeString(M),"/uuid/").concat(w)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.channelGroups,v=p===void 0?[]:p,w={};return v.length>0&&(w["channel-group"]=v.join(",")),w},handleResponse:function(d,u,p){var v=p.channels,w=v===void 0?[]:v,T=p.channelGroups,P=T===void 0?[]:T,M={};return w.length===1&&P.length===0?M[w[0]]=u.payload:M=u.payload,{channels:M}}}),dt=Object.freeze({__proto__:null,getOperation:function(){return Q.PNSetStateOperation},validateParams:function(d,u){var p=d.config,v=u.state,w=u.channels,T=w===void 0?[]:w,P=u.channelGroups,M=P===void 0?[]:P;return v?p.subscribeKey?T.length===0&&M.length===0?"Please provide a list of channels and/or channel-groups":void 0:"Missing Subscribe Key":"Missing State"},getURL:function(d,u){var p=d.config,v=u.channels,w=v===void 0?[]:v,T=w.length>0?w.join(","):",";return"/v2/presence/sub-key/".concat(p.subscribeKey,"/channel/").concat(me.encodeString(T),"/uuid/").concat(me.encodeString(p.UUID),"/data")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.state,v=u.channelGroups,w=v===void 0?[]:v,T={};return T.state=JSON.stringify(p),w.length>0&&(T["channel-group"]=w.join(",")),T},handleResponse:function(d,u){return{state:u.payload}}}),K=Object.freeze({__proto__:null,getOperation:function(){return Q.PNHereNowOperation},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d,u){var p=d.config,v=u.channels,w=v===void 0?[]:v,T=u.channelGroups,P=T===void 0?[]:T,M="/v2/presence/sub-key/".concat(p.subscribeKey);if(w.length>0||P.length>0){var z=w.length>0?w.join(","):",";M+="/channel/".concat(me.encodeString(z))}return M},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.channelGroups,v=p===void 0?[]:p,w=u.includeUUIDs,T=w===void 0||w,P=u.includeState,M=P!==void 0&&P,z=u.queryParameters,G=z===void 0?{}:z,Y={};return T||(Y.disable_uuids=1),M&&(Y.state=1),v.length>0&&(Y["channel-group"]=v.join(",")),Y=r(r({},Y),G)},handleResponse:function(d,u,p){var v=p.channels,w=v===void 0?[]:v,T=p.channelGroups,P=T===void 0?[]:T,M=p.includeUUIDs,z=M===void 0||M,G=p.includeState,Y=G!==void 0&&G;return w.length>1||P.length>0||P.length===0&&w.length===0?function(){var B={};return B.totalChannels=u.payload.total_channels,B.totalOccupancy=u.payload.total_occupancy,B.channels={},Object.keys(u.payload.channels).forEach(function(he){var se=u.payload.channels[he],ne=[];return B.channels[he]={occupants:ne,name:he,occupancy:se.occupancy},z&&se.uuids.forEach(function(oe){Y?ne.push({state:oe.state,uuid:oe.uuid}):ne.push({state:null,uuid:oe})}),B}),B}():function(){var B={},he=[];return B.totalChannels=1,B.totalOccupancy=u.occupancy,B.channels={},B.channels[w[0]]={occupants:he,name:w[0],occupancy:u.occupancy},z&&u.uuids&&u.uuids.forEach(function(se){Y?he.push({state:se.state,uuid:se.uuid}):he.push({state:null,uuid:se})}),B}()},handleError:function(d,u,p){p.statusCode!==402||this.getURL(d,u).includes("channel")||(p.errorData.message="You have tried to perform a Global Here Now operation, your keyset configuration does not support that. Please provide a channel, or enable the Global Here Now feature from the Portal.")}}),le=Object.freeze({__proto__:null,getOperation:function(){return Q.PNAddMessageActionOperation},validateParams:function(d,u){var p=d.config,v=u.action,w=u.channel;return u.messageTimetoken?p.subscribeKey?w?v?v.value?v.type?v.type.length>15?"Action.type value exceed maximum length of 15":void 0:"Missing Action.type":"Missing Action.value":"Missing Action":"Missing message channel":"Missing Subscribe Key":"Missing message timetoken"},usePost:function(){return!0},postURL:function(d,u){var p=d.config,v=u.channel,w=u.messageTimetoken;return"/v1/message-actions/".concat(p.subscribeKey,"/channel/").concat(me.encodeString(v),"/message/").concat(w)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},getRequestHeaders:function(){return{"Content-Type":"application/json"}},isAuthSupported:function(){return!0},prepareParams:function(){return{}},postPayload:function(d,u){return u.action},handleResponse:function(d,u){return{data:u.data}}}),U=Object.freeze({__proto__:null,getOperation:function(){return Q.PNRemoveMessageActionOperation},validateParams:function(d,u){var p=d.config,v=u.channel,w=u.actionTimetoken;return u.messageTimetoken?w?p.subscribeKey?v?void 0:"Missing message channel":"Missing Subscribe Key":"Missing action timetoken":"Missing message timetoken"},useDelete:function(){return!0},getURL:function(d,u){var p=d.config,v=u.channel,w=u.actionTimetoken,T=u.messageTimetoken;return"/v1/message-actions/".concat(p.subscribeKey,"/channel/").concat(me.encodeString(v),"/message/").concat(T,"/action/").concat(w)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return{data:u.data}}}),Ne=Object.freeze({__proto__:null,getOperation:function(){return Q.PNGetMessageActionsOperation},validateParams:function(d,u){var p=d.config,v=u.channel;return p.subscribeKey?v?void 0:"Missing message channel":"Missing Subscribe Key"},getURL:function(d,u){var p=d.config,v=u.channel;return"/v1/message-actions/".concat(p.subscribeKey,"/channel/").concat(me.encodeString(v))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.limit,v=u.start,w=u.end,T={};return p&&(T.limit=p),v&&(T.start=v),w&&(T.end=w),T},handleResponse:function(d,u){var p={data:u.data,start:null,end:null};return p.data.length&&(p.end=p.data[p.data.length-1].actionTimetoken,p.start=p.data[0].actionTimetoken),p}}),Ye={getOperation:function(){return Q.PNListFilesOperation},validateParams:function(d,u){if(!u?.channel)return"channel can't be empty"},getURL:function(d,u){var p=d.config;return"/v1/files/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel),"/files")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p={};return u.limit&&(p.limit=u.limit),u.next&&(p.next=u.next),p},handleResponse:function(d,u){return{status:u.status,data:u.data,next:u.next,count:u.count}}},ft={getOperation:function(){return Q.PNGenerateUploadUrlOperation},validateParams:function(d,u){return u?.channel?u?.name?void 0:"name can't be empty":"channel can't be empty"},usePost:function(){return!0},postURL:function(d,u){var p=d.config;return"/v1/files/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel),"/generate-upload-url")},postPayload:function(d,u){return{name:u.name}},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return{status:u.status,data:u.data,file_upload_request:u.file_upload_request}}},kt={getOperation:function(){return Q.PNPublishFileOperation},validateParams:function(d,u){return u?.channel?u?.fileId?u?.fileName?void 0:"file name can't be empty":"file id can't be empty":"channel can't be empty"},getURL:function(d,u){var p=d.config,v=p.publishKey,w=p.subscribeKey,T=function(P,M){var z=JSON.stringify(M);if(P.cryptoModule){var G=P.cryptoModule.encrypt(z);z=typeof G=="string"?G:J(G),z=JSON.stringify(z)}return z||""}(d,{message:u.message,file:{name:u.fileName,id:u.fileId}});return"/v1/files/publish-file/".concat(v,"/").concat(w,"/0/").concat(me.encodeString(u.channel),"/0/").concat(me.encodeString(T))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p={};return u.ttl&&(p.ttl=u.ttl),u.storeInHistory!==void 0&&(p.store=u.storeInHistory?"1":"0"),u.meta&&typeof u.meta=="object"&&(p.meta=JSON.stringify(u.meta)),p},handleResponse:function(d,u){return{timetoken:u[2]}}},Et=function(d){var u=function(p){var v=this,w=p.generateUploadUrl,T=p.publishFile,P=p.modules,M=P.PubNubFile,z=P.config,G=P.cryptography,Y=P.cryptoModule,B=P.networking;return function(he){var se=he.channel,ne=he.file,oe=he.message,ue=he.cipherKey,Ce=he.meta,Xe=he.ttl,it=he.storeInHistory;return i(v,void 0,void 0,function(){var ut,rt,ge,Be,Pe,et,Me,qe,ve,ot,je,Je,nt,gt,wr,Di,Li,Go,Fu,gs,lo,MA,$A,Qf,UA,M0,$0,Jg,U0;return a(this,function(ji){switch(ji.label){case 0:if(!se)throw new ke("Validation failed, check status for details",we("channel can't be empty"));if(!ne)throw new ke("Validation failed, check status for details",we("file can't be empty"));return ut=M.create(ne),[4,w({channel:se,name:ut.name})];case 1:return rt=ji.sent(),ge=rt.file_upload_request,Be=ge.url,Pe=ge.form_fields,et=rt.data,Me=et.id,qe=et.name,M.supportsEncryptFile&&(ue||Y)?ue!=null?[3,3]:[4,Y.encryptFile(ut,M)]:[3,6];case 2:return ve=ji.sent(),[3,5];case 3:return[4,G.encryptFile(ue,ut,M)];case 4:ve=ji.sent(),ji.label=5;case 5:ut=ve,ji.label=6;case 6:ot=Pe,ut.mimeType&&(ot=Pe.map(function(F0){return F0.key==="Content-Type"?{key:F0.key,value:ut.mimeType}:F0})),ji.label=7;case 7:return ji.trys.push([7,21,,22]),M.supportsFileUri&&ne.uri?(nt=(Je=B).POSTFILE,gt=[Be,ot],[4,ut.toFileUri()]):[3,10];case 8:return[4,nt.apply(Je,gt.concat([ji.sent()]))];case 9:return je=ji.sent(),[3,20];case 10:return M.supportsFile?(Di=(wr=B).POSTFILE,Li=[Be,ot],[4,ut.toFile()]):[3,13];case 11:return[4,Di.apply(wr,Li.concat([ji.sent()]))];case 12:return je=ji.sent(),[3,20];case 13:return M.supportsBuffer?(Fu=(Go=B).POSTFILE,gs=[Be,ot],[4,ut.toBuffer()]):[3,16];case 14:return[4,Fu.apply(Go,gs.concat([ji.sent()]))];case 15:return je=ji.sent(),[3,20];case 16:return M.supportsBlob?(MA=(lo=B).POSTFILE,$A=[Be,ot],[4,ut.toBlob()]):[3,19];case 17:return[4,MA.apply(lo,$A.concat([ji.sent()]))];case 18:return je=ji.sent(),[3,20];case 19:throw new Error("Unsupported environment");case 20:return[3,22];case 21:throw(Qf=ji.sent()).response&&typeof Qf.response.text=="string"?(UA=Qf.response.text,M0=/<Message>(.*)<\/Message>/gi.exec(UA),new ke(M0?"Upload to bucket failed: ".concat(M0[1]):"Upload to bucket failed.",Qf)):new ke("Upload to bucket failed.",Qf);case 22:if(je.status!==204)throw new ke("Upload to bucket was unsuccessful",je);$0=z.fileUploadPublishRetryLimit,Jg=!1,U0={timetoken:"0"},ji.label=23;case 23:return ji.trys.push([23,25,,26]),[4,T({channel:se,message:oe,fileId:Me,fileName:qe,meta:Ce,storeInHistory:it,ttl:Xe})];case 24:return U0=ji.sent(),Jg=!0,[3,26];case 25:return ji.sent(),$0-=1,[3,26];case 26:if(!Jg&&$0>0)return[3,23];ji.label=27;case 27:if(Jg)return[2,{timetoken:U0.timetoken,id:Me,name:qe}];throw new ke("Publish failed. You may want to execute that operation manually using pubnub.publishFile",{channel:se,id:Me,name:qe})}})})}}(d);return function(p,v){var w=u(p);return typeof v=="function"&&w.then(function(T){return v(null,T)}).catch(function(T){return v(T,null)}),w}},Ie=function(d,u){var p=u.channel,v=u.id,w=u.name,T=d.config,P=d.networking,M=d.tokenManager;if(!p)throw new ke("Validation failed, check status for details",we("channel can't be empty"));if(!v)throw new ke("Validation failed, check status for details",we("file id can't be empty"));if(!w)throw new ke("Validation failed, check status for details",we("file name can't be empty"));var z="/v1/files/".concat(T.subscribeKey,"/channels/").concat(me.encodeString(p),"/files/").concat(v,"/").concat(w),G={};G.uuid=T.getUUID(),G.pnsdk=bt(T);var Y=M.getToken()||T.getAuthKey();Y&&(G.auth=Y),T.secretKey&&Ee(d,z,G,{},{getOperation:function(){return"PubNubGetFileUrlOperation"}});var B=Object.keys(G).map(function(he){return"".concat(encodeURIComponent(he),"=").concat(encodeURIComponent(G[he]))}).join("&");return B!==""?"".concat(P.getStandardOrigin()).concat(z,"?").concat(B):"".concat(P.getStandardOrigin()).concat(z)},Jt={getOperation:function(){return Q.PNDownloadFileOperation},validateParams:function(d,u){return u?.channel?u?.name?u?.id?void 0:"id can't be empty":"name can't be empty":"channel can't be empty"},useGetFile:function(){return!0},getFileURL:function(d,u){var p=d.config;return"/v1/files/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel),"/files/").concat(u.id,"/").concat(u.name)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},ignoreBody:function(){return!0},forceBuffered:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u,p){var v=d.PubNubFile,w=d.config,T=d.cryptography,P=d.cryptoModule;return i(void 0,void 0,void 0,function(){var M,z,G,Y;return a(this,function(B){switch(B.label){case 0:return M=u.response.body,v.supportsEncryptFile&&(p.cipherKey||P)?p.cipherKey!=null?[3,2]:[4,P.decryptFile(v.create({data:M,name:p.name}),v)]:[3,5];case 1:return z=B.sent().data,[3,4];case 2:return[4,T.decrypt((G=p.cipherKey)!==null&&G!==void 0?G:w.cipherKey,M)];case 3:z=B.sent(),B.label=4;case 4:M=z,B.label=5;case 5:return[2,v.create({data:M,name:(Y=u.response.name)!==null&&Y!==void 0?Y:p.name,mimeType:u.response.type})]}})})}},Nt={getOperation:function(){return Q.PNListFilesOperation},validateParams:function(d,u){return u?.channel?u?.id?u?.name?void 0:"file name can't be empty":"file id can't be empty":"channel can't be empty"},useDelete:function(){return!0},getURL:function(d,u){var p=d.config;return"/v1/files/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel),"/files/").concat(u.id,"/").concat(u.name)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return{status:u.status}}},Ot={getOperation:function(){return Q.PNGetAllUUIDMetadataOperation},validateParams:function(){},getURL:function(d){var u=d.config;return"/v2/objects/".concat(u.subscribeKey,"/uuids")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w,T,P,M,z,G,Y,B={include:["status","type"]};return u?.include&&(!((p=u.include)===null||p===void 0)&&p.customFields)&&B.include.push("custom"),B.include=B.include.join(","),!((v=u?.include)===null||v===void 0)&&v.totalCount&&(B.count=(w=u.include)===null||w===void 0?void 0:w.totalCount),!((T=u?.page)===null||T===void 0)&&T.next&&(B.start=(P=u.page)===null||P===void 0?void 0:P.next),!((M=u?.page)===null||M===void 0)&&M.prev&&(B.end=(z=u.page)===null||z===void 0?void 0:z.prev),u?.filter&&(B.filter=u.filter),B.limit=(G=u?.limit)!==null&&G!==void 0?G:100,u?.sort&&(B.sort=Object.entries((Y=u.sort)!==null&&Y!==void 0?Y:{}).map(function(he){var se=o(he,2),ne=se[0],oe=se[1];return oe==="asc"||oe==="desc"?"".concat(ne,":").concat(oe):ne})),B},handleResponse:function(d,u){return{status:u.status,data:u.data,totalCount:u.totalCount,next:u.next,prev:u.prev}}},qr={getOperation:function(){return Q.PNGetUUIDMetadataOperation},validateParams:function(){},getURL:function(d,u){var p,v=d.config;return"/v2/objects/".concat(v.subscribeKey,"/uuids/").concat(me.encodeString((p=u?.uuid)!==null&&p!==void 0?p:v.getUUID()))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w=d.config,T={};return T.uuid=(p=u?.uuid)!==null&&p!==void 0?p:w.getUUID(),T.include=["status","type","custom"],u?.include&&((v=u.include)===null||v===void 0?void 0:v.customFields)===!1&&T.include.pop(),T.include=T.include.join(","),T},handleResponse:function(d,u){return{status:u.status,data:u.data}}},er={getOperation:function(){return Q.PNSetUUIDMetadataOperation},validateParams:function(d,u){if(!u?.data)return"Data cannot be empty"},usePatch:function(){return!0},patchURL:function(d,u){var p,v=d.config;return"/v2/objects/".concat(v.subscribeKey,"/uuids/").concat(me.encodeString((p=u.uuid)!==null&&p!==void 0?p:v.getUUID()))},patchPayload:function(d,u){return u.data},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w=d.config,T={};return T.uuid=(p=u?.uuid)!==null&&p!==void 0?p:w.getUUID(),T.include=["status","type","custom"],u?.include&&((v=u.include)===null||v===void 0?void 0:v.customFields)===!1&&T.include.pop(),T.include=T.include.join(","),T},handleResponse:function(d,u){return{status:u.status,data:u.data}}},hi={getOperation:function(){return Q.PNRemoveUUIDMetadataOperation},validateParams:function(){},getURL:function(d,u){var p,v=d.config;return"/v2/objects/".concat(v.subscribeKey,"/uuids/").concat(me.encodeString((p=u?.uuid)!==null&&p!==void 0?p:v.getUUID()))},useDelete:function(){return!0},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v=d.config;return{uuid:(p=u?.uuid)!==null&&p!==void 0?p:v.getUUID()}},handleResponse:function(d,u){return{status:u.status,data:u.data}}},mr={getOperation:function(){return Q.PNGetAllChannelMetadataOperation},validateParams:function(){},getURL:function(d){var u=d.config;return"/v2/objects/".concat(u.subscribeKey,"/channels")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w,T,P,M,z,G,Y,B={include:["status","type"]};return u?.include&&(!((p=u.include)===null||p===void 0)&&p.customFields)&&B.include.push("custom"),B.include=B.include.join(","),!((v=u?.include)===null||v===void 0)&&v.totalCount&&(B.count=(w=u.include)===null||w===void 0?void 0:w.totalCount),!((T=u?.page)===null||T===void 0)&&T.next&&(B.start=(P=u.page)===null||P===void 0?void 0:P.next),!((M=u?.page)===null||M===void 0)&&M.prev&&(B.end=(z=u.page)===null||z===void 0?void 0:z.prev),u?.filter&&(B.filter=u.filter),B.limit=(G=u?.limit)!==null&&G!==void 0?G:100,u?.sort&&(B.sort=Object.entries((Y=u.sort)!==null&&Y!==void 0?Y:{}).map(function(he){var se=o(he,2),ne=se[0],oe=se[1];return oe==="asc"||oe==="desc"?"".concat(ne,":").concat(oe):ne})),B},handleResponse:function(d,u){return{status:u.status,data:u.data,totalCount:u.totalCount,prev:u.prev,next:u.next}}},zr={getOperation:function(){return Q.PNGetChannelMetadataOperation},validateParams:function(d,u){if(!u?.channel)return"Channel cannot be empty"},getURL:function(d,u){var p=d.config;return"/v2/objects/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v={include:["status","type","custom"]};return u?.include&&((p=u.include)===null||p===void 0?void 0:p.customFields)===!1&&v.include.pop(),v.include=v.include.join(","),v},handleResponse:function(d,u){return{status:u.status,data:u.data}}},Pi={getOperation:function(){return Q.PNSetChannelMetadataOperation},validateParams:function(d,u){return u?.channel?u?.data?void 0:"Data cannot be empty":"Channel cannot be empty"},usePatch:function(){return!0},patchURL:function(d,u){var p=d.config;return"/v2/objects/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel))},patchPayload:function(d,u){return u.data},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v={include:["status","type","custom"]};return u?.include&&((p=u.include)===null||p===void 0?void 0:p.customFields)===!1&&v.include.pop(),v.include=v.include.join(","),v},handleResponse:function(d,u){return{status:u.status,data:u.data}}},jr={getOperation:function(){return Q.PNRemoveChannelMetadataOperation},validateParams:function(d,u){if(!u?.channel)return"Channel cannot be empty"},getURL:function(d,u){var p=d.config;return"/v2/objects/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel))},useDelete:function(){return!0},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return{status:u.status,data:u.data}}},rn={getOperation:function(){return Q.PNGetMembersOperation},validateParams:function(d,u){if(!u?.channel)return"channel cannot be empty"},getURL:function(d,u){var p=d.config;return"/v2/objects/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel),"/uuids")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w,T,P,M,z,G,Y,B,he,se,ne,oe,ue={include:[]};return u?.include&&(!((p=u.include)===null||p===void 0)&&p.statusField&&ue.include.push("status"),!((v=u.include)===null||v===void 0)&&v.customFields&&ue.include.push("custom"),!((w=u.include)===null||w===void 0)&&w.UUIDFields&&ue.include.push("uuid"),!((T=u.include)===null||T===void 0)&&T.customUUIDFields&&ue.include.push("uuid.custom"),!((P=u.include)===null||P===void 0)&&P.UUIDStatusField&&ue.include.push("uuid.status"),!((M=u.include)===null||M===void 0)&&M.UUIDTypeField&&ue.include.push("uuid.type")),ue.include=ue.include.join(","),!((z=u?.include)===null||z===void 0)&&z.totalCount&&(ue.count=(G=u.include)===null||G===void 0?void 0:G.totalCount),!((Y=u?.page)===null||Y===void 0)&&Y.next&&(ue.start=(B=u.page)===null||B===void 0?void 0:B.next),!((he=u?.page)===null||he===void 0)&&he.prev&&(ue.end=(se=u.page)===null||se===void 0?void 0:se.prev),u?.filter&&(ue.filter=u.filter),ue.limit=(ne=u?.limit)!==null&&ne!==void 0?ne:100,u?.sort&&(ue.sort=Object.entries((oe=u.sort)!==null&&oe!==void 0?oe:{}).map(function(Ce){var Xe=o(Ce,2),it=Xe[0],ut=Xe[1];return ut==="asc"||ut==="desc"?"".concat(it,":").concat(ut):it})),ue},handleResponse:function(d,u){return{status:u.status,data:u.data,totalCount:u.totalCount,prev:u.prev,next:u.next}}},Yr={getOperation:function(){return Q.PNSetMembersOperation},validateParams:function(d,u){return u?.channel?u?.uuids&&u?.uuids.length!==0?void 0:"UUIDs cannot be empty":"Channel cannot be empty"},usePatch:function(){return!0},patchURL:function(d,u){var p=d.config;return"/v2/objects/".concat(p.subscribeKey,"/channels/").concat(me.encodeString(u.channel),"/uuids")},patchPayload:function(d,u){var p;return(p={set:[],delete:[]})[u.type]=u.uuids.map(function(v){return typeof v=="string"?{uuid:{id:v}}:{uuid:{id:v.id},custom:v.custom,status:v.status}}),p},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w,T,P,M,z,G,Y,B={include:["uuid.status","uuid.type","type"]};return u?.include&&(!((p=u.include)===null||p===void 0)&&p.customFields&&B.include.push("custom"),!((v=u.include)===null||v===void 0)&&v.customUUIDFields&&B.include.push("uuid.custom"),!((w=u.include)===null||w===void 0)&&w.UUIDFields&&B.include.push("uuid")),B.include=B.include.join(","),!((T=u?.include)===null||T===void 0)&&T.totalCount&&(B.count=!0),!((P=u?.page)===null||P===void 0)&&P.next&&(B.start=(M=u.page)===null||M===void 0?void 0:M.next),!((z=u?.page)===null||z===void 0)&&z.prev&&(B.end=(G=u.page)===null||G===void 0?void 0:G.prev),u?.filter&&(B.filter=u.filter),u.limit!=null&&(B.limit=u.limit),u?.sort&&(B.sort=Object.entries((Y=u.sort)!==null&&Y!==void 0?Y:{}).map(function(he){var se=o(he,2),ne=se[0],oe=se[1];return oe==="asc"||oe==="desc"?"".concat(ne,":").concat(oe):ne})),B},handleResponse:function(d,u){return{status:u.status,data:u.data,totalCount:u.totalCount,prev:u.prev,next:u.next}}},qt={getOperation:function(){return Q.PNGetMembershipsOperation},validateParams:function(){},getURL:function(d,u){var p,v=d.config;return"/v2/objects/".concat(v.subscribeKey,"/uuids/").concat(me.encodeString((p=u?.uuid)!==null&&p!==void 0?p:v.getUUID()),"/channels")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w,T,P,M,z,G,Y,B,he,se,ne,oe,ue={include:[]};return u?.include&&(!((p=u.include)===null||p===void 0)&&p.statusField&&ue.include.push("status"),!((v=u.include)===null||v===void 0)&&v.customFields&&ue.include.push("custom"),!((w=u.include)===null||w===void 0)&&w.channelFields&&ue.include.push("channel"),!((T=u.include)===null||T===void 0)&&T.customChannelFields&&ue.include.push("channel.custom"),!((P=u.include)===null||P===void 0)&&P.channelStatusField&&ue.include.push("channel.status"),!((M=u.include)===null||M===void 0)&&M.channelTypeField&&ue.include.push("channel.type")),ue.include=ue.include.join(","),!((z=u?.include)===null||z===void 0)&&z.totalCount&&(ue.count=(G=u.include)===null||G===void 0?void 0:G.totalCount),!((Y=u?.page)===null||Y===void 0)&&Y.next&&(ue.start=(B=u.page)===null||B===void 0?void 0:B.next),!((he=u?.page)===null||he===void 0)&&he.prev&&(ue.end=(se=u.page)===null||se===void 0?void 0:se.prev),u?.filter&&(ue.filter=u.filter),ue.limit=(ne=u?.limit)!==null&&ne!==void 0?ne:100,u?.sort&&(ue.sort=Object.entries((oe=u.sort)!==null&&oe!==void 0?oe:{}).map(function(Ce){var Xe=o(Ce,2),it=Xe[0],ut=Xe[1];return ut==="asc"||ut==="desc"?"".concat(it,":").concat(ut):it})),ue},handleResponse:function(d,u){return{status:u.status,data:u.data,totalCount:u.totalCount,prev:u.prev,next:u.next}}},gi={getOperation:function(){return Q.PNSetMembershipsOperation},validateParams:function(d,u){if(!u?.channels||u?.channels.length===0)return"Channels cannot be empty"},usePatch:function(){return!0},patchURL:function(d,u){var p,v=d.config;return"/v2/objects/".concat(v.subscribeKey,"/uuids/").concat(me.encodeString((p=u.uuid)!==null&&p!==void 0?p:v.getUUID()),"/channels")},patchPayload:function(d,u){var p;return(p={set:[],delete:[]})[u.type]=u.channels.map(function(v){return typeof v=="string"?{channel:{id:v}}:{channel:{id:v.id},custom:v.custom,status:v.status}}),p},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p,v,w,T,P,M,z,G,Y,B={include:["channel.status","channel.type","status"]};return u?.include&&(!((p=u.include)===null||p===void 0)&&p.customFields&&B.include.push("custom"),!((v=u.include)===null||v===void 0)&&v.customChannelFields&&B.include.push("channel.custom"),!((w=u.include)===null||w===void 0)&&w.channelFields&&B.include.push("channel")),B.include=B.include.join(","),!((T=u?.include)===null||T===void 0)&&T.totalCount&&(B.count=!0),!((P=u?.page)===null||P===void 0)&&P.next&&(B.start=(M=u.page)===null||M===void 0?void 0:M.next),!((z=u?.page)===null||z===void 0)&&z.prev&&(B.end=(G=u.page)===null||G===void 0?void 0:G.prev),u?.filter&&(B.filter=u.filter),u.limit!=null&&(B.limit=u.limit),u?.sort&&(B.sort=Object.entries((Y=u.sort)!==null&&Y!==void 0?Y:{}).map(function(he){var se=o(he,2),ne=se[0],oe=se[1];return oe==="asc"||oe==="desc"?"".concat(ne,":").concat(oe):ne})),B},handleResponse:function(d,u){return{status:u.status,data:u.data,totalCount:u.totalCount,prev:u.prev,next:u.next}}},Ai=Object.freeze({__proto__:null,getOperation:function(){return Q.PNAccessManagerAudit},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d){var u=d.config;return"/v2/auth/audit/sub-key/".concat(u.subscribeKey)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(d,u){var p=u.channel,v=u.channelGroup,w=u.authKeys,T=w===void 0?[]:w,P={};return p&&(P.channel=p),v&&(P["channel-group"]=v),T.length>0&&(P.auth=T.join(",")),P},handleResponse:function(d,u){return u.payload}}),tr=Object.freeze({__proto__:null,getOperation:function(){return Q.PNAccessManagerGrant},validateParams:function(d,u){var p=d.config;return p.subscribeKey?p.publishKey?p.secretKey?u.uuids==null||u.authKeys?u.uuids==null||u.channels==null&&u.channelGroups==null?void 0:"Both channel/channelgroup and uuid cannot be used in the same request":"authKeys are required for grant request on uuids":"Missing Secret Key":"Missing Publish Key":"Missing Subscribe Key"},getURL:function(d){var u=d.config;return"/v2/auth/grant/sub-key/".concat(u.subscribeKey)},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(d,u){var p=u.channels,v=p===void 0?[]:p,w=u.channelGroups,T=w===void 0?[]:w,P=u.uuids,M=P===void 0?[]:P,z=u.ttl,G=u.read,Y=G!==void 0&&G,B=u.write,he=B!==void 0&&B,se=u.manage,ne=se!==void 0&&se,oe=u.get,ue=oe!==void 0&&oe,Ce=u.join,Xe=Ce!==void 0&&Ce,it=u.update,ut=it!==void 0&&it,rt=u.authKeys,ge=rt===void 0?[]:rt,Be=u.delete,Pe={};return Pe.r=Y?"1":"0",Pe.w=he?"1":"0",Pe.m=ne?"1":"0",Pe.d=Be?"1":"0",Pe.g=ue?"1":"0",Pe.j=Xe?"1":"0",Pe.u=ut?"1":"0",v.length>0&&(Pe.channel=v.join(",")),T.length>0&&(Pe["channel-group"]=T.join(",")),ge.length>0&&(Pe.auth=ge.join(",")),M.length>0&&(Pe["target-uuid"]=M.join(",")),(z||z===0)&&(Pe.ttl=z),Pe},handleResponse:function(){return{}}});function Jr(d){var u,p,v,w,T=d?.authorizedUserId!==void 0,P=((u=d?.resources)===null||u===void 0?void 0:u.users)!==void 0,M=((p=d?.resources)===null||p===void 0?void 0:p.spaces)!==void 0,z=((v=d?.patterns)===null||v===void 0?void 0:v.users)!==void 0,G=((w=d?.patterns)===null||w===void 0?void 0:w.spaces)!==void 0;return z||P||G||M||T}function Hr(d){var u=0;return d.join&&(u|=128),d.update&&(u|=64),d.get&&(u|=32),d.delete&&(u|=8),d.manage&&(u|=4),d.write&&(u|=2),d.read&&(u|=1),u}function Kt(d,u){if(Jr(u))return function(ne,oe){var ue=oe.ttl,Ce=oe.resources,Xe=oe.patterns,it=oe.meta,ut=oe.authorizedUserId,rt={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(Ce){var ge=Ce.users,Be=Ce.spaces,Pe=Ce.groups;ge&&Object.keys(ge).forEach(function(ve){rt.permissions.resources.uuids[ve]=Hr(ge[ve])}),Be&&Object.keys(Be).forEach(function(ve){rt.permissions.resources.channels[ve]=Hr(Be[ve])}),Pe&&Object.keys(Pe).forEach(function(ve){rt.permissions.resources.groups[ve]=Hr(Pe[ve])})}if(Xe){var et=Xe.users,Me=Xe.spaces,qe=Xe.groups;et&&Object.keys(et).forEach(function(ve){rt.permissions.patterns.uuids[ve]=Hr(et[ve])}),Me&&Object.keys(Me).forEach(function(ve){rt.permissions.patterns.channels[ve]=Hr(Me[ve])}),qe&&Object.keys(qe).forEach(function(ve){rt.permissions.patterns.groups[ve]=Hr(qe[ve])})}return(ue||ue===0)&&(rt.ttl=ue),it&&(rt.permissions.meta=it),ut&&(rt.permissions.uuid="".concat(ut)),rt}(0,u);var p=u.ttl,v=u.resources,w=u.patterns,T=u.meta,P=u.authorized_uuid,M={ttl:0,permissions:{resources:{channels:{},groups:{},uuids:{},users:{},spaces:{}},patterns:{channels:{},groups:{},uuids:{},users:{},spaces:{}},meta:{}}};if(v){var z=v.uuids,G=v.channels,Y=v.groups;z&&Object.keys(z).forEach(function(ne){M.permissions.resources.uuids[ne]=Hr(z[ne])}),G&&Object.keys(G).forEach(function(ne){M.permissions.resources.channels[ne]=Hr(G[ne])}),Y&&Object.keys(Y).forEach(function(ne){M.permissions.resources.groups[ne]=Hr(Y[ne])})}if(w){var B=w.uuids,he=w.channels,se=w.groups;B&&Object.keys(B).forEach(function(ne){M.permissions.patterns.uuids[ne]=Hr(B[ne])}),he&&Object.keys(he).forEach(function(ne){M.permissions.patterns.channels[ne]=Hr(he[ne])}),se&&Object.keys(se).forEach(function(ne){M.permissions.patterns.groups[ne]=Hr(se[ne])})}return(p||p===0)&&(M.ttl=p),T&&(M.permissions.meta=T),P&&(M.permissions.uuid="".concat(P)),M}var Er=Object.freeze({__proto__:null,getOperation:function(){return Q.PNAccessManagerGrantToken},extractPermissions:Hr,validateParams:function(d,u){var p,v,w,T,P,M,z=d.config;if(!z.subscribeKey)return"Missing Subscribe Key";if(!z.publishKey)return"Missing Publish Key";if(!z.secretKey)return"Missing Secret Key";if(!u.resources&&!u.patterns)return"Missing either Resources or Patterns.";var G=u?.authorized_uuid!==void 0,Y=((p=u?.resources)===null||p===void 0?void 0:p.uuids)!==void 0,B=((v=u?.resources)===null||v===void 0?void 0:v.channels)!==void 0,he=((w=u?.resources)===null||w===void 0?void 0:w.groups)!==void 0,se=((T=u?.patterns)===null||T===void 0?void 0:T.uuids)!==void 0,ne=((P=u?.patterns)===null||P===void 0?void 0:P.channels)!==void 0,oe=((M=u?.patterns)===null||M===void 0?void 0:M.groups)!==void 0,ue=G||Y||se||B||ne||he||oe;return Jr(u)&&ue?"Cannot mix `users`, `spaces` and `authorizedUserId` with `uuids`, `channels`, `groups` and `authorized_uuid`":(!u.resources||u.resources.uuids&&Object.keys(u.resources.uuids).length!==0||u.resources.channels&&Object.keys(u.resources.channels).length!==0||u.resources.groups&&Object.keys(u.resources.groups).length!==0||u.resources.users&&Object.keys(u.resources.users).length!==0||u.resources.spaces&&Object.keys(u.resources.spaces).length!==0)&&(!u.patterns||u.patterns.uuids&&Object.keys(u.patterns.uuids).length!==0||u.patterns.channels&&Object.keys(u.patterns.channels).length!==0||u.patterns.groups&&Object.keys(u.patterns.groups).length!==0||u.patterns.users&&Object.keys(u.patterns.users).length!==0||u.patterns.spaces&&Object.keys(u.patterns.spaces).length!==0)?void 0:"Missing values for either Resources or Patterns."},postURL:function(d){var u=d.config;return"/v3/pam/".concat(u.subscribeKey,"/grant")},usePost:function(){return!0},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(){return{}},postPayload:function(d,u){return Kt(0,u)},handleResponse:function(d,u){return u.data.token}}),ln={getOperation:function(){return Q.PNAccessManagerRevokeToken},validateParams:function(d,u){return d.config.secretKey?u?void 0:"token can't be empty":"Missing Secret Key"},getURL:function(d,u){var p=d.config;return"/v3/pam/".concat(p.subscribeKey,"/grant/").concat(me.encodeString(u))},useDelete:function(){return!0},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!1},prepareParams:function(d){return{uuid:d.config.getUUID()}},handleResponse:function(d,u){return{status:u.status,data:u.data}}};function Pn(d,u){var p=JSON.stringify(u);if(d.cryptoModule){var v=d.cryptoModule.encrypt(p);p=typeof v=="string"?v:J(v),p=JSON.stringify(p)}return p||""}var dn=Object.freeze({__proto__:null,getOperation:function(){return Q.PNPublishOperation},validateParams:function(d,u){var p=d.config,v=u.message;return u.channel?v?p.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"},usePost:function(d,u){var p=u.sendByPost;return p!==void 0&&p},getURL:function(d,u){var p=d.config,v=u.channel,w=Pn(d,u.message);return"/publish/".concat(p.publishKey,"/").concat(p.subscribeKey,"/0/").concat(me.encodeString(v),"/0/").concat(me.encodeString(w))},postURL:function(d,u){var p=d.config,v=u.channel;return"/publish/".concat(p.publishKey,"/").concat(p.subscribeKey,"/0/").concat(me.encodeString(v),"/0")},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},postPayload:function(d,u){return Pn(d,u.message)},prepareParams:function(d,u){var p=u.meta,v=u.replicate,w=v===void 0||v,T=u.storeInHistory,P=u.ttl,M={};return T!=null&&(M.store=T?"1":"0"),P&&(M.ttl=P),w===!1&&(M.norep="true"),p&&typeof p=="object"&&(M.meta=JSON.stringify(p)),M},handleResponse:function(d,u){return{timetoken:u[2]}}}),pa=Object.freeze({__proto__:null,getOperation:function(){return Q.PNSignalOperation},validateParams:function(d,u){var p=d.config,v=u.message;return u.channel?v?p.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"},getURL:function(d,u){var p,v=d.config,w=u.channel,T=u.message,P=(p=T,JSON.stringify(p));return"/signal/".concat(v.publishKey,"/").concat(v.subscribeKey,"/0/").concat(me.encodeString(w),"/0/").concat(me.encodeString(P))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(){return{}},handleResponse:function(d,u){return{timetoken:u[2]}}}),gr=Object.freeze({__proto__:null,getOperation:function(){return Q.PNHistoryOperation},validateParams:function(d,u){var p=u.channel,v=d.config;return p?v.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},getURL:function(d,u){var p=u.channel,v=d.config;return"/v2/history/sub-key/".concat(v.subscribeKey,"/channel/").concat(me.encodeString(p))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.start,v=u.end,w=u.reverse,T=u.count,P=T===void 0?100:T,M=u.stringifiedTimeToken,z=M!==void 0&&M,G=u.includeMeta,Y=G!==void 0&&G,B={include_token:"true"};return B.count=P,p&&(B.start=p),v&&(B.end=v),z&&(B.string_message_token="true"),w!=null&&(B.reverse=w.toString()),Y&&(B.include_meta="true"),B},handleResponse:function(d,u){var p={messages:[],startTimeToken:u[1],endTimeToken:u[2]};return Array.isArray(u[0])&&u[0].forEach(function(v){var w=function(P,M){var z={};if(!P.cryptoModule)return z.payload=M,z;try{var G=P.cryptoModule.decrypt(M),Y=G instanceof ArrayBuffer?JSON.parse(new TextDecoder().decode(G)):G;return z.payload=Y,z}catch(B){P.config.logVerbosity&&console&&console.log&&console.log("decryption error",B.message),z.payload=M,z.error="Error while decrypting message content: ".concat(B.message)}return z}(d,v.message),T={timetoken:v.timetoken,entry:w.payload};v.meta&&(T.meta=v.meta),w.error&&(T.error=w.error),p.messages.push(T)}),p}}),mi=Object.freeze({__proto__:null,getOperation:function(){return Q.PNDeleteMessagesOperation},validateParams:function(d,u){var p=u.channel,v=d.config;return p?v.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},useDelete:function(){return!0},getURL:function(d,u){var p=u.channel,v=d.config;return"/v3/history/sub-key/".concat(v.subscribeKey,"/channel/").concat(me.encodeString(p))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.start,v=u.end,w={};return p&&(w.start=p),v&&(w.end=v),w},handleResponse:function(d,u){return u.payload}}),vi=Object.freeze({__proto__:null,getOperation:function(){return Q.PNMessageCounts},validateParams:function(d,u){var p=u.channels,v=u.timetoken,w=u.channelTimetokens,T=d.config;return p?v&&w?"timetoken and channelTimetokens are incompatible together":w&&w.length>1&&p.length!==w.length?"Length of channelTimetokens and channels do not match":T.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"},getURL:function(d,u){var p=u.channels,v=d.config,w=p.join(",");return"/v3/history/sub-key/".concat(v.subscribeKey,"/message-counts/").concat(me.encodeString(w))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.timetoken,v=u.channelTimetokens,w={};if(v&&v.length===1){var T=o(v,1)[0];w.timetoken=T}else v?w.channelsTimetoken=v.join(","):p&&(w.timetoken=p);return w},handleResponse:function(d,u){return{channels:u.channels}}}),ha=Object.freeze({__proto__:null,getOperation:function(){return Q.PNFetchMessagesOperation},validateParams:function(d,u){var p=u.channels,v=u.includeMessageActions,w=v!==void 0&&v,T=d.config;if(!p||p.length===0)return"Missing channels";if(!T.subscribeKey)return"Missing Subscribe Key";if(w&&p.length>1)throw new TypeError("History can return actions data for a single channel only. Either pass a single channel or disable the includeMessageActions flag.")},getURL:function(d,u){var p=u.channels,v=p===void 0?[]:p,w=u.includeMessageActions,T=w!==void 0&&w,P=d.config,M=T?"history-with-actions":"history",z=v.length>0?v.join(","):",";return"/v3/".concat(M,"/sub-key/").concat(P.subscribeKey,"/channel/").concat(me.encodeString(z))},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=u.channels,v=u.start,w=u.end,T=u.includeMessageActions,P=u.count,M=u.stringifiedTimeToken,z=M!==void 0&&M,G=u.includeMeta,Y=G!==void 0&&G,B=u.includeUuid,he=u.includeUUID,se=he===void 0||he,ne=u.includeMessageType,oe=ne===void 0||ne,ue={};return ue.max=P||(p.length>1||T===!0?25:100),v&&(ue.start=v),w&&(ue.end=w),z&&(ue.string_message_token="true"),Y&&(ue.include_meta="true"),se&&B!==!1&&(ue.include_uuid="true"),oe&&(ue.include_message_type="true"),ue},handleResponse:function(d,u){var p={channels:{}};return Object.keys(u.channels||{}).forEach(function(v){p.channels[v]=[],(u.channels[v]||[]).forEach(function(w){var T={},P=function(M,z){var G={};if(!M.cryptoModule)return G.payload=z,G;try{var Y=M.cryptoModule.decrypt(z),B=Y instanceof ArrayBuffer?JSON.parse(new TextDecoder().decode(Y)):Y;return G.payload=B,G}catch(he){M.config.logVerbosity&&console&&console.log&&console.log("decryption error",he.message),G.payload=z,G.error="Error while decrypting message content: ".concat(he.message)}return G}(d,w.message);T.channel=v,T.timetoken=w.timetoken,T.message=P.payload,T.messageType=w.message_type,T.uuid=w.uuid,w.actions&&(T.actions=w.actions,T.data=w.actions),w.meta&&(T.meta=w.meta),P.error&&(T.error=P.error),p.channels[v].push(T)})}),u.more&&(p.more=u.more),p}}),Ka=Object.freeze({__proto__:null,getOperation:function(){return Q.PNTimeOperation},getURL:function(){return"/time/0"},getRequestTimeout:function(d){return d.config.getTransactionTimeout()},prepareParams:function(){return{}},isAuthSupported:function(){return!1},handleResponse:function(d,u){return{timetoken:u[0]}},validateParams:function(){}}),ro=Object.freeze({__proto__:null,getOperation:function(){return Q.PNSubscribeOperation},validateParams:function(d){if(!d.config.subscribeKey)return"Missing Subscribe Key"},getURL:function(d,u){var p=d.config,v=u.channels,w=v===void 0?[]:v,T=w.length>0?w.join(","):",";return"/v2/subscribe/".concat(p.subscribeKey,"/").concat(me.encodeString(T),"/0")},getRequestTimeout:function(d){return d.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p=d.config,v=u.state,w=u.channelGroups,T=w===void 0?[]:w,P=u.timetoken,M=u.filterExpression,z=u.region,G={heartbeat:p.getPresenceTimeout()};return T.length>0&&(G["channel-group"]=T.join(",")),M&&M.length>0&&(G["filter-expr"]=M),Object.keys(v).length&&(G.state=JSON.stringify(v)),P&&(G.tt=P),z&&(G.tr=z),G},handleResponse:function(d,u){var p=[];u.m.forEach(function(w){var T={timetoken:w.p.t,region:w.p.r},P={shard:parseInt(w.a,10),subscriptionMatch:w.b,channel:w.c,messageType:w.e,payload:w.d,flags:w.f,issuingClientId:w.i,subscribeKey:w.k,originationTimetoken:w.o,userMetadata:w.u,publishMetaData:T};p.push(P)});var v={timetoken:u.t.t,region:u.t.r};return{messages:p,metadata:v}}}),wn={getOperation:function(){return Q.PNHandshakeOperation},validateParams:function(d,u){if(!u?.channels&&!u?.channelGroups)return"channels and channleGroups both should not be empty"},getURL:function(d,u){var p=d.config,v=u.channels,w=v===void 0?[]:v,T=w.length>0?w.join(","):",";return"/v2/subscribe/".concat(p.subscribeKey,"/").concat(me.encodeString(T),"/0")},getRequestTimeout:function(d){return d.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},prepareParams:function(d,u){var p={};return u.channelGroups&&u.channelGroups.length>0&&(p["channel-group"]=u.channelGroups.join(",")),p.tt=0,u.state&&(p.state=JSON.stringify(u.state)),u.filterExpression&&u.filterExpression.length>0&&(p["filter-expr"]=u.filterExpression),p.ee="",p},handleResponse:function(d,u){return{region:u.t.r,timetoken:u.t.t}}},Wr={getOperation:function(){return Q.PNReceiveMessagesOperation},validateParams:function(d,u){return u?.channels||u?.channelGroups?u?.timetoken?u?.region?void 0:"region can not be empty":"timetoken can not be empty":"channels and channleGroups both should not be empty"},getURL:function(d,u){var p=d.config,v=u.channels,w=v===void 0?[]:v,T=w.length>0?w.join(","):",";return"/v2/subscribe/".concat(p.subscribeKey,"/").concat(me.encodeString(T),"/0")},getRequestTimeout:function(d){return d.config.getSubscribeTimeout()},isAuthSupported:function(){return!0},getAbortSignal:function(d,u){return u.abortSignal},prepareParams:function(d,u){var p={};return u.channelGroups&&u.channelGroups.length>0&&(p["channel-group"]=u.channelGroups.join(",")),u.filterExpression&&u.filterExpression.length>0&&(p["filter-expr"]=u.filterExpression),p.tt=u.timetoken,p.tr=u.region,p.ee="",p},handleResponse:function(d,u){var p=[];return u.m.forEach(function(v){var w={shard:parseInt(v.a,10),subscriptionMatch:v.b,channel:v.c,messageType:v.e,payload:v.d,flags:v.f,issuingClientId:v.i,subscribeKey:v.k,originationTimetoken:v.o,userMetadata:v.u,publishMetaData:{timetoken:v.p.t,region:v.p.r}};p.push(w)}),{messages:p,metadata:{region:u.t.r,timetoken:u.t.t}}}},Qr=function(){function d(u){u===void 0&&(u=!1),this.sync=u,this.listeners=new Set}return d.prototype.subscribe=function(u){var p=this;return this.listeners.add(u),function(){p.listeners.delete(u)}},d.prototype.notify=function(u){var p=this,v=function(){p.listeners.forEach(function(w){w(u)})};this.sync?v():setTimeout(v,0)},d}(),Ii=function(){function d(u){this.label=u,this.transitionMap=new Map,this.enterEffects=[],this.exitEffects=[]}return d.prototype.transition=function(u,p){var v;if(this.transitionMap.has(p.type))return(v=this.transitionMap.get(p.type))===null||v===void 0?void 0:v(u,p)},d.prototype.on=function(u,p){return this.transitionMap.set(u,p),this},d.prototype.with=function(u,p){return[this,u,p??[]]},d.prototype.onEnter=function(u){return this.enterEffects.push(u),this},d.prototype.onExit=function(u){return this.exitEffects.push(u),this},d}(),ps=function(d){function u(){return d!==null&&d.apply(this,arguments)||this}return e(u,d),u.prototype.describe=function(p){return new Ii(p)},u.prototype.start=function(p,v){this.currentState=p,this.currentContext=v,this.notify({type:"engineStarted",state:p,context:v})},u.prototype.transition=function(p){var v,w,T,P,M,z;if(!this.currentState)throw new Error("Start the engine first");this.notify({type:"eventReceived",event:p});var G=this.currentState.transition(this.currentContext,p);if(G){var Y=o(G,3),B=Y[0],he=Y[1],se=Y[2];try{for(var ne=s(this.currentState.exitEffects),oe=ne.next();!oe.done;oe=ne.next()){var ue=oe.value;this.notify({type:"invocationDispatched",invocation:ue(this.currentContext)})}}catch(Be){v={error:Be}}finally{try{oe&&!oe.done&&(w=ne.return)&&w.call(ne)}finally{if(v)throw v.error}}var Ce=this.currentState;this.currentState=B;var Xe=this.currentContext;this.currentContext=he,this.notify({type:"transitionDone",fromState:Ce,fromContext:Xe,toState:B,toContext:he,event:p});try{for(var it=s(se),ut=it.next();!ut.done;ut=it.next())ue=ut.value,this.notify({type:"invocationDispatched",invocation:ue})}catch(Be){T={error:Be}}finally{try{ut&&!ut.done&&(P=it.return)&&P.call(it)}finally{if(T)throw T.error}}try{for(var rt=s(this.currentState.enterEffects),ge=rt.next();!ge.done;ge=rt.next())ue=ge.value,this.notify({type:"invocationDispatched",invocation:ue(this.currentContext)})}catch(Be){M={error:Be}}finally{try{ge&&!ge.done&&(z=rt.return)&&z.call(rt)}finally{if(M)throw M.error}}}},u}(Qr),Xa=function(){function d(u){this.dependencies=u,this.instances=new Map,this.handlers=new Map}return d.prototype.on=function(u,p){this.handlers.set(u,p)},d.prototype.dispatch=function(u){if(u.type!=="CANCEL"){var p=this.handlers.get(u.type);if(!p)throw new Error("Unhandled invocation '".concat(u.type,"'"));var v=p(u.payload,this.dependencies);u.managed&&this.instances.set(u.type,v),v.start()}else if(this.instances.has(u.payload)){var w=this.instances.get(u.payload);w?.cancel(),this.instances.delete(u.payload)}},d.prototype.dispose=function(){var u,p;try{for(var v=s(this.instances.entries()),w=v.next();!w.done;w=v.next()){var T=o(w.value,2),P=T[0];T[1].cancel(),this.instances.delete(P)}}catch(M){u={error:M}}finally{try{w&&!w.done&&(p=v.return)&&p.call(v)}finally{if(u)throw u.error}}},d}();function lr(d,u){var p=function(){for(var v=[],w=0;w<arguments.length;w++)v[w]=arguments[w];return{type:d,payload:u?.apply(void 0,c([],o(v),!1))}};return p.type=d,p}function Rn(d,u){var p=function(){for(var v=[],w=0;w<arguments.length;w++)v[w]=arguments[w];return{type:d,payload:u.apply(void 0,c([],o(v),!1)),managed:!1}};return p.type=d,p}function Dt(d,u){var p=function(){for(var v=[],w=0;w<arguments.length;w++)v[w]=arguments[w];return{type:d,payload:u.apply(void 0,c([],o(v),!1)),managed:!0}};return p.type=d,p.cancel={type:"CANCEL",payload:d,managed:!1},p}var Ht=function(d){function u(){var p=this.constructor,v=d.call(this,"The operation was aborted.")||this;return v.name="AbortError",Object.setPrototypeOf(v,p.prototype),v}return e(u,d),u}(Error),fr=function(d){function u(){var p=d!==null&&d.apply(this,arguments)||this;return p._aborted=!1,p}return e(u,d),Object.defineProperty(u.prototype,"aborted",{get:function(){return this._aborted},enumerable:!1,configurable:!0}),u.prototype.throwIfAborted=function(){if(this._aborted)throw new Ht},u.prototype.abort=function(){this._aborted=!0,this.notify(new Ht)},u}(Qr),Vt=function(d){function u(p,v,w){var T=d.call(this,p,v)||this;return T.asyncFunction=w,T.abortSignal=new fr,T}return e(u,d),u.prototype.start=function(){this.asyncFunction(this.payload,this.abortSignal,this.dependencies).catch(function(p){})},u.prototype.cancel=function(){this.abortSignal.abort()},u}(function(d,u){this.payload=d,this.dependencies=u}),Pr=function(d){return function(u,p){return new Vt(u,p,d)}},nn=Dt("HANDSHAKE",function(d,u){return{channels:d,groups:u}}),Tn=Dt("RECEIVE_MESSAGES",function(d,u,p){return{channels:d,groups:u,cursor:p}}),Dn=Rn("EMIT_MESSAGES",function(d){return d}),Zr=Rn("EMIT_STATUS",function(d){return d}),yi=Dt("RECEIVE_RECONNECT",function(d){return d}),Sn=Dt("HANDSHAKE_RECONNECT",function(d){return d}),Vn=lr("SUBSCRIPTION_CHANGED",function(d,u){return{channels:d,groups:u}}),Ln=lr("SUBSCRIPTION_RESTORED",function(d,u,p,v){return{channels:d,groups:u,cursor:{timetoken:p,region:v??0}}}),O=lr("HANDSHAKE_SUCCESS",function(d){return d}),q=lr("HANDSHAKE_FAILURE",function(d){return d}),ae=lr("HANDSHAKE_RECONNECT_SUCCESS",function(d){return{cursor:d}}),$e=lr("HANDSHAKE_RECONNECT_FAILURE",function(d){return d}),Ke=lr("HANDSHAKE_RECONNECT_GIVEUP",function(d){return d}),pt=lr("RECEIVE_SUCCESS",function(d,u){return{cursor:d,events:u}}),Wt=lr("RECEIVE_FAILURE",function(d){return d}),Rr=lr("RECEIVE_RECONNECT_SUCCESS",function(d,u){return{cursor:d,events:u}}),xt=lr("RECEIVE_RECONNECT_FAILURE",function(d){return d}),Qt=lr("RECEIVING_RECONNECT_GIVEUP",function(d){return d}),Lt=lr("DISCONNECT",function(){return{}}),zn=lr("RECONNECT",function(d,u){return{cursor:{timetoken:d??"",region:u??0}}}),fn=lr("UNSUBSCRIBE_ALL",function(){return{}}),nr=function(d){function u(p,v){var w=d.call(this,v)||this;return w.on(nn.type,Pr(function(T,P,M){var z=M.handshake,G=M.presenceState,Y=M.config;return i(w,void 0,void 0,function(){var B,he;return a(this,function(se){switch(se.label){case 0:P.throwIfAborted(),se.label=1;case 1:return se.trys.push([1,3,,4]),[4,z(r({abortSignal:P,channels:T.channels,channelGroups:T.groups,filterExpression:Y.filterExpression},Y.maintainPresenceState&&{state:G}))];case 2:return B=se.sent(),[2,p.transition(O(B))];case 3:return(he=se.sent())instanceof Error&&he.message==="Aborted"?[2]:he instanceof ke?[2,p.transition(q(he))]:[3,4];case 4:return[2]}})})})),w.on(Tn.type,Pr(function(T,P,M){var z=M.receiveMessages,G=M.config;return i(w,void 0,void 0,function(){var Y,B;return a(this,function(he){switch(he.label){case 0:P.throwIfAborted(),he.label=1;case 1:return he.trys.push([1,3,,4]),[4,z({abortSignal:P,channels:T.channels,channelGroups:T.groups,timetoken:T.cursor.timetoken,region:T.cursor.region,filterExpression:G.filterExpression})];case 2:return Y=he.sent(),p.transition(pt(Y.metadata,Y.messages)),[3,4];case 3:return(B=he.sent())instanceof Error&&B.message==="Aborted"?[2]:B instanceof ke&&!P.aborted?[2,p.transition(Wt(B))]:[3,4];case 4:return[2]}})})})),w.on(Dn.type,Pr(function(T,P,M){var z=M.emitMessages;return i(w,void 0,void 0,function(){return a(this,function(G){return T.length>0&&z(T),[2]})})})),w.on(Zr.type,Pr(function(T,P,M){var z=M.emitStatus;return i(w,void 0,void 0,function(){return a(this,function(G){return z(T),[2]})})})),w.on(yi.type,Pr(function(T,P,M){var z=M.receiveMessages,G=M.delay,Y=M.config;return i(w,void 0,void 0,function(){var B,he;return a(this,function(se){switch(se.label){case 0:return Y.retryConfiguration&&Y.retryConfiguration.shouldRetry(T.reason,T.attempts)?(P.throwIfAborted(),[4,G(Y.retryConfiguration.getDelay(T.attempts,T.reason))]):[3,6];case 1:se.sent(),P.throwIfAborted(),se.label=2;case 2:return se.trys.push([2,4,,5]),[4,z({abortSignal:P,channels:T.channels,channelGroups:T.groups,timetoken:T.cursor.timetoken,region:T.cursor.region,filterExpression:Y.filterExpression})];case 3:return B=se.sent(),[2,p.transition(Rr(B.metadata,B.messages))];case 4:return(he=se.sent())instanceof Error&&he.message==="Aborted"?[2]:he instanceof ke?[2,p.transition(xt(he))]:[3,5];case 5:return[3,7];case 6:return[2,p.transition(Qt(new ke(Y.retryConfiguration.getGiveupReason(T.reason,T.attempts))))];case 7:return[2]}})})})),w.on(Sn.type,Pr(function(T,P,M){var z=M.handshake,G=M.delay,Y=M.presenceState,B=M.config;return i(w,void 0,void 0,function(){var he,se;return a(this,function(ne){switch(ne.label){case 0:return B.retryConfiguration&&B.retryConfiguration.shouldRetry(T.reason,T.attempts)?(P.throwIfAborted(),[4,G(B.retryConfiguration.getDelay(T.attempts,T.reason))]):[3,6];case 1:ne.sent(),P.throwIfAborted(),ne.label=2;case 2:return ne.trys.push([2,4,,5]),[4,z(r({abortSignal:P,channels:T.channels,channelGroups:T.groups,filterExpression:B.filterExpression},B.maintainPresenceState&&{state:Y}))];case 3:return he=ne.sent(),[2,p.transition(ae(he))];case 4:return(se=ne.sent())instanceof Error&&se.message==="Aborted"?[2]:se instanceof ke?[2,p.transition($e(se))]:[3,5];case 5:return[3,7];case 6:return[2,p.transition(Ke(new ke(B.retryConfiguration.getGiveupReason(T.reason,T.attempts))))];case 7:return[2]}})})})),w}return e(u,d),u}(Xa),Nn=new Ii("HANDSHAKE_FAILED");Nn.on(Vn.type,function(d,u){return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:d.cursor})}),Nn.on(zn.type,function(d,u){return ei.with({channels:d.channels,groups:d.groups,cursor:u.payload.cursor||d.cursor})}),Nn.on(Ln.type,function(d,u){var p,v;return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region?u.payload.cursor.region:(v=(p=d?.cursor)===null||p===void 0?void 0:p.region)!==null&&v!==void 0?v:0}})}),Nn.on(fn.type,function(d){return pn.with()});var bi=new Ii("HANDSHAKE_STOPPED");bi.on(Vn.type,function(d,u){return bi.with({channels:u.payload.channels,groups:u.payload.groups,cursor:d.cursor})}),bi.on(zn.type,function(d,u){return ei.with(r(r({},d),{cursor:u.payload.cursor||d.cursor}))}),bi.on(Ln.type,function(d,u){var p;return bi.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region||((p=d?.cursor)===null||p===void 0?void 0:p.region)||0}})}),bi.on(fn.type,function(d){return pn.with()});var oi=new Ii("RECEIVE_FAILED");oi.on(zn.type,function(d,u){var p;return ei.with({channels:d.channels,groups:d.groups,cursor:{timetoken:u.payload.cursor.timetoken?(p=u.payload.cursor)===null||p===void 0?void 0:p.timetoken:d.cursor.timetoken,region:u.payload.cursor.region||d.cursor.region}})}),oi.on(Vn.type,function(d,u){return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:d.cursor})}),oi.on(Ln.type,function(d,u){return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region||d.cursor.region}})}),oi.on(fn.type,function(d){return pn.with(void 0)});var Gr=new Ii("RECEIVE_STOPPED");Gr.on(Vn.type,function(d,u){return Gr.with({channels:u.payload.channels,groups:u.payload.groups,cursor:d.cursor})}),Gr.on(Ln.type,function(d,u){return Gr.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region||d.cursor.region}})}),Gr.on(zn.type,function(d,u){var p;return ei.with({channels:d.channels,groups:d.groups,cursor:{timetoken:u.payload.cursor.timetoken?(p=u.payload.cursor)===null||p===void 0?void 0:p.timetoken:d.cursor.timetoken,region:u.payload.cursor.region||d.cursor.region}})}),Gr.on(fn.type,function(){return pn.with(void 0)});var Bi=new Ii("RECEIVE_RECONNECTING");Bi.onEnter(function(d){return yi(d)}),Bi.onExit(function(){return yi.cancel}),Bi.on(Rr.type,function(d,u){return ki.with({channels:d.channels,groups:d.groups,cursor:u.payload.cursor},[Dn(u.payload.events)])}),Bi.on(xt.type,function(d,u){return Bi.with(r(r({},d),{attempts:d.attempts+1,reason:u.payload}))}),Bi.on(Qt.type,function(d,u){var p;return oi.with({groups:d.groups,channels:d.channels,cursor:d.cursor,reason:u.payload},[Zr({category:Ue.PNDisconnectedUnexpectedlyCategory,error:(p=u.payload)===null||p===void 0?void 0:p.message})])}),Bi.on(Lt.type,function(d){return Gr.with({channels:d.channels,groups:d.groups,cursor:d.cursor},[Zr({category:Ue.PNDisconnectedCategory})])}),Bi.on(Ln.type,function(d,u){return ki.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region||d.cursor.region}})}),Bi.on(Vn.type,function(d,u){return ki.with({channels:u.payload.channels,groups:u.payload.groups,cursor:d.cursor})}),Bi.on(fn.type,function(d){return pn.with(void 0,[Zr({category:Ue.PNDisconnectedCategory})])});var ki=new Ii("RECEIVING");ki.onEnter(function(d){return Tn(d.channels,d.groups,d.cursor)}),ki.onExit(function(){return Tn.cancel}),ki.on(pt.type,function(d,u){return ki.with({channels:d.channels,groups:d.groups,cursor:u.payload.cursor},[Dn(u.payload.events)])}),ki.on(Vn.type,function(d,u){return u.payload.channels.length===0&&u.payload.groups.length===0?pn.with(void 0):ki.with({cursor:d.cursor,channels:u.payload.channels,groups:u.payload.groups})}),ki.on(Ln.type,function(d,u){return u.payload.channels.length===0&&u.payload.groups.length===0?pn.with(void 0):ki.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region||d.cursor.region}})}),ki.on(Wt.type,function(d,u){return Bi.with(r(r({},d),{attempts:0,reason:u.payload}))}),ki.on(Lt.type,function(d){return Gr.with({channels:d.channels,groups:d.groups,cursor:d.cursor},[Zr({category:Ue.PNDisconnectedCategory})])}),ki.on(fn.type,function(d){return pn.with(void 0,[Zr({category:Ue.PNDisconnectedCategory})])});var Xi=new Ii("HANDSHAKE_RECONNECTING");Xi.onEnter(function(d){return Sn(d)}),Xi.onExit(function(){return Sn.cancel}),Xi.on(ae.type,function(d,u){var p,v,w={timetoken:!((p=d.cursor)===null||p===void 0)&&p.timetoken?(v=d.cursor)===null||v===void 0?void 0:v.timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region};return ki.with({channels:d.channels,groups:d.groups,cursor:w},[Zr({category:Ue.PNConnectedCategory})])}),Xi.on($e.type,function(d,u){return Xi.with(r(r({},d),{attempts:d.attempts+1,reason:u.payload}))}),Xi.on(Ke.type,function(d,u){var p;return Nn.with({groups:d.groups,channels:d.channels,cursor:d.cursor,reason:u.payload},[Zr({category:Ue.PNConnectionErrorCategory,error:(p=u.payload)===null||p===void 0?void 0:p.message})])}),Xi.on(Lt.type,function(d){return bi.with({channels:d.channels,groups:d.groups,cursor:d.cursor})}),Xi.on(Vn.type,function(d,u){return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:d.cursor})}),Xi.on(Ln.type,function(d,u){var p,v;return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:((p=u.payload.cursor)===null||p===void 0?void 0:p.region)||((v=d?.cursor)===null||v===void 0?void 0:v.region)||0}})}),Xi.on(fn.type,function(d){return pn.with(void 0)});var ei=new Ii("HANDSHAKING");ei.onEnter(function(d){return nn(d.channels,d.groups)}),ei.onExit(function(){return nn.cancel}),ei.on(Vn.type,function(d,u){return u.payload.channels.length===0&&u.payload.groups.length===0?pn.with(void 0):ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:d.cursor})}),ei.on(O.type,function(d,u){var p,v;return ki.with({channels:d.channels,groups:d.groups,cursor:{timetoken:!((p=d?.cursor)===null||p===void 0)&&p.timetoken?(v=d?.cursor)===null||v===void 0?void 0:v.timetoken:u.payload.timetoken,region:u.payload.region}},[Zr({category:Ue.PNConnectedCategory})])}),ei.on(q.type,function(d,u){return Xi.with({channels:d.channels,groups:d.groups,cursor:d.cursor,attempts:0,reason:u.payload})}),ei.on(Lt.type,function(d){return bi.with({channels:d.channels,groups:d.groups,cursor:d.cursor})}),ei.on(Ln.type,function(d,u){var p;return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:{timetoken:u.payload.cursor.timetoken,region:u.payload.cursor.region||((p=d?.cursor)===null||p===void 0?void 0:p.region)||0}})}),ei.on(fn.type,function(d){return pn.with()});var pn=new Ii("UNSUBSCRIBED");pn.on(Vn.type,function(d,u){return ei.with({channels:u.payload.channels,groups:u.payload.groups})}),pn.on(Ln.type,function(d,u){return ei.with({channels:u.payload.channels,groups:u.payload.groups,cursor:u.payload.cursor})});var Ac=function(){function d(u){var p=this;this.engine=new ps,this.channels=[],this.groups=[],this.dependencies=u,this.dispatcher=new nr(this.engine,u),this._unsubscribeEngine=this.engine.subscribe(function(v){v.type==="invocationDispatched"&&p.dispatcher.dispatch(v.invocation)}),this.engine.start(pn,void 0)}return Object.defineProperty(d.prototype,"_engine",{get:function(){return this.engine},enumerable:!1,configurable:!0}),d.prototype.subscribe=function(u){var p=this,v=u.channels,w=u.channelGroups,T=u.timetoken,P=u.withPresence;this.channels=c(c([],o(this.channels),!1),o(v??[]),!1),this.groups=c(c([],o(this.groups),!1),o(w??[]),!1),P&&(this.channels.map(function(M){return p.channels.push("".concat(M,"-pnpres"))}),this.groups.map(function(M){return p.groups.push("".concat(M,"-pnpres"))})),T?this.engine.transition(Ln(Array.from(new Set(c(c([],o(this.channels),!1),o(v??[]),!1))),Array.from(new Set(c(c([],o(this.groups),!1),o(w??[]),!1))),T)):this.engine.transition(Vn(Array.from(new Set(c(c([],o(this.channels),!1),o(v??[]),!1))),Array.from(new Set(c(c([],o(this.groups),!1),o(w??[]),!1))))),this.dependencies.join&&this.dependencies.join({channels:Array.from(new Set(this.channels.filter(function(M){return!M.endsWith("-pnpres")}))),groups:Array.from(new Set(this.groups.filter(function(M){return!M.endsWith("-pnpres")})))})},d.prototype.unsubscribe=function(u){var p=this,v=u.channels,w=v===void 0?[]:v,T=u.channelGroups,P=T===void 0?[]:T,M=me.removeSingleOccurance(this.channels,c(c([],o(w),!1),o(w.map(function(B){return"".concat(B,"-pnpres")})),!1)),z=me.removeSingleOccurance(this.groups,c(c([],o(P),!1),o(P.map(function(B){return"".concat(B,"-pnpres")})),!1));if(new Set(this.channels).size!==new Set(M).size||new Set(this.groups).size!==new Set(z).size){var G=me.findUniqueCommonElements(this.channels,w),Y=me.findUniqueCommonElements(this.groups,P);this.dependencies.presenceState&&(G?.forEach(function(B){return delete p.dependencies.presenceState[B]}),Y?.forEach(function(B){return delete p.dependencies.presenceState[B]})),this.channels=M,this.groups=z,this.engine.transition(Vn(Array.from(new Set(this.channels.slice(0))),Array.from(new Set(this.groups.slice(0))))),this.dependencies.leave&&this.dependencies.leave({channels:G.slice(0),groups:Y.slice(0)})}},d.prototype.unsubscribeAll=function(){this.channels=[],this.groups=[],this.dependencies.presenceState&&(this.dependencies.presenceState={}),this.engine.transition(Vn(this.channels.slice(0),this.groups.slice(0))),this.dependencies.leaveAll&&this.dependencies.leaveAll()},d.prototype.reconnect=function(u){var p=u.timetoken,v=u.region;this.engine.transition(zn(p,v))},d.prototype.disconnect=function(){this.engine.transition(Lt()),this.dependencies.leaveAll&&this.dependencies.leaveAll()},d.prototype.getSubscribedChannels=function(){return Array.from(new Set(this.channels))},d.prototype.getSubscribedChannelGroups=function(){return Array.from(new Set(this.groups))},d.prototype.dispose=function(){this.disconnect(),this._unsubscribeEngine(),this.dispatcher.dispose()},d}(),Lo=lr("RECONNECT",function(){return{}}),jt=lr("DISCONNECT",function(){return{}}),hr=lr("JOINED",function(d,u){return{channels:d,groups:u}}),vr=lr("LEFT",function(d,u){return{channels:d,groups:u}}),ti=lr("LEFT_ALL",function(){return{}}),xr=lr("HEARTBEAT_SUCCESS",function(d){return{statusCode:d}}),Dr=lr("HEARTBEAT_FAILURE",function(d){return d}),Ra=lr("HEARTBEAT_GIVEUP",function(){return{}}),hn=lr("TIMES_UP",function(){return{}}),No=Rn("HEARTBEAT",function(d,u){return{channels:d,groups:u}}),Ri=Rn("LEAVE",function(d,u){return{channels:d,groups:u}}),Du=Rn("EMIT_STATUS",function(d){return d}),Mo=Dt("WAIT",function(){return{}}),Lu=Dt("DELAYED_HEARTBEAT",function(d){return d}),Uf=function(d){function u(p,v){var w=d.call(this,v)||this;return w.on(No.type,Pr(function(T,P,M){var z=M.heartbeat,G=M.presenceState,Y=M.config;return i(w,void 0,void 0,function(){var B;return a(this,function(he){switch(he.label){case 0:return he.trys.push([0,2,,3]),[4,z(r({channels:T.channels,channelGroups:T.groups},Y.maintainPresenceState&&{state:G}))];case 1:return he.sent(),p.transition(xr(200)),[3,3];case 2:return(B=he.sent())instanceof ke?[2,p.transition(Dr(B))]:[3,3];case 3:return[2]}})})})),w.on(Ri.type,Pr(function(T,P,M){var z=M.leave,G=M.config;return i(w,void 0,void 0,function(){return a(this,function(Y){switch(Y.label){case 0:if(G.suppressLeaveEvents)return[3,4];Y.label=1;case 1:return Y.trys.push([1,3,,4]),[4,z({channels:T.channels,channelGroups:T.groups})];case 2:case 3:return Y.sent(),[3,4];case 4:return[2]}})})})),w.on(Mo.type,Pr(function(T,P,M){var z=M.heartbeatDelay;return i(w,void 0,void 0,function(){return a(this,function(G){switch(G.label){case 0:return P.throwIfAborted(),[4,z()];case 1:return G.sent(),P.throwIfAborted(),[2,p.transition(hn())]}})})})),w.on(Lu.type,Pr(function(T,P,M){var z=M.heartbeat,G=M.retryDelay,Y=M.presenceState,B=M.config;return i(w,void 0,void 0,function(){var he;return a(this,function(se){switch(se.label){case 0:return B.retryConfiguration&&B.retryConfiguration.shouldRetry(T.reason,T.attempts)?(P.throwIfAborted(),[4,G(B.retryConfiguration.getDelay(T.attempts,T.reason))]):[3,6];case 1:se.sent(),P.throwIfAborted(),se.label=2;case 2:return se.trys.push([2,4,,5]),[4,z(r({channels:T.channels,channelGroups:T.groups},B.maintainPresenceState&&{state:Y}))];case 3:return se.sent(),[2,p.transition(xr(200))];case 4:return(he=se.sent())instanceof Error&&he.message==="Aborted"?[2]:he instanceof ke?[2,p.transition(Dr(he))]:[3,5];case 5:return[3,7];case 6:return[2,p.transition(Ra())];case 7:return[2]}})})})),w.on(Du.type,Pr(function(T,P,M){var z=M.emitStatus,G=M.config;return i(w,void 0,void 0,function(){var Y;return a(this,function(B){return G.announceFailedHeartbeats&&((Y=T?.status)===null||Y===void 0?void 0:Y.error)===!0?z(T.status):G.announceSuccessfulHeartbeats&&T.statusCode===200&&z(r(r({},T),{operation:Q.PNHeartbeatOperation,error:!1})),[2]})})})),w}return e(u,d),u}(Xa),hs=new Ii("HEARTBEAT_STOPPED");hs.on(hr.type,function(d,u){return hs.with({channels:c(c([],o(d.channels),!1),o(u.payload.channels),!1),groups:c(c([],o(d.groups),!1),o(u.payload.groups),!1)})}),hs.on(vr.type,function(d,u){return hs.with({channels:d.channels.filter(function(p){return!u.payload.channels.includes(p)}),groups:d.groups.filter(function(p){return!u.payload.groups.includes(p)})})}),hs.on(Lo.type,function(d,u){return Yi.with({channels:d.channels,groups:d.groups})}),hs.on(ti.type,function(d,u){return $o.with(void 0)});var Da=new Ii("HEARTBEAT_COOLDOWN");Da.onEnter(function(){return Mo()}),Da.onExit(function(){return Mo.cancel}),Da.on(hn.type,function(d,u){return Yi.with({channels:d.channels,groups:d.groups})}),Da.on(hr.type,function(d,u){return Yi.with({channels:c(c([],o(d.channels),!1),o(u.payload.channels),!1),groups:c(c([],o(d.groups),!1),o(u.payload.groups),!1)})}),Da.on(vr.type,function(d,u){return Yi.with({channels:d.channels.filter(function(p){return!u.payload.channels.includes(p)}),groups:d.groups.filter(function(p){return!u.payload.groups.includes(p)})},[Ri(u.payload.channels,u.payload.groups)])}),Da.on(jt.type,function(d){return hs.with({channels:d.channels,groups:d.groups},[Ri(d.channels,d.groups)])}),Da.on(ti.type,function(d,u){return $o.with(void 0,[Ri(d.channels,d.groups)])});var Nu=new Ii("HEARTBEAT_FAILED");Nu.on(hr.type,function(d,u){return Yi.with({channels:c(c([],o(d.channels),!1),o(u.payload.channels),!1),groups:c(c([],o(d.groups),!1),o(u.payload.groups),!1)})}),Nu.on(vr.type,function(d,u){return Yi.with({channels:d.channels.filter(function(p){return!u.payload.channels.includes(p)}),groups:d.groups.filter(function(p){return!u.payload.groups.includes(p)})},[Ri(u.payload.channels,u.payload.groups)])}),Nu.on(Lo.type,function(d,u){return Yi.with({channels:d.channels,groups:d.groups})}),Nu.on(jt.type,function(d,u){return hs.with({channels:d.channels,groups:d.groups},[Ri(d.channels,d.groups)])}),Nu.on(ti.type,function(d,u){return $o.with(void 0,[Ri(d.channels,d.groups)])});var gn=new Ii("HEARBEAT_RECONNECTING");gn.onEnter(function(d){return Lu(d)}),gn.onExit(function(){return Lu.cancel}),gn.on(hr.type,function(d,u){return Yi.with({channels:c(c([],o(d.channels),!1),o(u.payload.channels),!1),groups:c(c([],o(d.groups),!1),o(u.payload.groups),!1)})}),gn.on(vr.type,function(d,u){return Yi.with({channels:d.channels.filter(function(p){return!u.payload.channels.includes(p)}),groups:d.groups.filter(function(p){return!u.payload.groups.includes(p)})},[Ri(u.payload.channels,u.payload.groups)])}),gn.on(jt.type,function(d,u){hs.with({channels:d.channels,groups:d.groups},[Ri(d.channels,d.groups)])}),gn.on(xr.type,function(d,u){return Da.with({channels:d.channels,groups:d.groups})}),gn.on(Dr.type,function(d,u){return gn.with(r(r({},d),{attempts:d.attempts+1,reason:u.payload}))}),gn.on(Ra.type,function(d,u){return Nu.with({channels:d.channels,groups:d.groups})}),gn.on(ti.type,function(d,u){return $o.with(void 0,[Ri(d.channels,d.groups)])});var Yi=new Ii("HEARTBEATING");Yi.onEnter(function(d){return No(d.channels,d.groups)}),Yi.on(xr.type,function(d,u){return Da.with({channels:d.channels,groups:d.groups})}),Yi.on(hr.type,function(d,u){return Yi.with({channels:c(c([],o(d.channels),!1),o(u.payload.channels),!1),groups:c(c([],o(d.groups),!1),o(u.payload.groups),!1)})}),Yi.on(vr.type,function(d,u){return Yi.with({channels:d.channels.filter(function(p){return!u.payload.channels.includes(p)}),groups:d.groups.filter(function(p){return!u.payload.groups.includes(p)})},[Ri(u.payload.channels,u.payload.groups)])}),Yi.on(Dr.type,function(d,u){return gn.with(r(r({},d),{attempts:0,reason:u.payload}))}),Yi.on(jt.type,function(d){return hs.with({channels:d.channels,groups:d.groups},[Ri(d.channels,d.groups)])}),Yi.on(ti.type,function(d,u){return $o.with(void 0,[Ri(d.channels,d.groups)])});var $o=new Ii("HEARTBEAT_INACTIVE");$o.on(hr.type,function(d,u){return Yi.with({channels:u.payload.channels,groups:u.payload.groups})});var ri=function(){function d(u){var p=this;this.engine=new ps,this.channels=[],this.groups=[],this.dispatcher=new Uf(this.engine,u),this.dependencies=u,this._unsubscribeEngine=this.engine.subscribe(function(v){v.type==="invocationDispatched"&&p.dispatcher.dispatch(v.invocation)}),this.engine.start($o,void 0)}return Object.defineProperty(d.prototype,"_engine",{get:function(){return this.engine},enumerable:!1,configurable:!0}),d.prototype.join=function(u){var p=u.channels,v=u.groups;this.channels=c(c([],o(this.channels),!1),o(p??[]),!1),this.groups=c(c([],o(this.groups),!1),o(v??[]),!1),this.engine.transition(hr(this.channels.slice(0),this.groups.slice(0)))},d.prototype.leave=function(u){var p=this,v=u.channels,w=u.groups;this.dependencies.presenceState&&(v?.forEach(function(T){return delete p.dependencies.presenceState[T]}),w?.forEach(function(T){return delete p.dependencies.presenceState[T]})),this.engine.transition(vr(v??[],w??[]))},d.prototype.leaveAll=function(){this.engine.transition(ti())},d.prototype.dispose=function(){this._unsubscribeEngine(),this.dispatcher.dispose()},d}(),Ig=function(){function d(){}return d.LinearRetryPolicy=function(u){return{delay:u.delay,maximumRetry:u.maximumRetry,shouldRetry:function(p,v){var w;return((w=p?.status)===null||w===void 0?void 0:w.statusCode)!==403&&this.maximumRetry>v},getDelay:function(p,v){var w;return 1e3*(((w=v.retryAfter)!==null&&w!==void 0?w:this.delay)+Math.random())},getGiveupReason:function(p,v){var w;return this.maximumRetry<=v?"retry attempts exhaused.":((w=p?.status)===null||w===void 0?void 0:w.statusCode)===403?"forbidden operation.":"unknown error"}}},d.ExponentialRetryPolicy=function(u){return{minimumDelay:u.minimumDelay,maximumDelay:u.maximumDelay,maximumRetry:u.maximumRetry,shouldRetry:function(p,v){var w;return((w=p?.status)===null||w===void 0?void 0:w.statusCode)!==403&&this.maximumRetry>v},getDelay:function(p,v){var w;return 1e3*(((w=v.retryAfter)!==null&&w!==void 0?w:Math.min(Math.pow(2,p),this.maximumDelay))+Math.random())},getGiveupReason:function(p,v){var w;return this.maximumRetry<=v?"retry attempts exhaused.":((w=p?.status)===null||w===void 0?void 0:w.statusCode)===403?"forbidden operation.":"unknown error"}}},d}(),s0=function(){function d(u){var p=u.modules,v=u.listenerManager,w=u.getFileUrl;this.modules=p,this.listenerManager=v,this.getFileUrl=w,this._channelListenerMap=new Map,this._groupListenerMap=new Map,p.cryptoModule&&(this._decoder=new TextDecoder)}return d.prototype.emitEvent=function(u){var p=u.channel,v=u.publishMetaData,w=u.subscriptionMatch;if(p===w&&(w=null),u.channel.endsWith("-pnpres")){var T={channel:null,subscription:null};p&&(T.channel=p.substring(0,p.lastIndexOf("-pnpres"))),w&&(T.subscription=w.substring(0,w.lastIndexOf("-pnpres"))),T.action=u.payload.action,T.state=u.payload.data,T.timetoken=v.timetoken,T.occupancy=u.payload.occupancy,T.uuid=u.payload.uuid,T.timestamp=u.payload.timestamp,u.payload.join&&(T.join=u.payload.join),u.payload.leave&&(T.leave=u.payload.leave),u.payload.timeout&&(T.timeout=u.payload.timeout),T.actualChannel=w!=null?p:null,T.subscribedChannel=w??p,this.listenerManager.announcePresence(T),this._announce("presence",T,T.channel,T.subscription)}else if(u.messageType===1)(T={channel:null,subscription:null}).channel=p,T.subscription=w,T.timetoken=v.timetoken,T.publisher=u.issuingClientId,u.userMetadata&&(T.userMetadata=u.userMetadata),T.message=u.payload,this.listenerManager.announceSignal(T),this._announce("signal",T,T.channel,T.subscription);else if(u.messageType===2){if((T={channel:null,subscription:null}).channel=p,T.subscription=w,T.timetoken=v.timetoken,T.publisher=u.issuingClientId,u.userMetadata&&(T.userMetadata=u.userMetadata),T.message={event:u.payload.event,type:u.payload.type,data:u.payload.data},this.listenerManager.announceObjects(T),this._announce("objects",T,T.channel,T.subscription),u.payload.type==="uuid"){var P=this._renameChannelField(T),M=r(r({},P),{message:r(r({},P.message),{event:this._renameEvent(P.message.event),type:"user"})});this.listenerManager.announceUser(M),this._announce("user",M,T.channel,T.subscription)}else if(u.payload.type==="channel"){P=this._renameChannelField(T);var z=r(r({},P),{message:r(r({},P.message),{event:this._renameEvent(P.message.event),type:"space"})});this.listenerManager.announceSpace(z),this._announce("space",z,T.channel,T.subscription)}else if(u.payload.type==="membership"){var G=(P=this._renameChannelField(T)).message.data,Y=G.uuid,B=G.channel,he=n(G,["uuid","channel"]);he.user=Y,he.space=B;var se=r(r({},P),{message:r(r({},P.message),{event:this._renameEvent(P.message.event),data:he})});this.listenerManager.announceMembership(se),this._announce("membership",se,T.channel,T.subscription)}}else if(u.messageType===3)(T={}).channel=p,T.subscription=w,T.timetoken=v.timetoken,T.publisher=u.issuingClientId,T.data={messageTimetoken:u.payload.data.messageTimetoken,actionTimetoken:u.payload.data.actionTimetoken,type:u.payload.data.type,uuid:u.issuingClientId,value:u.payload.data.value},T.event=u.payload.event,this.listenerManager.announceMessageAction(T),this._announce("messageAction",T,T.channel,T.subscription);else if(u.messageType===4){(T={}).channel=p,T.subscription=w,T.timetoken=v.timetoken,T.publisher=u.issuingClientId;var ne=u.payload;if(this.modules.cryptoModule){var oe=void 0;try{oe=(ue=this.modules.cryptoModule.decrypt(u.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(ue)):ue}catch(Ce){oe=null,T.error="Error while decrypting message content: ".concat(Ce.message)}oe!==null&&(ne=oe)}u.userMetadata&&(T.userMetadata=u.userMetadata),T.message=ne.message,T.file={id:ne.file.id,name:ne.file.name,url:this.getFileUrl({id:ne.file.id,name:ne.file.name,channel:p})},this.listenerManager.announceFile(T),this._announce("file",T,T.channel,T.subscription)}else{if((T={channel:null,subscription:null}).channel=p,T.subscription=w,T.timetoken=v.timetoken,T.publisher=u.issuingClientId,u.userMetadata&&(T.userMetadata=u.userMetadata),this.modules.cryptoModule){oe=void 0;try{var ue;oe=(ue=this.modules.cryptoModule.decrypt(u.payload))instanceof ArrayBuffer?JSON.parse(this._decoder.decode(ue)):ue}catch(Ce){oe=null,T.error="Error while decrypting message content: ".concat(Ce.message)}T.message=oe??u.payload}else T.message=u.payload;T.actualChannel=w!=null?p:null,T.subscribedChannel=w??p,this.listenerManager.announceMessage(T),this._announce("message",T,T.channel,T.subscription)}},d.prototype.addListener=function(u,p,v){var w=this;p&&v?(p?.forEach(function(T){w._channelListenerMap[T]?w._channelListenerMap[T].includes(u)||w._channelListenerMap[T].push(u):w._channelListenerMap[T]=[u]}),v?.forEach(function(T){w._groupListenerMap[T]?w._groupListenerMap[T].includes(u)||w._groupListenerMap[T].push(u):w._groupListenerMap[T]=[u]})):this.listenerManager.addListener(u)},d.prototype.removeListener=function(u,p,v){var w=this;p&&v?(p?.forEach(function(T){var P;w._channelListenerMap[T]=(P=w._channelListenerMap[T])===null||P===void 0?void 0:P.filter(function(M){return M!==u})}),v?.forEach(function(T){var P;w._groupListenerMap[T]=(P=w._groupListenerMap[T])===null||P===void 0?void 0:P.filter(function(M){return M!==u})})):this.listenerManager.removeListener(u)},d.prototype.removeAllListeners=function(){this.listenerManager.removeAllListeners()},d.prototype._renameEvent=function(u){return u==="set"?"updated":"removed"},d.prototype._renameChannelField=function(u){var p=u.channel,v=n(u,["channel"]);return v.spaceId=p,v},d.prototype._announce=function(u,p,v,w){var T,P;(T=this._channelListenerMap[v])===null||T===void 0||T.forEach(function(M){return M[u]&&M[u](p)}),(P=this._groupListenerMap[w])===null||P===void 0||P.forEach(function(M){return M[u]&&M[u](p)})},d}(),kg=function(){function d(){}return d.prototype.subscribe=function(){var u,p;this.pubnub.subscribe(r({channels:this.channelNames,channelGroups:this.groupNames},((p=(u=this.options)===null||u===void 0?void 0:u.cursor)===null||p===void 0?void 0:p.timetoken)&&{timetoken:this.options.cursor.timetoken}))},d.prototype.unsubscribe=function(){this.pubnub.unsubscribe({channels:this.channelNames.filter(function(u){return!u.endsWith("-pnpres")}),channelGroups:this.groupNames.filter(function(u){return!u.endsWith("-pnpres")})})},Object.defineProperty(d.prototype,"onMessage",{set:function(u){this.listener.message=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onPresence",{set:function(u){this.listener.presence=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onSignal",{set:function(u){this.listener.signal=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onObjects",{set:function(u){this.listener.objects=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onMessageAction",{set:function(u){this.listener.messageAction=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onFile",{set:function(u){this.listener.file=u},enumerable:!1,configurable:!0}),d.prototype.addListener=function(u){this.eventEmitter.addListener(u,this.channelNames.filter(function(p){return!p.endsWith("-pnpres")}),this.groupNames.filter(function(p){return!p.endsWith("-pnpres")}))},d.prototype.removeListener=function(u){this.eventEmitter.removeListener(u,this.channelNames,this.groupNames)},Object.defineProperty(d.prototype,"channels",{get:function(){return this.channelNames.slice(0)},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"channelGroups",{get:function(){return this.groupNames.slice(0)},enumerable:!1,configurable:!0}),d}(),Ff=function(d){function u(p){var v=p.channels,w=v===void 0?[]:v,T=p.channelGroups,P=T===void 0?[]:T,M=p.subscriptionOptions,z=p.eventEmitter,G=p.pubnub,Y=d.call(this)||this;return Y.channelNames=[],Y.groupNames=[],Y.subscriptionList=[],Y.options=M,Y.eventEmitter=z,Y.pubnub=G,w.filter(function(B){return!B.endsWith("-pnpres")}).forEach(function(B){var he=Y.pubnub.channel(B).subscription(Y.options);Y.channelNames=c(c([],o(Y.channelNames),!1),o(he.channels),!1),Y.subscriptionList.push(he)}),P.filter(function(B){return!B.endsWith("-pnpres")}).forEach(function(B){var he=Y.pubnub.channelGroup(B).subscription(Y.options);Y.groupNames=c(c([],o(Y.groupNames),!1),o(he.channelGroups),!1),Y.subscriptionList.push(he)}),Y.listener={},z.addListener(Y.listener,Y.channelNames.filter(function(B){return!B.endsWith("-pnpres")}),Y.groupNames.filter(function(B){return!B.endsWith("-pnpres")})),Y}return e(u,d),u.prototype.addSubscription=function(p){this.subscriptionList.push(p),this.channelNames=c(c([],o(this.channelNames),!1),o(p.channels),!1),this.groupNames=c(c([],o(this.groupNames),!1),o(p.channelGroups),!1),this.eventEmitter.addListener(this.listener,p.channels,p.channelGroups)},u.prototype.removeSubscription=function(p){var v=p.channels,w=p.channelGroups;this.channelNames=this.channelNames.filter(function(T){return!v.includes(T)}),this.groupNames=this.groupNames.filter(function(T){return!w.includes(T)}),this.subscriptionList=this.subscriptionList.filter(function(T){return T!==p}),this.eventEmitter.removeListener(this.listener,v,w)},u.prototype.addSubscriptionSet=function(p){this.subscriptionList=c(c([],o(this.subscriptionList),!1),o(p.subscriptions),!1),this.channelNames=c(c([],o(this.channelNames),!1),o(p.channels),!1),this.groupNames=c(c([],o(this.groupNames),!1),o(p.channelGroups),!1),this.eventEmitter.addListener(this.listener,p.channels,p.channelGroups)},u.prototype.removeSubscriptionSet=function(p){var v=p.channels,w=p.channelGroups;this.channelNames=this.channelNames.filter(function(T){return!v.includes(T)}),this.groupNames=this.groupNames.filter(function(T){return!w.includes(T)}),this.subscriptionList=this.subscriptionList.filter(function(T){return!p.subscriptions.includes(T)}),this.eventEmitter.removeListener(this.listener,v,w)},Object.defineProperty(u.prototype,"subscriptions",{get:function(){return this.subscriptionList.slice(0)},enumerable:!1,configurable:!0}),u}(kg),Ml=function(d){function u(p){var v=p.channels,w=p.channelGroups,T=p.subscriptionOptions,P=p.eventEmitter,M=p.pubnub,z=d.call(this)||this;return z.channelNames=[],z.groupNames=[],z.channelNames=v,z.groupNames=w,z.options=T,z.pubnub=M,z.eventEmitter=P,z.listener={},P.addListener(z.listener,z.channelNames.filter(function(G){return!G.endsWith("-pnpres")}),z.groupNames.filter(function(G){return!G.endsWith("-pnpres")})),z}return e(u,d),u.prototype.addSubscription=function(p){return new Ff({channels:c(c([],o(this.channelNames),!1),o(p.channels),!1),channelGroups:c(c([],o(this.groupNames),!1),o(p.channelGroups),!1),subscriptionOptions:r(r({},this.options),p?.options),eventEmitter:this.eventEmitter,pubnub:this.pubnub})},u}(kg),Og=function(){function d(u,p,v){this.name=u,this.eventEmitter=p,this.pubnub=v}return d.prototype.subscription=function(u){return new Ml({channels:u?.receivePresenceEvents?[this.name,"".concat(this.name,"-pnpres")]:[this.name],channelGroups:[],subscriptionOptions:u,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},d}(),o0=function(){function d(u,p,v){this.name=u,this.eventEmitter=p,this.pubnub=v}return d.prototype.subscription=function(u){return new Ml({channels:[],channelGroups:u?.receivePresenceEvents?[this.name,"".concat(this.name,"-pnpres")]:[this.name],subscriptionOptions:u,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},d}(),Pg=function(){function d(u,p,v){this.id=u,this.eventEmitter=p,this.pubnub=v}return d.prototype.subscription=function(u){return new Ml({channels:[this.id],channelGroups:[],subscriptionOptions:u,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},d}(),u0=function(){function d(u,p,v){this.id=u,this.eventEmitter=p,this.pubnub=v}return d.prototype.subscription=function(u){return new Ml({channels:[this.id],channelGroups:[],subscriptionOptions:u,eventEmitter:this.eventEmitter,pubnub:this.pubnub})},d}(),Rg=function(){function d(u){var p=this,v=u.networking,w=u.cbor,T=new I({setup:u});this._config=T;var P=new Re({config:T}),M=u.cryptography;v.init(T);var z=new Zt(T,w);this._tokenManager=z;var G=new Fe({maximumSamplesCount:6e4});this._telemetryManager=G;var Y=this._config.cryptoModule,B={config:T,networking:v,crypto:P,cryptography:M,tokenManager:z,telemetryManager:G,PubNubFile:u.PubNubFile,cryptoModule:Y};this.File=u.PubNubFile,this.encryptFile=function(ge,Be){return arguments.length==1&&typeof ge!="string"&&B.cryptoModule?(Be=ge,B.cryptoModule.encryptFile(Be,this.File)):M.encryptFile(ge,Be,this.File)},this.decryptFile=function(ge,Be){return arguments.length==1&&typeof ge!="string"&&B.cryptoModule?(Be=ge,B.cryptoModule.decryptFile(Be,this.File)):M.decryptFile(ge,Be,this.File)};var he=He.bind(this,B,Ka),se=He.bind(this,B,re),ne=He.bind(this,B,be),oe=He.bind(this,B,dt),ue=He.bind(this,B,ro),Ce=new St;if(this._listenerManager=Ce,this.iAmHere=He.bind(this,B,be),this.iAmAway=He.bind(this,B,re),this.setPresenceState=He.bind(this,B,dt),this.handshake=He.bind(this,B,wn),this.receiveMessages=He.bind(this,B,Wr),this._eventEmitter=new s0({modules:B,listenerManager:this._listenerManager,getFileUrl:function(ge){return Ie(B,ge)}}),T.enableEventEngine===!0){if(T.maintainPresenceState&&(this.presenceState={},this.setState=function(ge){var Be,Pe;return(Be=ge.channels)===null||Be===void 0||Be.forEach(function(et){return p.presenceState[et]=ge.state}),(Pe=ge.channelGroups)===null||Pe===void 0||Pe.forEach(function(et){return p.presenceState[et]=ge.state}),p.setPresenceState({channels:ge.channels,channelGroups:ge.channelGroups,state:p.presenceState})}),T.getHeartbeatInterval()){var Xe=new ri({heartbeat:this.iAmHere,leave:this.iAmAway,heartbeatDelay:function(){return new Promise(function(ge){return setTimeout(ge,1e3*B.config.getHeartbeatInterval())})},retryDelay:function(ge){return new Promise(function(Be){return setTimeout(Be,ge)})},config:B.config,presenceState:this.presenceState,emitStatus:function(ge){Ce.announceStatus(ge)}});this.presenceEventEngine=Xe,this.join=this.presenceEventEngine.join.bind(Xe),this.leave=this.presenceEventEngine.leave.bind(Xe),this.leaveAll=this.presenceEventEngine.leaveAll.bind(Xe)}var it=new Ac({handshake:this.handshake,receiveMessages:this.receiveMessages,delay:function(ge){return new Promise(function(Be){return setTimeout(Be,ge)})},join:this.join,leave:this.leave,leaveAll:this.leaveAll,presenceState:this.presenceState,config:B.config,emitMessages:function(ge){var Be,Pe;try{for(var et=s(ge),Me=et.next();!Me.done;Me=et.next()){var qe=Me.value;p._eventEmitter.emitEvent(qe)}}catch(ve){Be={error:ve}}finally{try{Me&&!Me.done&&(Pe=et.return)&&Pe.call(et)}finally{if(Be)throw Be.error}}},emitStatus:function(ge){Ce.announceStatus(ge)}});this.subscribe=it.subscribe.bind(it),this.unsubscribe=it.unsubscribe.bind(it),this.unsubscribeAll=it.unsubscribeAll.bind(it),this.reconnect=it.reconnect.bind(it),this.disconnect=it.disconnect.bind(it),this.destroy=it.dispose.bind(it),this.getSubscribedChannels=it.getSubscribedChannels.bind(it),this.getSubscribedChannelGroups=it.getSubscribedChannelGroups.bind(it),this.eventEngine=it}else{var ut=new de({timeEndpoint:he,leaveEndpoint:se,heartbeatEndpoint:ne,setStateEndpoint:oe,subscribeEndpoint:ue,crypto:B.crypto,config:B.config,listenerManager:Ce,getFileUrl:function(ge){return Ie(B,ge)},cryptoModule:B.cryptoModule,eventEmitter:this._eventEmitter});this.subscribe=ut.adaptSubscribeChange.bind(ut),this.unsubscribe=ut.adaptUnsubscribeChange.bind(ut),this.disconnect=ut.disconnect.bind(ut),this.reconnect=ut.reconnect.bind(ut),this.unsubscribeAll=ut.unsubscribeAll.bind(ut),this.getSubscribedChannels=ut.getSubscribedChannels.bind(ut),this.getSubscribedChannelGroups=ut.getSubscribedChannelGroups.bind(ut),this.setState=ut.adaptStateChange.bind(ut),this.presence=ut.adaptPresenceChange.bind(ut),this.destroy=function(ge){ut.unsubscribeAll(ge),ut.disconnect()}}this.addListener=this._eventEmitter.addListener.bind(this._eventEmitter),this.removeListener=this._eventEmitter.removeListener.bind(this._eventEmitter),this.removeAllListeners=this._eventEmitter.removeAllListeners.bind(this._eventEmitter),this.parseToken=z.parseToken.bind(z),this.setToken=z.setToken.bind(z),this.getToken=z.getToken.bind(z),this.channelGroups={listGroups:He.bind(this,B,Ve),listChannels:He.bind(this,B,Ae),addChannels:He.bind(this,B,zt),removeChannels:He.bind(this,B,Ge),deleteGroup:He.bind(this,B,at)},this.push={addChannels:He.bind(this,B,lt),removeChannels:He.bind(this,B,Bt),deleteDevice:He.bind(this,B,_t),listChannels:He.bind(this,B,ct)},this.hereNow=He.bind(this,B,K),this.whereNow=He.bind(this,B,te),this.getState=He.bind(this,B,De),this.grant=He.bind(this,B,tr),this.grantToken=He.bind(this,B,Er),this.audit=He.bind(this,B,Ai),this.revokeToken=He.bind(this,B,ln),this.publish=He.bind(this,B,dn),this.fire=function(ge,Be){return ge.replicate=!1,ge.storeInHistory=!1,p.publish(ge,Be)},this.signal=He.bind(this,B,pa),this.history=He.bind(this,B,gr),this.deleteMessages=He.bind(this,B,mi),this.messageCounts=He.bind(this,B,vi),this.fetchMessages=He.bind(this,B,ha),this.addMessageAction=He.bind(this,B,le),this.removeMessageAction=He.bind(this,B,U),this.getMessageActions=He.bind(this,B,Ne),this.listFiles=He.bind(this,B,Ye);var rt=He.bind(this,B,ft);this.publishFile=He.bind(this,B,kt),this.sendFile=Et({generateUploadUrl:rt,publishFile:this.publishFile,modules:B}),this.getFileUrl=function(ge){return Ie(B,ge)},this.downloadFile=He.bind(this,B,Jt),this.deleteFile=He.bind(this,B,Nt),this.channel=function(ge){return new Og(ge,p._eventEmitter,p)},this.channelGroup=function(ge){return new o0(ge,p._eventEmitter,p)},this.channelMetadata=function(ge){return new Pg(ge,p._eventEmitter,p)},this.userMetadata=function(ge){return new u0(ge,p._eventEmitter,p)},this.subscriptionSet=function(ge){return new Ff({channels:ge.channels,channelGroups:ge.channelGroups,subscriptionOptions:ge.subscriptionOptions,eventEmitter:p._eventEmitter,pubnub:p})},this.objects={getAllUUIDMetadata:He.bind(this,B,Ot),getUUIDMetadata:He.bind(this,B,qr),setUUIDMetadata:He.bind(this,B,er),removeUUIDMetadata:He.bind(this,B,hi),getAllChannelMetadata:He.bind(this,B,mr),getChannelMetadata:He.bind(this,B,zr),setChannelMetadata:He.bind(this,B,Pi),removeChannelMetadata:He.bind(this,B,jr),getChannelMembers:He.bind(this,B,rn),setChannelMembers:function(ge){for(var Be=[],Pe=1;Pe<arguments.length;Pe++)Be[Pe-1]=arguments[Pe];return He.call.apply(He,c([p,B,Yr,r({type:"set"},ge)],o(Be),!1))},removeChannelMembers:function(ge){for(var Be=[],Pe=1;Pe<arguments.length;Pe++)Be[Pe-1]=arguments[Pe];return He.call.apply(He,c([p,B,Yr,r({type:"delete"},ge)],o(Be),!1))},getMemberships:He.bind(this,B,qt),setMemberships:function(ge){for(var Be=[],Pe=1;Pe<arguments.length;Pe++)Be[Pe-1]=arguments[Pe];return He.call.apply(He,c([p,B,gi,r({type:"set"},ge)],o(Be),!1))},removeMemberships:function(ge){for(var Be=[],Pe=1;Pe<arguments.length;Pe++)Be[Pe-1]=arguments[Pe];return He.call.apply(He,c([p,B,gi,r({type:"delete"},ge)],o(Be),!1))}},this.createUser=function(ge){return p.objects.setUUIDMetadata({uuid:ge.userId,data:ge.data,include:ge.include})},this.updateUser=this.createUser,this.removeUser=function(ge){return p.objects.removeUUIDMetadata({uuid:ge?.userId})},this.fetchUser=function(ge){return p.objects.getUUIDMetadata({uuid:ge?.userId,include:ge?.include})},this.fetchUsers=this.objects.getAllUUIDMetadata,this.createSpace=function(ge){return p.objects.setChannelMetadata({channel:ge.spaceId,data:ge.data,include:ge.include})},this.updateSpace=this.createSpace,this.removeSpace=function(ge){return p.objects.removeChannelMetadata({channel:ge.spaceId})},this.fetchSpace=function(ge){return p.objects.getChannelMetadata({channel:ge.spaceId,include:ge.include})},this.fetchSpaces=this.objects.getAllChannelMetadata,this.addMemberships=function(ge){var Be,Pe;return typeof ge.spaceId=="string"?p.objects.setChannelMembers({channel:ge.spaceId,uuids:(Be=ge.users)===null||Be===void 0?void 0:Be.map(function(et){return typeof et=="string"?et:{id:et.userId,custom:et.custom,status:et.status}}),limit:0}):p.objects.setMemberships({uuid:ge.userId,channels:(Pe=ge.spaces)===null||Pe===void 0?void 0:Pe.map(function(et){return typeof et=="string"?et:{id:et.spaceId,custom:et.custom,status:et.status}}),limit:0})},this.updateMemberships=this.addMemberships,this.removeMemberships=function(ge){return typeof ge.spaceId=="string"?p.objects.removeChannelMembers({channel:ge.spaceId,uuids:ge.userIds,limit:0}):p.objects.removeMemberships({uuid:ge.userId,channels:ge.spaceIds,limit:0})},this.fetchMemberships=function(ge){return typeof ge.spaceId=="string"?p.objects.getChannelMembers({channel:ge.spaceId,filter:ge.filter,limit:ge.limit,page:ge.page,include:{customFields:ge.include.customFields,UUIDFields:ge.include.userFields,customUUIDFields:ge.include.customUserFields,statusField:ge.include.statusField,UUIDStatusField:ge.include.userStatusField,UUIDTypeField:ge.include.userTypeField,totalCount:ge.include.totalCount},sort:ge.sort!=null?Object.fromEntries(Object.entries(ge.sort).map(function(Be){var Pe=o(Be,2),et=Pe[0],Me=Pe[1];return[et.replace("user","uuid"),Me]})):null}).then(function(Be){var Pe;return Be.data=(Pe=Be.data)===null||Pe===void 0?void 0:Pe.map(function(et){return{user:et.uuid,custom:et.custom,updated:et.updated,eTag:et.eTag}}),Be}):p.objects.getMemberships({uuid:ge.userId,filter:ge.filter,limit:ge.limit,page:ge.page,include:{customFields:ge.include.customFields,channelFields:ge.include.spaceFields,customChannelFields:ge.include.customSpaceFields,statusField:ge.include.statusField,channelStatusField:ge.include.spaceStatusField,channelTypeField:ge.include.spaceTypeField,totalCount:ge.include.totalCount},sort:ge.sort!=null?Object.fromEntries(Object.entries(ge.sort).map(function(Be){var Pe=o(Be,2),et=Pe[0],Me=Pe[1];return[et.replace("space","channel"),Me]})):null}).then(function(Be){var Pe;return Be.data=(Pe=Be.data)===null||Pe===void 0?void 0:Pe.map(function(et){return{space:et.channel,custom:et.custom,updated:et.updated,eTag:et.eTag}}),Be})},this.time=he,this.stop=this.destroy,this.encrypt=function(ge,Be){if(Be===void 0&&B.cryptoModule){var Pe=B.cryptoModule.encrypt(ge);return typeof Pe=="string"?Pe:J(Pe)}return P.encrypt(ge,Be)},this.decrypt=function(ge,Be){if(Be===void 0&&Y){var Pe=B.cryptoModule.decrypt(ge);return Pe instanceof ArrayBuffer?JSON.parse(new TextDecoder().decode(Pe)):Pe}return P.decrypt(ge,Be)},this.getAuthKey=B.config.getAuthKey.bind(B.config),this.setAuthKey=B.config.setAuthKey.bind(B.config),this.getUUID=B.config.getUUID.bind(B.config),this.setUUID=B.config.setUUID.bind(B.config),this.getUserId=B.config.getUserId.bind(B.config),this.setUserId=B.config.setUserId.bind(B.config),this.getFilterExpression=B.config.getFilterExpression.bind(B.config),this.setFilterExpression=B.config.setFilterExpression.bind(B.config),this.setCipherKey=function(ge){return B.config.setCipherKey(ge,u,B)},this.setHeartbeatInterval=B.config.setHeartbeatInterval.bind(B.config),v.hasModule("proxy")&&(this.setProxy=function(ge){B.config.setProxy(ge),p.reconnect()})}return d.prototype.getVersion=function(){return this._config.getVersion()},d.prototype._addPnsdkSuffix=function(u,p){this._config._addPnsdkSuffix(u,p)},d.prototype.networkDownDetected=function(){this._listenerManager.announceNetworkDown(),this._config.restore?this.disconnect():this.destroy(!0)},d.prototype.networkUpDetected=function(){this._listenerManager.announceNetworkUp(),this.reconnect()},d.notificationPayload=function(u,p){return new It(u,p)},d.generateUUID=function(){return k()},d.OPERATIONS=Q,d.CATEGORIES=Ue,d.LinearRetryPolicy=Ig.LinearRetryPolicy,d.ExponentialRetryPolicy=Ig.ExponentialRetryPolicy,d}(),Dg=function(){function d(u){var p=this;this._modules={},Object.keys(u).forEach(function(v){p._modules[v]=u[v].bind(p)})}return d.prototype.init=function(u){this._config=u,Array.isArray(this._config.origin)?this._currentSubDomain=Math.floor(Math.random()*this._config.origin.length):this._currentSubDomain=0,this._coreParams={},this.shiftStandardOrigin()},d.prototype.nextOrigin=function(){var u=this._config.secure?"https://":"http://";if(typeof this._config.origin=="string")return"".concat(u).concat(this._config.origin);this._currentSubDomain+=1,this._currentSubDomain>=this._config.origin.length&&(this._currentSubDomain=0);var p=this._config.origin[this._currentSubDomain];return"".concat(u).concat(p)},d.prototype.hasModule=function(u){return u in this._modules},d.prototype.shiftStandardOrigin=function(){return this._standardOrigin=this.nextOrigin(),this._standardOrigin},d.prototype.getStandardOrigin=function(){return this._standardOrigin},d.prototype.POSTFILE=function(u,p,v){return this._modules.postfile(u,p,v)},d.prototype.GETFILE=function(u,p,v){return this._modules.getfile(u,p,v)},d.prototype.POST=function(u,p,v,w){return this._modules.post(u,p,v,w)},d.prototype.PATCH=function(u,p,v,w){return this._modules.patch(u,p,v,w)},d.prototype.GET=function(u,p,v){return this._modules.get(u,p,v)},d.prototype.DELETE=function(u,p,v){return this._modules.del(u,p,v)},d.prototype._detectErrorCategory=function(u){if(u.code==="ENOTFOUND"||u.code==="ECONNREFUSED"||u.code==="ECONNRESET"||u.code==="EAI_AGAIN"||u.status===0||u.hasOwnProperty("status")&&u.status===void 0)return Ue.PNNetworkIssuesCategory;if(u.timeout)return Ue.PNTimeoutCategory;if(u.code==="ETIMEDOUT")return Ue.PNNetworkIssuesCategory;if(u.response){if(u.response.badRequest)return Ue.PNBadRequestCategory;if(u.response.forbidden)return Ue.PNAccessDeniedCategory}return Ue.PNUnknownCategory},d}();function Mu(d){var u=function(v){return v&&typeof v=="object"&&v.constructor===Object};if(!u(d))return d;var p={};return Object.keys(d).forEach(function(v){var w=function(M){return typeof M=="string"||M instanceof String}(v),T=v,P=d[v];Array.isArray(v)||w&&v.indexOf(",")>=0?T=(w?v.split(","):v).reduce(function(M,z){return M+=String.fromCharCode(z)},""):(function(M){return typeof M=="number"&&isFinite(M)}(v)||w&&!isNaN(v))&&(T=String.fromCharCode(w?parseInt(v,10):10)),p[T]=u(P)?Mu(P):P}),p}var Ic=function(){function d(u,p){this._base64ToBinary=p,this._decode=u}return d.prototype.decodeToken=function(u){var p="";u.length%4==3?p="=":u.length%4==2&&(p="==");var v=u.replace(/-/gi,"+").replace(/_/gi,"/")+p,w=this._decode(this._base64ToBinary(v));if(typeof w=="object")return w},d}(),Bf={exports:{}},Lg={exports:{}};(function(d){function u(p){if(p)return function(v){for(var w in u.prototype)v[w]=u.prototype[w];return v}(p)}d.exports=u,u.prototype.on=u.prototype.addEventListener=function(p,v){return this._callbacks=this._callbacks||{},(this._callbacks["$"+p]=this._callbacks["$"+p]||[]).push(v),this},u.prototype.once=function(p,v){function w(){this.off(p,w),v.apply(this,arguments)}return w.fn=v,this.on(p,w),this},u.prototype.off=u.prototype.removeListener=u.prototype.removeAllListeners=u.prototype.removeEventListener=function(p,v){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var w,T=this._callbacks["$"+p];if(!T)return this;if(arguments.length==1)return delete this._callbacks["$"+p],this;for(var P=0;P<T.length;P++)if((w=T[P])===v||w.fn===v){T.splice(P,1);break}return T.length===0&&delete this._callbacks["$"+p],this},u.prototype.emit=function(p){this._callbacks=this._callbacks||{};for(var v=new Array(arguments.length-1),w=this._callbacks["$"+p],T=1;T<arguments.length;T++)v[T-1]=arguments[T];if(w){T=0;for(var P=(w=w.slice(0)).length;T<P;++T)w[T].apply(this,v)}return this},u.prototype.listeners=function(p){return this._callbacks=this._callbacks||{},this._callbacks["$"+p]||[]},u.prototype.hasListeners=function(p){return!!this.listeners(p).length}})(Lg);var c0=kc;kc.default=kc,kc.stable=qf,kc.stableStringify=qf;var $l="[...]",Ng="[Circular]",Uo=[],Fo=[];function Mg(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function kc(d,u,p,v){var w;v===void 0&&(v=Mg()),Bo(d,"",0,[],void 0,0,v);try{w=Fo.length===0?JSON.stringify(d,u,p):JSON.stringify(d,jf(u),p)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Uo.length!==0;){var T=Uo.pop();T.length===4?Object.defineProperty(T[0],T[1],T[3]):T[0][T[1]]=T[2]}}return w}function Ds(d,u,p,v){var w=Object.getOwnPropertyDescriptor(v,p);w.get!==void 0?w.configurable?(Object.defineProperty(v,p,{value:d}),Uo.push([v,p,u,w])):Fo.push([u,p,d]):(v[p]=d,Uo.push([v,p,u]))}function Bo(d,u,p,v,w,T,P){var M;if(T+=1,typeof d=="object"&&d!==null){for(M=0;M<v.length;M++)if(v[M]===d)return void Ds(Ng,d,u,w);if(P.depthLimit!==void 0&&T>P.depthLimit||P.edgesLimit!==void 0&&p+1>P.edgesLimit)return void Ds($l,d,u,w);if(v.push(d),Array.isArray(d))for(M=0;M<d.length;M++)Bo(d[M],M,M,v,d,T,P);else{var z=Object.keys(d);for(M=0;M<z.length;M++){var G=z[M];Bo(d[G],G,M,v,d,T,P)}}v.pop()}}function l0(d,u){return d<u?-1:d>u?1:0}function qf(d,u,p,v){v===void 0&&(v=Mg());var w,T=Ul(d,"",0,[],void 0,0,v)||d;try{w=Fo.length===0?JSON.stringify(T,u,p):JSON.stringify(T,jf(u),p)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;Uo.length!==0;){var P=Uo.pop();P.length===4?Object.defineProperty(P[0],P[1],P[3]):P[0][P[1]]=P[2]}}return w}function Ul(d,u,p,v,w,T,P){var M;if(T+=1,typeof d=="object"&&d!==null){for(M=0;M<v.length;M++)if(v[M]===d)return void Ds(Ng,d,u,w);try{if(typeof d.toJSON=="function")return}catch{return}if(P.depthLimit!==void 0&&T>P.depthLimit||P.edgesLimit!==void 0&&p+1>P.edgesLimit)return void Ds($l,d,u,w);if(v.push(d),Array.isArray(d))for(M=0;M<d.length;M++)Ul(d[M],M,M,v,d,T,P);else{var z={},G=Object.keys(d).sort(l0);for(M=0;M<G.length;M++){var Y=G[M];Ul(d[Y],Y,M,v,d,T,P),z[Y]=d[Y]}if(w===void 0)return z;Uo.push([w,u,d]),w[u]=z}v.pop()}}function jf(d){return d=d!==void 0?d:function(u,p){return p},function(u,p){if(Fo.length>0)for(var v=0;v<Fo.length;v++){var w=Fo[v];if(w[1]===u&&w[0]===p){p=w[2],Fo.splice(v,1);break}}return d.call(this,u,p)}}var yr,Hf=typeof Symbol<"u"&&Symbol,Gf=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var d={},u=Symbol("test"),p=Object(u);if(typeof u=="string"||Object.prototype.toString.call(u)!=="[object Symbol]"||Object.prototype.toString.call(p)!=="[object Symbol]")return!1;for(u in d[u]=42,d)return!1;if(typeof Object.keys=="function"&&Object.keys(d).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(d).length!==0)return!1;var v=Object.getOwnPropertySymbols(d);if(v.length!==1||v[0]!==u||!Object.prototype.propertyIsEnumerable.call(d,u))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var w=Object.getOwnPropertyDescriptor(d,u);if(w.value!==42||w.enumerable!==!0)return!1}return!0},$g="Function.prototype.bind called on incompatible ",Fl=Array.prototype.slice,Bl=Object.prototype.toString,ql="[object Function]",d0=function(d){var u=this;if(typeof u!="function"||Bl.call(u)!==ql)throw new TypeError($g+u);for(var p,v=Fl.call(arguments,1),w=function(){if(this instanceof p){var G=u.apply(this,v.concat(Fl.call(arguments)));return Object(G)===G?G:this}return u.apply(d,v.concat(Fl.call(arguments)))},T=Math.max(0,u.length-v.length),P=[],M=0;M<T;M++)P.push("$"+M);if(p=Function("binder","return function ("+P.join(",")+"){ return binder.apply(this,arguments); }")(w),u.prototype){var z=function(){};z.prototype=u.prototype,p.prototype=new z,z.prototype=null}return p},Vf=Function.prototype.bind||d0,f0=Vf.call(Function.call,Object.prototype.hasOwnProperty),Oc=SyntaxError,Ug=Function,io=TypeError,zf=function(d){try{return Ug('"use strict"; return ('+d+").constructor;")()}catch{}},qo=Object.getOwnPropertyDescriptor;if(qo)try{qo({},"")}catch{qo=null}var no=function(){throw new io},Lr=qo?function(){try{return no}catch{try{return qo(arguments,"callee").get}catch{return no}}}():no,La=typeof Hf=="function"&&typeof Symbol=="function"&&typeof Hf("foo")=="symbol"&&typeof Symbol("bar")=="symbol"&&Gf(),Oi=Object.getPrototypeOf||function(d){return d.__proto__},Mn={},p0=typeof Uint8Array>"u"?yr:Oi(Uint8Array),jo={"%AggregateError%":typeof AggregateError>"u"?yr:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?yr:ArrayBuffer,"%ArrayIteratorPrototype%":La?Oi([][Symbol.iterator]()):yr,"%AsyncFromSyncIteratorPrototype%":yr,"%AsyncFunction%":Mn,"%AsyncGenerator%":Mn,"%AsyncGeneratorFunction%":Mn,"%AsyncIteratorPrototype%":Mn,"%Atomics%":typeof Atomics>"u"?yr:Atomics,"%BigInt%":typeof BigInt>"u"?yr:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?yr:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?yr:Float32Array,"%Float64Array%":typeof Float64Array>"u"?yr:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?yr:FinalizationRegistry,"%Function%":Ug,"%GeneratorFunction%":Mn,"%Int8Array%":typeof Int8Array>"u"?yr:Int8Array,"%Int16Array%":typeof Int16Array>"u"?yr:Int16Array,"%Int32Array%":typeof Int32Array>"u"?yr:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":La?Oi(Oi([][Symbol.iterator]())):yr,"%JSON%":typeof JSON=="object"?JSON:yr,"%Map%":typeof Map>"u"?yr:Map,"%MapIteratorPrototype%":typeof Map<"u"&&La?Oi(new Map()[Symbol.iterator]()):yr,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?yr:Promise,"%Proxy%":typeof Proxy>"u"?yr:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?yr:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?yr:Set,"%SetIteratorPrototype%":typeof Set<"u"&&La?Oi(new Set()[Symbol.iterator]()):yr,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?yr:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":La?Oi(""[Symbol.iterator]()):yr,"%Symbol%":La?Symbol:yr,"%SyntaxError%":Oc,"%ThrowTypeError%":Lr,"%TypedArray%":p0,"%TypeError%":io,"%Uint8Array%":typeof Uint8Array>"u"?yr:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?yr:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?yr:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?yr:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?yr:WeakMap,"%WeakRef%":typeof WeakRef>"u"?yr:WeakRef,"%WeakSet%":typeof WeakSet>"u"?yr:WeakSet},h0=function d(u){var p;if(u==="%AsyncFunction%")p=zf("async function () {}");else if(u==="%GeneratorFunction%")p=zf("function* () {}");else if(u==="%AsyncGeneratorFunction%")p=zf("async function* () {}");else if(u==="%AsyncGenerator%"){var v=d("%AsyncGeneratorFunction%");v&&(p=v.prototype)}else if(u==="%AsyncIteratorPrototype%"){var w=d("%AsyncGenerator%");w&&(p=Oi(w.prototype))}return jo[u]=p,p},Fg={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},jl=Vf,Hl=f0,g0=jl.call(Function.call,Array.prototype.concat),m0=jl.call(Function.apply,Array.prototype.splice),Bg=jl.call(Function.call,String.prototype.replace),Pc=jl.call(Function.call,String.prototype.slice),W=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,b=/\\(\\)?/g,E=function(d){var u=Pc(d,0,1),p=Pc(d,-1);if(u==="%"&&p!=="%")throw new Oc("invalid intrinsic syntax, expected closing `%`");if(p==="%"&&u!=="%")throw new Oc("invalid intrinsic syntax, expected opening `%`");var v=[];return Bg(d,W,function(w,T,P,M){v[v.length]=P?Bg(M,b,"$1"):T||w}),v},S=function(d,u){var p,v=d;if(Hl(Fg,v)&&(v="%"+(p=Fg[v])[0]+"%"),Hl(jo,v)){var w=jo[v];if(w===Mn&&(w=h0(v)),w===void 0&&!u)throw new io("intrinsic "+d+" exists, but is not available. Please file an issue!");return{alias:p,name:v,value:w}}throw new Oc("intrinsic "+d+" does not exist!")},x=function(d,u){if(typeof d!="string"||d.length===0)throw new io("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof u!="boolean")throw new io('"allowMissing" argument must be a boolean');var p=E(d),v=p.length>0?p[0]:"",w=S("%"+v+"%",u),T=w.name,P=w.value,M=!1,z=w.alias;z&&(v=z[0],m0(p,g0([0,1],z)));for(var G=1,Y=!0;G<p.length;G+=1){var B=p[G],he=Pc(B,0,1),se=Pc(B,-1);if((he==='"'||he==="'"||he==="`"||se==='"'||se==="'"||se==="`")&&he!==se)throw new Oc("property names with quotes must have matching quotes");if(B!=="constructor"&&Y||(M=!0),Hl(jo,T="%"+(v+="."+B)+"%"))P=jo[T];else if(P!=null){if(!(B in P)){if(!u)throw new io("base intrinsic for "+d+" exists, but the property is not available.");return}if(qo&&G+1>=p.length){var ne=qo(P,B);P=(Y=!!ne)&&"get"in ne&&!("originalValue"in ne.get)?ne.get:P[B]}else Y=Hl(P,B),P=P[B];Y&&!M&&(jo[T]=P)}}return P},R={exports:{}};(function(d){var u=Vf,p=x,v=p("%Function.prototype.apply%"),w=p("%Function.prototype.call%"),T=p("%Reflect.apply%",!0)||u.call(w,v),P=p("%Object.getOwnPropertyDescriptor%",!0),M=p("%Object.defineProperty%",!0),z=p("%Math.max%");if(M)try{M({},"a",{value:1})}catch{M=null}d.exports=function(Y){var B=T(u,w,arguments);if(P&&M){var he=P(B,"length");he.configurable&&M(B,"length",{value:1+z(0,Y.length-(arguments.length-1))})}return B};var G=function(){return T(u,v,arguments)};M?M(d.exports,"apply",{value:G}):d.exports.apply=G})(R);var N=x,ee=R.exports,ce=ee(N("String.prototype.indexOf")),Te=f(Object.freeze({__proto__:null,default:{}})),_e=typeof Map=="function"&&Map.prototype,xe=Object.getOwnPropertyDescriptor&&_e?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Qe=_e&&xe&&typeof xe.get=="function"?xe.get:null,wt=_e&&Map.prototype.forEach,Pt=typeof Set=="function"&&Set.prototype,mt=Object.getOwnPropertyDescriptor&&Pt?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Gt=Pt&&mt&&typeof mt.get=="function"?mt.get:null,qi=Pt&&Set.prototype.forEach,Ji=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap.prototype.has:null,Ya=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet.prototype.has:null,Gl=typeof WeakRef=="function"&&WeakRef.prototype?WeakRef.prototype.deref:null,qg=Boolean.prototype.valueOf,jg=Object.prototype.toString,Hg=Function.prototype.toString,Wf=String.prototype.match,Vl=String.prototype.slice,Ur=String.prototype.replace,Gg=String.prototype.toUpperCase,ao=String.prototype.toLowerCase,uA=RegExp.prototype.test,cA=Array.prototype.concat,so=Array.prototype.join,AV=Array.prototype.slice,lA=Math.floor,v0=typeof BigInt=="function"?BigInt.prototype.valueOf:null,y0=Object.getOwnPropertySymbols,b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,zl=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Wn=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===zl||!0)?Symbol.toStringTag:null,dA=Object.prototype.propertyIsEnumerable,fA=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(d){return d.__proto__}:null);function pA(d,u){if(d===1/0||d===-1/0||d!=d||d&&d>-1e3&&d<1e3||uA.call(/e/,u))return u;var p=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof d=="number"){var v=d<0?-lA(-d):lA(d);if(v!==d){var w=String(v),T=Vl.call(u,w.length+1);return Ur.call(w,p,"$&_")+"."+Ur.call(Ur.call(T,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ur.call(u,p,"$&_")}var _0=Te,hA=_0.custom,gA=yA(hA)?hA:null;function mA(d,u,p){var v=(p.quoteStyle||u)==="double"?'"':"'";return v+d+v}function IV(d){return Ur.call(String(d),/"/g,"&quot;")}function w0(d){return!(Uu(d)!=="[object Array]"||Wn&&typeof d=="object"&&Wn in d)}function vA(d){return!(Uu(d)!=="[object RegExp]"||Wn&&typeof d=="object"&&Wn in d)}function yA(d){if(zl)return d&&typeof d=="object"&&d instanceof Symbol;if(typeof d=="symbol")return!0;if(!d||typeof d!="object"||!b0)return!1;try{return b0.call(d),!0}catch{}return!1}var kV=Object.prototype.hasOwnProperty||function(d){return d in this};function $u(d,u){return kV.call(d,u)}function Uu(d){return jg.call(d)}function bA(d,u){if(d.indexOf)return d.indexOf(u);for(var p=0,v=d.length;p<v;p++)if(d[p]===u)return p;return-1}function _A(d,u){if(d.length>u.maxStringLength){var p=d.length-u.maxStringLength,v="... "+p+" more character"+(p>1?"s":"");return _A(Vl.call(d,0,u.maxStringLength),u)+v}return mA(Ur.call(Ur.call(d,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,OV),"single",u)}function OV(d){var u=d.charCodeAt(0),p={8:"b",9:"t",10:"n",12:"f",13:"r"}[u];return p?"\\"+p:"\\x"+(u<16?"0":"")+Gg.call(u.toString(16))}function Kf(d){return"Object("+d+")"}function T0(d){return d+" { ? }"}function wA(d,u,p,v){return d+" ("+u+") {"+(v?S0(p,v):so.call(p,", "))+"}"}function S0(d,u){if(d.length===0)return"";var p=`
`+u.prev+u.base;return p+so.call(d,","+p)+`
`+u.prev}function Vg(d,u){var p=w0(d),v=[];if(p){v.length=d.length;for(var w=0;w<d.length;w++)v[w]=$u(d,w)?u(d[w],d):""}var T,P=typeof y0=="function"?y0(d):[];if(zl){T={};for(var M=0;M<P.length;M++)T["$"+P[M]]=P[M]}for(var z in d)$u(d,z)&&(p&&String(Number(z))===z&&z<d.length||zl&&T["$"+z]instanceof Symbol||(uA.call(/[^\w$]/,z)?v.push(u(z,d)+": "+u(d[z],d)):v.push(z+": "+u(d[z],d))));if(typeof y0=="function")for(var G=0;G<P.length;G++)dA.call(d,P[G])&&v.push("["+u(P[G])+"]: "+u(d[P[G]],d));return v}var E0=x,Wl=function(d,u){var p=N(d,!!u);return typeof p=="function"&&ce(d,".prototype.")>-1?ee(p):p},PV=function d(u,p,v,w){var T=p||{};if($u(T,"quoteStyle")&&T.quoteStyle!=="single"&&T.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if($u(T,"maxStringLength")&&(typeof T.maxStringLength=="number"?T.maxStringLength<0&&T.maxStringLength!==1/0:T.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var P=!$u(T,"customInspect")||T.customInspect;if(typeof P!="boolean"&&P!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if($u(T,"indent")&&T.indent!==null&&T.indent!=="	"&&!(parseInt(T.indent,10)===T.indent&&T.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if($u(T,"numericSeparator")&&typeof T.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var M=T.numericSeparator;if(u===void 0)return"undefined";if(u===null)return"null";if(typeof u=="boolean")return u?"true":"false";if(typeof u=="string")return _A(u,T);if(typeof u=="number"){if(u===0)return 1/0/u>0?"0":"-0";var z=String(u);return M?pA(u,z):z}if(typeof u=="bigint"){var G=String(u)+"n";return M?pA(u,G):G}var Y=T.depth===void 0?5:T.depth;if(v===void 0&&(v=0),v>=Y&&Y>0&&typeof u=="object")return w0(u)?"[Array]":"[Object]";var B=function(ve,ot){var je;if(ve.indent==="	")je="	";else{if(!(typeof ve.indent=="number"&&ve.indent>0))return null;je=so.call(Array(ve.indent+1)," ")}return{base:je,prev:so.call(Array(ot+1),je)}}(T,v);if(w===void 0)w=[];else if(bA(w,u)>=0)return"[Circular]";function he(ve,ot,je){if(ot&&(w=AV.call(w)).push(ot),je){var Je={depth:T.depth};return $u(T,"quoteStyle")&&(Je.quoteStyle=T.quoteStyle),d(ve,Je,v+1,w)}return d(ve,T,v+1,w)}if(typeof u=="function"&&!vA(u)){var se=function(ve){if(ve.name)return ve.name;var ot=Wf.call(Hg.call(ve),/^function\s*([\w$]+)/);return ot?ot[1]:null}(u),ne=Vg(u,he);return"[Function"+(se?": "+se:" (anonymous)")+"]"+(ne.length>0?" { "+so.call(ne,", ")+" }":"")}if(yA(u)){var oe=zl?Ur.call(String(u),/^(Symbol\(.*\))_[^)]*$/,"$1"):b0.call(u);return typeof u!="object"||zl?oe:Kf(oe)}if(function(ve){return!ve||typeof ve!="object"?!1:typeof HTMLElement<"u"&&ve instanceof HTMLElement?!0:typeof ve.nodeName=="string"&&typeof ve.getAttribute=="function"}(u)){for(var ue="<"+ao.call(String(u.nodeName)),Ce=u.attributes||[],Xe=0;Xe<Ce.length;Xe++)ue+=" "+Ce[Xe].name+"="+mA(IV(Ce[Xe].value),"double",T);return ue+=">",u.childNodes&&u.childNodes.length&&(ue+="..."),ue+="</"+ao.call(String(u.nodeName))+">"}if(w0(u)){if(u.length===0)return"[]";var it=Vg(u,he);return B&&!function(ve){for(var ot=0;ot<ve.length;ot++)if(bA(ve[ot],`
`)>=0)return!1;return!0}(it)?"["+S0(it,B)+"]":"[ "+so.call(it,", ")+" ]"}if(function(ve){return!(Uu(ve)!=="[object Error]"||Wn&&typeof ve=="object"&&Wn in ve)}(u)){var ut=Vg(u,he);return"cause"in Error.prototype||!("cause"in u)||dA.call(u,"cause")?ut.length===0?"["+String(u)+"]":"{ ["+String(u)+"] "+so.call(ut,", ")+" }":"{ ["+String(u)+"] "+so.call(cA.call("[cause]: "+he(u.cause),ut),", ")+" }"}if(typeof u=="object"&&P){if(gA&&typeof u[gA]=="function"&&_0)return _0(u,{depth:Y-v});if(P!=="symbol"&&typeof u.inspect=="function")return u.inspect()}if(function(ve){if(!Qe||!ve||typeof ve!="object")return!1;try{Qe.call(ve);try{Gt.call(ve)}catch{return!0}return ve instanceof Map}catch{}return!1}(u)){var rt=[];return wt&&wt.call(u,function(ve,ot){rt.push(he(ot,u,!0)+" => "+he(ve,u))}),wA("Map",Qe.call(u),rt,B)}if(function(ve){if(!Gt||!ve||typeof ve!="object")return!1;try{Gt.call(ve);try{Qe.call(ve)}catch{return!0}return ve instanceof Set}catch{}return!1}(u)){var ge=[];return qi&&qi.call(u,function(ve){ge.push(he(ve,u))}),wA("Set",Gt.call(u),ge,B)}if(function(ve){if(!Ji||!ve||typeof ve!="object")return!1;try{Ji.call(ve,Ji);try{Ya.call(ve,Ya)}catch{return!0}return ve instanceof WeakMap}catch{}return!1}(u))return T0("WeakMap");if(function(ve){if(!Ya||!ve||typeof ve!="object")return!1;try{Ya.call(ve,Ya);try{Ji.call(ve,Ji)}catch{return!0}return ve instanceof WeakSet}catch{}return!1}(u))return T0("WeakSet");if(function(ve){if(!Gl||!ve||typeof ve!="object")return!1;try{return Gl.call(ve),!0}catch{}return!1}(u))return T0("WeakRef");if(function(ve){return!(Uu(ve)!=="[object Number]"||Wn&&typeof ve=="object"&&Wn in ve)}(u))return Kf(he(Number(u)));if(function(ve){if(!ve||typeof ve!="object"||!v0)return!1;try{return v0.call(ve),!0}catch{}return!1}(u))return Kf(he(v0.call(u)));if(function(ve){return!(Uu(ve)!=="[object Boolean]"||Wn&&typeof ve=="object"&&Wn in ve)}(u))return Kf(qg.call(u));if(function(ve){return!(Uu(ve)!=="[object String]"||Wn&&typeof ve=="object"&&Wn in ve)}(u))return Kf(he(String(u)));if(typeof window<"u"&&u===window)return"{ [object Window] }";if(u===l)return"{ [object globalThis] }";if(!function(ve){return!(Uu(ve)!=="[object Date]"||Wn&&typeof ve=="object"&&Wn in ve)}(u)&&!vA(u)){var Be=Vg(u,he),Pe=fA?fA(u)===Object.prototype:u instanceof Object||u.constructor===Object,et=u instanceof Object?"":"null prototype",Me=!Pe&&Wn&&Object(u)===u&&Wn in u?Vl.call(Uu(u),8,-1):et?"Object":"",qe=(Pe||typeof u.constructor!="function"?"":u.constructor.name?u.constructor.name+" ":"")+(Me||et?"["+so.call(cA.call([],Me||[],et||[]),": ")+"] ":"");return Be.length===0?qe+"{}":B?qe+"{"+S0(Be,B)+"}":qe+"{ "+so.call(Be,", ")+" }"}return String(u)},RV=E0("%TypeError%"),zg=E0("%WeakMap%",!0),Wg=E0("%Map%",!0),DV=Wl("WeakMap.prototype.get",!0),LV=Wl("WeakMap.prototype.set",!0),NV=Wl("WeakMap.prototype.has",!0),MV=Wl("Map.prototype.get",!0),$V=Wl("Map.prototype.set",!0),UV=Wl("Map.prototype.has",!0),x0=function(d,u){for(var p,v=d;(p=v.next)!==null;v=p)if(p.key===u)return v.next=p.next,p.next=d.next,d.next=p,p},FV=String.prototype.replace,BV=/%20/g,TA="RFC3986",C0={default:TA,formatters:{RFC1738:function(d){return FV.call(d,BV,"+")},RFC3986:function(d){return String(d)}},RFC1738:"RFC1738",RFC3986:TA},qV=C0,A0=Object.prototype.hasOwnProperty,Rc=Array.isArray,oo=function(){for(var d=[],u=0;u<256;++u)d.push("%"+((u<16?"0":"")+u.toString(16)).toUpperCase());return d}(),SA=function(d,u){for(var p=u&&u.plainObjects?Object.create(null):{},v=0;v<d.length;++v)d[v]!==void 0&&(p[v]=d[v]);return p},EA={arrayToObject:SA,assign:function(d,u){return Object.keys(u).reduce(function(p,v){return p[v]=u[v],p},d)},combine:function(d,u){return[].concat(d,u)},compact:function(d){for(var u=[{obj:{o:d},prop:"o"}],p=[],v=0;v<u.length;++v)for(var w=u[v],T=w.obj[w.prop],P=Object.keys(T),M=0;M<P.length;++M){var z=P[M],G=T[z];typeof G=="object"&&G!==null&&p.indexOf(G)===-1&&(u.push({obj:T,prop:z}),p.push(G))}return function(Y){for(;Y.length>1;){var B=Y.pop(),he=B.obj[B.prop];if(Rc(he)){for(var se=[],ne=0;ne<he.length;++ne)he[ne]!==void 0&&se.push(he[ne]);B.obj[B.prop]=se}}}(u),d},decode:function(d,u,p){var v=d.replace(/\+/g," ");if(p==="iso-8859-1")return v.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(v)}catch{return v}},encode:function(d,u,p,v,w){if(d.length===0)return d;var T=d;if(typeof d=="symbol"?T=Symbol.prototype.toString.call(d):typeof d!="string"&&(T=String(d)),p==="iso-8859-1")return escape(T).replace(/%u[0-9a-f]{4}/gi,function(G){return"%26%23"+parseInt(G.slice(2),16)+"%3B"});for(var P="",M=0;M<T.length;++M){var z=T.charCodeAt(M);z===45||z===46||z===95||z===126||z>=48&&z<=57||z>=65&&z<=90||z>=97&&z<=122||w===qV.RFC1738&&(z===40||z===41)?P+=T.charAt(M):z<128?P+=oo[z]:z<2048?P+=oo[192|z>>6]+oo[128|63&z]:z<55296||z>=57344?P+=oo[224|z>>12]+oo[128|z>>6&63]+oo[128|63&z]:(M+=1,z=65536+((1023&z)<<10|1023&T.charCodeAt(M)),P+=oo[240|z>>18]+oo[128|z>>12&63]+oo[128|z>>6&63]+oo[128|63&z])}return P},isBuffer:function(d){return!(!d||typeof d!="object")&&!!(d.constructor&&d.constructor.isBuffer&&d.constructor.isBuffer(d))},isRegExp:function(d){return Object.prototype.toString.call(d)==="[object RegExp]"},maybeMap:function(d,u){if(Rc(d)){for(var p=[],v=0;v<d.length;v+=1)p.push(u(d[v]));return p}return u(d)},merge:function d(u,p,v){if(!p)return u;if(typeof p!="object"){if(Rc(u))u.push(p);else{if(!u||typeof u!="object")return[u,p];(v&&(v.plainObjects||v.allowPrototypes)||!A0.call(Object.prototype,p))&&(u[p]=!0)}return u}if(!u||typeof u!="object")return[u].concat(p);var w=u;return Rc(u)&&!Rc(p)&&(w=SA(u,v)),Rc(u)&&Rc(p)?(p.forEach(function(T,P){if(A0.call(u,P)){var M=u[P];M&&typeof M=="object"&&T&&typeof T=="object"?u[P]=d(M,T,v):u.push(T)}else u[P]=T}),u):Object.keys(p).reduce(function(T,P){var M=p[P];return A0.call(T,P)?T[P]=d(T[P],M,v):T[P]=M,T},w)}},xA=function(){var d,u,p,v={assert:function(w){if(!v.has(w))throw new RV("Side channel does not contain "+PV(w))},get:function(w){if(zg&&w&&(typeof w=="object"||typeof w=="function")){if(d)return DV(d,w)}else if(Wg){if(u)return MV(u,w)}else if(p)return function(T,P){var M=x0(T,P);return M&&M.value}(p,w)},has:function(w){if(zg&&w&&(typeof w=="object"||typeof w=="function")){if(d)return NV(d,w)}else if(Wg){if(u)return UV(u,w)}else if(p)return function(T,P){return!!x0(T,P)}(p,w);return!1},set:function(w,T){zg&&w&&(typeof w=="object"||typeof w=="function")?(d||(d=new zg),LV(d,w,T)):Wg?(u||(u=new Wg),$V(u,w,T)):(p||(p={key:{},next:null}),function(P,M,z){var G=x0(P,M);G?G.value=z:P.next={key:M,next:P.next,value:z}}(p,w,T))}};return v},Kg=EA,Xf=C0,jV=Object.prototype.hasOwnProperty,CA={brackets:function(d){return d+"[]"},comma:"comma",indices:function(d,u){return d+"["+u+"]"},repeat:function(d){return d}},Ho=Array.isArray,HV=Array.prototype.push,AA=function(d,u){HV.apply(d,Ho(u)?u:[u])},GV=Date.prototype.toISOString,IA=Xf.default,Kn={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Kg.encode,encodeValuesOnly:!1,format:IA,formatter:Xf.formatters[IA],indices:!1,serializeDate:function(d){return GV.call(d)},skipNulls:!1,strictNullHandling:!1},I0={},VV=function d(u,p,v,w,T,P,M,z,G,Y,B,he,se,ne,oe,ue){for(var Ce,Xe=u,it=ue,ut=0,rt=!1;(it=it.get(I0))!==void 0&&!rt;){var ge=it.get(u);if(ut+=1,ge!==void 0){if(ge===ut)throw new RangeError("Cyclic object value");rt=!0}it.get(I0)===void 0&&(ut=0)}if(typeof z=="function"?Xe=z(p,Xe):Xe instanceof Date?Xe=B(Xe):v==="comma"&&Ho(Xe)&&(Xe=Kg.maybeMap(Xe,function(nt){return nt instanceof Date?B(nt):nt})),Xe===null){if(T)return M&&!ne?M(p,Kn.encoder,oe,"key",he):p;Xe=""}if(typeof(Ce=Xe)=="string"||typeof Ce=="number"||typeof Ce=="boolean"||typeof Ce=="symbol"||typeof Ce=="bigint"||Kg.isBuffer(Xe))return M?[se(ne?p:M(p,Kn.encoder,oe,"key",he))+"="+se(M(Xe,Kn.encoder,oe,"value",he))]:[se(p)+"="+se(String(Xe))];var Be,Pe=[];if(Xe===void 0)return Pe;if(v==="comma"&&Ho(Xe))ne&&M&&(Xe=Kg.maybeMap(Xe,M)),Be=[{value:Xe.length>0?Xe.join(",")||null:void 0}];else if(Ho(z))Be=z;else{var et=Object.keys(Xe);Be=G?et.sort(G):et}for(var Me=w&&Ho(Xe)&&Xe.length===1?p+"[]":p,qe=0;qe<Be.length;++qe){var ve=Be[qe],ot=typeof ve=="object"&&ve.value!==void 0?ve.value:Xe[ve];if(!P||ot!==null){var je=Ho(Xe)?typeof v=="function"?v(Me,ve):Me:Me+(Y?"."+ve:"["+ve+"]");ue.set(u,ut);var Je=xA();Je.set(I0,ue),AA(Pe,d(ot,je,v,w,T,P,v==="comma"&&ne&&Ho(Xe)?null:M,z,G,Y,B,he,se,ne,oe,Je))}}return Pe},Kl=EA,k0=Object.prototype.hasOwnProperty,zV=Array.isArray,En={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Kl.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},WV=function(d){return d.replace(/&#(\d+);/g,function(u,p){return String.fromCharCode(parseInt(p,10))})},kA=function(d,u){return d&&typeof d=="string"&&u.comma&&d.indexOf(",")>-1?d.split(","):d},KV=function(d,u,p,v){if(d){var w=p.allowDots?d.replace(/\.([^.[]+)/g,"[$1]"):d,T=/(\[[^[\]]*])/g,P=p.depth>0&&/(\[[^[\]]*])/.exec(w),M=P?w.slice(0,P.index):w,z=[];if(M){if(!p.plainObjects&&k0.call(Object.prototype,M)&&!p.allowPrototypes)return;z.push(M)}for(var G=0;p.depth>0&&(P=T.exec(w))!==null&&G<p.depth;){if(G+=1,!p.plainObjects&&k0.call(Object.prototype,P[1].slice(1,-1))&&!p.allowPrototypes)return;z.push(P[1])}return P&&z.push("["+w.slice(P.index)+"]"),function(Y,B,he,se){for(var ne=se?B:kA(B,he),oe=Y.length-1;oe>=0;--oe){var ue,Ce=Y[oe];if(Ce==="[]"&&he.parseArrays)ue=[].concat(ne);else{ue=he.plainObjects?Object.create(null):{};var Xe=Ce.charAt(0)==="["&&Ce.charAt(Ce.length-1)==="]"?Ce.slice(1,-1):Ce,it=parseInt(Xe,10);he.parseArrays||Xe!==""?!isNaN(it)&&Ce!==Xe&&String(it)===Xe&&it>=0&&he.parseArrays&&it<=he.arrayLimit?(ue=[])[it]=ne:Xe!=="__proto__"&&(ue[Xe]=ne):ue={0:ne}}ne=ue}return ne}(z,u,p,v)}},XV=function(d,u){var p,v=d,w=function(ne){if(!ne)return Kn;if(ne.encoder!==null&&ne.encoder!==void 0&&typeof ne.encoder!="function")throw new TypeError("Encoder has to be a function.");var oe=ne.charset||Kn.charset;if(ne.charset!==void 0&&ne.charset!=="utf-8"&&ne.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var ue=Xf.default;if(ne.format!==void 0){if(!jV.call(Xf.formatters,ne.format))throw new TypeError("Unknown format option provided.");ue=ne.format}var Ce=Xf.formatters[ue],Xe=Kn.filter;return(typeof ne.filter=="function"||Ho(ne.filter))&&(Xe=ne.filter),{addQueryPrefix:typeof ne.addQueryPrefix=="boolean"?ne.addQueryPrefix:Kn.addQueryPrefix,allowDots:ne.allowDots===void 0?Kn.allowDots:!!ne.allowDots,charset:oe,charsetSentinel:typeof ne.charsetSentinel=="boolean"?ne.charsetSentinel:Kn.charsetSentinel,delimiter:ne.delimiter===void 0?Kn.delimiter:ne.delimiter,encode:typeof ne.encode=="boolean"?ne.encode:Kn.encode,encoder:typeof ne.encoder=="function"?ne.encoder:Kn.encoder,encodeValuesOnly:typeof ne.encodeValuesOnly=="boolean"?ne.encodeValuesOnly:Kn.encodeValuesOnly,filter:Xe,format:ue,formatter:Ce,serializeDate:typeof ne.serializeDate=="function"?ne.serializeDate:Kn.serializeDate,skipNulls:typeof ne.skipNulls=="boolean"?ne.skipNulls:Kn.skipNulls,sort:typeof ne.sort=="function"?ne.sort:null,strictNullHandling:typeof ne.strictNullHandling=="boolean"?ne.strictNullHandling:Kn.strictNullHandling}}(u);typeof w.filter=="function"?v=(0,w.filter)("",v):Ho(w.filter)&&(p=w.filter);var T,P=[];if(typeof v!="object"||v===null)return"";T=u&&u.arrayFormat in CA?u.arrayFormat:u&&"indices"in u?u.indices?"indices":"repeat":"indices";var M=CA[T];if(u&&"commaRoundTrip"in u&&typeof u.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var z=M==="comma"&&u&&u.commaRoundTrip;p||(p=Object.keys(v)),w.sort&&p.sort(w.sort);for(var G=xA(),Y=0;Y<p.length;++Y){var B=p[Y];w.skipNulls&&v[B]===null||AA(P,VV(v[B],B,M,z,w.strictNullHandling,w.skipNulls,w.encode?w.encoder:null,w.filter,w.sort,w.allowDots,w.serializeDate,w.format,w.formatter,w.encodeValuesOnly,w.charset,G))}var he=P.join(w.delimiter),se=w.addQueryPrefix===!0?"?":"";return w.charsetSentinel&&(w.charset==="iso-8859-1"?se+="utf8=%26%2310003%3B&":se+="utf8=%E2%9C%93&"),he.length>0?se+he:""},YV={formats:C0,parse:function(d,u){var p=function(G){if(!G)return En;if(G.decoder!==null&&G.decoder!==void 0&&typeof G.decoder!="function")throw new TypeError("Decoder has to be a function.");if(G.charset!==void 0&&G.charset!=="utf-8"&&G.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var Y=G.charset===void 0?En.charset:G.charset;return{allowDots:G.allowDots===void 0?En.allowDots:!!G.allowDots,allowPrototypes:typeof G.allowPrototypes=="boolean"?G.allowPrototypes:En.allowPrototypes,allowSparse:typeof G.allowSparse=="boolean"?G.allowSparse:En.allowSparse,arrayLimit:typeof G.arrayLimit=="number"?G.arrayLimit:En.arrayLimit,charset:Y,charsetSentinel:typeof G.charsetSentinel=="boolean"?G.charsetSentinel:En.charsetSentinel,comma:typeof G.comma=="boolean"?G.comma:En.comma,decoder:typeof G.decoder=="function"?G.decoder:En.decoder,delimiter:typeof G.delimiter=="string"||Kl.isRegExp(G.delimiter)?G.delimiter:En.delimiter,depth:typeof G.depth=="number"||G.depth===!1?+G.depth:En.depth,ignoreQueryPrefix:G.ignoreQueryPrefix===!0,interpretNumericEntities:typeof G.interpretNumericEntities=="boolean"?G.interpretNumericEntities:En.interpretNumericEntities,parameterLimit:typeof G.parameterLimit=="number"?G.parameterLimit:En.parameterLimit,parseArrays:G.parseArrays!==!1,plainObjects:typeof G.plainObjects=="boolean"?G.plainObjects:En.plainObjects,strictNullHandling:typeof G.strictNullHandling=="boolean"?G.strictNullHandling:En.strictNullHandling}}(u);if(d===""||d==null)return p.plainObjects?Object.create(null):{};for(var v=typeof d=="string"?function(G,Y){var B,he={__proto__:null},se=Y.ignoreQueryPrefix?G.replace(/^\?/,""):G,ne=Y.parameterLimit===1/0?void 0:Y.parameterLimit,oe=se.split(Y.delimiter,ne),ue=-1,Ce=Y.charset;if(Y.charsetSentinel)for(B=0;B<oe.length;++B)oe[B].indexOf("utf8=")===0&&(oe[B]==="utf8=%E2%9C%93"?Ce="utf-8":oe[B]==="utf8=%26%2310003%3B"&&(Ce="iso-8859-1"),ue=B,B=oe.length);for(B=0;B<oe.length;++B)if(B!==ue){var Xe,it,ut=oe[B],rt=ut.indexOf("]="),ge=rt===-1?ut.indexOf("="):rt+1;ge===-1?(Xe=Y.decoder(ut,En.decoder,Ce,"key"),it=Y.strictNullHandling?null:""):(Xe=Y.decoder(ut.slice(0,ge),En.decoder,Ce,"key"),it=Kl.maybeMap(kA(ut.slice(ge+1),Y),function(Be){return Y.decoder(Be,En.decoder,Ce,"value")})),it&&Y.interpretNumericEntities&&Ce==="iso-8859-1"&&(it=WV(it)),ut.indexOf("[]=")>-1&&(it=zV(it)?[it]:it),k0.call(he,Xe)?he[Xe]=Kl.combine(he[Xe],it):he[Xe]=it}return he}(d,p):d,w=p.plainObjects?Object.create(null):{},T=Object.keys(v),P=0;P<T.length;++P){var M=T[P],z=KV(M,v[M],p,typeof d=="string");w=Kl.merge(w,z,p)}return p.allowSparse===!0?w:Kl.compact(w)},stringify:XV},Dc={};(function(d){function u(v,w){var T=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!T){if(Array.isArray(v)||(T=function(B,he){if(B){if(typeof B=="string")return p(B,he);var se=Object.prototype.toString.call(B).slice(8,-1);if(se==="Object"&&B.constructor&&(se=B.constructor.name),se==="Map"||se==="Set")return Array.from(B);if(se==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(se))return p(B,he)}}(v))||w&&v&&typeof v.length=="number"){T&&(v=T);var P=0,M=function(){};return{s:M,n:function(){return P>=v.length?{done:!0}:{done:!1,value:v[P++]}},e:function(B){throw B},f:M}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var z,G=!0,Y=!1;return{s:function(){T=T.call(v)},n:function(){var B=T.next();return G=B.done,B},e:function(B){Y=!0,z=B},f:function(){try{G||T.return==null||T.return()}finally{if(Y)throw z}}}}function p(v,w){(w==null||w>v.length)&&(w=v.length);for(var T=0,P=new Array(w);T<w;T++)P[T]=v[T];return P}d.type=v=>v.split(/ *; */).shift(),d.params=v=>{let w={};var T,P=u(v.split(/ *; */));try{for(P.s();!(T=P.n()).done;){let M=T.value.split(/ *= */),z=M.shift(),G=M.shift();z&&G&&(w[z]=G)}}catch(M){P.e(M)}finally{P.f()}return w},d.parseLinks=v=>{let w={};var T,P=u(v.split(/ *, */));try{for(P.s();!(T=P.n()).done;){let M=T.value.split(/ *; */),z=M[0].slice(1,-1);w[M[1].split(/ *= */)[1].slice(1,-1)]=z}}catch(M){P.e(M)}finally{P.f()}return w},d.cleanHeader=(v,w)=>(delete v["content-type"],delete v["content-length"],delete v["transfer-encoding"],delete v.host,w&&(delete v.authorization,delete v.cookie),v),d.isObject=v=>v!==null&&typeof v=="object",d.hasOwn=Object.hasOwn||function(v,w){if(v==null)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(new Object(v),w)},d.mixin=(v,w)=>{for(let T in w)d.hasOwn(w,T)&&(v[T]=w[T])}})(Dc);let OA=Te,Xg=Dc.isObject,Yf=Dc.hasOwn;var JV=kr;function kr(){}kr.prototype.clearTimeout=function(){return clearTimeout(this._timer),clearTimeout(this._responseTimeoutTimer),clearTimeout(this._uploadTimeoutTimer),delete this._timer,delete this._responseTimeoutTimer,delete this._uploadTimeoutTimer,this},kr.prototype.parse=function(d){return this._parser=d,this},kr.prototype.responseType=function(d){return this._responseType=d,this},kr.prototype.serialize=function(d){return this._serializer=d,this},kr.prototype.timeout=function(d){if(!d||typeof d!="object")return this._timeout=d,this._responseTimeout=0,this._uploadTimeout=0,this;for(let u in d)if(Yf(d,u))switch(u){case"deadline":this._timeout=d.deadline;break;case"response":this._responseTimeout=d.response;break;case"upload":this._uploadTimeout=d.upload;break;default:console.warn("Unknown timeout option",u)}return this},kr.prototype.retry=function(d,u){return arguments.length!==0&&d!==!0||(d=1),d<=0&&(d=0),this._maxRetries=d,this._retries=0,this._retryCallback=u,this};let QV=new Set(["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"]),ZV=new Set([408,413,429,500,502,503,504,521,522,524]);kr.prototype._shouldRetry=function(d,u){if(!this._maxRetries||this._retries++>=this._maxRetries)return!1;if(this._retryCallback)try{let p=this._retryCallback(d,u);if(p===!0)return!0;if(p===!1)return!1}catch(p){console.error(p)}return!!(u&&u.status&&ZV.has(u.status)||d&&(d.code&&QV.has(d.code)||d.timeout&&d.code==="ECONNABORTED"||d.crossDomain))},kr.prototype._retry=function(){return this.clearTimeout(),this.req&&(this.req=null,this.req=this.request()),this._aborted=!1,this.timedout=!1,this.timedoutError=null,this._end()},kr.prototype.then=function(d,u){if(!this._fullfilledPromise){let p=this;this._endCalled&&console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises"),this._fullfilledPromise=new Promise((v,w)=>{p.on("abort",()=>{if(this._maxRetries&&this._maxRetries>this._retries)return;if(this.timedout&&this.timedoutError)return void w(this.timedoutError);let T=new Error("Aborted");T.code="ABORTED",T.status=this.status,T.method=this.method,T.url=this.url,w(T)}),p.end((T,P)=>{T?w(T):v(P)})})}return this._fullfilledPromise.then(d,u)},kr.prototype.catch=function(d){return this.then(void 0,d)},kr.prototype.use=function(d){return d(this),this},kr.prototype.ok=function(d){if(typeof d!="function")throw new Error("Callback required");return this._okCallback=d,this},kr.prototype._isResponseOK=function(d){return!!d&&(this._okCallback?this._okCallback(d):d.status>=200&&d.status<300)},kr.prototype.get=function(d){return this._header[d.toLowerCase()]},kr.prototype.getHeader=kr.prototype.get,kr.prototype.set=function(d,u){if(Xg(d)){for(let p in d)Yf(d,p)&&this.set(p,d[p]);return this}return this._header[d.toLowerCase()]=u,this.header[d]=u,this},kr.prototype.unset=function(d){return delete this._header[d.toLowerCase()],delete this.header[d],this},kr.prototype.field=function(d,u,p){if(d==null)throw new Error(".field(name, val) name can not be empty");if(this._data)throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()");if(Xg(d)){for(let v in d)Yf(d,v)&&this.field(v,d[v]);return this}if(Array.isArray(u)){for(let v in u)Yf(u,v)&&this.field(d,u[v]);return this}if(u==null)throw new Error(".field(name, val) val can not be empty");return typeof u=="boolean"&&(u=String(u)),p?this._getFormData().append(d,u,p):this._getFormData().append(d,u),this},kr.prototype.abort=function(){if(this._aborted)return this;if(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req){if(OA.gte(process.version,"v13.0.0")&&OA.lt(process.version,"v14.0.0"))throw new Error("Superagent does not work in v13 properly with abort() due to Node.js core changes");this.req.abort()}return this.clearTimeout(),this.emit("abort"),this},kr.prototype._auth=function(d,u,p,v){switch(p.type){case"basic":this.set("Authorization",`Basic ${v(`${d}:${u}`)}`);break;case"auto":this.username=d,this.password=u;break;case"bearer":this.set("Authorization",`Bearer ${d}`)}return this},kr.prototype.withCredentials=function(d){return d===void 0&&(d=!0),this._withCredentials=d,this},kr.prototype.redirects=function(d){return this._maxRedirects=d,this},kr.prototype.maxResponseSize=function(d){if(typeof d!="number")throw new TypeError("Invalid argument");return this._maxResponseSize=d,this},kr.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}},kr.prototype.send=function(d){let u=Xg(d),p=this._header["content-type"];if(this._formData)throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()");if(u&&!this._data)Array.isArray(d)?this._data=[]:this._isHost(d)||(this._data={});else if(d&&this._data&&this._isHost(this._data))throw new Error("Can't merge these send calls");if(u&&Xg(this._data))for(let v in d){if(typeof d[v]=="bigint"&&!d[v].toJSON)throw new Error("Cannot serialize BigInt value to json");Yf(d,v)&&(this._data[v]=d[v])}else{if(typeof d=="bigint")throw new Error("Cannot send value of type BigInt");typeof d=="string"?(p||this.type("form"),p=this._header["content-type"],p&&(p=p.toLowerCase().trim()),this._data=p==="application/x-www-form-urlencoded"?this._data?`${this._data}&${d}`:d:(this._data||"")+d):this._data=d}return!u||this._isHost(d)||p||this.type("json"),this},kr.prototype.sortQuery=function(d){return this._sort=d===void 0||d,this},kr.prototype._finalizeQueryString=function(){let d=this._query.join("&");if(d&&(this.url+=(this.url.includes("?")?"&":"?")+d),this._query.length=0,this._sort){let u=this.url.indexOf("?");if(u>=0){let p=this.url.slice(u+1).split("&");typeof this._sort=="function"?p.sort(this._sort):p.sort(),this.url=this.url.slice(0,u)+"?"+p.join("&")}}},kr.prototype._appendQueryString=()=>{console.warn("Unsupported")},kr.prototype._timeoutError=function(d,u,p){if(this._aborted)return;let v=new Error(`${d+u}ms exceeded`);v.timeout=u,v.code="ECONNABORTED",v.errno=p,this.timedout=!0,this.timedoutError=v,this.abort(),this.callback(v)},kr.prototype._setTimeouts=function(){let d=this;this._timeout&&!this._timer&&(this._timer=setTimeout(()=>{d._timeoutError("Timeout of ",d._timeout,"ETIME")},this._timeout)),this._responseTimeout&&!this._responseTimeoutTimer&&(this._responseTimeoutTimer=setTimeout(()=>{d._timeoutError("Response timeout of ",d._responseTimeout,"ETIMEDOUT")},this._responseTimeout))};let O0=Dc;var ez=Yg;function Yg(){}function tz(d,u){var p=typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(!p){if(Array.isArray(d)||(p=function(z,G){if(z){if(typeof z=="string")return PA(z,G);var Y=Object.prototype.toString.call(z).slice(8,-1);if(Y==="Object"&&z.constructor&&(Y=z.constructor.name),Y==="Map"||Y==="Set")return Array.from(z);if(Y==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Y))return PA(z,G)}}(d))||u&&d&&typeof d.length=="number"){p&&(d=p);var v=0,w=function(){};return{s:w,n:function(){return v>=d.length?{done:!0}:{done:!1,value:d[v++]}},e:function(z){throw z},f:w}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var T,P=!0,M=!1;return{s:function(){p=p.call(d)},n:function(){var z=p.next();return P=z.done,z},e:function(z){M=!0,T=z},f:function(){try{P||p.return==null||p.return()}finally{if(M)throw T}}}}function PA(d,u){(u==null||u>d.length)&&(u=d.length);for(var p=0,v=new Array(u);p<u;p++)v[p]=d[p];return v}function P0(){this._defaults=[]}Yg.prototype.get=function(d){return this.header[d.toLowerCase()]},Yg.prototype._setHeaderProperties=function(d){let u=d["content-type"]||"";this.type=O0.type(u);let p=O0.params(u);for(let v in p)Object.prototype.hasOwnProperty.call(p,v)&&(this[v]=p[v]);this.links={};try{d.link&&(this.links=O0.parseLinks(d.link))}catch{}},Yg.prototype._setStatusProperties=function(d){let u=Math.trunc(d/100);this.statusCode=d,this.status=this.statusCode,this.statusType=u,this.info=u===1,this.ok=u===2,this.redirect=u===3,this.clientError=u===4,this.serverError=u===5,this.error=(u===4||u===5)&&this.toError(),this.created=d===201,this.accepted=d===202,this.noContent=d===204,this.badRequest=d===400,this.unauthorized=d===401,this.notAcceptable=d===406,this.forbidden=d===403,this.notFound=d===404,this.unprocessableEntity=d===422};for(var R0=0,RA=["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert","disableTLSCerts"];R0<RA.length;R0++){let d=RA[R0];P0.prototype[d]=function(){for(var u=arguments.length,p=new Array(u),v=0;v<u;v++)p[v]=arguments[v];return this._defaults.push({fn:d,args:p}),this}}P0.prototype._setDefaults=function(d){var u,p=tz(this._defaults);try{for(p.s();!(u=p.n()).done;){let v=u.value;d[v.fn](...v.args)}}catch(v){p.e(v)}finally{p.f()}};var rz=P0;(function(d,u){function p(Me,qe){var ve=typeof Symbol<"u"&&Me[Symbol.iterator]||Me["@@iterator"];if(!ve){if(Array.isArray(Me)||(ve=function(wr,Di){if(wr){if(typeof wr=="string")return v(wr,Di);var Li=Object.prototype.toString.call(wr).slice(8,-1);if(Li==="Object"&&wr.constructor&&(Li=wr.constructor.name),Li==="Map"||Li==="Set")return Array.from(wr);if(Li==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Li))return v(wr,Di)}}(Me))||qe&&Me&&typeof Me.length=="number"){ve&&(Me=ve);var ot=0,je=function(){};return{s:je,n:function(){return ot>=Me.length?{done:!0}:{done:!1,value:Me[ot++]}},e:function(wr){throw wr},f:je}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Je,nt=!0,gt=!1;return{s:function(){ve=ve.call(Me)},n:function(){var wr=ve.next();return nt=wr.done,wr},e:function(wr){gt=!0,Je=wr},f:function(){try{nt||ve.return==null||ve.return()}finally{if(gt)throw Je}}}}function v(Me,qe){(qe==null||qe>Me.length)&&(qe=Me.length);for(var ve=0,ot=new Array(qe);ve<qe;ve++)ot[ve]=Me[ve];return ot}let w;typeof window<"u"?w=window:typeof self>"u"?(console.warn("Using browser-only version of superagent in non-browser environment"),w=void 0):w=self;let T=Lg.exports,P=c0,M=YV,z=JV,G=Dc.isObject,Y=Dc.mixin,B=Dc.hasOwn,he=ez,se=rz;function ne(){}d.exports=function(Me,qe){return typeof qe=="function"?new u.Request("GET",Me).end(qe):arguments.length===1?new u.Request("GET",Me):new u.Request(Me,qe)};let oe=u=d.exports;u.Request=ge,oe.getXHR=()=>{if(w.XMLHttpRequest)return new w.XMLHttpRequest;throw new Error("Browser-only version of superagent could not find XHR")};let ue="".trim?Me=>Me.trim():Me=>Me.replace(/(^\s*|\s*$)/g,"");function Ce(Me){if(!G(Me))return Me;let qe=[];for(let ve in Me)B(Me,ve)&&Xe(qe,ve,Me[ve]);return qe.join("&")}function Xe(Me,qe,ve){if(ve!==void 0)if(ve!==null)if(Array.isArray(ve)){var ot,je=p(ve);try{for(je.s();!(ot=je.n()).done;)Xe(Me,qe,ot.value)}catch(Je){je.e(Je)}finally{je.f()}}else if(G(ve))for(let Je in ve)B(ve,Je)&&Xe(Me,`${qe}[${Je}]`,ve[Je]);else Me.push(encodeURI(qe)+"="+encodeURIComponent(ve));else Me.push(encodeURI(qe))}function it(Me){let qe={},ve=Me.split("&"),ot,je;for(let Je=0,nt=ve.length;Je<nt;++Je)ot=ve[Je],je=ot.indexOf("="),je===-1?qe[decodeURIComponent(ot)]="":qe[decodeURIComponent(ot.slice(0,je))]=decodeURIComponent(ot.slice(je+1));return qe}function ut(Me){return/[/+]json($|[^-\w])/i.test(Me)}function rt(Me){this.req=Me,this.xhr=this.req.xhr,this.text=this.req.method!=="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||this.xhr.responseType===void 0?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText;let qe=this.xhr.status;qe===1223&&(qe=204),this._setStatusProperties(qe),this.headers=function(ve){let ot=ve.split(/\r?\n/),je={},Je,nt,gt,wr;for(let Di=0,Li=ot.length;Di<Li;++Di)nt=ot[Di],Je=nt.indexOf(":"),Je!==-1&&(gt=nt.slice(0,Je).toLowerCase(),wr=ue(nt.slice(Je+1)),je[gt]=wr);return je}(this.xhr.getAllResponseHeaders()),this.header=this.headers,this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.text===null&&Me._responseType?this.body=this.xhr.response:this.body=this.req.method==="HEAD"?null:this._parseBody(this.text?this.text:this.xhr.response)}function ge(Me,qe){let ve=this;this._query=this._query||[],this.method=Me,this.url=qe,this.header={},this._header={},this.on("end",()=>{let ot,je=null,Je=null;try{Je=new rt(ve)}catch(nt){return je=new Error("Parser is unable to parse the response"),je.parse=!0,je.original=nt,ve.xhr?(je.rawResponse=ve.xhr.responseType===void 0?ve.xhr.responseText:ve.xhr.response,je.status=ve.xhr.status?ve.xhr.status:null,je.statusCode=je.status):(je.rawResponse=null,je.status=null),ve.callback(je)}ve.emit("response",Je);try{ve._isResponseOK(Je)||(ot=new Error(Je.statusText||Je.text||"Unsuccessful HTTP response"))}catch(nt){ot=nt}ot?(ot.original=je,ot.response=Je,ot.status=ot.status||Je.status,ve.callback(ot,Je)):ve.callback(null,Je)})}oe.serializeObject=Ce,oe.parseString=it,oe.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},oe.serialize={"application/x-www-form-urlencoded":M.stringify,"application/json":P},oe.parse={"application/x-www-form-urlencoded":it,"application/json":JSON.parse},Y(rt.prototype,he.prototype),rt.prototype._parseBody=function(Me){let qe=oe.parse[this.type];return this.req._parser?this.req._parser(this,Me):(!qe&&ut(this.type)&&(qe=oe.parse["application/json"]),qe&&Me&&(Me.length>0||Me instanceof Object)?qe(Me):null)},rt.prototype.toError=function(){let Me=this.req,qe=Me.method,ve=Me.url,ot=`cannot ${qe} ${ve} (${this.status})`,je=new Error(ot);return je.status=this.status,je.method=qe,je.url=ve,je},oe.Response=rt,T(ge.prototype),Y(ge.prototype,z.prototype),ge.prototype.type=function(Me){return this.set("Content-Type",oe.types[Me]||Me),this},ge.prototype.accept=function(Me){return this.set("Accept",oe.types[Me]||Me),this},ge.prototype.auth=function(Me,qe,ve){arguments.length===1&&(qe=""),typeof qe=="object"&&qe!==null&&(ve=qe,qe=""),ve||(ve={type:typeof btoa=="function"?"basic":"auto"});let ot=ve.encoder?ve.encoder:je=>{if(typeof btoa=="function")return btoa(je);throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(Me,qe,ve,ot)},ge.prototype.query=function(Me){return typeof Me!="string"&&(Me=Ce(Me)),Me&&this._query.push(Me),this},ge.prototype.attach=function(Me,qe,ve){if(qe){if(this._data)throw new Error("superagent can't mix .send() and .attach()");this._getFormData().append(Me,qe,ve||qe.name)}return this},ge.prototype._getFormData=function(){return this._formData||(this._formData=new w.FormData),this._formData},ge.prototype.callback=function(Me,qe){if(this._shouldRetry(Me,qe))return this._retry();let ve=this._callback;this.clearTimeout(),Me&&(this._maxRetries&&(Me.retries=this._retries-1),this.emit("error",Me)),ve(Me,qe)},ge.prototype.crossDomainError=function(){let Me=new Error(`Request has been terminated
Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.`);Me.crossDomain=!0,Me.status=this.status,Me.method=this.method,Me.url=this.url,this.callback(Me)},ge.prototype.agent=function(){return console.warn("This is not supported in browser version of superagent"),this},ge.prototype.ca=ge.prototype.agent,ge.prototype.buffer=ge.prototype.ca,ge.prototype.write=()=>{throw new Error("Streaming is not supported in browser version of superagent")},ge.prototype.pipe=ge.prototype.write,ge.prototype._isHost=function(Me){return Me&&typeof Me=="object"&&!Array.isArray(Me)&&Object.prototype.toString.call(Me)!=="[object Object]"},ge.prototype.end=function(Me){this._endCalled&&console.warn("Warning: .end() was called twice. This is not supported in superagent"),this._endCalled=!0,this._callback=Me||ne,this._finalizeQueryString(),this._end()},ge.prototype._setUploadTimeout=function(){let Me=this;this._uploadTimeout&&!this._uploadTimeoutTimer&&(this._uploadTimeoutTimer=setTimeout(()=>{Me._timeoutError("Upload timeout of ",Me._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout))},ge.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));let Me=this;this.xhr=oe.getXHR();let qe=this.xhr,ve=this._formData||this._data;this._setTimeouts(),qe.addEventListener("readystatechange",()=>{let je=qe.readyState;if(je>=2&&Me._responseTimeoutTimer&&clearTimeout(Me._responseTimeoutTimer),je!==4)return;let Je;try{Je=qe.status}catch{Je=0}if(!Je)return Me.timedout||Me._aborted?void 0:Me.crossDomainError();Me.emit("end")});let ot=(je,Je)=>{Je.total>0&&(Je.percent=Je.loaded/Je.total*100,Je.percent===100&&clearTimeout(Me._uploadTimeoutTimer)),Je.direction=je,Me.emit("progress",Je)};if(this.hasListeners("progress"))try{qe.addEventListener("progress",ot.bind(null,"download")),qe.upload&&qe.upload.addEventListener("progress",ot.bind(null,"upload"))}catch{}qe.upload&&this._setUploadTimeout();try{this.username&&this.password?qe.open(this.method,this.url,!0,this.username,this.password):qe.open(this.method,this.url,!0)}catch(je){return this.callback(je)}if(this._withCredentials&&(qe.withCredentials=!0),!this._formData&&this.method!=="GET"&&this.method!=="HEAD"&&typeof ve!="string"&&!this._isHost(ve)){let je=this._header["content-type"],Je=this._serializer||oe.serialize[je?je.split(";")[0]:""];!Je&&ut(je)&&(Je=oe.serialize["application/json"]),Je&&(ve=Je(ve))}for(let je in this.header)this.header[je]!==null&&B(this.header,je)&&qe.setRequestHeader(je,this.header[je]);this._responseType&&(qe.responseType=this._responseType),this.emit("request",this),qe.send(ve===void 0?null:ve)},oe.agent=()=>new se;for(var Be=0,Pe=["GET","POST","OPTIONS","PATCH","PUT","DELETE"];Be<Pe.length;Be++){let Me=Pe[Be];se.prototype[Me.toLowerCase()]=function(qe,ve){let ot=new oe.Request(Me,qe);return this._setDefaults(ot),ve&&ot.end(ve),ot}}function et(Me,qe,ve){let ot=oe("DELETE",Me);return typeof qe=="function"&&(ve=qe,qe=null),qe&&ot.send(qe),ve&&ot.end(ve),ot}se.prototype.del=se.prototype.delete,oe.get=(Me,qe,ve)=>{let ot=oe("GET",Me);return typeof qe=="function"&&(ve=qe,qe=null),qe&&ot.query(qe),ve&&ot.end(ve),ot},oe.head=(Me,qe,ve)=>{let ot=oe("HEAD",Me);return typeof qe=="function"&&(ve=qe,qe=null),qe&&ot.query(qe),ve&&ot.end(ve),ot},oe.options=(Me,qe,ve)=>{let ot=oe("OPTIONS",Me);return typeof qe=="function"&&(ve=qe,qe=null),qe&&ot.send(qe),ve&&ot.end(ve),ot},oe.del=et,oe.delete=et,oe.patch=(Me,qe,ve)=>{let ot=oe("PATCH",Me);return typeof qe=="function"&&(ve=qe,qe=null),qe&&ot.send(qe),ve&&ot.end(ve),ot},oe.post=(Me,qe,ve)=>{let ot=oe("POST",Me);return typeof qe=="function"&&(ve=qe,qe=null),qe&&ot.send(qe),ve&&ot.end(ve),ot},oe.put=(Me,qe,ve)=>{let ot=oe("PUT",Me);return typeof qe=="function"&&(ve=qe,qe=null),qe&&ot.send(qe),ve&&ot.end(ve),ot}})(Bf,Bf.exports);var Xl=Bf.exports;function iz(d){var u=new Date().getTime(),p=new Date().toISOString(),v=console&&console.log?console:window&&window.console&&window.console.log?window.console:console;v.log("<<<<<"),v.log("[".concat(p,"]"),`
`,d.url,`
`,d.qs),v.log("-----"),d.on("response",function(w){var T=new Date().getTime()-u,P=new Date().toISOString();v.log(">>>>>>"),v.log("[".concat(P," / ").concat(T,"]"),`
`,d.url,`
`,d.qs,`
`,w.text),v.log("-----")})}function Jf(d,u,p){var v=this;this._config.logVerbosity&&(d=d.use(iz)),this._config.proxy&&this._modules.proxy&&(d=this._modules.proxy.call(this,d)),this._config.keepAlive&&this._modules.keepAlive&&(d=this._modules.keepAlive(d));var w=d;if(u.abortSignal)var T=u.abortSignal.subscribe(function(){w.abort(),T()});return u.forceBuffered===!0?w=typeof Blob>"u"?w.buffer().responseType("arraybuffer"):w.responseType("arraybuffer"):u.forceBuffered===!1&&(w=w.buffer(!1)),(w=w.timeout(u.timeout)).on("abort",function(){return p({category:Ue.PNUnknownCategory,error:!0,operation:u.operation,errorData:new Error("Aborted")},null)}),w.end(function(P,M){var z,G={};if(G.error=P!==null,G.operation=u.operation,M&&M.status&&(G.statusCode=M.status),P){if(P.response&&P.response.text&&!v._config.logVerbosity)try{G.errorData=JSON.parse(P.response.text)}catch{G.errorData=P}else G.errorData=P;return G.category=v._detectErrorCategory(P),p(G,null)}if(u.ignoreBody)z={headers:M.headers,redirects:M.redirects,response:M};else try{z=JSON.parse(M.text)}catch{return G.errorData=M,G.error=!0,p(G,null)}return z.error&&z.error===1&&z.status&&z.message&&z.service?(G.errorData=z,G.statusCode=z.status,G.error=!0,G.category=v._detectErrorCategory(G),p(G,null)):(z.error&&z.error.message&&(G.errorData=z.error),p(G,z))}),w}function nz(d,u,p){return i(this,void 0,void 0,function(){var v;return a(this,function(w){switch(w.label){case 0:return v=Xl.post(d),u.forEach(function(T){var P=T.key,M=T.value;v=v.field(P,M)}),v.attach("file",p,{contentType:"application/octet-stream"}),[4,v];case 1:return[2,w.sent()]}})})}function az(d,u,p){var v=Xl.get(this.getStandardOrigin()+u.url).set(u.headers).query(d);return Jf.call(this,v,u,p)}function sz(d,u,p){var v=Xl.get(this.getStandardOrigin()+u.url).set(u.headers).query(d);return Jf.call(this,v,u,p)}function oz(d,u,p,v){var w=Xl.post(this.getStandardOrigin()+p.url).query(d).set(p.headers).send(u);return Jf.call(this,w,p,v)}function uz(d,u,p,v){var w=Xl.patch(this.getStandardOrigin()+p.url).query(d).set(p.headers).send(u);return Jf.call(this,w,p,v)}function cz(d,u,p){var v=Xl.delete(this.getStandardOrigin()+u.url).set(u.headers).query(d);return Jf.call(this,v,u,p)}function DA(d,u){var p=new Uint8Array(d.byteLength+u.byteLength);return p.set(new Uint8Array(d),0),p.set(new Uint8Array(u),d.byteLength),p.buffer}var uo,LA=function(){function d(){}return Object.defineProperty(d.prototype,"algo",{get:function(){return"aes-256-cbc"},enumerable:!1,configurable:!0}),d.prototype.encrypt=function(u,p){return i(this,void 0,void 0,function(){var v;return a(this,function(w){switch(w.label){case 0:return[4,this.getKey(u)];case 1:if(v=w.sent(),p instanceof ArrayBuffer)return[2,this.encryptArrayBuffer(v,p)];if(typeof p=="string")return[2,this.encryptString(v,p)];throw new Error("Cannot encrypt this file. In browsers file encryption supports only string or ArrayBuffer")}})})},d.prototype.decrypt=function(u,p){return i(this,void 0,void 0,function(){var v;return a(this,function(w){switch(w.label){case 0:return[4,this.getKey(u)];case 1:if(v=w.sent(),p instanceof ArrayBuffer)return[2,this.decryptArrayBuffer(v,p)];if(typeof p=="string")return[2,this.decryptString(v,p)];throw new Error("Cannot decrypt this file. In browsers file decryption supports only string or ArrayBuffer")}})})},d.prototype.encryptFile=function(u,p,v){return i(this,void 0,void 0,function(){var w,T,P;return a(this,function(M){switch(M.label){case 0:if(p.data.byteLength<=0)throw new Error("encryption error. empty content");return[4,this.getKey(u)];case 1:return w=M.sent(),[4,p.data.arrayBuffer()];case 2:return T=M.sent(),[4,this.encryptArrayBuffer(w,T)];case 3:return P=M.sent(),[2,v.create({name:p.name,mimeType:"application/octet-stream",data:P})]}})})},d.prototype.decryptFile=function(u,p,v){return i(this,void 0,void 0,function(){var w,T,P;return a(this,function(M){switch(M.label){case 0:return[4,this.getKey(u)];case 1:return w=M.sent(),[4,p.data.arrayBuffer()];case 2:return T=M.sent(),[4,this.decryptArrayBuffer(w,T)];case 3:return P=M.sent(),[2,v.create({name:p.name,data:P})]}})})},d.prototype.getKey=function(u){return i(this,void 0,void 0,function(){var p,v,w;return a(this,function(T){switch(T.label){case 0:return[4,crypto.subtle.digest("SHA-256",d.encoder.encode(u))];case 1:return p=T.sent(),v=Array.from(new Uint8Array(p)).map(function(P){return P.toString(16).padStart(2,"0")}).join(""),w=d.encoder.encode(v.slice(0,32)).buffer,[2,crypto.subtle.importKey("raw",w,"AES-CBC",!0,["encrypt","decrypt"])]}})})},d.prototype.encryptArrayBuffer=function(u,p){return i(this,void 0,void 0,function(){var v,w,T;return a(this,function(P){switch(P.label){case 0:return v=crypto.getRandomValues(new Uint8Array(16)),w=DA,T=[v.buffer],[4,crypto.subtle.encrypt({name:"AES-CBC",iv:v},u,p)];case 1:return[2,w.apply(void 0,T.concat([P.sent()]))]}})})},d.prototype.decryptArrayBuffer=function(u,p){return i(this,void 0,void 0,function(){var v;return a(this,function(w){switch(w.label){case 0:if(v=p.slice(0,16),p.slice(d.IV_LENGTH).byteLength<=0)throw new Error("decryption error: empty content");return[4,crypto.subtle.decrypt({name:"AES-CBC",iv:v},u,p.slice(d.IV_LENGTH))];case 1:return[2,w.sent()]}})})},d.prototype.encryptString=function(u,p){return i(this,void 0,void 0,function(){var v,w,T,P;return a(this,function(M){switch(M.label){case 0:return v=crypto.getRandomValues(new Uint8Array(16)),w=d.encoder.encode(p).buffer,[4,crypto.subtle.encrypt({name:"AES-CBC",iv:v},u,w)];case 1:return T=M.sent(),P=DA(v.buffer,T),[2,d.decoder.decode(P)]}})})},d.prototype.decryptString=function(u,p){return i(this,void 0,void 0,function(){var v,w,T,P;return a(this,function(M){switch(M.label){case 0:return v=d.encoder.encode(p).buffer,w=v.slice(0,16),T=v.slice(16),[4,crypto.subtle.decrypt({name:"AES-CBC",iv:w},u,T)];case 1:return P=M.sent(),[2,d.decoder.decode(P)]}})})},d.IV_LENGTH=16,d.encoder=new TextEncoder,d.decoder=new TextDecoder,d}(),lz=(uo=function(){function d(u){if(u instanceof File)this.data=u,this.name=this.data.name,this.mimeType=this.data.type;else if(u.data){var p=u.data;this.data=new File([p],u.name,{type:u.mimeType}),this.name=u.name,u.mimeType&&(this.mimeType=u.mimeType)}if(this.data===void 0)throw new Error("Couldn't construct a file out of supplied options.");if(this.name===void 0)throw new Error("Couldn't guess filename out of the options. Please provide one.")}return d.create=function(u){return new this(u)},d.prototype.toBuffer=function(){return i(this,void 0,void 0,function(){return a(this,function(u){throw new Error("This feature is only supported in Node.js environments.")})})},d.prototype.toStream=function(){return i(this,void 0,void 0,function(){return a(this,function(u){throw new Error("This feature is only supported in Node.js environments.")})})},d.prototype.toFileUri=function(){return i(this,void 0,void 0,function(){return a(this,function(u){throw new Error("This feature is only supported in react native environments.")})})},d.prototype.toBlob=function(){return i(this,void 0,void 0,function(){return a(this,function(u){return[2,this.data]})})},d.prototype.toArrayBuffer=function(){return i(this,void 0,void 0,function(){var u=this;return a(this,function(p){return[2,new Promise(function(v,w){var T=new FileReader;T.addEventListener("load",function(){if(T.result instanceof ArrayBuffer)return v(T.result)}),T.addEventListener("error",function(){w(T.error)}),T.readAsArrayBuffer(u.data)})]})})},d.prototype.toString=function(){return i(this,void 0,void 0,function(){var u=this;return a(this,function(p){return[2,new Promise(function(v,w){var T=new FileReader;T.addEventListener("load",function(){if(typeof T.result=="string")return v(T.result)}),T.addEventListener("error",function(){w(T.error)}),T.readAsBinaryString(u.data)})]})})},d.prototype.toFile=function(){return i(this,void 0,void 0,function(){return a(this,function(u){return[2,this.data]})})},d}(),uo.supportsFile=typeof File<"u",uo.supportsBlob=typeof Blob<"u",uo.supportsArrayBuffer=typeof ArrayBuffer<"u",uo.supportsBuffer=!1,uo.supportsStream=!1,uo.supportsString=!0,uo.supportsEncryptFile=!0,uo.supportsFileUri=!1,uo),D0=function(){function d(u){this.config=u,this.cryptor=new Re({config:u}),this.fileCryptor=new LA}return Object.defineProperty(d.prototype,"identifier",{get:function(){return""},enumerable:!1,configurable:!0}),d.prototype.encrypt=function(u){var p=typeof u=="string"?u:new TextDecoder().decode(u);return{data:this.cryptor.encrypt(p),metadata:null}},d.prototype.decrypt=function(u){var p=typeof u.data=="string"?u.data:J(u.data);return this.cryptor.decrypt(p)},d.prototype.encryptFile=function(u,p){var v;return i(this,void 0,void 0,function(){return a(this,function(w){return[2,this.fileCryptor.encryptFile((v=this.config)===null||v===void 0?void 0:v.cipherKey,u,p)]})})},d.prototype.decryptFile=function(u,p){return i(this,void 0,void 0,function(){return a(this,function(v){return[2,this.fileCryptor.decryptFile(this.config.cipherKey,u,p)]})})},d}(),L0=function(){function d(u){this.cipherKey=u.cipherKey,this.CryptoJS=ie,this.encryptedKey=this.CryptoJS.SHA256(this.cipherKey)}return Object.defineProperty(d.prototype,"algo",{get:function(){return"AES-CBC"},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"identifier",{get:function(){return"ACRH"},enumerable:!1,configurable:!0}),d.prototype.getIv=function(){return crypto.getRandomValues(new Uint8Array(d.BLOCK_SIZE))},d.prototype.getKey=function(){return i(this,void 0,void 0,function(){var u,p;return a(this,function(v){switch(v.label){case 0:return u=d.encoder.encode(this.cipherKey),[4,crypto.subtle.digest("SHA-256",u.buffer)];case 1:return p=v.sent(),[2,crypto.subtle.importKey("raw",p,this.algo,!0,["encrypt","decrypt"])]}})})},d.prototype.encrypt=function(u){if((typeof u=="string"?u:d.decoder.decode(u)).length===0)throw new Error("encryption error. empty content");var p=this.getIv();return{metadata:p,data:F(this.CryptoJS.AES.encrypt(u,this.encryptedKey,{iv:this.bufferToWordArray(p),mode:this.CryptoJS.mode.CBC}).ciphertext.toString(this.CryptoJS.enc.Base64))}},d.prototype.decrypt=function(u){var p=this.bufferToWordArray(new Uint8ClampedArray(u.metadata)),v=this.bufferToWordArray(new Uint8ClampedArray(u.data));return d.encoder.encode(this.CryptoJS.AES.decrypt({ciphertext:v},this.encryptedKey,{iv:p,mode:this.CryptoJS.mode.CBC}).toString(this.CryptoJS.enc.Utf8)).buffer},d.prototype.encryptFileData=function(u){return i(this,void 0,void 0,function(){var p,v,w;return a(this,function(T){switch(T.label){case 0:return[4,this.getKey()];case 1:return p=T.sent(),v=this.getIv(),w={},[4,crypto.subtle.encrypt({name:this.algo,iv:v},p,u)];case 2:return[2,(w.data=T.sent(),w.metadata=v,w)]}})})},d.prototype.decryptFileData=function(u){return i(this,void 0,void 0,function(){var p;return a(this,function(v){switch(v.label){case 0:return[4,this.getKey()];case 1:return p=v.sent(),[2,crypto.subtle.decrypt({name:this.algo,iv:u.metadata},p,u.data)]}})})},d.prototype.bufferToWordArray=function(u){var p,v=[];for(p=0;p<u.length;p+=1)v[p/4|0]|=u[p]<<24-8*p;return this.CryptoJS.lib.WordArray.create(v,u.length)},d.BLOCK_SIZE=16,d.encoder=new TextEncoder,d.decoder=new TextDecoder,d}(),NA=function(){function d(u){var p;this.defaultCryptor=u.default,this.cryptors=(p=u.cryptors)!==null&&p!==void 0?p:[]}return d.legacyCryptoModule=function(u){var p;return new this({default:new D0({cipherKey:u.cipherKey,useRandomIVs:(p=u.useRandomIVs)===null||p===void 0||p}),cryptors:[new L0({cipherKey:u.cipherKey})]})},d.aesCbcCryptoModule=function(u){var p;return new this({default:new L0({cipherKey:u.cipherKey}),cryptors:[new D0({cipherKey:u.cipherKey,useRandomIVs:(p=u.useRandomIVs)===null||p===void 0||p})]})},d.withDefaultCryptor=function(u){return new this({default:u})},d.prototype.getAllCryptors=function(){return c([this.defaultCryptor],o(this.cryptors),!1)},d.prototype.encrypt=function(u){var p=this.defaultCryptor.encrypt(u);if(!p.metadata)return p.data;var v=this.getHeaderData(p);return this.concatArrayBuffer(v,p.data)},d.prototype.decrypt=function(u){var p=typeof u=="string"?F(u):u,v=co.tryParse(p),w=this.getCryptor(v),T=v.length>0?p.slice(v.length-v.metadataLength,v.length):null;if(p.slice(v.length).byteLength<=0)throw new Error("decryption error. empty content");return w.decrypt({data:p.slice(v.length),metadata:T})},d.prototype.encryptFile=function(u,p){return i(this,void 0,void 0,function(){var v,w;return a(this,function(T){switch(T.label){case 0:return this.defaultCryptor.identifier===co.LEGACY_IDENTIFIER?[2,this.defaultCryptor.encryptFile(u,p)]:[4,this.getFileData(u.data)];case 1:return v=T.sent(),[4,this.defaultCryptor.encryptFileData(v)];case 2:return w=T.sent(),[2,p.create({name:u.name,mimeType:"application/octet-stream",data:this.concatArrayBuffer(this.getHeaderData(w),w.data)})]}})})},d.prototype.decryptFile=function(u,p){return i(this,void 0,void 0,function(){var v,w,T,P,M,z,G,Y;return a(this,function(B){switch(B.label){case 0:return[4,u.data.arrayBuffer()];case 1:return v=B.sent(),w=co.tryParse(v),((T=this.getCryptor(w))==null?void 0:T.identifier)===d.LEGACY_IDENTIFIER?[2,T.decryptFile(u,p)]:[4,this.getFileData(v)];case 2:return P=B.sent(),M=P.slice(w.length-w.metadataLength,w.length),G=(z=p).create,Y={name:u.name},[4,this.defaultCryptor.decryptFileData({data:v.slice(w.length),metadata:M})];case 3:return[2,G.apply(z,[(Y.data=B.sent(),Y)])]}})})},d.prototype.getCryptor=function(u){if(u===""){var p=this.getAllCryptors().find(function(v){return v.identifier===""});if(p)return p;throw new Error("unknown cryptor error")}if(u instanceof N0)return this.getCryptorFromId(u.identifier)},d.prototype.getCryptorFromId=function(u){var p=this.getAllCryptors().find(function(v){return u===v.identifier});if(p)return p;throw Error("unknown cryptor error")},d.prototype.concatArrayBuffer=function(u,p){var v=new Uint8Array(u.byteLength+p.byteLength);return v.set(new Uint8Array(u),0),v.set(new Uint8Array(p),u.byteLength),v.buffer},d.prototype.getHeaderData=function(u){if(u.metadata){var p=co.from(this.defaultCryptor.identifier,u.metadata),v=new Uint8Array(p.length),w=0;return v.set(p.data,w),w+=p.length-u.metadata.byteLength,v.set(new Uint8Array(u.metadata),w),v.buffer}},d.prototype.getFileData=function(u){return i(this,void 0,void 0,function(){return a(this,function(p){switch(p.label){case 0:return u instanceof Blob?[4,u.arrayBuffer()]:[3,2];case 1:return[2,p.sent()];case 2:if(u instanceof ArrayBuffer)return[2,u];if(typeof u=="string")return[2,d.encoder.encode(u)];throw new Error("Cannot decrypt/encrypt file. In browsers file encrypt/decrypt supported for string, ArrayBuffer or Blob")}})})},d.LEGACY_IDENTIFIER="",d.encoder=new TextEncoder,d.decoder=new TextDecoder,d}(),co=function(){function d(){}return d.from=function(u,p){if(u!==d.LEGACY_IDENTIFIER)return new N0(u,p.byteLength)},d.tryParse=function(u){var p=new Uint8Array(u),v="";if(p.byteLength>=4&&(v=p.slice(0,4),this.decoder.decode(v)!==d.SENTINEL))return"";if(!(p.byteLength>=5))throw new Error("decryption error. invalid header version");if(p[4]>d.MAX_VERSION)throw new Error("unknown cryptor error");var w="",T=5+d.IDENTIFIER_LENGTH;if(!(p.byteLength>=T))throw new Error("decryption error. invalid crypto identifier");w=p.slice(5,T);var P=null;if(!(p.byteLength>=T+1))throw new Error("decryption error. invalid metadata length");return P=p[T],T+=1,P===255&&p.byteLength>=T+2&&(P=new Uint16Array(p.slice(T,T+2)).reduce(function(M,z){return(M<<8)+z},0),T+=2),new N0(this.decoder.decode(w),P)},d.SENTINEL="PNED",d.LEGACY_IDENTIFIER="",d.IDENTIFIER_LENGTH=4,d.VERSION=1,d.MAX_VERSION=1,d.decoder=new TextDecoder,d}(),N0=function(){function d(u,p){this._identifier=u,this._metadataLength=p}return Object.defineProperty(d.prototype,"identifier",{get:function(){return this._identifier},set:function(u){this._identifier=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"metadataLength",{get:function(){return this._metadataLength},set:function(u){this._metadataLength=u},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"version",{get:function(){return co.VERSION},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"length",{get:function(){return co.SENTINEL.length+1+co.IDENTIFIER_LENGTH+(this.metadataLength<255?1:3)+this.metadataLength},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"data",{get:function(){var u=0,p=new Uint8Array(this.length),v=new TextEncoder;p.set(v.encode(co.SENTINEL)),p[u+=co.SENTINEL.length]=this.version,u++,this.identifier&&p.set(v.encode(this.identifier),u),u+=co.IDENTIFIER_LENGTH;var w=this.metadataLength;return w<255?p[u]=w:p.set([255,w>>8,255&w],u),p},enumerable:!1,configurable:!0}),d.IDENTIFIER_LENGTH=4,d.SENTINEL="PNED",d}();function dz(d){if(!navigator||!navigator.sendBeacon)return!1;navigator.sendBeacon(d)}var fz=function(d){function u(p){var v=this,w=p.listenToBrowserNetworkEvents,T=w===void 0||w;return p.sdkFamily="Web",p.networking=new Dg({del:cz,get:sz,post:oz,patch:uz,sendBeacon:dz,getfile:az,postfile:nz}),p.cbor=new Ic(function(P){return Mu(m.decode(P))},F),p.PubNubFile=lz,p.cryptography=new LA,p.initCryptoModule=function(P){return new NA({default:new D0({cipherKey:P.cipherKey,useRandomIVs:P.useRandomIVs}),cryptors:[new L0({cipherKey:P.cipherKey})]})},v=d.call(this,p)||this,T&&(window.addEventListener("offline",function(){v.networkDownDetected()}),window.addEventListener("online",function(){v.networkUpDetected()})),v}return e(u,d),u.CryptoModule=NA,u}(Rg);return fz})});var R4=D((ib,P4)=>{(function(t,e){typeof ib=="object"&&typeof P4<"u"?e(ib):typeof define=="function"&&define.amd?define(["exports"],e):(t=t||self,e(t.Diff={}))})(ib,function(t){"use strict";function e(){}e.prototype={diff:function(te,be){var De=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},dt=De.callback;typeof De=="function"&&(dt=De,De={}),this.options=De;var K=this;function le(Nt){return dt?(setTimeout(function(){dt(void 0,Nt)},0),!0):Nt}te=this.castInput(te),be=this.castInput(be),te=this.removeEmpty(this.tokenize(te)),be=this.removeEmpty(this.tokenize(be));var U=be.length,Ne=te.length,Ye=1,ft=U+Ne,kt=[{newPos:-1,components:[]}],Et=this.extractCommon(kt[0],be,te,0);if(kt[0].newPos+1>=U&&Et+1>=Ne)return le([{value:this.join(be),count:be.length}]);function Ie(){for(var Nt=-1*Ye;Nt<=Ye;Nt+=2){var Ot=void 0,qr=kt[Nt-1],er=kt[Nt+1],hi=(er?er.newPos:0)-Nt;qr&&(kt[Nt-1]=void 0);var mr=qr&&qr.newPos+1<U,zr=er&&0<=hi&&hi<Ne;if(!mr&&!zr){kt[Nt]=void 0;continue}if(!mr||zr&&qr.newPos<er.newPos?(Ot=n(er),K.pushComponent(Ot.components,void 0,!0)):(Ot=qr,Ot.newPos++,K.pushComponent(Ot.components,!0,void 0)),hi=K.extractCommon(Ot,be,te,Nt),Ot.newPos+1>=U&&hi+1>=Ne)return le(r(K,Ot.components,be,te,K.useLongestToken));kt[Nt]=Ot}Ye++}if(dt)(function Nt(){setTimeout(function(){if(Ye>ft)return dt();Ie()||Nt()},0)})();else for(;Ye<=ft;){var Jt=Ie();if(Jt)return Jt}},pushComponent:function(te,be,De){var dt=te[te.length-1];dt&&dt.added===be&&dt.removed===De?te[te.length-1]={count:dt.count+1,added:be,removed:De}:te.push({count:1,added:be,removed:De})},extractCommon:function(te,be,De,dt){for(var K=be.length,le=De.length,U=te.newPos,Ne=U-dt,Ye=0;U+1<K&&Ne+1<le&&this.equals(be[U+1],De[Ne+1]);)U++,Ne++,Ye++;return Ye&&te.components.push({count:Ye}),te.newPos=U,Ne},equals:function(te,be){return this.options.comparator?this.options.comparator(te,be):te===be||this.options.ignoreCase&&te.toLowerCase()===be.toLowerCase()},removeEmpty:function(te){for(var be=[],De=0;De<te.length;De++)te[De]&&be.push(te[De]);return be},castInput:function(te){return te},tokenize:function(te){return te.split("")},join:function(te){return te.join("")}};function r(re,te,be,De,dt){for(var K=0,le=te.length,U=0,Ne=0;K<le;K++){var Ye=te[K];if(Ye.removed){if(Ye.value=re.join(De.slice(Ne,Ne+Ye.count)),Ne+=Ye.count,K&&te[K-1].added){var kt=te[K-1];te[K-1]=te[K],te[K]=kt}}else{if(!Ye.added&&dt){var ft=be.slice(U,U+Ye.count);ft=ft.map(function(Ie,Jt){var Nt=De[Ne+Jt];return Nt.length>Ie.length?Nt:Ie}),Ye.value=re.join(ft)}else Ye.value=re.join(be.slice(U,U+Ye.count));U+=Ye.count,Ye.added||(Ne+=Ye.count)}}var Et=te[le-1];return le>1&&typeof Et.value=="string"&&(Et.added||Et.removed)&&re.equals("",Et.value)&&(te[le-2].value+=Et.value,te.pop()),te}function n(re){return{newPos:re.newPos,components:re.components.slice(0)}}var i=new e;function a(re,te,be){return i.diff(re,te,be)}function s(re,te){if(typeof re=="function")te.callback=re;else if(re)for(var be in re)re.hasOwnProperty(be)&&(te[be]=re[be]);return te}var o=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,c=/\S/,l=new e;l.equals=function(re,te){return this.options.ignoreCase&&(re=re.toLowerCase(),te=te.toLowerCase()),re===te||this.options.ignoreWhitespace&&!c.test(re)&&!c.test(te)},l.tokenize=function(re){for(var te=re.split(/(\s+|[()[\]{}'"]|\b)/),be=0;be<te.length-1;be++)!te[be+1]&&te[be+2]&&o.test(te[be])&&o.test(te[be+2])&&(te[be]+=te[be+2],te.splice(be+1,2),be--);return te};function f(re,te,be){return be=s(be,{ignoreWhitespace:!0}),l.diff(re,te,be)}function g(re,te,be){return l.diff(re,te,be)}var m=new e;m.tokenize=function(re){var te=[],be=re.split(/(\n|\r\n)/);be[be.length-1]||be.pop();for(var De=0;De<be.length;De++){var dt=be[De];De%2&&!this.options.newlineIsToken?te[te.length-1]+=dt:(this.options.ignoreWhitespace&&(dt=dt.trim()),te.push(dt))}return te};function y(re,te,be){return m.diff(re,te,be)}function A(re,te,be){var De=s(be,{ignoreWhitespace:!0});return m.diff(re,te,De)}var k=new e;k.tokenize=function(re){return re.split(/(\S.+?[.!?])(?=\s+|$)/)};function I(re,te,be){return k.diff(re,te,be)}var F=new e;F.tokenize=function(re){return re.split(/([{}:;,]|\s+)/)};function J(re,te,be){return F.diff(re,te,be)}function pe(re){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pe=function(te){return typeof te}:pe=function(te){return te&&typeof Symbol=="function"&&te.constructor===Symbol&&te!==Symbol.prototype?"symbol":typeof te},pe(re)}function L(re){return H(re)||j(re)||X()}function H(re){if(Array.isArray(re)){for(var te=0,be=new Array(re.length);te<re.length;te++)be[te]=re[te];return be}}function j(re){if(Symbol.iterator in Object(re)||Object.prototype.toString.call(re)==="[object Arguments]")return Array.from(re)}function X(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var V=Object.prototype.toString,ie=new e;ie.useLongestToken=!0,ie.tokenize=m.tokenize,ie.castInput=function(re){var te=this.options,be=te.undefinedReplacement,De=te.stringifyReplacer,dt=De===void 0?function(K,le){return typeof le>"u"?be:le}:De;return typeof re=="string"?re:JSON.stringify(Re(re,null,null,dt),dt,"  ")},ie.equals=function(re,te){return e.prototype.equals.call(ie,re.replace(/,([\r\n])/g,"$1"),te.replace(/,([\r\n])/g,"$1"))};function fe(re,te,be){return ie.diff(re,te,be)}function Re(re,te,be,De,dt){te=te||[],be=be||[],De&&(re=De(dt,re));var K;for(K=0;K<te.length;K+=1)if(te[K]===re)return be[K];var le;if(V.call(re)==="[object Array]"){for(te.push(re),le=new Array(re.length),be.push(le),K=0;K<re.length;K+=1)le[K]=Re(re[K],te,be,De,dt);return te.pop(),be.pop(),le}if(re&&re.toJSON&&(re=re.toJSON()),pe(re)==="object"&&re!==null){te.push(re),le={},be.push(le);var U=[],Ne;for(Ne in re)re.hasOwnProperty(Ne)&&U.push(Ne);for(U.sort(),K=0;K<U.length;K+=1)Ne=U[K],le[Ne]=Re(re[Ne],te,be,De,Ne);te.pop(),be.pop()}else le=re;return le}var ye=new e;ye.tokenize=function(re){return re.slice()},ye.join=ye.removeEmpty=function(re){return re};function ze(re,te,be){return ye.diff(re,te,be)}function Ue(re){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be=re.split(/\r\n|[\n\v\f\r\x85]/),De=re.match(/\r\n|[\n\v\f\r\x85]/g)||[],dt=[],K=0;function le(){var Ye={};for(dt.push(Ye);K<be.length;){var ft=be[K];if(/^(\-\-\-|\+\+\+|@@)\s/.test(ft))break;var kt=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(ft);kt&&(Ye.index=kt[1]),K++}for(U(Ye),U(Ye),Ye.hunks=[];K<be.length;){var Et=be[K];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(Et))break;if(/^@@/.test(Et))Ye.hunks.push(Ne());else{if(Et&&te.strict)throw new Error("Unknown line "+(K+1)+" "+JSON.stringify(Et));K++}}}function U(Ye){var ft=/^(---|\+\+\+)\s+(.*)$/.exec(be[K]);if(ft){var kt=ft[1]==="---"?"old":"new",Et=ft[2].split("	",2),Ie=Et[0].replace(/\\\\/g,"\\");/^".*"$/.test(Ie)&&(Ie=Ie.substr(1,Ie.length-2)),Ye[kt+"FileName"]=Ie,Ye[kt+"Header"]=(Et[1]||"").trim(),K++}}function Ne(){for(var Ye=K,ft=be[K++],kt=ft.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),Et={oldStart:+kt[1],oldLines:+kt[2]||1,newStart:+kt[3],newLines:+kt[4]||1,lines:[],linedelimiters:[]},Ie=0,Jt=0;K<be.length&&!(be[K].indexOf("--- ")===0&&K+2<be.length&&be[K+1].indexOf("+++ ")===0&&be[K+2].indexOf("@@")===0);K++){var Nt=be[K].length==0&&K!=be.length-1?" ":be[K][0];if(Nt==="+"||Nt==="-"||Nt===" "||Nt==="\\")Et.lines.push(be[K]),Et.linedelimiters.push(De[K]||`
`),Nt==="+"?Ie++:Nt==="-"?Jt++:Nt===" "&&(Ie++,Jt++);else break}if(!Ie&&Et.newLines===1&&(Et.newLines=0),!Jt&&Et.oldLines===1&&(Et.oldLines=0),te.strict){if(Ie!==Et.newLines)throw new Error("Added line count did not match for hunk at line "+(Ye+1));if(Jt!==Et.oldLines)throw new Error("Removed line count did not match for hunk at line "+(Ye+1))}return Et}for(;K<be.length;)le();return dt}function de(re,te,be){var De=!0,dt=!1,K=!1,le=1;return function U(){if(De&&!K){if(dt?le++:De=!1,re+le<=be)return le;K=!0}if(!dt)return K||(De=!0),te<=re-le?-le++:(dt=!0,U())}}function Q(re,te){var be=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof te=="string"&&(te=Ue(te)),Array.isArray(te)){if(te.length>1)throw new Error("applyPatch only works with a single input.");te=te[0]}var De=re.split(/\r\n|[\n\v\f\r\x85]/),dt=re.match(/\r\n|[\n\v\f\r\x85]/g)||[],K=te.hunks,le=be.compareLine||function(Hr,Kt,Er,ln){return Kt===ln},U=0,Ne=be.fuzzFactor||0,Ye=0,ft=0,kt,Et;function Ie(Hr,Kt){for(var Er=0;Er<Hr.lines.length;Er++){var ln=Hr.lines[Er],Pn=ln.length>0?ln[0]:" ",dn=ln.length>0?ln.substr(1):ln;if(Pn===" "||Pn==="-"){if(!le(Kt+1,De[Kt],Pn,dn)&&(U++,U>Ne))return!1;Kt++}}return!0}for(var Jt=0;Jt<K.length;Jt++){for(var Nt=K[Jt],Ot=De.length-Nt.oldLines,qr=0,er=ft+Nt.oldStart-1,hi=de(er,Ye,Ot);qr!==void 0;qr=hi())if(Ie(Nt,er+qr)){Nt.offset=ft+=qr;break}if(qr===void 0)return!1;Ye=Nt.offset+Nt.oldStart+Nt.oldLines}for(var mr=0,zr=0;zr<K.length;zr++){var Pi=K[zr],jr=Pi.oldStart+Pi.offset+mr-1;mr+=Pi.newLines-Pi.oldLines,jr<0&&(jr=0);for(var rn=0;rn<Pi.lines.length;rn++){var Yr=Pi.lines[rn],qt=Yr.length>0?Yr[0]:" ",gi=Yr.length>0?Yr.substr(1):Yr,Ai=Pi.linedelimiters[rn];if(qt===" ")jr++;else if(qt==="-")De.splice(jr,1),dt.splice(jr,1);else if(qt==="+")De.splice(jr,0,gi),dt.splice(jr,0,Ai),jr++;else if(qt==="\\"){var tr=Pi.lines[rn-1]?Pi.lines[rn-1][0]:null;tr==="+"?kt=!0:tr==="-"&&(Et=!0)}}}if(kt)for(;!De[De.length-1];)De.pop(),dt.pop();else Et&&(De.push(""),dt.push(`
`));for(var Jr=0;Jr<De.length-1;Jr++)De[Jr]=De[Jr]+dt[Jr];return De.join("")}function Fe(re,te){typeof re=="string"&&(re=Ue(re));var be=0;function De(){var dt=re[be++];if(!dt)return te.complete();te.loadFile(dt,function(K,le){if(K)return te.complete(K);var U=Q(le,dt,te);te.patched(dt,U,function(Ne){if(Ne)return te.complete(Ne);De()})})}De()}function We(re,te,be,De,dt,K,le){le||(le={}),typeof le.context>"u"&&(le.context=4);var U=y(be,De,le);U.push({value:"",lines:[]});function Ne(qr){return qr.map(function(er){return" "+er})}for(var Ye=[],ft=0,kt=0,Et=[],Ie=1,Jt=1,Nt=function(er){var hi=U[er],mr=hi.lines||hi.value.replace(/\n$/,"").split(`
`);if(hi.lines=mr,hi.added||hi.removed){var zr;if(!ft){var Pi=U[er-1];ft=Ie,kt=Jt,Pi&&(Et=le.context>0?Ne(Pi.lines.slice(-le.context)):[],ft-=Et.length,kt-=Et.length)}(zr=Et).push.apply(zr,L(mr.map(function(Jr){return(hi.added?"+":"-")+Jr}))),hi.added?Jt+=mr.length:Ie+=mr.length}else{if(ft)if(mr.length<=le.context*2&&er<U.length-2){var jr;(jr=Et).push.apply(jr,L(Ne(mr)))}else{var rn,Yr=Math.min(mr.length,le.context);(rn=Et).push.apply(rn,L(Ne(mr.slice(0,Yr))));var qt={oldStart:ft,oldLines:Ie-ft+Yr,newStart:kt,newLines:Jt-kt+Yr,lines:Et};if(er>=U.length-2&&mr.length<=le.context){var gi=/\n$/.test(be),Ai=/\n$/.test(De),tr=mr.length==0&&Et.length>qt.oldLines;!gi&&tr&&Et.splice(qt.oldLines,0,"\\ No newline at end of file"),(!gi&&!tr||!Ai)&&Et.push("\\ No newline at end of file")}Ye.push(qt),ft=0,kt=0,Et=[]}Ie+=mr.length,Jt+=mr.length}},Ot=0;Ot<U.length;Ot++)Nt(Ot);return{oldFileName:re,newFileName:te,oldHeader:dt,newHeader:K,hunks:Ye}}function tt(re,te,be,De,dt,K,le){var U=We(re,te,be,De,dt,K,le),Ne=[];re==te&&Ne.push("Index: "+re),Ne.push("==================================================================="),Ne.push("--- "+U.oldFileName+(typeof U.oldHeader>"u"?"":"	"+U.oldHeader)),Ne.push("+++ "+U.newFileName+(typeof U.newHeader>"u"?"":"	"+U.newHeader));for(var Ye=0;Ye<U.hunks.length;Ye++){var ft=U.hunks[Ye];Ne.push("@@ -"+ft.oldStart+","+ft.oldLines+" +"+ft.newStart+","+ft.newLines+" @@"),Ne.push.apply(Ne,ft.lines)}return Ne.join(`
`)+`
`}function Le(re,te,be,De,dt,K){return tt(re,re,te,be,De,dt,K)}function Tt(re,te){return re.length!==te.length?!1:It(re,te)}function It(re,te){if(te.length>re.length)return!1;for(var be=0;be<te.length;be++)if(te[be]!==re[be])return!1;return!0}function St(re){var te=lt(re.lines),be=te.oldLines,De=te.newLines;be!==void 0?re.oldLines=be:delete re.oldLines,De!==void 0?re.newLines=De:delete re.newLines}function Zt(re,te,be){re=Ze(re,be),te=Ze(te,be);var De={};(re.index||te.index)&&(De.index=re.index||te.index),(re.newFileName||te.newFileName)&&(Z(re)?Z(te)?(De.oldFileName=me(De,re.oldFileName,te.oldFileName),De.newFileName=me(De,re.newFileName,te.newFileName),De.oldHeader=me(De,re.oldHeader,te.oldHeader),De.newHeader=me(De,re.newHeader,te.newHeader)):(De.oldFileName=re.oldFileName,De.newFileName=re.newFileName,De.oldHeader=re.oldHeader,De.newHeader=re.newHeader):(De.oldFileName=te.oldFileName||re.oldFileName,De.newFileName=te.newFileName||re.newFileName,De.oldHeader=te.oldHeader||re.oldHeader,De.newHeader=te.newHeader||re.newHeader)),De.hunks=[];for(var dt=0,K=0,le=0,U=0;dt<re.hunks.length||K<te.hunks.length;){var Ne=re.hunks[dt]||{oldStart:1/0},Ye=te.hunks[K]||{oldStart:1/0};if(ke(Ne,Ye))De.hunks.push(we(Ne,le)),dt++,U+=Ne.newLines-Ne.oldLines;else if(ke(Ye,Ne))De.hunks.push(we(Ye,U)),K++,le+=Ye.newLines-Ye.oldLines;else{var ft={oldStart:Math.min(Ne.oldStart,Ye.oldStart),oldLines:0,newStart:Math.min(Ne.newStart+le,Ye.oldStart+U),newLines:0,lines:[]};st(ft,Ne.oldStart,Ne.lines,Ye.oldStart,Ye.lines),K++,dt++,De.hunks.push(ft)}}return De}function Ze(re,te){if(typeof re=="string"){if(/^@@/m.test(re)||/^Index:/m.test(re))return Ue(re)[0];if(!te)throw new Error("Must provide a base reference or pass in a patch");return We(void 0,void 0,te,re)}return re}function Z(re){return re.newFileName&&re.newFileName!==re.oldFileName}function me(re,te,be){return te===be?te:(re.conflict=!0,{mine:te,theirs:be})}function ke(re,te){return re.oldStart<te.oldStart&&re.oldStart+re.oldLines<te.oldStart}function we(re,te){return{oldStart:re.oldStart,oldLines:re.oldLines,newStart:re.newStart+te,newLines:re.newLines,lines:re.lines}}function st(re,te,be,De,dt){var K={offset:te,lines:be,index:0},le={offset:De,lines:dt,index:0};for(He(re,K,le),He(re,le,K);K.index<K.lines.length&&le.index<le.lines.length;){var U=K.lines[K.index],Ne=le.lines[le.index];if((U[0]==="-"||U[0]==="+")&&(Ne[0]==="-"||Ne[0]==="+"))bt(re,K,le);else if(U[0]==="+"&&Ne[0]===" "){var Ye;(Ye=re.lines).push.apply(Ye,L(Ge(K)))}else if(Ne[0]==="+"&&U[0]===" "){var ft;(ft=re.lines).push.apply(ft,L(Ge(le)))}else U[0]==="-"&&Ne[0]===" "?vt(re,K,le):Ne[0]==="-"&&U[0]===" "?vt(re,le,K,!0):U===Ne?(re.lines.push(U),K.index++,le.index++):Ee(re,Ge(K),Ge(le))}zt(re,K),zt(re,le),St(re)}function bt(re,te,be){var De=Ge(te),dt=Ge(be);if(Ve(De)&&Ve(dt)){if(It(De,dt)&&Ae(be,De,De.length-dt.length)){var K;(K=re.lines).push.apply(K,L(De));return}else if(It(dt,De)&&Ae(te,dt,dt.length-De.length)){var le;(le=re.lines).push.apply(le,L(dt));return}}else if(Tt(De,dt)){var U;(U=re.lines).push.apply(U,L(De));return}Ee(re,De,dt)}function vt(re,te,be,De){var dt=Ge(te),K=at(be,dt);if(K.merged){var le;(le=re.lines).push.apply(le,L(K.merged))}else Ee(re,De?K:dt,De?dt:K)}function Ee(re,te,be){re.conflict=!0,re.lines.push({conflict:!0,mine:te,theirs:be})}function He(re,te,be){for(;te.offset<be.offset&&te.index<te.lines.length;){var De=te.lines[te.index++];re.lines.push(De),te.offset++}}function zt(re,te){for(;te.index<te.lines.length;){var be=te.lines[te.index++];re.lines.push(be)}}function Ge(re){for(var te=[],be=re.lines[re.index][0];re.index<re.lines.length;){var De=re.lines[re.index];if(be==="-"&&De[0]==="+"&&(be="+"),be===De[0])te.push(De),re.index++;else break}return te}function at(re,te){for(var be=[],De=[],dt=0,K=!1,le=!1;dt<te.length&&re.index<re.lines.length;){var U=re.lines[re.index],Ne=te[dt];if(Ne[0]==="+")break;if(K=K||U[0]!==" ",De.push(Ne),dt++,U[0]==="+")for(le=!0;U[0]==="+";)be.push(U),U=re.lines[++re.index];Ne.substr(1)===U.substr(1)?(be.push(U),re.index++):le=!0}if((te[dt]||"")[0]==="+"&&K&&(le=!0),le)return be;for(;dt<te.length;)De.push(te[dt++]);return{merged:De,changes:be}}function Ve(re){return re.reduce(function(te,be){return te&&be[0]==="-"},!0)}function Ae(re,te,be){for(var De=0;De<be;De++){var dt=te[te.length-be+De].substr(1);if(re.lines[re.index+De]!==" "+dt)return!1}return re.index+=be,!0}function lt(re){var te=0,be=0;return re.forEach(function(De){if(typeof De!="string"){var dt=lt(De.mine),K=lt(De.theirs);te!==void 0&&(dt.oldLines===K.oldLines?te+=dt.oldLines:te=void 0),be!==void 0&&(dt.newLines===K.newLines?be+=dt.newLines:be=void 0)}else be!==void 0&&(De[0]==="+"||De[0]===" ")&&be++,te!==void 0&&(De[0]==="-"||De[0]===" ")&&te++}),{oldLines:te,newLines:be}}function Bt(re){for(var te=[],be,De,dt=0;dt<re.length;dt++)be=re[dt],be.added?De=1:be.removed?De=-1:De=0,te.push([De,be.value]);return te}function ct(re){for(var te=[],be=0;be<re.length;be++){var De=re[be];De.added?te.push("<ins>"):De.removed&&te.push("<del>"),te.push(_t(De.value)),De.added?te.push("</ins>"):De.removed&&te.push("</del>")}return te.join("")}function _t(re){var te=re;return te=te.replace(/&/g,"&amp;"),te=te.replace(/</g,"&lt;"),te=te.replace(/>/g,"&gt;"),te=te.replace(/"/g,"&quot;"),te}t.Diff=e,t.diffChars=a,t.diffWords=f,t.diffWordsWithSpace=g,t.diffLines=y,t.diffTrimmedLines=A,t.diffSentences=I,t.diffCss=J,t.diffJson=fe,t.diffArrays=ze,t.structuredPatch=We,t.createTwoFilesPatch=tt,t.createPatch=Le,t.applyPatch=Q,t.applyPatches=Fe,t.parsePatch=Ue,t.merge=Zt,t.convertChangesToDMP=Bt,t.convertChangesToXML=ct,t.canonicalize=Re,Object.defineProperty(t,"__esModule",{value:!0})})});var D4=D((sg,nb)=>{(function(t,e){"use strict";var r="0.7.28",n="",i="?",a="function",s="undefined",o="object",c="string",l="major",f="model",g="name",m="type",y="vendor",A="version",k="architecture",I="console",F="mobile",J="tablet",pe="smarttv",L="wearable",H="embedded",j=255,X={extend:function(Ue,de){var Q={};for(var Fe in Ue)de[Fe]&&de[Fe].length%2===0?Q[Fe]=de[Fe].concat(Ue[Fe]):Q[Fe]=Ue[Fe];return Q},has:function(Ue,de){return typeof Ue===c?de.toLowerCase().indexOf(Ue.toLowerCase())!==-1:!1},lowerize:function(Ue){return Ue.toLowerCase()},major:function(Ue){return typeof Ue===c?Ue.replace(/[^\d\.]/g,"").split(".")[0]:e},trim:function(Ue,de){return Ue=Ue.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),typeof de===s?Ue:Ue.substring(0,j)}},V={rgx:function(Ue,de){for(var Q=0,Fe,We,tt,Le,Tt,It;Q<de.length&&!Tt;){var St=de[Q],Zt=de[Q+1];for(Fe=We=0;Fe<St.length&&!Tt;)if(Tt=St[Fe++].exec(Ue),Tt)for(tt=0;tt<Zt.length;tt++)It=Tt[++We],Le=Zt[tt],typeof Le===o&&Le.length>0?Le.length==2?typeof Le[1]==a?this[Le[0]]=Le[1].call(this,It):this[Le[0]]=Le[1]:Le.length==3?typeof Le[1]===a&&!(Le[1].exec&&Le[1].test)?this[Le[0]]=It?Le[1].call(this,It,Le[2]):e:this[Le[0]]=It?It.replace(Le[1],Le[2]):e:Le.length==4&&(this[Le[0]]=It?Le[3].call(this,It.replace(Le[1],Le[2])):e):this[Le]=It||e;Q+=2}},str:function(Ue,de){for(var Q in de)if(typeof de[Q]===o&&de[Q].length>0){for(var Fe=0;Fe<de[Q].length;Fe++)if(X.has(de[Q][Fe],Ue))return Q===i?e:Q}else if(X.has(de[Q],Ue))return Q===i?e:Q;return Ue}},ie={browser:{oldSafari:{version:{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{"0.1":"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},fe={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[A,[g,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[A,[g,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[g,A],[/opios[\/\s]+([\w\.]+)/i],[A,[g,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[A,[g,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[g,A],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[A,[g,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[A,[g,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[A,[g,"WeChat"]],[/konqueror\/([\w\.]+)/i],[A,[g,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[A,[g,"IE"]],[/yabrowser\/([\w\.]+)/i],[A,[g,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[g,/(.+)/,"$1 Secure Browser"],A],[/focus\/([\w\.]+)/i],[A,[g,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[A,[g,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[A,[g,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[A,[g,"Dolphin"]],[/coast\/([\w\.]+)/i],[A,[g,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[A,[g,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[A,[g,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[g,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[g,/(.+)/,"$1 Browser"],A],[/(comodo_dragon)\/([\w\.]+)/i],[[g,/_/g," "],A],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[g,A],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[g],[/;fbav\/([\w\.]+);/i],[A,[g,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[g,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[g,A],[/\bgsa\/([\w\.]+)\s.*safari\//i],[A,[g,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[A,[g,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[g,"Chrome WebView"],A],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[A,[g,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[g,A],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[A,[g,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[A,g],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[g,[A,V.str,ie.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[g,A],[/(navigator|netscape)\/([\w\.-]+)/i],[[g,"Netscape"],A],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[A,[g,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[g,A]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[k,"amd64"]],[/(ia32(?=;))/i],[[k,X.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[k,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[k,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[k,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[k,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[k,/ower/,"",X.lowerize]],[/(sun4\w)[;\)]/i],[[k,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[k,X.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[f,[y,"Samsung"],[m,J]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[f,[y,"Samsung"],[m,F]],[/\((ip(?:hone|od)[\s\w]*);/i],[f,[y,"Apple"],[m,F]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[f,[y,"Apple"],[m,J]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[f,[y,"Huawei"],[m,J]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[f,[y,"Huawei"],[m,F]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[f,/_/g," "],[y,"Xiaomi"],[m,F]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[f,/_/g," "],[y,"Xiaomi"],[m,J]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[f,[y,"OPPO"],[m,F]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[f,[y,"Vivo"],[m,F]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[f,[y,"Realme"],[m,F]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[f,[y,"Motorola"],[m,F]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[f,[y,"Motorola"],[m,J]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[f,[y,"LG"],[m,J]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[f,[y,"LG"],[m,F]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[f,[y,"Lenovo"],[m,J]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[f,/_/g," "],[y,"Nokia"],[m,F]],[/droid.+;\s(pixel\sc)[\s)]/i],[f,[y,"Google"],[m,J]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[f,[y,"Google"],[m,F]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[y,"Sony"],[m,F]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[f,"Xperia Tablet"],[y,"Sony"],[m,J]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[f,[y,"OnePlus"],[m,F]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[f,[y,"Amazon"],[m,J]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[f,"Fire Phone"],[y,"Amazon"],[m,F]],[/\((playbook);[\w\s\),;-]+(rim)/i],[f,y,[m,J]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[f,[y,"BlackBerry"],[m,F]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[f,[y,"ASUS"],[m,J]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[f,[y,"ASUS"],[m,F]],[/(nexus\s9)/i],[f,[y,"HTC"],[m,J]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[y,[f,/_/g," "],[m,F]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[f,[y,"Acer"],[m,J]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[f,[y,"Meizu"],[m,F]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[y,f,[m,F]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[y,f,[m,J]],[/\s(surface\sduo)\s/i],[f,[y,"Microsoft"],[m,J]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[f,[y,"Fairphone"],[m,F]],[/\s(u304aa)\sbuild/i],[f,[y,"AT&T"],[m,F]],[/sie-(\w*)/i],[f,[y,"Siemens"],[m,F]],[/[;\/]\s?(rct\w+)\sbuild/i],[f,[y,"RCA"],[m,J]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[f,[y,"Dell"],[m,J]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[f,[y,"Verizon"],[m,J]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[f,[y,"Barnes & Noble"],[m,J]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[f,[y,"NuVision"],[m,J]],[/;\s(k88)\sbuild/i],[f,[y,"ZTE"],[m,J]],[/;\s(nx\d{3}j)\sbuild/i],[f,[y,"ZTE"],[m,F]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[f,[y,"Swiss"],[m,F]],[/[;\/]\s?(zur\d{3})\sbuild/i],[f,[y,"Swiss"],[m,J]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[f,[y,"Zeki"],[m,J]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[y,"Dragon Touch"],f,[m,J]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[f,[y,"Insignia"],[m,J]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[f,[y,"NextBook"],[m,J]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[y,"Voice"],f,[m,F]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[y,"LvTel"],f,[m,F]],[/;\s(ph-1)\s/i],[f,[y,"Essential"],[m,F]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[f,[y,"Envizen"],[m,J]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[f,[y,"MachSpeed"],[m,J]],[/[;\/]\s?tu_(1491)\sbuild/i],[f,[y,"Rotor"],[m,J]],[/(shield[\w\s]+)\sbuild/i],[f,[y,"Nvidia"],[m,J]],[/(sprint)\s(\w+)/i],[y,f,[m,F]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[y,"Microsoft"],[m,F]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[f,[y,"Zebra"],[m,J]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[f,[y,"Zebra"],[m,F]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[y,f,[m,I]],[/droid.+;\s(shield)\sbuild/i],[f,[y,"Nvidia"],[m,I]],[/(playstation\s[345portablevi]+)/i],[f,[y,"Sony"],[m,I]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[f,[y,"Microsoft"],[m,I]],[/smart-tv.+(samsung)/i],[y,[m,pe]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[y,"Samsung"],[m,pe]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[y,"LG"],[m,pe]],[/(apple)\s?tv/i],[y,[f,"Apple TV"],[m,pe]],[/crkey/i],[[f,"Chromecast"],[y,"Google"],[m,pe]],[/droid.+aft([\w])(\sbuild\/|\))/i],[f,[y,"Amazon"],[m,pe]],[/\(dtv[\);].+(aquos)/i],[f,[y,"Sharp"],[m,pe]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[y,X.trim],[f,X.trim],[m,pe]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[m,pe]],[/((pebble))app\/[\d\.]+\s/i],[y,f,[m,L]],[/droid.+;\s(glass)\s\d/i],[f,[y,"Google"],[m,L]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[f,[y,"Zebra"],[m,L]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[y,[m,H]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[f,[m,F]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[f,[m,J]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[m,X.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[f,[y,"Generic"]],[/(phone)/i],[[m,F]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[A,[g,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[A,[g,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[g,A],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[A,g]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[g,A],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[g,[A,V.str,ie.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[g,"Windows"],[A,V.str,ie.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[A,/_/g,"."],[g,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[g,"Mac OS"],[A,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[g,A],[/\(bb(10);/i],[A,[g,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[A,[g,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[g,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[A,[g,"webOS"]],[/crkey\/([\d\.]+)/i],[A,[g,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[g,"Chromium OS"],A],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[g,A],[/(sunos)\s?([\w\.\d]*)/i],[[g,"Solaris"],A],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[g,A]]},Re=function(Ue,de){if(typeof Ue=="object"&&(de=Ue,Ue=e),!(this instanceof Re))return new Re(Ue,de).getResult();var Q=Ue||(typeof t<"u"&&t.navigator&&t.navigator.userAgent?t.navigator.userAgent:n),Fe=de?X.extend(fe,de):fe;return this.getBrowser=function(){var We={name:e,version:e};return V.rgx.call(We,Q,Fe.browser),We.major=X.major(We.version),We},this.getCPU=function(){var We={architecture:e};return V.rgx.call(We,Q,Fe.cpu),We},this.getDevice=function(){var We={vendor:e,model:e,type:e};return V.rgx.call(We,Q,Fe.device),We},this.getEngine=function(){var We={name:e,version:e};return V.rgx.call(We,Q,Fe.engine),We},this.getOS=function(){var We={name:e,version:e};return V.rgx.call(We,Q,Fe.os),We},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return Q},this.setUA=function(We){return Q=typeof We===c&&We.length>j?X.trim(We,j):We,this},this.setUA(Q),this};Re.VERSION=r,Re.BROWSER={NAME:g,MAJOR:l,VERSION:A},Re.CPU={ARCHITECTURE:k},Re.DEVICE={MODEL:f,VENDOR:y,TYPE:m,CONSOLE:I,MOBILE:F,SMARTTV:pe,TABLET:J,WEARABLE:L,EMBEDDED:H},Re.ENGINE={NAME:g,VERSION:A},Re.OS={NAME:g,VERSION:A},typeof sg!==s?(typeof nb!==s&&nb.exports&&(sg=nb.exports=Re),sg.UAParser=Re):typeof define=="function"&&define.amd?define(function(){return Re}):typeof t<"u"&&(t.UAParser=Re);var ye=typeof t<"u"&&(t.jQuery||t.Zepto);if(ye&&!ye.ua){var ze=new Re;ye.ua=ze.getResult(),ye.ua.get=function(){return ze.getUA()},ye.ua.set=function(Ue){ze.setUA(Ue);var de=ze.getResult();for(var Q in de)ye.ua[Q]=de[Q]}}})(typeof window=="object"?window:sg)});var N4=D(_u=>{"use strict";var bx=_u&&_u.__assign||function(){return bx=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},bx.apply(this,arguments)},Zye=_u&&_u.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_u,"__esModule",{value:!0});_u.getFileDiff=void 0;var ebe=R4(),tbe=yu(),rbe=D4(),ibe=Zye(hx()),yx=rb(),nbe={files:yx.SnackIdentityState.files,dependencies:yx.SnackIdentityState.dependencies,sdkVersion:yx.SnackIdentityState.sdkVersion};function L4(t,e){var r=ebe.createPatch("code",t,e,"","",{context:0});if(r)return r;throw new Error("Error creating a file diff")}_u.getFileDiff=L4;var abe="https://snack-code-uploads.s3.us-west-1.amazonaws.com/~asset/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",sbe=function(){function t(e){var r=this;this.code=nbe,this.placeholderURLs={},this.uploadedURLs={},this.onFileUploaded=function(n,i,a){var s=n.path;if(delete r.placeholderURLs[s],i&&(r.uploadedURLs[s]=i,!Object.keys(r.placeholderURLs).length)){var o=r.createCodeMessage(r.code,r.codeMessage,r.code);r.verifyCodeMessageSize(o)&&r.callback(o,r.code)}},this.logger=e.logger,this.callback=e.callback,this.verifyCodeMessageSize=e.verifyCodeMessageSize,this.maxDiffPlaceholder=e.maxDiffPlaceholder,this.codeUploader=e.apiURL?new ibe.default({apiURL:e.apiURL,logger:e.logger,callback:this.onFileUploaded}):void 0}return t.prototype.setCode=function(e){var r,n,i;if(e!==this.code){var a=this.code,s=e.files;this.code=e;for(var o in a.files)a.files[o].contents!==((r=s[o])===null||r===void 0?void 0:r.contents)&&(delete this.placeholderURLs[o],delete this.uploadedURLs[o],(n=this.codeUploader)===null||n===void 0||n.remove(o,a.files[o]));var c=this.createCodeMessage(e,this.codeMessage,a);if(this.codeMessage=c,this.verifyCodeMessageSize(c)){Object.keys(this.placeholderURLs).length||this.callback(c,e);return}if(this.codeUploader)for(var l=Object.keys(s).filter(function(m){return s[m].type==="CODE"}).sort(function(m,y){return s[y].contents.length-s[m].contents.length}),f=0;f<l.length;f++){var o=l[f];if(!this.uploadedURLs[o]&&!this.placeholderURLs[o]){var g=s[o];if(this.placeholderURLs[o]=abe,this.codeUploader.add(o,g),c.diff[o]="",c.s3url[o]=this.placeholderURLs[o],this.verifyCodeMessageSize(c))return}}(i=this.logger)===null||i===void 0||i.error("Message size is too large")}},t.prototype.createCodeMessage=function(e,r,n){var i=e.files,a=e.dependencies,s=e.sdkVersion,o=bx({},i),c={};for(var l in i){var f=i[l];this.uploadedURLs[l]||this.placeholderURLs[l]?(o[l]="",c[l]=this.uploadedURLs[l]||this.placeholderURLs[l]):(f.type==="CODE"?r?.diff[l]&&n?.files[l].contents===e.files[l].contents?o[l]=r.diff[l]:this.maxDiffPlaceholder&&f.contents.length>=this.maxDiffPlaceholder.length?o[l]=this.maxDiffPlaceholder:o[l]=L4("",f.contents):o[l]="",f.type==="ASSET"&&typeof f.contents=="string"&&(c[l]=f.contents))}var g={};for(var m in a){var y=a[m];y.handle&&!tbe.isModulePreloaded(m,s)&&(g[m]={version:y.version,handle:y.handle,resolved:y.handle.substring(y.handle.lastIndexOf("@")+1)})}var A={expoSDKVersion:e.sdkVersion};if(typeof navigator<"u"&&navigator.userAgent){var k=new rbe.UAParser(navigator.userAgent).getResult();A.webHostName=window.location.hostname,A.webOSArchitecture=k.cpu.architecture,A.webOSFamily=k.os.name,A.webOSVersion=k.os.version,A.webLayoutEngine=k.engine.name,A.webDeviceType=k.device.type,A.webBrowser=k.browser.name,A.webBrowserVersion=k.browser.version}return{type:"CODE",diff:o,s3url:c,dependencies:g,metadata:A}},t}();_u.default=sbe});var ab=D(wu=>{"use strict";var obe=wu&&wu.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},ube=wu&&wu.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},cbe=wu&&wu.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(wu,"__esModule",{value:!0});var M4=cbe(N4()),lbe=gx(),dbe=function(){function t(e){var r=this;this.connectionsCount=0,this.onCodeMessageReady=function(s){var o;r.codeMessage=s,(o=r.logger)===null||o===void 0||o.comm("Sending code...",r.logSuffix),r.publish(s)};var n=e.apiURL,i=e.channel,a=e.verbose;this.channel=i??"",this.logger=a?lbe.createLogger(!0):void 0,this.logSuffix=e.name?" ("+e.name+")":"",i?this.codeMessageBuilder=new M4.default({verifyCodeMessageSize:this.onVerifyCodeMessageSize,callback:this.onCodeMessageReady,apiURL:n,logger:this.logger,maxDiffPlaceholder:"X".repeat(t.CODE_SIZE_LIMIT_FOR_DIFF)}):this.codeMessageBuilder=new M4.default({verifyCodeMessageSize:function(){return!0},callback:this.onCodeMessageReady,logger:this.logger})}return t.prototype.addEventListener=function(e,r){this.callback=r},t.prototype.removeEventListener=function(e,r){this.callback=void 0},t.prototype.postMessage=function(e){switch(e.type){case"start":this.start();break;case"stop":this.stop();break;case"update_code":this.codeMessageBuilder.setCode(e.data);break;case"protocol_message":this.publish(e.data);break;case"synthetic_event":this.onSyntheticEvent(e.data);break}},t.prototype.handleMessage=function(e,r){this.onProtocolMessage(e,r)},t.prototype.handleChannelEvent=function(e,r){var n,i,a;if(e==="join")try{var s=JSON.parse(r);this.connectionsCount++,(n=this.callback)===null||n===void 0||n.call(this,{type:"connect",connectionId:r,data:s}),this.codeMessage&&((i=this.logger)===null||i===void 0||i.comm("Sending code...",this.logSuffix),this.publish(this.codeMessage))}catch{}else this.connectionsCount=Math.max(this.connectionsCount-1,0),(a=this.callback)===null||a===void 0||a.call(this,{type:"disconnect",connectionId:r,data:{}})},t.prototype.onProtocolMessage=function(e,r){var n,i;r.type==="RESEND_CODE"?this.codeMessage&&((n=this.logger)===null||n===void 0||n.comm("Resending code...",this.logSuffix),this.publish(this.codeMessage)):(i=this.callback)===null||i===void 0||i.call(this,{type:"protocol_message",connectionId:e,data:r})},t.prototype.publish=function(e){var r,n,i;return obe(this,void 0,void 0,function(){var a;return ube(this,function(s){switch(s.label){case 0:if(!this.connectionsCount)return[2];if(!this.isStarted())return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.sendAsync(this.channel,e)];case 2:return s.sent(),[3,4];case 3:return a=s.sent(),(r=this.logger)===null||r===void 0||r.error("Failed to publish message",e.type,a,this.logSuffix),[3,4];case 4:return[3,6];case 5:(n=this.callback)===null||n===void 0||n.call(this,{type:"synthetic_event",data:e}),s.label=6;case 6:return(i=this.callback)===null||i===void 0||i.call(this,{type:"send_message",data:e}),[2]}})})},t.prototype.onSyntheticEvent=function(e){var r,n,i;if(typeof e=="string")try{var a=JSON.parse(e);switch(a.type){case"CONNECT":this.connectionsCount++,(r=this.callback)===null||r===void 0||r.call(this,{type:"connect",connectionId:JSON.stringify(a.device),data:a.device});break;case"DISCONNECT":this.connectionsCount=Math.max(this.connectionsCount-1,0),(n=this.callback)===null||n===void 0||n.call(this,{type:"disconnect",connectionId:JSON.stringify(a.device),data:{}});break;case"MESSAGE":this.onProtocolMessage(JSON.stringify(a.message.device),a.message);break}}catch(s){(i=this.logger)===null||i===void 0||i.error("Failed to parse postMessage",s,e,this.logSuffix)}},t.CODE_SIZE_LIMIT_FOR_DIFF=32768,t}();wu.default=dbe});var B4=D(us=>{"use strict";var fbe=us&&us.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pbe=us&&us.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},hbe=us&&us.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},U4=us&&us.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(us,"__esModule",{value:!0});us.calcPubNubCodeMessageSize=void 0;var $4=U4(O4()),_x=U4(ab());function F4(t,e){return encodeURIComponent(t+JSON.stringify(e).replace(/[!~*'()]/g,function(r){return"%"+r.charCodeAt(0).toString(16).toUpperCase()})).length+200}us.calcPubNubCodeMessageSize=F4;var gbe=function(t){fbe(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.onPubNubPresence=function(n){switch(n.action){case"join":r.handleChannelEvent("join",n.uuid);break;case"timeout":case"leave":r.handleChannelEvent("leave",n.uuid);break}},r.onPubNubMessage=function(n){var i=n.message;r.handleMessage(n.publisher,i)},r.onPubNubStatus=function(n){},r}return e.prototype.start=function(){var r;this.stop(),this.pubNubClientId||(this.pubNubClientId=$4.default.generateUUID()),this.channel&&((r=this.logger)===null||r===void 0||r.comm("Starting channel...",this.channel,this.logSuffix),this.pubNub=new $4.default({publishKey:"pub-c-2a7fd67b-333d-40db-ad2d-3255f8835f70",subscribeKey:"sub-c-0b655000-d784-11e6-b950-02ee2ddab7fe",uuid:this.pubNubClientId,ssl:!0,presenceTimeout:600,heartbeatInterval:60}),this.pubNub.addListener({presence:this.onPubNubPresence,message:this.onPubNubMessage,status:this.onPubNubStatus}),this.pubNub.subscribe({channels:[this.channel],withPresence:!0}))},e.prototype.stop=function(){var r;this.pubNub&&((r=this.logger)===null||r===void 0||r.comm("Stopping...",this.logSuffix),this.pubNub.removeListener({presence:this.onPubNubPresence,message:this.onPubNubMessage,status:this.onPubNubStatus}),this.pubNub.unsubscribe({channels:[this.channel]}),this.pubNub.stop(),this.pubNub=void 0)},e.prototype.isStarted=function(){return this.pubNub!=null},e.prototype.sendAsync=function(r,n){var i;return pbe(this,void 0,void 0,function(){return hbe(this,function(a){switch(a.label){case 0:return[4,(i=this.pubNub)===null||i===void 0?void 0:i.publish({channel:r,message:n})];case 1:return a.sent(),[2]}})})},e.prototype.onVerifyCodeMessageSize=function(r){var n=0;for(var i in r.diff)n+=i.length+r.diff[i].length;if(n>=_x.default.CODE_SIZE_LIMIT_FOR_DIFF)return!1;var a=F4(this.channel,r);return a<_x.default.CODE_SIZE_LIMIT_FOR_DIFF},e}(_x.default);us.default=gbe});var wx=D(dc=>{"use strict";Object.defineProperty(dc,"__esModule",{value:!0});dc.ERROR_PACKET=dc.PACKET_TYPES_REVERSE=dc.PACKET_TYPES=void 0;var Ao=Object.create(null);dc.PACKET_TYPES=Ao;Ao.open="0";Ao.close="1";Ao.ping="2";Ao.pong="3";Ao.message="4";Ao.upgrade="5";Ao.noop="6";var q4=Object.create(null);dc.PACKET_TYPES_REVERSE=q4;Object.keys(Ao).forEach(t=>{q4[Ao[t]]=t});var mbe={type:"error",data:"parser error"};dc.ERROR_PACKET=mbe});var H4=D(Tx=>{"use strict";Object.defineProperty(Tx,"__esModule",{value:!0});var vbe=wx(),ybe=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",bbe=typeof ArrayBuffer=="function",_be=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,wbe=({type:t,data:e},r,n)=>ybe&&e instanceof Blob?r?n(e):j4(e,n):bbe&&(e instanceof ArrayBuffer||_be(e))?r?n(e):j4(new Blob([e]),n):n(vbe.PACKET_TYPES[t]+(e||"")),j4=(t,e)=>{let r=new FileReader;return r.onload=function(){let n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};Tx.default=wbe});var G4=D(hf=>{"use strict";Object.defineProperty(hf,"__esModule",{value:!0});hf.decode=hf.encode=void 0;var pf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",og=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<pf.length;t++)og[pf.charCodeAt(t)]=t;var Tbe=t=>{let e=new Uint8Array(t),r,n=e.length,i="";for(r=0;r<n;r+=3)i+=pf[e[r]>>2],i+=pf[(e[r]&3)<<4|e[r+1]>>4],i+=pf[(e[r+1]&15)<<2|e[r+2]>>6],i+=pf[e[r+2]&63];return n%3===2?i=i.substring(0,i.length-1)+"=":n%3===1&&(i=i.substring(0,i.length-2)+"=="),i};hf.encode=Tbe;var Sbe=t=>{let e=t.length*.75,r=t.length,n,i=0,a,s,o,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);let l=new ArrayBuffer(e),f=new Uint8Array(l);for(n=0;n<r;n+=4)a=og[t.charCodeAt(n)],s=og[t.charCodeAt(n+1)],o=og[t.charCodeAt(n+2)],c=og[t.charCodeAt(n+3)],f[i++]=a<<2|s>>4,f[i++]=(s&15)<<4|o>>2,f[i++]=(o&3)<<6|c&63;return l};hf.decode=Sbe});var z4=D(Sx=>{"use strict";Object.defineProperty(Sx,"__esModule",{value:!0});var sb=wx(),Ebe=G4(),xbe=typeof ArrayBuffer=="function",Cbe=(t,e)=>{if(typeof t!="string")return{type:"message",data:V4(t,e)};let r=t.charAt(0);return r==="b"?{type:"message",data:Abe(t.substring(1),e)}:sb.PACKET_TYPES_REVERSE[r]?t.length>1?{type:sb.PACKET_TYPES_REVERSE[r],data:t.substring(1)}:{type:sb.PACKET_TYPES_REVERSE[r]}:sb.ERROR_PACKET},Abe=(t,e)=>{if(xbe){let r=(0,Ebe.decode)(t);return V4(r,e)}else return{base64:!0,data:t}},V4=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}};Sx.default=Cbe});var ug=D(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.decodePayload=Cs.decodePacket=Cs.encodePayload=Cs.encodePacket=Cs.protocol=void 0;var W4=H4();Cs.encodePacket=W4.default;var K4=z4();Cs.decodePacket=K4.default;var X4="",Ibe=(t,e)=>{let r=t.length,n=new Array(r),i=0;t.forEach((a,s)=>{(0,W4.default)(a,!1,o=>{n[s]=o,++i===r&&e(n.join(X4))})})};Cs.encodePayload=Ibe;var kbe=(t,e)=>{let r=t.split(X4),n=[];for(let i=0;i<r.length;i++){let a=(0,K4.default)(r[i],e);if(n.push(a),a.type==="error")break}return n};Cs.decodePayload=kbe;Cs.protocol=4});var xl=D(Y4=>{Y4.Emitter=Oa;function Oa(t){if(t)return Obe(t)}function Obe(t){for(var e in Oa.prototype)t[e]=Oa.prototype[e];return t}Oa.prototype.on=Oa.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};Oa.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};Oa.prototype.off=Oa.prototype.removeListener=Oa.prototype.removeAllListeners=Oa.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};Oa.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};Oa.prototype.emitReserved=Oa.prototype.emit;Oa.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};Oa.prototype.hasListeners=function(t){return!!this.listeners(t).length}});var cg=D(ob=>{"use strict";Object.defineProperty(ob,"__esModule",{value:!0});ob.globalThisShim=void 0;ob.globalThisShim=typeof self<"u"?self:typeof window<"u"?window:Function("return this")()});var gf=D(fc=>{"use strict";Object.defineProperty(fc,"__esModule",{value:!0});fc.byteLength=fc.installTimerFunctions=fc.pick=void 0;var ub=cg();function Pbe(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}fc.pick=Pbe;var Rbe=setTimeout,Dbe=clearTimeout;function Lbe(t,e){e.useNativeTimers?(t.setTimeoutFn=Rbe.bind(ub.globalThisShim),t.clearTimeoutFn=Dbe.bind(ub.globalThisShim)):(t.setTimeoutFn=setTimeout.bind(ub.globalThisShim),t.clearTimeoutFn=clearTimeout.bind(ub.globalThisShim))}fc.installTimerFunctions=Lbe;var Nbe=1.33;function Mbe(t){return typeof t=="string"?$be(t):Math.ceil((t.byteLength||t.size)*Nbe)}fc.byteLength=Mbe;function $be(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}});var Q4=D((VRe,J4)=>{var mf=1e3,vf=mf*60,yf=vf*60,Cl=yf*24,Ube=Cl*7,Fbe=Cl*365.25;J4.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Bbe(t);if(r==="number"&&isFinite(t))return e.long?jbe(t):qbe(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Bbe(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Fbe;case"weeks":case"week":case"w":return r*Ube;case"days":case"day":case"d":return r*Cl;case"hours":case"hour":case"hrs":case"hr":case"h":return r*yf;case"minutes":case"minute":case"mins":case"min":case"m":return r*vf;case"seconds":case"second":case"secs":case"sec":case"s":return r*mf;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function qbe(t){var e=Math.abs(t);return e>=Cl?Math.round(t/Cl)+"d":e>=yf?Math.round(t/yf)+"h":e>=vf?Math.round(t/vf)+"m":e>=mf?Math.round(t/mf)+"s":t+"ms"}function jbe(t){var e=Math.abs(t);return e>=Cl?cb(t,e,Cl,"day"):e>=yf?cb(t,e,yf,"hour"):e>=vf?cb(t,e,vf,"minute"):e>=mf?cb(t,e,mf,"second"):t+" ms"}function cb(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var eG=D((zRe,Z4)=>{function Hbe(t){r.debug=r,r.default=r,r.coerce=c,r.disable=a,r.enable=i,r.enabled=s,r.humanize=Q4(),r.destroy=l,Object.keys(t).forEach(f=>{r[f]=t[f]}),r.names=[],r.skips=[],r.formatters={};function e(f){let g=0;for(let m=0;m<f.length;m++)g=(g<<5)-g+f.charCodeAt(m),g|=0;return r.colors[Math.abs(g)%r.colors.length]}r.selectColor=e;function r(f){let g,m=null,y,A;function k(...I){if(!k.enabled)return;let F=k,J=Number(new Date),pe=J-(g||J);F.diff=pe,F.prev=g,F.curr=J,g=J,I[0]=r.coerce(I[0]),typeof I[0]!="string"&&I.unshift("%O");let L=0;I[0]=I[0].replace(/%([a-zA-Z%])/g,(j,X)=>{if(j==="%%")return"%";L++;let V=r.formatters[X];if(typeof V=="function"){let ie=I[L];j=V.call(F,ie),I.splice(L,1),L--}return j}),r.formatArgs.call(F,I),(F.log||r.log).apply(F,I)}return k.namespace=f,k.useColors=r.useColors(),k.color=r.selectColor(f),k.extend=n,k.destroy=r.destroy,Object.defineProperty(k,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(y!==r.namespaces&&(y=r.namespaces,A=r.enabled(f)),A),set:I=>{m=I}}),typeof r.init=="function"&&r.init(k),k}function n(f,g){let m=r(this.namespace+(typeof g>"u"?":":g)+f);return m.log=this.log,m}function i(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let g,m=(typeof f=="string"?f:"").split(/[\s,]+/),y=m.length;for(g=0;g<y;g++)m[g]&&(f=m[g].replace(/\*/g,".*?"),f[0]==="-"?r.skips.push(new RegExp("^"+f.slice(1)+"$")):r.names.push(new RegExp("^"+f+"$")))}function a(){let f=[...r.names.map(o),...r.skips.map(o).map(g=>"-"+g)].join(",");return r.enable(""),f}function s(f){if(f[f.length-1]==="*")return!0;let g,m;for(g=0,m=r.skips.length;g<m;g++)if(r.skips[g].test(f))return!1;for(g=0,m=r.names.length;g<m;g++)if(r.names[g].test(f))return!0;return!1}function o(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function c(f){return f instanceof Error?f.stack||f.message:f}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}Z4.exports=Hbe});var Io=D((cs,lb)=>{cs.formatArgs=Vbe;cs.save=zbe;cs.load=Wbe;cs.useColors=Gbe;cs.storage=Kbe();cs.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();cs.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Gbe(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Vbe(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+lb.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}cs.log=console.debug||console.log||(()=>{});function zbe(t){try{t?cs.storage.setItem("debug",t):cs.storage.removeItem("debug")}catch{}}function Wbe(){let t;try{t=cs.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=!1),t}function Kbe(){try{return localStorage}catch{}}lb.exports=eG()(cs);var{formatters:Xbe}=lb.exports;Xbe.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var db=D(bf=>{"use strict";var Ybe=bf&&bf.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(bf,"__esModule",{value:!0});bf.Transport=void 0;var Jbe=ug(),Qbe=xl(),Zbe=gf(),e0e=Ybe(Io()),t0e=(0,e0e.default)("engine.io-client:transport"),Ex=class extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}},xx=class extends Qbe.Emitter{constructor(e){super(),this.writable=!1,(0,Zbe.installTimerFunctions)(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,r,n){return super.emitReserved("error",new Ex(e,r,n)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):t0e("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let r=(0,Jbe.decodePacket)(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}};bf.Transport=xx});var Ax=D(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.yeast=hc.decode=hc.encode=void 0;var iG="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),fb=64,nG={},tG=0,pc=0,rG;function Cx(t){let e="";do e=iG[t%fb]+e,t=Math.floor(t/fb);while(t>0);return e}hc.encode=Cx;function r0e(t){let e=0;for(pc=0;pc<t.length;pc++)e=e*fb+nG[t.charAt(pc)];return e}hc.decode=r0e;function i0e(){let t=Cx(+new Date);return t!==rG?(tG=0,rG=t):t+"."+Cx(tG++)}hc.yeast=i0e;for(;pc<fb;pc++)nG[iG[pc]]=pc});var pb=D(_f=>{"use strict";Object.defineProperty(_f,"__esModule",{value:!0});_f.decode=_f.encode=void 0;function n0e(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}_f.encode=n0e;function a0e(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let a=r[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}_f.decode=a0e});var sG=D(hb=>{"use strict";Object.defineProperty(hb,"__esModule",{value:!0});hb.hasCORS=void 0;var aG=!1;try{aG=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}hb.hasCORS=aG});var oG=D(gb=>{"use strict";Object.defineProperty(gb,"__esModule",{value:!0});gb.XHR=void 0;var s0e=sG(),o0e=cg();function u0e(t){let e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||s0e.hasCORS))return new XMLHttpRequest}catch{}if(!e)try{return new o0e.globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}gb.XHR=u0e});var fG=D(gc=>{"use strict";var c0e=gc&&gc.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gc,"__esModule",{value:!0});gc.Request=gc.Polling=void 0;var l0e=db(),d0e=c0e(Io()),f0e=Ax(),p0e=pb(),uG=ug(),dG=oG(),h0e=xl(),cG=gf(),g0e=cg(),za=(0,d0e.default)("engine.io-client:polling");function m0e(){}var v0e=function(){return new dG.XHR({xdomain:!1}).responseType!=null}(),Ix=class extends l0e.Transport{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let n=location.protocol==="https:",i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port,this.xs=e.secure!==n}let r=e&&e.forceBase64;this.supportsBinary=v0e&&!r}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let r=()=>{za("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let n=0;this.polling&&(za("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){za("pre-pause polling complete"),--n||r()})),this.writable||(za("we are currently writing - waiting to pause"),n++,this.once("drain",function(){za("pre-pause writing complete"),--n||r()}))}else r()}poll(){za("polling"),this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){za("polling got data %s",e);let r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};(0,uG.decodePayload)(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"?this.poll():za('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{za("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(za("transport open - closing"),e()):(za("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,(0,uG.encodePayload)(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{},r=this.opts.secure?"https":"http",n="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=(0,f0e.yeast)()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(r==="https"&&Number(this.opts.port)!==443||r==="http"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port);let i=(0,p0e.encode)(e),a=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(a?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new Tu(this.uri(),e)}doWrite(e,r){let n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,a)=>{this.onError("xhr post error",i,a)})}doPoll(){za("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}};gc.Polling=Ix;var Tu=class t extends h0e.Emitter{constructor(e,r){super(),(0,cG.installTimerFunctions)(this,r),this.opts=r,this.method=r.method||"GET",this.uri=e,this.async=r.async!==!1,this.data=r.data!==void 0?r.data:null,this.create()}create(){let e=(0,cG.pick)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let r=this.xhr=new dG.XHR(e);try{za("xhr open %s: %s",this.method,this.uri),r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let n in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this.opts.extraHeaders[n])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},za("xhr data %s",this.data),r.send(this.data)}catch(n){this.setTimeoutFn(()=>{this.onError(n)},0);return}typeof document<"u"&&(this.index=t.requestsCount++,t.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=m0e,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete t.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};gc.Request=Tu;Tu.requestsCount=0;Tu.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",lG);else if(typeof addEventListener=="function"){let t="onpagehide"in g0e.globalThisShim?"pagehide":"unload";addEventListener(t,lG,!1)}}function lG(){for(let t in Tu.requests)Tu.requests.hasOwnProperty(t)&&Tu.requests[t].abort()}});var kx=D(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.defaultBinaryType=ko.usingBrowserWebSocket=ko.WebSocket=ko.nextTick=void 0;var pG=cg();ko.nextTick=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0);ko.WebSocket=pG.globalThisShim.WebSocket||pG.globalThisShim.MozWebSocket;ko.usingBrowserWebSocket=!0;ko.defaultBinaryType="arraybuffer"});var gG=D(wf=>{"use strict";var y0e=wf&&wf.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(wf,"__esModule",{value:!0});wf.WS=void 0;var b0e=db(),_0e=pb(),w0e=Ax(),T0e=gf(),Su=kx(),S0e=y0e(Io()),E0e=ug(),x0e=(0,S0e.default)("engine.io-client:websocket"),hG=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Ox=class extends b0e.Transport{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),r=this.opts.protocols,n=hG?{}:(0,T0e.pick)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=Su.usingBrowserWebSocket&&!hG?r?new Su.WebSocket(e,r):new Su.WebSocket(e):new Su.WebSocket(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||Su.defaultBinaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let n=e[r],i=r===e.length-1;(0,E0e.encodePacket)(n,this.supportsBinary,a=>{let s={};Su.usingBrowserWebSocket||(n.options&&(s.compress=n.options.compress),this.opts.perMessageDeflate&&(typeof a=="string"?Buffer.byteLength(a):a.length)<this.opts.perMessageDeflate.threshold&&(s.compress=!1));try{Su.usingBrowserWebSocket?this.ws.send(a):this.ws.send(a,s)}catch{x0e("websocket closed before onclose event")}i&&(0,Su.nextTick)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},r=this.opts.secure?"wss":"ws",n="";this.opts.port&&(r==="wss"&&Number(this.opts.port)!==443||r==="ws"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=(0,w0e.yeast)()),this.supportsBinary||(e.b64=1);let i=(0,_0e.encode)(e),a=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(a?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}check(){return!!Su.WebSocket}};wf.WS=Ox});var Px=D(mb=>{"use strict";Object.defineProperty(mb,"__esModule",{value:!0});mb.transports=void 0;var C0e=fG(),A0e=gG();mb.transports={websocket:A0e.WS,polling:C0e.Polling}});var Rx=D(vb=>{"use strict";Object.defineProperty(vb,"__esModule",{value:!0});vb.parse=void 0;var I0e=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,k0e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function O0e(t){let e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=I0e.exec(t||""),a={},s=14;for(;s--;)a[k0e[s]]=i[s]||"";return r!=-1&&n!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=P0e(a,a.path),a.queryKey=R0e(a,a.query),a}vb.parse=O0e;function P0e(t,e){let r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function R0e(t,e){let r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,a){i&&(r[i]=a)}),r}});var bG=D(Tf=>{"use strict";var D0e=Tf&&Tf.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.Socket=void 0;var L0e=Px(),mG=gf(),N0e=pb(),vG=Rx(),M0e=D0e(Io()),$0e=xl(),yG=ug(),$i=(0,M0e.default)("engine.io-client:socket"),yb=class t extends $0e.Emitter{constructor(e,r={}){super(),e&&typeof e=="object"&&(r=e,e=null),e?(e=(0,vG.parse)(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=(0,vG.parse)(r.host).host),(0,mG.installTimerFunctions)(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=(0,N0e.decode)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){$i('creating transport "%s"',e);let r=Object.assign({},this.opts.query);r.EIO=yG.protocol,r.transport=e,this.id&&(r.sid=this.id);let n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return $i("options: %j",n),new L0e.transports[e](n)}open(){let e;if(this.opts.rememberUpgrade&&t.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(r){$i("error while creating transport: %s",r),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){$i("setting transport %s",e.name),this.transport&&($i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(e){$i('probing transport "%s"',e);let r=this.createTransport(e),n=!1;t.priorWebsocketSuccess=!1;let i=()=>{n||($i('probe transport "%s" opened',e),r.send([{type:"ping",data:"probe"}]),r.once("packet",g=>{if(!n)if(g.type==="pong"&&g.data==="probe"){if($i('probe transport "%s" pong',e),this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;t.priorWebsocketSuccess=r.name==="websocket",$i('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{n||this.readyState!=="closed"&&($i("changing transport and sending upgrade packet"),f(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{$i('probe transport "%s" failed',e);let m=new Error("probe error");m.transport=r.name,this.emitReserved("upgradeError",m)}}))};function a(){n||(n=!0,f(),r.close(),r=null)}let s=g=>{let m=new Error("probe error: "+g);m.transport=r.name,a(),$i('probe transport "%s" failed because of error: %s',e,g),this.emitReserved("upgradeError",m)};function o(){s("transport closed")}function c(){s("socket closed")}function l(g){r&&g.name!==r.name&&($i('"%s" works - aborting "%s"',g.name,r.name),a())}let f=()=>{r.removeListener("open",i),r.removeListener("error",s),r.removeListener("close",o),this.off("close",c),this.off("upgrading",l)};r.once("open",i),r.once("error",s),r.once("close",o),this.once("close",c),this.once("upgrading",l),r.open()}onOpen(){if($i("socket open"),this.readyState="open",t.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){$i("starting upgrade probes");let e=0,r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch($i('socket receive: type "%s", data "%s"',e.type,e.data),this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}else $i('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();$i("flushing %d packets in socket",e.length),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){let i=this.writeBuffer[n].data;if(i&&(r+=(0,mG.byteLength)(i)),n>0&&r>this.maxPayload)return $i("only send %d out of %d packets",n,this.writeBuffer.length),this.writeBuffer.slice(0,n);r+=2}return $i("payload size is %d (max: %d)",r,this.maxPayload),this.writeBuffer}write(e,r,n){return this.sendPacket("message",e,r,n),this}send(e,r,n){return this.sendPacket("message",e,r,n),this}sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;let a={type:e,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),i&&this.once("flush",i),this.flush()}close(){let e=()=>{this.onClose("forced close"),$i("socket closing - telling transport to close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}onError(e){$i("socket error %j",e),t.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&($i('socket close with reason: "%s"',e),this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let r=[],n=0,i=e.length;for(;n<i;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}};Tf.Socket=yb;yb.protocol=yG.protocol});var Dx=D(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.nextTick=la.parse=la.installTimerFunctions=la.transports=la.Transport=la.protocol=la.Socket=void 0;var _G=bG();Object.defineProperty(la,"Socket",{enumerable:!0,get:function(){return _G.Socket}});la.protocol=_G.Socket.protocol;var U0e=db();Object.defineProperty(la,"Transport",{enumerable:!0,get:function(){return U0e.Transport}});var F0e=Px();Object.defineProperty(la,"transports",{enumerable:!0,get:function(){return F0e.transports}});var B0e=gf();Object.defineProperty(la,"installTimerFunctions",{enumerable:!0,get:function(){return B0e.installTimerFunctions}});var q0e=Rx();Object.defineProperty(la,"parse",{enumerable:!0,get:function(){return q0e.parse}});var j0e=kx();Object.defineProperty(la,"nextTick",{enumerable:!0,get:function(){return j0e.nextTick}})});var TG=D(Sf=>{"use strict";var H0e=Sf&&Sf.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Sf,"__esModule",{value:!0});Sf.url=void 0;var G0e=Dx(),V0e=H0e(Io()),wG=V0e.default("socket.io-client:url");function z0e(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(wG("protocol-less url %s",t),typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),wG("parse %s",t),n=G0e.parse(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+e,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}Sf.url=z0e});var Lx=D(Ef=>{"use strict";Object.defineProperty(Ef,"__esModule",{value:!0});Ef.hasBinary=Ef.isBinary=void 0;var W0e=typeof ArrayBuffer=="function",K0e=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,SG=Object.prototype.toString,X0e=typeof Blob=="function"||typeof Blob<"u"&&SG.call(Blob)==="[object BlobConstructor]",Y0e=typeof File=="function"||typeof File<"u"&&SG.call(File)==="[object FileConstructor]";function EG(t){return W0e&&(t instanceof ArrayBuffer||K0e(t))||X0e&&t instanceof Blob||Y0e&&t instanceof File}Ef.isBinary=EG;function bb(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(bb(t[r]))return!0;return!1}if(EG(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return bb(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&bb(t[r]))return!0;return!1}Ef.hasBinary=bb});var xG=D(xf=>{"use strict";Object.defineProperty(xf,"__esModule",{value:!0});xf.reconstructPacket=xf.deconstructPacket=void 0;var J0e=Lx();function Q0e(t){let e=[],r=t.data,n=t;return n.data=Nx(r,e),n.attachments=e.length,{packet:n,buffers:e}}xf.deconstructPacket=Q0e;function Nx(t,e){if(!t)return t;if((0,J0e.isBinary)(t)){let r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){let r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=Nx(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){let r={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=Nx(t[n],e));return r}return t}function Z0e(t,e){return t.data=Mx(t.data,e),delete t.attachments,t}xf.reconstructPacket=Z0e;function Mx(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=Mx(t[r],e);else if(typeof t=="object")for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=Mx(t[r],e));return t}});var _b=D(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.Decoder=Js.Encoder=Js.PacketType=Js.protocol=void 0;var e_e=xl(),AG=xG(),IG=Lx(),t_e=Io(),$x=(0,t_e.default)("socket.io-parser"),r_e=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];Js.protocol=5;var Ki;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Ki=Js.PacketType||(Js.PacketType={}));var Ux=class{constructor(e){this.replacer=e}encode(e){return $x("encoding packet %j",e),(e.type===Ki.EVENT||e.type===Ki.ACK)&&(0,IG.hasBinary)(e)?this.encodeAsBinary({type:e.type===Ki.EVENT?Ki.BINARY_EVENT:Ki.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===Ki.BINARY_EVENT||e.type===Ki.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),$x("encoded %j as %s",e,r),r}encodeAsBinary(e){let r=(0,AG.deconstructPacket)(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}};Js.Encoder=Ux;function CG(t){return Object.prototype.toString.call(t)==="[object Object]"}var Fx=class t extends e_e.Emitter{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);let n=r.type===Ki.BINARY_EVENT;n||r.type===Ki.BINARY_ACK?(r.type=n?Ki.EVENT:Ki.ACK,this.reconstructor=new Bx(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if((0,IG.isBinary)(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0,n={type:Number(e.charAt(0))};if(Ki[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===Ki.BINARY_EVENT||n.type===Ki.BINARY_ACK){let a=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);let s=e.substring(a,r);if(s!=Number(s)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(s)}if(e.charAt(r+1)==="/"){let a=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(a,r)}else n.nsp="/";let i=e.charAt(r+1);if(i!==""&&Number(i)==i){let a=r+1;for(;++r;){let s=e.charAt(r);if(s==null||Number(s)!=s){--r;break}if(r===e.length)break}n.id=Number(e.substring(a,r+1))}if(e.charAt(++r)){let a=this.tryParse(e.substr(r));if(t.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return $x("decoded %s as %j",e,n),n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case Ki.CONNECT:return CG(r);case Ki.DISCONNECT:return r===void 0;case Ki.CONNECT_ERROR:return typeof r=="string"||CG(r);case Ki.EVENT:case Ki.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&r_e.indexOf(r[0])===-1);case Ki.ACK:case Ki.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};Js.Decoder=Fx;var Bx=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let r=(0,AG.reconstructPacket)(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var qx=D(wb=>{"use strict";Object.defineProperty(wb,"__esModule",{value:!0});wb.on=void 0;function i_e(t,e,r){return t.on(e,r),function(){t.off(e,r)}}wb.on=i_e});var Hx=D(Cf=>{"use strict";var n_e=Cf&&Cf.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Cf,"__esModule",{value:!0});Cf.Socket=void 0;var As=_b(),Tb=qx(),a_e=xl(),s_e=n_e(Io()),Wa=s_e.default("socket.io-client:socket"),o_e=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),jx=class extends a_e.Emitter{constructor(e,r,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[Tb.on(e,"open",this.onopen.bind(this)),Tb.on(e,"packet",this.onpacket.bind(this)),Tb.on(e,"error",this.onerror.bind(this)),Tb.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(o_e.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');r.unshift(e);let n={type:As.PacketType.EVENT,data:r};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){let s=this.ids++;Wa("emitting packet with ack id %d",s);let o=r.pop();this._registerAckCallback(s,o),n.id=s}let i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)?Wa("discard packet as the transport is not currently writable"):this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n),this.flags={},this}_registerAckCallback(e,r){let n=this.flags.timeout;if(n===void 0){this.acks[e]=r;return}let i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&(Wa("removing packet with ack id %d from the buffer",e),this.sendBuffer.splice(a,1));Wa("event with ack id %d has timed out after %d ms",e,n),r.call(this,new Error("operation has timed out"))},n);this.acks[e]=(...a)=>{this.io.clearTimeoutFn(i),r.apply(this,[null,...a])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){Wa("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:As.PacketType.CONNECT,data:e})}):this.packet({type:As.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){Wa("close (%s)",e),this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case As.PacketType.CONNECT:if(e.data&&e.data.sid){let i=e.data.sid;this.onconnect(i)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case As.PacketType.EVENT:case As.PacketType.BINARY_EVENT:this.onevent(e);break;case As.PacketType.ACK:case As.PacketType.BINARY_ACK:this.onack(e);break;case As.PacketType.DISCONNECT:this.ondisconnect();break;case As.PacketType.CONNECT_ERROR:this.destroy();let n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){let r=e.data||[];Wa("emitting event %j",r),e.id!=null&&(Wa("attaching ack callback to event"),r.push(this.ack(e.id))),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let n of r)n.apply(this,e)}super.emit.apply(this,e)}ack(e){let r=this,n=!1;return function(...i){n||(n=!0,Wa("sending ack %j",i),r.packet({type:As.PacketType.ACK,id:e,data:i}))}}onack(e){let r=this.acks[e.id];typeof r=="function"?(Wa("calling ack %s with %j",e.id,e.data),r.apply(this,e.data),delete this.acks[e.id]):Wa("bad ack %s",e.id)}onconnect(e){Wa("socket connected with id %s",e),this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){Wa("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(Wa("performing disconnect (%s)",this.nsp),this.packet({type:As.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let r=this._anyOutgoingListeners.slice();for(let n of r)n.apply(this,e.data)}}};Cf.Socket=jx});var kG=D(Sb=>{"use strict";Object.defineProperty(Sb,"__esModule",{value:!0});Sb.Backoff=void 0;function Af(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Sb.Backoff=Af;Af.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};Af.prototype.reset=function(){this.attempts=0};Af.prototype.setMin=function(t){this.ms=t};Af.prototype.setMax=function(t){this.max=t};Af.prototype.setJitter=function(t){this.jitter=t}});var OG=D(Is=>{"use strict";var u_e=Is&&Is.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),c_e=Is&&Is.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),l_e=Is&&Is.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&u_e(e,t,r);return c_e(e,t),e},d_e=Is&&Is.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Is,"__esModule",{value:!0});Is.Manager=void 0;var Gx=Dx(),f_e=Hx(),p_e=l_e(_b()),Al=qx(),h_e=kG(),g_e=xl(),m_e=d_e(Io()),jn=m_e.default("socket.io-client:manager"),Vx=class extends g_e.Emitter{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Gx.installTimerFunctions(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new h_e.Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;let i=r.parser||p_e;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(jn("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;jn("opening %s",this.uri),this.engine=new Gx.Socket(this.uri,this.opts);let r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let i=Al.on(r,"open",function(){n.onopen(),e&&e()}),a=Al.on(r,"error",s=>{jn("error"),n.cleanup(),n._readyState="closed",this.emitReserved("error",s),e?e(s):n.maybeReconnectOnOpen()});if(this._timeout!==!1){let s=this._timeout;jn("connect attempt will timeout after %d",s),s===0&&i();let o=this.setTimeoutFn(()=>{jn("connect attempt timed out after %d",s),i(),r.close(),r.emit("error",new Error("timeout"))},s);this.opts.autoUnref&&o.unref(),this.subs.push(function(){clearTimeout(o)})}return this.subs.push(i),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){jn("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Al.on(e,"ping",this.onping.bind(this)),Al.on(e,"data",this.ondata.bind(this)),Al.on(e,"error",this.onerror.bind(this)),Al.on(e,"close",this.onclose.bind(this)),Al.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){Gx.nextTick(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){jn("error",e),this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n||(n=new f_e.Socket(this,e,r),this.nsps[e]=n),n}_destroy(e){let r=Object.keys(this.nsps);for(let n of r)if(this.nsps[n].active){jn("socket %s is still active, skipping close",n);return}this._close()}_packet(e){jn("writing packet %j",e);let r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){jn("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){jn("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,r){jn("closed due to %s",e),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)jn("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();jn("will wait %dms before reconnect attempt",r),this._reconnecting=!0;let n=this.setTimeoutFn(()=>{e.skipReconnect||(jn("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(jn("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):(jn("reconnect success"),e.onreconnect())}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(function(){clearTimeout(n)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};Is.Manager=Vx});var LG=D((da,DG)=>{"use strict";var v_e=da&&da.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(da,"__esModule",{value:!0});da.default=da.connect=da.io=da.Socket=da.Manager=da.protocol=void 0;var y_e=TG(),Eb=OG();Object.defineProperty(da,"Manager",{enumerable:!0,get:function(){return Eb.Manager}});var RG=Hx();Object.defineProperty(da,"Socket",{enumerable:!0,get:function(){return RG.Socket}});var b_e=v_e(Io()),PG=b_e.default("socket.io-client"),lg={};function Il(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};let r=y_e.url(t,e.path||"/socket.io"),n=r.source,i=r.id,a=r.path,s=lg[i]&&a in lg[i].nsps,o=e.forceNew||e["force new connection"]||e.multiplex===!1||s,c;return o?(PG("ignoring socket cache for %s",n),c=new Eb.Manager(n,e)):(lg[i]||(PG("new io instance for %s",n),lg[i]=new Eb.Manager(n,e)),c=lg[i]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}da.io=Il;da.connect=Il;da.default=Il;Object.assign(Il,{Manager:Eb.Manager,Socket:RG.Socket,io:Il,connect:Il});var __e=_b();Object.defineProperty(da,"protocol",{enumerable:!0,get:function(){return __e.protocol}});DG.exports=Il});var Cb=D(dg=>{"use strict";var xb=dg&&dg.__assign||function(){return xb=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},xb.apply(this,arguments)};Object.defineProperty(dg,"__esModule",{value:!0});var w_e=5,T_e=function(){function t(){this.listener=null}return t.prototype.emitSuccessed=function(e){(this.lastEmitState===void 0||this.lastEmitState==="TRANSPORT_CONNECTION_FAILED")&&(this.emit(xb({name:"TRANSPORT_CONNECTION_SUCCEEDED"},e)),this.lastEmitState="TRANSPORT_CONNECTION_SUCCEEDED")},t.prototype.emitFailed=function(e){this.lastEmitState===void 0&&e.attempts>=w_e&&(this.emit(xb({name:"TRANSPORT_CONNECTION_FAILED"},e)),this.lastEmitState="TRANSPORT_CONNECTION_FAILED")},t.prototype.resetState=function(){this.lastEmitState=void 0},t.prototype.setUpdateListener=function(e){this.listener=e},t.prototype.emit=function(e){var r;(r=this.listener)===null||r===void 0||r.call(this,e)},t}();dg.default=new T_e});var zx=D(kl=>{"use strict";var S_e=kl&&kl.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),$G=kl&&kl.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(kl,"__esModule",{value:!0});var E_e=LG(),NG=$G(Cb()),MG=$G(ab()),x_e=function(t){S_e(e,t);function e(r){var n=t.call(this,r)||this;n.socket=null,n.onMessage=function(a){var s=a.sender,o=a.message;n.handleMessage(s,o)},n.onJoinChannel=function(a){var s,o=a.sender;o!==""&&o!==((s=n.socket)===null||s===void 0?void 0:s.id)&&n.handleChannelEvent("join",o)},n.onLeaveChannel=function(a){var s,o=a.sender;o!==""&&o!==((s=n.socket)===null||s===void 0?void 0:s.id)&&n.handleChannelEvent("leave",o)};var i=r.snackpubURL;if(!i)throw new Error("The `snackpubURL` option is unspecified.");return n.snackpubURL=i,n.connectionAttempts=0,n}return e.prototype.start=function(){var r=this;this.stop(),this.startTime=Date.now(),this.socket=E_e.io(this.snackpubURL,{transports:["websocket"]}),this.socket.on("connect",function(){var n,i;(n=r.socket)===null||n===void 0||n.emit("subscribeChannel",{channel:r.channel,sender:(i=r.socket)===null||i===void 0?void 0:i.id}),r.startTime&&NG.default.emitSuccessed({timeMs:Date.now()-r.startTime,attempts:r.connectionAttempts})}),this.socket.io.on("reconnect_attempt",function(n){r.connectionAttempts=n,r.startTime&&NG.default.emitFailed({timeMs:Date.now()-r.startTime,attempts:n})}),this.socket.on("message",this.onMessage),this.socket.on("joinChannel",this.onJoinChannel),this.socket.on("leaveChannel",this.onLeaveChannel),this.socket.on("terminate",function(n){var i,a;(i=r.logger)===null||i===void 0||i.comm("Terminating connection: "+n),(a=r.socket)===null||a===void 0||a.disconnect()})},e.prototype.stop=function(){var r;this.socket!=null&&((r=this.logger)===null||r===void 0||r.comm("Stopping...",this.logSuffix),this.socket.offAny(),this.socket.close(),this.socket=null),this.startTime=void 0},e.prototype.isStarted=function(){return this.socket!=null},e.prototype.sendAsync=function(r,n){var i;return(i=this.socket)===null||i===void 0||i.emit("message",{channel:r,message:n,sender:this.socket.id}),Promise.resolve()},e.prototype.onVerifyCodeMessageSize=function(r){var n=0;for(var i in r.diff)n+=i.length+r.diff[i].length;return n<MG.default.CODE_SIZE_LIMIT_FOR_DIFF},e}(MG.default);kl.default=x_e});var FG=D(fg=>{"use strict";var UG=fg&&fg.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fg,"__esModule",{value:!0});var C_e=UG(B4()),A_e=UG(zx()),I_e=function(){function t(e){this.transports=[new C_e.default(e),new A_e.default(e)]}return t.prototype.addEventListener=function(e,r){for(var n=0,i=this.transports;n<i.length;n++){var a=i[n];a.addEventListener(e,r)}},t.prototype.removeEventListener=function(e,r){for(var n=0,i=this.transports;n<i.length;n++){var a=i[n];a.removeEventListener(e,r)}},t.prototype.postMessage=function(e){for(var r=0,n=this.transports;r<n.length;r++){var i=n[r];i.postMessage(e)}},t}();fg.default=I_e});var qG=D(BG=>{"use strict";Object.defineProperty(BG,"__esModule",{value:!0})});var Kx=D(fa=>{"use strict";var k_e=fa&&fa.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),jG=fa&&fa.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&k_e(e,t,r)},Wx=fa&&fa.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fa,"__esModule",{value:!0});fa.createTrafficMirroringTransport=fa.createTransport=fa.ConnectionMetricsEmitter=void 0;var O_e=Wx(FG()),P_e=Wx(zx());jG(qG(),fa);jG(Cb(),fa);var R_e=Cb();Object.defineProperty(fa,"ConnectionMetricsEmitter",{enumerable:!0,get:function(){return Wx(R_e).default}});function D_e(t){return new P_e.default(t)}fa.createTransport=D_e;function L_e(t){return new O_e.default(t)}fa.createTrafficMirroringTransport=L_e});var GG=D((yDe,HG)=>{HG.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var VG=D((bDe,Xx)=>{typeof Object.create=="function"?Xx.exports=function(e,r){e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:Xx.exports=function(e,r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}});var XG=D(Fr=>{var N_e=/%[sdj%]/g;Fr.format=function(t){if(!Db(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(mc(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,i=n.length,a=String(t).replace(N_e,function(o){if(o==="%%")return"%";if(r>=i)return o;switch(o){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch{return"[Circular]"}default:return o}}),s=n[r];r<i;s=n[++r])Rb(s)||!If(s)?a+=" "+s:a+=" "+mc(s);return a};Fr.deprecate=function(t,e){if(Eu(window.process))return function(){return Fr.deprecate(t,e).apply(this,arguments)};if(process.noDeprecation===!0)return t;var r=!1;function n(){if(!r){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}return n};var Ab={},Yx;Fr.debuglog=function(t){if(Eu(Yx)&&(Yx=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!Ab[t])if(new RegExp("\\b"+t+"\\b","i").test(Yx)){var e=process.pid;Ab[t]=function(){var r=Fr.format.apply(Fr,arguments);console.error("%s %d: %s",t,e,r)}}else Ab[t]=function(){};return Ab[t]};function mc(t,e){var r={seen:[],stylize:$_e};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),tC(e)?r.showHidden=e:e&&Fr._extend(r,e),Eu(r.showHidden)&&(r.showHidden=!1),Eu(r.depth)&&(r.depth=2),Eu(r.colors)&&(r.colors=!1),Eu(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=M_e),Pb(r,t,r.depth)}Fr.inspect=mc;mc.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};mc.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function M_e(t,e){var r=mc.styles[e];return r?"\x1B["+mc.colors[r][0]+"m"+t+"\x1B["+mc.colors[r][1]+"m":t}function $_e(t,e){return t}function U_e(t){var e={};return t.forEach(function(r,n){e[r]=!0}),e}function Pb(t,e,r){if(t.customInspect&&e&&Ob(e.inspect)&&e.inspect!==Fr.inspect&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(r,t);return Db(n)||(n=Pb(t,n,r)),n}var i=F_e(t,e);if(i)return i;var a=Object.keys(e),s=U_e(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),kb(e)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return Jx(e);if(a.length===0){if(Ob(e)){var o=e.name?": "+e.name:"";return t.stylize("[Function"+o+"]","special")}if(Ib(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(eC(e))return t.stylize(Date.prototype.toString.call(e),"date");if(kb(e))return Jx(e)}var c="",l=!1,f=["{","}"];if(zG(e)&&(l=!0,f=["[","]"]),Ob(e)){var g=e.name?": "+e.name:"";c=" [Function"+g+"]"}if(Ib(e)&&(c=" "+RegExp.prototype.toString.call(e)),eC(e)&&(c=" "+Date.prototype.toUTCString.call(e)),kb(e)&&(c=" "+Jx(e)),a.length===0&&(!l||e.length==0))return f[0]+c+f[1];if(r<0)return Ib(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var m;return l?m=B_e(t,e,r,s,a):m=a.map(function(y){return Zx(t,e,r,s,y,l)}),t.seen.pop(),q_e(m,c,f)}function F_e(t,e){if(Eu(e))return t.stylize("undefined","undefined");if(Db(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(WG(e))return t.stylize(""+e,"number");if(tC(e))return t.stylize(""+e,"boolean");if(Rb(e))return t.stylize("null","null")}function Jx(t){return"["+Error.prototype.toString.call(t)+"]"}function B_e(t,e,r,n,i){for(var a=[],s=0,o=e.length;s<o;++s)KG(e,String(s))?a.push(Zx(t,e,r,n,String(s),!0)):a.push("");return i.forEach(function(c){c.match(/^\d+$/)||a.push(Zx(t,e,r,n,c,!0))}),a}function Zx(t,e,r,n,i,a){var s,o,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?c.set?o=t.stylize("[Getter/Setter]","special"):o=t.stylize("[Getter]","special"):c.set&&(o=t.stylize("[Setter]","special")),KG(n,i)||(s="["+i+"]"),o||(t.seen.indexOf(c.value)<0?(Rb(r)?o=Pb(t,c.value,null):o=Pb(t,c.value,r-1),o.indexOf(`
`)>-1&&(a?o=o.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):o=`
`+o.split(`
`).map(function(l){return"   "+l}).join(`
`))):o=t.stylize("[Circular]","special")),Eu(s)){if(a&&i.match(/^\d+$/))return o;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+o}function q_e(t,e,r){var n=0,i=t.reduce(function(a,s){return n++,s.indexOf(`
`)>=0&&n++,a+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function zG(t){return Array.isArray(t)}Fr.isArray=zG;function tC(t){return typeof t=="boolean"}Fr.isBoolean=tC;function Rb(t){return t===null}Fr.isNull=Rb;function j_e(t){return t==null}Fr.isNullOrUndefined=j_e;function WG(t){return typeof t=="number"}Fr.isNumber=WG;function Db(t){return typeof t=="string"}Fr.isString=Db;function H_e(t){return typeof t=="symbol"}Fr.isSymbol=H_e;function Eu(t){return t===void 0}Fr.isUndefined=Eu;function Ib(t){return If(t)&&rC(t)==="[object RegExp]"}Fr.isRegExp=Ib;function If(t){return typeof t=="object"&&t!==null}Fr.isObject=If;function eC(t){return If(t)&&rC(t)==="[object Date]"}Fr.isDate=eC;function kb(t){return If(t)&&(rC(t)==="[object Error]"||t instanceof Error)}Fr.isError=kb;function Ob(t){return typeof t=="function"}Fr.isFunction=Ob;function G_e(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}Fr.isPrimitive=G_e;Fr.isBuffer=GG();function rC(t){return Object.prototype.toString.call(t)}function Qx(t){return t<10?"0"+t.toString(10):t.toString(10)}var V_e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function z_e(){var t=new Date,e=[Qx(t.getHours()),Qx(t.getMinutes()),Qx(t.getSeconds())].join(":");return[t.getDate(),V_e[t.getMonth()],e].join(" ")}Fr.log=function(){console.log("%s - %s",z_e(),Fr.format.apply(Fr,arguments))};Fr.inherits=VG();Fr._extend=function(t,e){if(!e||!If(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t};function KG(t,e){return Object.prototype.hasOwnProperty.call(t,e)}});var n8=D((wDe,i8)=>{var bn=XG(),Lb=Array.prototype.slice,W_e=Object.prototype.hasOwnProperty,tn=i8.exports=t8;tn.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=K_e(this),this.generatedMessage=!0);var r=e.stackStartFunction||Qs;if(Error.captureStackTrace)Error.captureStackTrace(this,r);else{var n=new Error;if(n.stack){var i=n.stack,a=r.name,s=i.indexOf(`
`+a);if(s>=0){var o=i.indexOf(`
`,s+1);i=i.substring(o+1)}this.stack=i}}};bn.inherits(tn.AssertionError,Error);function YG(t,e){return bn.isUndefined(e)?""+e:bn.isNumber(e)&&!isFinite(e)||bn.isFunction(e)||bn.isRegExp(e)?e.toString():e}function JG(t,e){return bn.isString(t)?t.length<e?t:t.slice(0,e):t}function K_e(t){return JG(JSON.stringify(t.actual,YG),128)+" "+t.operator+" "+JG(JSON.stringify(t.expected,YG),128)}function Qs(t,e,r,n,i){throw new tn.AssertionError({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}tn.fail=Qs;function t8(t,e){t||Qs(t,!0,e,"==",tn.ok)}tn.ok=t8;tn.equal=function(e,r,n){e!=r&&Qs(e,r,n,"==",tn.equal)};tn.notEqual=function(e,r,n){e==r&&Qs(e,r,n,"!=",tn.notEqual)};tn.deepEqual=function(e,r,n){Nb(e,r)||Qs(e,r,n,"deepEqual",tn.deepEqual)};function Nb(t,e){if(t===e)return!0;if(bn.isBuffer(t)&&bn.isBuffer(e)){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}else return bn.isDate(t)&&bn.isDate(e)?t.getTime()===e.getTime():bn.isRegExp(t)&&bn.isRegExp(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:!bn.isObject(t)&&!bn.isObject(e)?t==e:X_e(t,e)}function QG(t){return Object.prototype.toString.call(t)=="[object Arguments]"}function X_e(t,e){if(bn.isNullOrUndefined(t)||bn.isNullOrUndefined(e)||t.prototype!==e.prototype)return!1;if(bn.isPrimitive(t)||bn.isPrimitive(e))return t===e;var r=QG(t),n=QG(e);if(r&&!n||!r&&n)return!1;if(r)return t=Lb.call(t),e=Lb.call(e),Nb(t,e);var i=e8(t),a=e8(e),s,o;if(i.length!=a.length)return!1;for(i.sort(),a.sort(),o=i.length-1;o>=0;o--)if(i[o]!=a[o])return!1;for(o=i.length-1;o>=0;o--)if(s=i[o],!Nb(t[s],e[s]))return!1;return!0}tn.notDeepEqual=function(e,r,n){Nb(e,r)&&Qs(e,r,n,"notDeepEqual",tn.notDeepEqual)};tn.strictEqual=function(e,r,n){e!==r&&Qs(e,r,n,"===",tn.strictEqual)};tn.notStrictEqual=function(e,r,n){e===r&&Qs(e,r,n,"!==",tn.notStrictEqual)};function ZG(t,e){return!t||!e?!1:Object.prototype.toString.call(e)=="[object RegExp]"?e.test(t):t instanceof e?!0:e.call({},t)===!0}function r8(t,e,r,n){var i;bn.isString(r)&&(n=r,r=null);try{e()}catch(a){i=a}if(n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),t&&!i&&Qs(i,r,"Missing expected exception"+n),!t&&ZG(i,r)&&Qs(i,r,"Got unwanted exception"+n),t&&i&&r&&!ZG(i,r)||!t&&i)throw i}tn.throws=function(t,e,r){r8.apply(this,[!0].concat(Lb.call(arguments)))};tn.doesNotThrow=function(t,e){r8.apply(this,[!1].concat(Lb.call(arguments)))};tn.ifError=function(t){if(t)throw t};var e8=Object.keys||function(t){var e=[];for(var r in t)W_e.call(t,r)&&e.push(r);return e}});var s8=D(Zs=>{"use strict";var Y_e=Zs&&Zs.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),J_e=Zs&&Zs.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},Q_e=Zs&&Zs.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},a8=Zs&&Zs.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Zs,"__esModule",{value:!0});var Mb=a8(n8()),Z_e=a8(ab()),ewe=function(t){Y_e(e,t);function e(r){var n=t.call(this,{name:r.name,verbose:r.verbose})||this;n.status="stopped",n.handleDomWindowMessage=function(a){var s;if(a.origin===n.origin)try{var o=JSON.parse(a.data),c=o.type;if(c==="CONNECT"){var l=JSON.stringify(o.device);n.handleChannelEvent("join",l)}else if(c==="DISCONNECT"){var l=JSON.stringify(o.device);n.handleChannelEvent("leave",l)}else if(c==="MESSAGE"){var l=JSON.stringify(o.message.device);n.handleMessage(l,o.message)}}catch{(s=n.logger)===null||s===void 0||s.warn("Invalid message",a.data)}};var i=new URL(r.webPlayerURL).origin;return n.currentWindow=r.window,n.targetWindowRef=r.ref,n.status="stopped",n.origin=i,n}return e.prototype.start=function(){var r;Mb.default(this.currentWindow),(r=this.currentWindow)===null||r===void 0||r.addEventListener("message",this.handleDomWindowMessage,!1),this.status="started"},e.prototype.stop=function(){Mb.default(this.currentWindow),this.currentWindow.removeEventListener("message",this.handleDomWindowMessage,!1),this.currentWindow=void 0,this.targetWindowRef=void 0,this.status="stopped"},e.prototype.isStarted=function(){return this.status==="started"&&this.currentWindow!=null},e.prototype.sendAsync=function(r,n){var i;return J_e(this,void 0,void 0,function(){var a;return Q_e(this,function(s){return Mb.default(this.isStarted),a=(i=this.targetWindowRef)===null||i===void 0?void 0:i.current,Mb.default(a),a.postMessage(JSON.stringify(n),this.origin),[2]})})},e.prototype.onVerifyCodeMessageSize=function(r){return!0},e}(Z_e.default);Zs.default=ewe});var o8=D(vc=>{"use strict";var twe=vc&&vc.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vc,"__esModule",{value:!0});vc.getWebPlayerIFrameURL=vc.createWebPlayerTransport=void 0;var rwe=twe(s8());function iwe(t){return new rwe.default(t)}vc.createWebPlayerTransport=iwe;function nwe(t,e,r,n){if(!(e<"40.0.0"||typeof window>"u"))return t.replace("%%SDK_VERSION%%",e.split(".")[0])+"/index.html?initialUrl="+encodeURIComponent(r)+"&origin="+encodeURIComponent(window.location.origin)+"&verbose="+n}vc.getWebPlayerIFrameURL=nwe});var l8=D(Hn=>{"use strict";var Xr=Hn&&Hn.__assign||function(){return Xr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Xr.apply(this,arguments)},awe=Hn&&Hn.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),swe=Hn&&Hn.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),aC=Hn&&Hn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&awe(e,t,r);return swe(e,t),e},pg=Hn&&Hn.__awaiter||function(t,e,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{l(n.next(f))}catch(g){s(g)}}function c(f){try{l(n.throw(f))}catch(g){s(g)}}function l(f){f.done?a(f.value):i(f.value).then(o,c)}l((n=n.apply(t,e||[])).next())})},hg=Hn&&Hn.__generator||function(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(f){return c([l,f])}}function c(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=l[0]&2?i.return:l[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,l[1])).done)return a;switch(i=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},$b=Hn&&Hn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Hn,"__esModule",{value:!0});var iC=$b(nH()),u8=$b(sH()),kf=yu(),yc=aC(p4()),owe=$b(v4()),c8=$b(hx()),uwe=gx(),Ui=aC(C4()),cwe=I4(),bc=aC(rb()),lwe=Kx(),nC=o8(),xu=cf(),dwe=function(){function t(e){var r=this,n,i,a,s,o,c,l,f,g,m,y,A,k,I,F;this.stateListeners=new Set,this.logListeners=new Set,this.transportListeners={},this.uploadAssetAsync=function(X){return pg(r,void 0,void 0,function(){var V,ie;return hg(this,function(fe){switch(fe.label){case 0:return V="",ie=new c8.default({apiURL:this.apiURL,logger:this.logger,callback:function(Re,ye,ze){if(ze)throw ze;ye&&(V=ye)}}),ie.add("asset",{type:"ASSET",contents:X}),[4,ie.waitForCompletion()];case 1:return fe.sent(),[2,V]}})})},this.onFileUploaded=function(X,V,ie){r.setState(function(fe){var Re=fe.files;return{files:Ui.addObject(Re,X.path,Xr(Xr(Xr({},X.file),V?{contents:V}:{}),ie?{error:ie}:{}))}})},this.onWantedDependencyVersions=function(X,V,ie){var fe=ie?{}:V;r.setState(function(Re){var ye=Re.dependencies,ze=Re.sdkVersion;return{wantedDependencyVersions:fe,missingDependencies:yc.getMissingDependencies(ye,ze,fe)}})},this.onDependencyResolved=function(X,V,ie){r.setState(function(fe){var Re=fe.dependencies,ye=fe.sdkVersion,ze=fe.wantedDependencyVersions,Ue=Ui.addObject(Re,X.name,Xr(Xr(Xr(Xr({},Re[X.name]),{version:X.version}),V?{handle:V.handle,peerDependencies:V.dependencies}:{}),ie?{error:ie}:{}));return Ue!==Re?{dependencies:Ue,missingDependencies:yc.getMissingDependencies(Ue,ye,ze)}:null})},this.onDevSessionSendBeaconCloseRequest=function(X){r.setState(function(V){return{sendBeaconCloseRequest:X}})},this.onTransportEvent=function(X,V){var ie,fe,Re,ye=V.type,ze=V.data,Ue=V.connectionId;switch(ye){case"connect":(ie=r.logger)===null||ie===void 0||ie.comm("Client connected ("+X+")",Ue),r.onClientConnected(X,Ue,ze);break;case"disconnect":(fe=r.logger)===null||fe===void 0||fe.comm("Client disconnected ("+X+")",Ue,ze),r.onClientDisconnected(X,Ue,ze);break;case"protocol_message":(Re=r.logger)===null||Re===void 0||Re.comm_recv("Message received ("+X+")",Ue,ze),r.onProtocolMessageReceived(X,Ue,V.data);break;case"send_message":r.onProtocolMessageSent(X,V.data);break}};var J=xu.createChannel(e.channel),pe=kf.validateSDKVersion((n=e.sdkVersion)!==null&&n!==void 0?n:bc.default.sdkVersion),L=e.dependencies?Xr({},e.dependencies):{};this.options=e,this.apiURL=(i=e.apiURL)!==null&&i!==void 0?i:bc.default.apiURL,this.snackpubURL=(a=e.snackpubURL)!==null&&a!==void 0?a:bc.default.snackpubURL,this.runtimeEndpoint=(s=e.runtimeEndpoint)!==null&&s!==void 0?s:kf.SNACK_RUNTIME_URL_ENDPOINT,this.logger=e.verbose?uwe.createLogger(!0):void 0,this.codeChangesDelay=(o=e.codeChangesDelay)!==null&&o!==void 0?o:0,this.reloadTimeout=(c=e.reloadTimeout)!==null&&c!==void 0?c:0,this.previewTimeout=(l=e.previewTimeout)!==null&&l!==void 0?l:1e4,this.createTransport=(f=e.createTransport)!==null&&f!==void 0?f:lwe.createTransport;var H=(g=e.webPlayerURL)!==null&&g!==void 0?g:bc.default.webPlayerURL,j=(m=e.transports)!==null&&m!==void 0?m:{};e.online&&(j=Ui.addObject(j,"pubsub",this.createTransport({name:"pubsub",channel:J,verbose:e.verbose,apiURL:this.apiURL,snackpubURL:this.snackpubURL}))),e.webPreviewRef&&(j=Ui.addObject(j,"webplayer",nC.createWebPlayerTransport({ref:e.webPreviewRef,verbose:e.verbose,window:u8.default(window),webPlayerURL:H}))),this.state=this.updateDerivedState({disabled:!!e.disabled,unsaved:!1,name:(y=e.name)!==null&&y!==void 0?y:"",description:(A=e.description)!==null&&A!==void 0?A:"",sdkVersion:pe,files:(k=e.files)!==null&&k!==void 0?k:{},dependencies:L,missingDependencies:yc.getMissingDependencies(L,pe),connectedClients:{},transports:j,user:e.user,id:e.id,saveURL:e.id?xu.createURL(this.runtimeEndpoint,pe,void 0,e.id):void 0,savedSDKVersion:e.id?pe:void 0,online:!1,url:xu.createURL(this.runtimeEndpoint,pe,J,e.id),channel:J,deviceId:e.deviceId,snackId:e.snackId,accountSnackId:e.accountSnackId,webPlayerURL:H},bc.SnackIdentityState),this.state.unsaved=!1,this.wantedDependencyVersions=new cwe.WantedDependencyVersions({apiUrl:this.apiURL,logger:this.logger,callback:this.onWantedDependencyVersions}),this.dependencyResolver=new yc.default({snackagerURL:(I=e.snackagerURL)!==null&&I!==void 0?I:bc.default.snackagerURL,logger:this.logger,callback:this.onDependencyResolved}),this.fileUploader=new c8.default({apiURL:this.apiURL,logger:this.logger,callback:this.onFileUploaded}),this.DevSession=new owe.default({apiURL:this.apiURL,logger:this.logger,onSendBeaconCloseRequest:this.onDevSessionSendBeaconCloseRequest}),(F=this.logger)===null||F===void 0||F.info("Snack created",this.getState()),this.onStateChanged(this.state,bc.SnackIdentityState)}return t.prototype.setSDKVersion=function(e){return kf.validateSDKVersion(e),this.setState(function(r){return r.sdkVersion!==e?{sdkVersion:e,missingDependencies:yc.getMissingDependencies(r.dependencies,e,r.wantedDependencyVersions)}:null})},t.prototype.setName=function(e){return this.setState(function(r){return r.name!==e?{name:e}:null})},t.prototype.setDescription=function(e){return this.setState(function(r){return r.description!==e?{description:e}:null})},t.prototype.setUser=function(e){return this.setState(function(r){return r.user!==e?{user:e}:null})},t.prototype.setDeviceId=function(e){return this.setState(function(r){return r.deviceId!==e?{deviceId:e}:null})},t.prototype.setFocus=function(){this.DevSession.setFocus(this.state)},t.prototype.setCodeChangesDelay=function(e){this.codeChangesDelay!==e&&(this.codeChangesDelay=e,this._sendCodeChangesDebounced(this.state))},t.prototype.setWebPlayerURL=function(e){var r=this;this.setState(function(n){var i=e??bc.default.webPlayerURL;if(n.webPlayerURL!==i&&r.options.webPreviewRef){var a=n.transports;return a=Ui.addObject(a,"webplayer",nC.createWebPlayerTransport({ref:r.options.webPreviewRef,verbose:r.options.verbose,window:u8.default(window),webPlayerURL:i})),{webPlayerURL:i,transports:a}}return null})},t.prototype.sendCodeChanges=function(){this._sendCodeChangesDebounced(this.state,!0)},t.prototype._sendCodeChangesDebounced=function(e,r){var n=this;if(this.codeChangesTimer&&(clearTimeout(this.codeChangesTimer),this.codeChangesTimer=void 0),!r&&this.codeChangesDelay>0){this.codeChangesTimer=setTimeout(function(){return n._sendCodeChangesDebounced(e,!0)},this.codeChangesDelay);return}else if(!r&&this.codeChangesDelay<0)return;var i=e.transports,a=e.files,s=e.dependencies,o=e.sdkVersion;for(var c in i)i[c].postMessage({type:"update_code",data:{files:a,dependencies:s,sdkVersion:o}})},t.prototype.saveAsync=function(e){var r,n,i,a,s,o;return pg(this,void 0,void 0,function(){var c,l,f,g,m,y,A,k,I,F,J,pe,L,H,j,X,V,ie,fe,Re=this;return hg(this,function(ye){switch(ye.label){case 0:return c=this.state,[4,this.fileUploader.waitForCompletion()];case 1:ye.sent(),l=this.state,f=l.name,g=l.description,m=l.sdkVersion,y=l.files,A=l.dependencies,k=l.user,ye.label=2;case 2:return ye.trys.push([2,5,,6]),I={manifest:{sdkVersion:m,name:f,description:g,dependencies:iC.default(A,function(ze){return ze.version})},code:iC.default(y,function(ze){return ze=Xr({},ze),delete ze.error,ze}),dependencies:iC.default(A,function(ze){return ze=Xr({},ze),delete ze.error,ze}),isDraft:(r=e?.isDraft)!==null&&r!==void 0?r:!1},(n=this.logger)===null||n===void 0||n.info("Saving...",I),F=this.getPreviewAsync(),J=this.apiURL+"/--/api/v2/snack/save",[4,xu.fetch(J,{method:"POST",body:JSON.stringify(I),headers:Xr({"Content-Type":"application/json"},e?.ignoreUser?{}:xu.createUserHeader(k))})];case 3:return pe=ye.sent(),[4,pe.json()];case 4:if(L=ye.sent(),!L?.id)throw new Error(((a=(i=L.errors)===null||i===void 0?void 0:i[0])===null||a===void 0?void 0:a.message)||"Failed to save");return(s=this.logger)===null||s===void 0||s.info("Saved",L),H=L.id,j=xu.createURL(this.runtimeEndpoint,m,void 0,H),X=L.hashId,V=L.accountSnackId,ie=L.snackId,this.setState(function(ze){return{id:H,saveURL:j,unsaved:Ui.isUnsaved(ze,c),savedSDKVersion:e?.isDraft&&ze.savedSDKVersion?ze.savedSDKVersion:m,accountSnackId:V,snackId:ie}}),F.then(function(ze){var Ue=Object.values(ze).filter(function(de){return de.previewURL}).sort(function(de,Q){var Fe,We;return((Fe=de.previewTimestamp)!==null&&Fe!==void 0?Fe:0)-((We=Q.previewTimestamp)!==null&&We!==void 0?We:0)});Ue.length&&Re.uploadPreview(H,Ue[0].previewURL,Ue[0].status!=="error")}),[2,{id:H,url:j,hashId:X,accountSnackId:V,snackId:ie}];case 5:throw fe=ye.sent(),(o=this.logger)===null||o===void 0||o.error(fe),fe;case 6:return[2]}})})},t.prototype.getDownloadURLAsync=function(e){return pg(this,void 0,void 0,function(){var r;return hg(this,function(n){switch(n.label){case 0:return[4,this.fileUploader.waitForCompletion()];case 1:return n.sent(),r=this.getState(),!r.id||r.unsaved?[4,this.saveAsync(e)]:[3,3];case 2:n.sent(),r=this.getState(),n.label=3;case 3:return[2,this.apiURL+"/--/api/v2/snack/download/"+r.id]}})})},t.prototype.uploadPreview=function(e,r,n){var i,a,s,o,c,l;return pg(this,void 0,void 0,function(){var f,g,m,y,A;return hg(this,function(k){switch(k.label){case 0:f=this.apiURL+"/--/api/v2/snack/updateMetadata",g={id:e,previewLocation:r,status:n?"SUCCESS":"FAILURE"},(i=this.logger)===null||i===void 0||i.info("Uploading preview...",g),k.label=1;case 1:return k.trys.push([1,4,,5]),[4,xu.fetch(f,{method:"POST",body:JSON.stringify(g),headers:{"Content-Type":"application/json"}})];case 2:return m=k.sent(),[4,m.json()];case 3:if(y=k.sent(),y.id)(a=this.logger)===null||a===void 0||a.info("Uploaded preview",y);else throw new Error((c=(o=(s=y.errors)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.message)!==null&&c!==void 0?c:"Unknown error");return[3,5];case 4:return A=k.sent(),(l=this.logger)===null||l===void 0||l.error("Failed to upload preview",A),[3,5];case 5:return[2]}})})},t.prototype.getState=function(){return this.state},t.prototype.getStateAsync=function(){return pg(this,void 0,void 0,function(){return hg(this,function(e){switch(e.label){case 0:return[4,this.wantedDependencyVersions.waitForCompletion()];case 1:return e.sent(),[4,this.dependencyResolver.waitForCompletion()];case 2:return e.sent(),[4,this.fileUploader.waitForCompletion()];case 3:return e.sent(),[2,this.getState()]}})})},t.prototype.addStateListener=function(e){var r=this;return this.stateListeners.add(e),function(){return r.stateListeners.delete(e)}},t.prototype.setState=function(e){var r=e(this.state);if(r){var n=this.state,i=Xr(Xr({},n),r);this.state=this.updateDerivedState(i,n),this.onStateChanged(i,n),this.stateListeners.forEach(function(a){return a(i,n)})}},t.prototype.updateDerivedState=function(e,r){return e.unsaved=e.unsaved||Ui.isUnsaved(e,r),this.updateDerivedOnlineState(e,r),this.updateDerivedDependenciesState(e,r),this.updateDerivedWebPreviewState(e,r),e},t.prototype.onStateChanged=function(e,r){this.updateWantedDependencyVersions(e,r),this.updateDependencyResolver(e,r),this.updateFileUploader(e,r),this.updateTransports(e,r),this.DevSession.setState(e,r)},t.prototype.updateFiles=function(e){return this.setState(function(r){var n=Ui.updateObjects(r.files,e);return n!==r.files?{files:n}:null})},t.prototype.updateFileUploader=function(e,r){var n,i=e.files,a=r.files;if(!r.disabled&&(!e.disabled&&i!==a||e.disabled))for(var s in a)(!i[s]||i[s].contents!==a[s].contents||e.disabled)&&this.fileUploader.remove(s,a[s]);if(!e.disabled&&(i!==a||r.disabled))for(var s in i){var o=i[s];o.type==="ASSET"&&typeof o.contents=="object"&&!o.error&&(((n=a[s])===null||n===void 0?void 0:n.contents)!==o.contents||r.disabled)&&this.fileUploader.add(s,o)}},t.prototype.updateDependencies=function(e){return this.setState(function(r){var n=Ui.updateObjects(r.dependencies,e);return n!==r.dependencies?{dependencies:n,missingDependencies:yc.getMissingDependencies(n,r.sdkVersion,r.wantedDependencyVersions)}:null})},t.prototype.updateDerivedDependenciesState=function(e,r){var n,i,a,s;if(e.wantedDependencyVersions!==r.wantedDependencyVersions||e.dependencies!==r.dependencies)for(var o in e.dependencies){var c=e.dependencies[o],l=(s=(i=(n=e.wantedDependencyVersions)===null||n===void 0?void 0:n[o])!==null&&i!==void 0?i:(a=e.wantedDependencyVersions)===null||a===void 0?void 0:a[yc.getPackageName(o)])!==null&&s!==void 0?s:void 0;if(c.wantedVersion!==l){e.dependencies=e.dependencies===r.dependencies?Xr({},e.dependencies):e.dependencies;var f=(c.version==="*"||c.wantedVersion&&c.version===c.wantedVersion)&&l?l:c.version;e.dependencies[o]=Xr(Xr({},c),{version:f,wantedVersion:l}),c.handle&&c.version!==f&&delete e.dependencies[o].handle}}if(e.dependencies!==r.dependencies)for(var g in e.dependencies){var c=e.dependencies[g];if(c!==r.dependencies[g]){var m=yc.verifyDependency(g,c.version);m&&(e.dependencies[g]=Xr(Xr({},c),{error:m}))}}},t.prototype.updateWantedDependencyVersions=function(e,r){!e.disabled&&Object.keys(e.dependencies).length&&this.wantedDependencyVersions.setSDKVersion(e.sdkVersion)},t.prototype.updateDependencyResolver=function(e,r){var n,i,a,s=e.dependencies,o=r.dependencies;if(!r.disabled&&(s!==o||e.disabled||e.sdkVersion!==r.sdkVersion))for(var c in o)(!s[c]||s[c].version!==o[c].version||e.disabled||kf.isModulePreloaded(c,e.sdkVersion)&&!kf.isModulePreloaded(c,r.sdkVersion))&&this.dependencyResolver.remove(c,o[c].version,r.sdkVersion);if(!e.disabled&&(s!==o||r.disabled||e.sdkVersion!==r.sdkVersion||e.wantedDependencyVersions!==r.wantedDependencyVersions))for(var l in s){var f=s[l];!f.handle&&!f.error&&!kf.isModulePreloaded(l,e.sdkVersion)&&!(f.version==="*"&&!e.wantedDependencyVersions)&&(((n=o[l])===null||n===void 0?void 0:n.version)!==f.version||f.version==="*"&&!r.wantedDependencyVersions||!((i=o[l])===null||i===void 0)&&i.handle||!((a=o[l])===null||a===void 0)&&a.error||r.disabled)&&this.dependencyResolver.add(l,f.version,e.sdkVersion)}},t.prototype.setDisabled=function(e){return this.setState(function(r){return e!==r.disabled?{disabled:e}:null})},t.prototype.setOnline=function(e){var r=this;return this.setState(function(n){if(e&&!n.transports.pubsub)return{transports:Ui.addObject(n.transports,"pubsub",r.createTransport({name:"pubsub",apiURL:r.apiURL,snackpubURL:r.snackpubURL,channel:n.channel,verbose:!!r.logger}))};if(!e&&n.transports.pubsub){var i=n.connectedClients;for(var a in n.connectedClients)n.connectedClients[a].transport==="pubsub"&&(i=Ui.removeObject(i,a));return{transports:Ui.removeObject(n.transports,"pubsub"),connectedClients:i}}else return null})},t.prototype.updateDerivedOnlineState=function(e,r){var n=e.transports,i=e.sdkVersion,a=e.channel,s=e.id,o=e.name,c=e.disabled,l=e.savedSDKVersion;(n!==r.transports||i!==r.sdkVersion||a!==r.channel||s!==r.id||o!==r.name||l!==r.savedSDKVersion)&&(e.online=!!n.pubsub&&!c,e.url=xu.createURL(this.runtimeEndpoint,i,a,l&&l!==i?void 0:s),e.onlineName=""+(o||"Unnamed Snack"))},t.prototype.updateDerivedWebPreviewState=function(e,r){var n=e.transports,i=e.sdkVersion,a=e.url,s=e.webPlayerURL;(a&&!r.url||i!==r.sdkVersion||s!==r.webPlayerURL)&&(e.webPreviewURL=n.webplayer&&s?nC.getWebPlayerIFrameURL(s,i,a,!!this.logger):void 0)},t.prototype.reloadConnectedClients=function(){var e,r=new Set;this.setState(function(i){var a=i.connectedClients;for(var s in i.connectedClients){var o=i.connectedClients[s];r.add(i.transports[o.transport]),a=Ui.addObject(a,s,Xr(Xr({},o),{status:"reloading"}))}return a!==i.connectedClients?{connectedClients:a}:null});var n={type:"RELOAD_SNACK"};r.size&&((e=this.logger)===null||e===void 0||e.comm("Reloading..."),r.forEach(function(i){i.postMessage({type:"protocol_message",data:n})}))},t.prototype.getPreviewAsync=function(){var e=this,r,n=this.state,i=n.connectedClients,a=n.transports,s=new Set;if(Object.values(i).forEach(function(c){var l=c.transport;return s.add(a[l])}),!s.size)return Promise.resolve(i);var o={type:"REQUEST_STATUS"};return s.size&&((r=this.logger)===null||r===void 0||r.comm("Requesting preview..."),s.forEach(function(c){c.postMessage({type:"protocol_message",data:o})})),new Promise(function(c,l){var f,g=new Set,m=e.addStateListener(function(y,A){var k;if(y.connectedClients!==A.connectedClients){for(var I in i)if((i[I].previewTimestamp!==((k=y.connectedClients[I])===null||k===void 0?void 0:k.previewTimestamp)||!y.connectedClients[I])&&(g.add(I),g.size===Object.values(i).length)){m(),clearTimeout(f),c(y.connectedClients);return}}});f=setTimeout(function(){m(),l(new Error("Operation timed out"))},e.previewTimeout)})},t.prototype.updateTransports=function(e,r){var n=this,i=e.transports,a=r.transports;if(!r.disabled&&(i!==a||e.disabled))for(var s in a)this.transportListeners[s]&&(i[s]!==a[s]||e.disabled)&&(a[s].removeEventListener("message",this.transportListeners[s]),delete this.transportListeners[s],a[s].postMessage({type:"stop"}));if(!e.disabled&&(i!==a||r.disabled)){var o=function(l){!c.transportListeners[l]&&(i[l]!==a[l]||r.disabled)&&(c.transportListeners[l]=function(f){return n.onTransportEvent(l,f)},i[l].addEventListener("message",c.transportListeners[l]),i[l].postMessage({type:"start"}))},c=this;for(var s in i)o(s)}!e.disabled&&!Ui.isBusy(e)&&(i!==a||Ui.isCodeChanged(e,r)||r.disabled)&&this._sendCodeChangesDebounced(e,a!==i||!Ui.isBusy(e)&&Ui.isBusy(r))},t.prototype.onClientConnected=function(e,r,n){this.setState(function(i){return{connectedClients:Ui.addObject(i.connectedClients,r,{transport:e,id:n.id,name:n.name,platform:n.platform,status:"ok"})}})},t.prototype.onClientDisconnected=function(e,r,n){var i=this;this.setState(function(a){var s=a.connectedClients[r];if(s?.status==="reloading"&&i.reloadTimeout>=0)return i.pruneConnectionsTimer&&(clearTimeout(i.pruneConnectionsTimer),i.pruneConnectionsTimer=void 0),i.pruneConnectionsTimer=setTimeout(function(){i.pruneConnectionsTimer=void 0,i.setState(function(c){var l=c.connectedClients;for(var f in c.connectedClients)c.connectedClients[f].status==="reloading"&&(l=Ui.removeObject(l,f));return l!==c.connectedClients?{connectedClients:l}:null})},i.reloadTimeout),null;var o=Ui.removeObject(a.connectedClients,r);return o!==a.connectedClients?{connectedClients:o}:null})},t.prototype.addLogListener=function(e){var r=this;return this.logListeners.add(e),function(){return r.logListeners.delete(e)}},t.prototype.onProtocolMessageReceived=function(e,r,n){var i;if(this.state.connectedClients[r])switch(n.type){case"CONSOLE":this.onConsoleMessageReceived(r,n);break;case"ERROR":this.onErrorMessageReceived(r,n);break;case"STATUS_REPORT":this.onStatusReportMessageReceived(r,n);break;case"CODE":break;case"RELOAD_SNACK":break;case"REQUEST_STATUS":break;default:(i=this.logger)===null||i===void 0||i.error("Invalid message received",e,n);break}},t.prototype.onProtocolMessageSent=function(e,r){switch(r.type){case"CODE":this.setState(function(n){var i=n.connectedClients;for(var a in i){var s=i[a];s.transport===e&&(i=Ui.addObject(i,a,Xr(Xr({},s),{error:void 0,status:s.status==="error"?"ok":s.status})))}return i!==n.connectedClients?{connectedClients:i}:null});break}},t.prototype.onConsoleMessageReceived=function(e,r){var n=r.payload||[],i={type:r.method,connectedClient:this.state.connectedClients[e],message:n.join(" ")};this.logListeners.forEach(function(a){return a(i)})},t.prototype.onErrorMessageReceived=function(e,r){var n,i,a;try{var s=JSON.parse(r.error),o=xu.createError({name:s.name||"Error",message:s.message||"",fileName:s.fileName,lineNumber:s.lineNumber||((n=s.loc)===null||n===void 0?void 0:n.line)||s.line,columnNumber:s.columnNumber||((i=s.loc)===null||i===void 0?void 0:i.column)||s.column,stack:s.stack});this.setState(function(c){return{connectedClients:Ui.addObject(c.connectedClients,e,Xr(Xr({},c.connectedClients[e]),{error:o,status:"error"}))}})}catch{(a=this.logger)===null||a===void 0||a.error("Failed to parse received error message",r)}},t.prototype.onStatusReportMessageReceived=function(e,r){var n=r.previewLocation;this.setState(function(i){return{connectedClients:Ui.addObject(i.connectedClients,e,Xr(Xr({},i.connectedClients[e]),{previewURL:n,previewTimestamp:Date.now()}))}})},t}();Hn.default=dwe});var f8=D(d8=>{"use strict";Object.defineProperty(d8,"__esModule",{value:!0})});var g8=D(Or=>{"use strict";var fwe=Or&&Or.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),p8=Or&&Or.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&fwe(e,t,r)},h8=Or&&Or.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Or,"__esModule",{value:!0});Or.parseRuntimeUrl=Or.createRuntimeUrl=Or.Snack=Or.defaultConfig=Or.getDeprecatedModule=Or.standardizeDependencies=Or.isFeatureSupported=Or.getSupportedSDKVersions=Or.isValidSemver=Or.getPreloadedModules=Or.isModulePreloaded=void 0;var Cu=yu();Object.defineProperty(Or,"isModulePreloaded",{enumerable:!0,get:function(){return Cu.isModulePreloaded}});Object.defineProperty(Or,"getPreloadedModules",{enumerable:!0,get:function(){return Cu.getPreloadedModules}});Object.defineProperty(Or,"isValidSemver",{enumerable:!0,get:function(){return Cu.isValidSemver}});Object.defineProperty(Or,"getSupportedSDKVersions",{enumerable:!0,get:function(){return Cu.getSupportedSDKVersions}});Object.defineProperty(Or,"isFeatureSupported",{enumerable:!0,get:function(){return Cu.isFeatureSupported}});Object.defineProperty(Or,"standardizeDependencies",{enumerable:!0,get:function(){return Cu.standardizeDependencies}});Object.defineProperty(Or,"getDeprecatedModule",{enumerable:!0,get:function(){return Cu.getDeprecatedModule}});Object.defineProperty(Or,"createRuntimeUrl",{enumerable:!0,get:function(){return Cu.createRuntimeUrl}});Object.defineProperty(Or,"parseRuntimeUrl",{enumerable:!0,get:function(){return Cu.parseRuntimeUrl}});var pwe=h8(l8());Or.Snack=pwe.default;var hwe=h8(rb());Or.defaultConfig=hwe.default;p8(Kx(),Or);p8(f8(),Or)});var _8=D((ADe,b8)=>{"use strict";var m8=_i(),gwe=g8();function mwe(t,e,r,n){var i=new gwe.Snack({files:y8(t),name:e,description:r,sdkVersion:"53.0.0",dependencies:{"react-native-webview":{version:"10.10.0",isUserSpecified:!0}},online:!0,codeChangesDelay:1e3});return Promise.resolve(i)}function v8(t,e){var r=y8(t);return e.updateFiles(r),e.sendCodeChanges(),e.getStateAsync().then(function(i){return i.url})}function vwe(t,e,r,n,i){return _we(t,r,n,i).catch(function(a){return ywe(t,e,r)})}function ywe(t,e,r){return v8(t,e).then(function(){return e.saveAsync()}).then(function(n){var i=n.url;return bwe(i,r)})}function bwe(t,e){return new Promise(function(r,n){m8.send({method:"publish_expo_metadata",app:"editor",type:"POST",data:{userProgramID:e,expoUrl:t},success:function(i){return i.status==="ok"?r({expoUrl:i.expoUrl,codehsUrl:i.codehsUrl}):n()},error:function(i){return n()}})})}function _we(t,e,r,n){return new Promise(function(i,a){m8.send({method:"publish_expo_project",app:"editor",type:"POST",data:{userProgramID:e,code:t,name:r,description:n},success:function(s){return s.status==="ok"?i({expoUrl:s.expoUrl,codehsUrl:s.codehsUrl}):a()},error:function(s){return a()}})})}function y8(t){return{"app.js":{contents:t,type:"CODE"}}}b8.exports={sessionPromise:mwe,updateSessionCode:v8,publishSnack:vwe}});var Ub=D((IDe,E8)=>{"use strict";var sC=_8(),wwe=_i(),gg=ui(),Twe=BA().GULP_URL,Swe=gg.LOCAL_URL,w8="#react-native-destination",T8=".expo-publish-destination";function Ewe(t,e,r,n){var i=$(t.target),a=i.parent().parent(),s=i.data("field"),o=i.prop("checked");return xwe(s,o,r.userProgramID).then(function(c){a.append("<i class='status-icon icon-ok icon-green'></i>")}).catch(function(c){i.prop("checked",!o),a.append("<i class='status-icon icon-remove icon-red'></i>")}).finally(function(){setTimeout(function(){$(".status-icon").remove()},800)}).then(function(){return S8(e,n,w8)})}function xwe(t,e,r){return new Promise(function(n,i){wwe.send({method:"set_expo_metadata_field",app:"editor",type:"POST",data:{userProgramID:r,field:t,value:e},success:function(a){return a.status==="ok"?n():i()},error:function(a){return i()}})})}function S8(t,e,r){return sC.updateSessionCode(t,e).then(function(n){gg.writeQRCode(n,r)})}function Cwe(t,e){return sC.sessionPromise(t,e.codeTitle,e.codeDescription,e.replConsole)}function Awe(t,e,r,n){return sC.publishSnack(t,r,e.userProgramID,e.codeTitle,e.codeDescription).then(function(i){gg.writeQRCode(i.expoUrl,T8),Iwe(i.codehsUrl,n)})}function Iwe(t,e){e=typeof e>"u"?e:!1;var r=$("#publish-link");r.text(t),r.attr("href",t),$("#publish-button").text("Republish"),$("#publish-url").show(),e&&($("#publish-button-container").append("<i class='status-icon icon-ok icon-green'></i>"),setTimeout(function(){$(".status-icon").remove()},800))}function kwe(t,e){var r=e.includes("localhost")?Swe:Twe,n=$("#show-buttons-switch").prop("checked"),i=$("#start-immediately-switch").prop("checked"),a=$("#full-screen-switch").prop("checked"),s={showButtons:n,startImmediately:i,fullScreen:a,placeholderCode:t,GULP_URL:r},o=gg.getAndApplyTemplate(s);return o}function Owe(t,e){gg.writeQRCode(t,e)}E8.exports={checkboxChange:Ewe,updateCode:S8,publishCode:Awe,sessionPromise:Cwe,userCodeToReactCode:kwe,writeQRCode:Owe,SNACK_SESSION_QR_DOM:w8,PUBLISH_QR_DOM:T8}});var C8=D((kDe,x8)=>{x8.exports='<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M448 312.43c.77-1.11 1.51-2.26 2.27-3.34A174.55 174.55 0 00480 211.85C480.32 112.55 396.54 32 292.94 32c-90.36 0-165.74 61.49-183.4 143.12a172.81 172.81 0 00-4 36.83c0 99.4 80.56 182.11 184.16 182.11 16.47 0 38.66-4.95 50.83-8.29s24.23-7.75 27.35-8.94 8-2.41 11.89-1.29l77.42 22.38a4 4 0 005-4.86l-17.72-67.49c-1.23-5-1.39-5.94 3.53-13.14z"></path><path d="M312.54 415.38a165.32 165.32 0 01-23.26 2.05c-42.43 0-82.5-11.2-115-32.2a184.09 184.09 0 01-53.09-49.32c-26.08-34.57-40.3-78.51-40.3-124.49 0-3.13.11-6.14.22-9.16a4.34 4.34 0 00-7.54-3.12 158.76 158.76 0 00-14.86 195.24c2.47 3.77 3.87 6.68 3.44 8.62l-14.09 72.26a4 4 0 005.22 4.53l68-24.24a16.85 16.85 0 0112.92.22c20.35 8 42.86 12.92 65.37 12.92a169.45 169.45 0 00116.63-46 4.29 4.29 0 00-3.66-7.31z"></path></svg>'});var A8=D((ODe,Pwe)=>{Pwe.exports=`<style>
    #share-modal #share-modal-link-wrapper {
        display: flex;
    }

    #share-modal #share-modal-link-input {
        cursor: auto;
        background-color: white;
        width: 75%;
        margin: 3px;
        flex: 1;
    }

    #share-modal .share-modal-info {
        padding: 10px;
        margin: 10px 0 0;
        background-color: rgba(39,169,225,.15);
        color: #27a9e1;
        border-radius: 3px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    #share-modal .share-modal-info-icon {
        padding-right: 3px;
    }

    #share-modal input {
        margin: 5px auto;

    }

    #share-modal input.error {
        border-color: red;
    }

    #sharemodal .info-text {
        margin-top: 15px;
    }

    #sharemodal .info-text .icon-info-sign {
        margin-right: 5px;
    }

    #sharemodal  #course-select-section {
        margin-top: 15px;
    }

    #share-modal h3.advanced-settings {
        margin-bottom: 0px;
    }
    .modal-footer {
        margin-top: 0px;
    }

    #collab-enabled-section p {
        font-size: 16px;
        font-weight: bold;
        text-align: center;
    }

    #collab-disabled-section {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    #collab-disabled-section p {
        font-size: 20px;
    }
</style>
<div id="share-modal">
    <div id="share-url" class="share-publish-url">
        <div id="share-type-switch">
            <button value="Code" class="btn active">
                <i class="fas fa-share-alt"></i>
                Share
            </button>
            <button value="Embed" class="btn">
                <i class="far fa-file-code"></i>
                Embed
            </button>
            {{#if canBeAssigned }}
            <button value="Assign" class="btn">
                <i class="far fa-check-circle"></i>
                Assign
            </button>
            {{/if}}
            {{#if showCollaborateTab }}
            <button value="Collaborate" class="btn">
                <i class="fas fa-user-friends"></i>
                Collaborate
            </button>
            {{/if}}
        </div>
    </div>
    {{#if isLoggedOut }}
    <div id="logged-out-banner" class="alert alert-warning">
        You are using CodeHS with no account. {{#if showEditWarning }}<span id="logged-out-edit-warning">Anyone with this link will be able to edit this program. </span>{{/if}}<a target="_blank" href="/login?next=/signup/from_sandbox/{{itemID}}">Log in</a> or <a target="_blank" href="/signup/from_sandbox/{{itemID}}">sign up</a> for an account to <span id="logged-out-banner-message">change the share settings for this program.</span>
    </div>
    {{else}}
    {{/if}}
    <div id="share-modal-contents">
        <input id="share-modal-share-link" value="{{shareURL}}" target="_blank" class="hidden"></input>
        <button class="btn btn-main-transparent share-modal-btn js-share-modal-copy hidden">
            <span>copy</span>
            <i class="far fa-clone"></i>
        </button>

        <div id="share-options" class="checkbox-container">
            <div>
                <div class="checkbox-display">
                    {{#if isActive }}
                        <input type="checkbox" id="share-modal-active-switch" class="sharing-option-checkbox share-tab-checkbox" checked>
                    {{else}}
                        <input type="checkbox" id="share-modal-active-switch" class="sharing-option-checkbox share-tab-checkbox">
                    {{/if}}
                    <label class="sharing-option-label">
                        Public
                        <p>Allow others to run your program without seeing the code.</p>
                    </label>
                </div>
                <input id="share-modal-public-link" value="{{shareURL}}" target="_blank" class="hidden"></input>
                <button class="btn btn-main-transparent share-public-modal-btn js-share-modal-copy" id="share-public-copy">
                    <span>copy</span>
                    <i class="far fa-clone"></i>
                </button>
            </div>
            <div id="code-display-container">
                <div class="checkbox-display">
                    {{#if showCode }}
                        <input type="checkbox" id="share-modal-show-code-switch" class="sharing-option-checkbox share-tab-checkbox" checked>
                    {{else}}
                        <input type="checkbox" id="share-modal-show-code-switch" class="sharing-option-checkbox share-tab-checkbox">
                    {{/if}}
                    <label class="sharing-option-label">
                        Show code
                        <p>Allow others to view your code and run your program. </p>
                    </label>
                </div>
                <input id="share-modal-copy-link" value="{{shareURL}}" target="_blank" class="hidden"></input>
                <button class="btn btn-main-transparent share-code-modal-btn js-share-modal-copy" id="share-code-copy">
                    <span>copy</span>
                    <i class="far fa-clone"></i>
                </button>
            </div>

            {{#if showSocialMedia }}
            <label class="sharing-option-label">Social media</label>
            <div class="sharing-option">
                <a href="https://www.facebook.com/dialog/feed?&app_id=374319315985729&link=https%3A%2F%2Fcodehs.com%2Fshare%2F{{shareIdentifier}}&display=popup&quote=Check out this cool beat I made with Code Remix and let me know what you think!&hashtag=#UnlockTheBeat" target="_blank"><i class="icon-facebook-sign large share" rel="tooltip" title="Share on Facebook"></i></a>
                <a id="twitter-share-link" href="https://twitter.com/intent/tweet?text=Check%20out%20this%20cool%20beat%20I%20made%20with%20Beats%20Unlocked%20and%20let%20me%20know%20what%20you%20think!&url=https%3A%2F%2Fcodehs.com%2Fshare%2F{{shareIdentifier}}&hashtags=UnlockTheBeat&via=codehs" target="_blank"><i class="icon-twitter-sign large share" rel="tooltip" title="Share on Twitter"></i></a>
            </div>
            {{/if}}
        </div>

        <div id="embed-options" class="hidden">
            <div class="dimension-container">
                <div class="embed-dimension">
                    <label class="">Display</label>
                    <select id="embed-opt-display-type" class="small-dropdown">
                        <option value="default">App &amp; Code</option>
                        <option value="displayOnly">App Only</option>
                        <option value="editorOnly">Code Only</option>
                    </select>
                </div>
                <div class="embed-dimension">
                    <label class="">Width</label>
                    <input type="text" id="embed-opt-width" placeholder="850">
                </div>
                <div class="embed-dimension">
                    <label class="">Height</label>
                    <input type="text" id="embed-opt-height" placeholder="500">
                </div>
            </div>
            <div id="embed-display-options" class="checkbox-container">
                <div class="checkbox-display">
                    <input type="checkbox" id="embed-opt-read-only" class="sharing-option-checkbox">
                    <label class="sharing-option-label">
                        Read Only
                        <p>Prevent others from modifying the embedded code.</p>
                    </label>
                </div>
                <div class="checkbox-display">
                    <input type="checkbox" id="embed-opt-show-tree" class="sharing-option-checkbox">
                    <label class="sharing-option-label">
                        Show File Tree
                        <p>Show the file tree in the embedded editor.</p>
                    </label>
                </div>
            </div>
        </div>

        {{#unless isLoggedOut}}
        <div id="collab-container" class="hidden">
            <div id="collab-disabled-section">
                <p>Collaboration is currently disabled for this program.</p>
                <button id="enable-collab-button" class="btn btn-main">Enable Collaboration</button>
            </div>
            <div id="collab-enabled-section" class="hidden">
                <p>Share this link to let others collaborate on this program with you!</p>
                <input id="share-modal-collab-link"></input>
                <button class="btn btn-main-transparent share-modal-btn js-share-modal-collab-copy">
                    <span>copy</span>
                    <i class="far fa-clone"></i>
                </button>
            </div>
        </div>
        {{/unless}}
    </div>
    <div id="assign-options" class="hidden">
        <div class="info-text">
            <p><span class="icon icon-info-sign"></span> The starter code for this assignment will automatically be generated from your sandbox program. Any future changes made to this sandbox program will not affect this assignment.</p>
        </div>
        <div id="description-container">
            <label class="sharing-option-label description-label">Description<span class="chs-icon chs-icon-check text-green hidden"></span></label>
            <p>This is the exercise prompt your students will see when they open this assignment</p>
            <div id="markdown-editor" class="description-container">
                <textarea name="description" id="share-modal-edit-description">{{itemDescription}}</textarea>
                <div id="preview-description-text" data-markdown="{{itemDescription}}"></div>
            </div>
        </div>
         <div id="item-type-container">
            <label class="sharing-option-label item-type-label">Assign as</label>
            <div class="item-type-picker-container">
                <select class="item-type-select selectpicker" data-dropup-auto="false" data-width="50%">
                    <option data-type="{{C.ItemType.EXERCISE}}">Exercise</option>
                    <option data-type="{{C.ItemType.EXAMPLE}}">Example</option>
                </select>
            </div>
        </div>
        <div id="course-select-section">
            <label class="sharing-option-label">Choose a Course</label>
            <div class="course-picker-container">
                <select class="course-select selectpicker" data-dropup-auto="false" data-width="438px">
                    <option disabled="">Choose a Course</option>
                    {{#each activeTeacherCourses as | course |}}
                        <option value="{{[id]}}" id="{{[id]}}">{{[name]}}</option>
                    {{/each}}
                </select>
                <button class="btn btn-main btn-main-green assign-btn" id="share-modal-assign-btn">Assign</button>
            </div>
        </div>
        <div id="links-section" class="hidden">
            <a class="view-link" target="_blank">View Assignment in the Course</a>
        </div>
    </div>
</div>
`});var I8=D((PDe,Rwe)=>{Rwe.exports=`<style>
.abacus-fork-modal .row {
    display: flex;
    height: 83px;
    position: relative;
    width: 100%;
    padding: 0px 20px;
    margin-top: 20px;
    margin-bottom: 0;
    align-items: center;
}
 .abacus-fork-modal .text-wrap {
    display: flex;
    align-items: center;
    word-break: break-all;
}
.abacus-fork-modal .sandbox-program-title {
    font-size: 24px;
    font-weight: 200;
    color: #555;
}
.abacus-fork-modal img {
    height: 80px;
    margin-right: 20px;
    vertical-align: middle;
}
#abacus-fork-submit {
    height: 40px;
    margin-left: auto;
}
</style>
<div class="abacus-fork-modal">
    <div class="row">
        <img src="{{STATIC_URL}}img/program_icons/{{ progTypeString }}.png"/>
        <div class="text-wrap">
            <h1 class="sandbox-program-title">
                <span id="forked-program-title-display-span">{{itemTitle}}</span> (Forked from {{sharedProgramOwnerAttribution}})
            </h1>
        </div>
        <button class="btn btn-main" id="abacus-fork-submit">Fork!</button>
    </div>
</div>

`});var k8=D((RDe,Dwe)=>{Dwe.exports=`<style>
    #contest-modal .contest-modal-btn {
        color: #27a9e1;
        border-color: #27a9e1;
        margin: 3px;
    }
    #contest-modal .contest-modal-btn:hover {
        color: rgb(39,169,225);
    }
    #contest-modal input.error {
        border-color: red;
    }
</style>
<div id="contest-modal">
    <div>
        <div id="contest-just-submitted" class="hidden">
            <h3>
                Successfully submitted to <a class="contest-url-link" target="_blank">!</a>
            </h3>
            <div><strong>Submit to another contest?</strong></div>
        </div>

        <div id="contest-already-submitted" class="hidden">
            <h3>You've already submitted this program to <a class="contest-url-link" target="_blank"></a>!</h3>
            <div><strong>Submit to another contest?</strong></div>
        </div>

        <div class="contest-not-submitted">
            <h3>Submit to a Contest!</h3>
            <div><strong>If you have a contest code, enter it here</strong></div>
        </div>

        <div class="submit-to-contest-wrapper">
            {{#if isLoggedOut}}
                <input id="contest-contact-me-input" type="checkbox" checked>
                <span>I would like to be contacted about contest results</span>
                <input id="contest-user-name-input" type="text" placeholder="First Name Last Initial" autocomplete="off">
                <input id="contest-user-email-input" type="text" placeholder="name@email.com" autocomplete="off">
            {{/if}}
            <input class="spacing-top" id="contest-id-input" style="display: inline-block;" type="text" placeholder="Contest Code">
            <button id="submit-to-contest-btn" type="submit" class="btn btn-main-transparent contest-modal-btn spacing-top"><span class="icon icon-external-link"></span> Submit</button>
        </div>

        <div class="contest-past-submissions-container hidden">
            <hr>
            <div><strong>Past Submissions</strong></div>
            <ul id="contest-past-submissions" style="margin-bottom: 0px;"></ul>
        </div>
    </div>
</div>
`});var O8=D((DDe,Lwe)=>{Lwe.exports=`<style>
    #contest-modal .contest-modal-btn {
        color: #27a9e1;
        border-color: #27a9e1;
        margin: 3px;
    }
    #contest-modal .contest-modal-btn:hover {
        color: rgb(39,169,225);
    }
    #contest-modal input.error {
        border-color: red;
    }
</style>
<div id="contest-modal">
    <div>
        <div id="section-contest-just-submitted" class="hidden">
            <h3>Successfully submitted to <span class="contest-name">!</span></h3>
        </div>

        <div id="section-contest-already-submitted" class="hidden">
            <h3>You've already submitted this program to <span class="contest-name">!</span></h3>
        </div>

        <div id="section-contest-not-submitted">
            <h3>Submit to the Beat Showcase for your Section:</h3>
            <button id="submit-to-section-contest-btn" class="btn btn-main-transparent contest-modal-btn spacing-top">
                <span class="icon icon-external-link"></span> Submit
            </button>
        </div>
    </div>
</div>
`});var Fb=D((exports,module)=>{var Ajax=_i(),_=Qg(),h=FD(),html=GD()(h),alertModal=Jl(),validEmail=ui().validEmail,PubSub=Cr(),submit=Ql(),EditorInstructions=YD(),ShareTab=$T(),LMSGradingTab=FT(),HelpTab=HT(),ConversationTab=GA(),GradingTab=Nv(),UploadTab=zT(),PhoneTab=WT(),TypeTester=VA(),KarelWorld=Zf(),RunnerFactory=vy(),QuillCustom=Zl(),flattenAbacusFiles=Ni().flattenAbacusFiles,mapAbacusFiles=Ni().mapAbacusFiles,groupsToPermissions=Ni().groupsToPermissions,turtleTemplate=qA(),turtleInputOerrideTemplate=yy(),template=Zg(),expoIntegrationUtils=Ub(),getQueryParams=ui().getQueryParams,modalAlert=ui().alert,conversationTabIcon=C8(),SHARE_MODAL_TEMPLATE=A8(),FORK_MODAL_TEMPLATE=I8(),CONTEST_MODAL_TEMPLATE=k8(),BU_CONTEST_MODAL_TEMPLATE=O8(),FAVORITE_PROGRAM_STAR=".favorite-program-star",GRADE_CODE_BUTTON="button.grade_code",GRADING_TAB_CHECK_BUTTON="#grading-unit-test-run",SUBMIT_BUTTON="#submit-button",RUN_BUTTON=".run_code",SUBMIT_CORRECT_BUTTON="#submit-correct",AI_EASIER_BUTTON="#ai-easier-button",AI_CHALLENGE_BUTTON="#ai-challenge-button",SHARE_SCREENSHOT_WAIT_TIME=5e3,CODE_LINE_LIMIT=1e4,mostRecentSavedCode,submittedToContest={},C=Nr(),{fetchAjaxTabRequests,registerAjaxTabRequest,htmlDecode,loadHistory,cleanupTabRequests,updateQueryString,deriveAbacusSettings}=ep(),JavaErrors=gh(),{createDOMSubtreeModifiedListener}=ui(),BASE_URL=C.Uploads.UPLOADS_PROXY_BASE_URL,TIMERS=[],ANSI={transform:function(t){var e=new RegExp(["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|"),"g");return t.replace(e,"")}};function onCollaborationEnabled(t){if(!window.pageSpecific.showCollabTab)return;let e={identifier:t};if(window.pageSpecific.sharedProgramID)e={...e,shared_program_id:window.pageSpecific.sharedProgramID};else if(window.pageSpecific.studentAssignmentID)e={...e,student_assignment_id:window.pageSpecific.studentAssignmentID};else{window.toastr.error("No shared program or student assignment found to collaborate on");return}Ajax.send({method:"setup_collaboration",app:"editor",data:e});let r=window.location.href;if(!r.includes(t)){let n="collaborate="+t;r.endsWith("?")?r+=n:r+=(r.includes("?")?"&":"?")+n}$("#share-modal-collab-link").val(r)}function onCollaborationDisabled(){if(window.pageSpecific.showCollabTab)return new Promise(function(t,e){let r;window.pageSpecific.sharedProgramID?r={shared_program_id:window.pageSpecific.sharedProgramID}:window.pageSpecific.studentAssignmentID?r={student_assignment_id:window.pageSpecific.studentAssignmentID}:(window.toastr.error("No shared program or student assignment found to collaborate on"),t()),Ajax.send({method:"disable_collaboration",app:"editor",data:r,success:function(n){n.status==="ok"?t():e()}})})}function onCollabModeChanged(t){return new Promise(function(e,r){let n={section_id:window.pageSpecific.sectionID};n.mode=t,Ajax.send({method:"set_assignment_collab_mode",app:"editor",data:n,success:function(i){i.status==="ok"?e():r()}})})}function onCollabIdentifierReset(){if(window.pageSpecific.showCollabTab)return new Promise(function(t,e){let r;window.pageSpecific.sharedProgramID?r={shared_program_id:window.pageSpecific.sharedProgramID}:window.pageSpecific.studentAssignmentID?r={student_assignment_id:window.pageSpecific.studentAssignmentID}:(window.toastr.error("No shared program or student assignment found to collaborate on"),t()),Ajax.send({method:"reset_collab_identifier",app:"editor",data:r,success:function(n){n.status==="ok"?t():e()}})})}function onAudioDataReceived(t){let e=new FormData;return e.append("file",t),new Promise(function(r,n){$.ajax({url:"/core/ajax/code_remix_upload_beat",type:"POST",data:e,processData:!1,dataType:"JSON",contentType:!1}).then(i=>{r(i.url)})})}function onSendAudioText(t,e){let r="Download your beat at https://codehs.com/uploads/"+e;return new Promise(function(n,i){Ajax.send({method:"send_text_message",app:"core",data:{phone_number:t,message:r},success:function(a){a.status==="ok"?(window.toastr.success("Text Message Sent!"),n()):i(a.msg)}})})}function shimAbacusForModules(t){var e={cleanup:function(){},sqlSetup:window.pageSpecific.helper_code,getCode:function(){let r=flattenAbacusFiles(t.getCodeTree()).filter(n=>n.main)?.[0];return r?r.text:flattenAbacusFiles(t.getCodeTree())[0].text},getCurrentCode:function(){return flattenAbacusFiles(t.getCodeTree()).reduce(function(r,n){var i={};return i[n.name]=n.text,Object.assign(r,i)},{})},currentCode:flattenAbacusFiles(t.getCodeTree()).reduce(function(r,n){var i={};return i[n.name]=n.text,Object.assign(r,i)},{}),code:flattenAbacusFiles(t.getCodeTree()).reduce(function(r,n){var i={};return i[n.name]=n.text,Object.assign(r,i)},{}),setCode:function(r){var n=Object.entries(r).reduce(function(i,a,s){return Object.assign({name:a[0],text:a[1],main:s===0},i)},{});t.setCodeTree([n])},studentAssignmentID:window.pageSpecific.studentAssignmentID,getItemType:function(){return window.pageSpecific.itemType},itemType:window.pageSpecific.itemType,isOwnPage:function(){return window.pageSpecific.viewerID===window.pageSpecific.codeUserID},isHourOfCode:function(){return window.pageSpecific.editorType==="hourofcode"},getProgrammingLanguage:function(){return window.pageSpecific.programmingLanguage},getProgramType:function(){return window.pageSpecific.progType},getItemID:function(){return window.pageSpecific.itemID},autograderCode:JSON.parse(window.pageSpecific.autograderCode),autograderConfig:window.pageSpecific.autograderConfig,codeUserID:window.pageSpecific.codeUserID,viewerID:window.pageSpecific.viewerID,solutionCode:htmlDecode(window.pageSpecific.solutionCode),save:function(r,n){n!==void 0?saveCode(t.getCodeTree(),!1,n).then(function(){r()}):saveCode(t.getCodeTree()).then(function(){r()})},getInfo:function(){return this.info},info:{codeUserID:window.pageSpecific.codeUserID,itemID:window.pageSpecific.itemID,studentAssignmentID:window.pageSpecific.studentAssignmentID,moduleID:window.pageSpecific.moduleID,courseID:window.pageSpecific.courseID,sql_tables:window.pageSpecific.sql_tables},itemID:window.pageSpecific.itemID,moduleID:window.pageSpecific.moduleID,courseID:window.pageSpecific.courseID,stop:function(){window.CodeHSConsole.clear()},cleanNewLine:function(r){return r=r.replace(/\r\n/g,`
`),r=r.replace(/\r/g,`
`),r},abc:t.abc,wasShimmed:!0,runOnHub:!0,clearHighlightedLines:function(){},graderExec:(r,n,i)=>new Promise((a,s)=>{PubSub.trigger("utils:disableButton",".run_code"),PubSub.trigger("utils:disableButton","button.grade_code"),PubSub.trigger("utils:disableButton","#grading-unit-test-run"),PubSub.trigger("ProgramRun:create",{userId:i.codeUserID,itemId:i.itemID,usesHub:!0,startTime:Date.now()}),t.execWithExistingConnection(r,n).then(o=>{if(PubSub.trigger("utils:enableButton",".run_code"),PubSub.trigger("utils:enableButton","button.grade_code"),PubSub.trigger("utils:enableButton","#grading-unit-test-run"),PubSub.trigger("ProgramRun:successful",Date.now()),t.shim.typeTester.isJava()&&t.shim.javaErrorChecker){var c={name:"karel"},l=[];for(var f in n)if(n.hasOwnProperty(f)){var g={};g.name=f,g.contents=n[f],l.push(g)}c.contents=l,t.shim.javaErrorChecker.check(o.split(`
`),c)}a(ANSI.transform(o))})})};e.typeTester=new TypeTester(e),e.javaErrorChecker=new JavaErrors(e),window.Ed=e,t.shim=e}function setup(){setupTestCasesAIButton(),!window.pageSpecific.showTeacherSaveButton&&!window.pageSpecific.previewOnly&&setupAutosave(),window.pageSpecific.trackKeystrokes&&setupTrackingKeystrokes(),setupTrackingHeartbeat();let permissions=groupsToPermissions(window.pageSpecific.groups);var assetImports=void 0;typeof window.pageSpecific.assetImports<"u"&&(assetImports=JSON.parse(window.pageSpecific.assetImports),assetImports=assetImports.map(function(t){return t.uploadDate=new Date(JSON.parse(t.uploadDate)),t}));var assetStore=void 0;typeof window.pageSpecific.assetStore<"u"&&(assetStore=JSON.parse(window.pageSpecific.assetStore),assetStore=assetStore.map(function(t){return t.uploadDate=new Date(JSON.parse(t.uploadDate)),t}));var viewerIsPageUser=window.pageSpecific.codeUserID===window.pageSpecific.viewerID,isAdmin=window.pageSpecific.isAdmin,isFacebookExperienceCourse=window.pageSpecific.teacherCourseID===58752||window.pageSpecific.teacherCourseID===43536||window.pageSpecific.courseID===4252||window.pageSpecific.courseID===4280||window.pageSpecific.courseID===4251,canRenameProject=window.pageSpecific.isSandbox&&window.pageSpecific.isAuthenticated&&viewerIsPageUser&&!window.pageSpecific.isCodeHSMeHomepage;window.pageSpecific.isBlockly&&eval(window.pageSpecific.block_definitions);let consoleThemeValue=window.pageSpecific.editorSettings.consoleTheme.value;consoleThemeValue==="System Default"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?consoleThemeValue="Dark":consoleThemeValue="Light");let editorSettings={theme:{value:window.pageSpecific.editorSettings.theme.value,choices:window.pageSpecific.editorSettings.theme.choices,displayName:window.pageSpecific.editorSettings.theme.displayName,category:window.pageSpecific.editorSettings.theme.category,type:"choice"},fontSize:{value:window.pageSpecific.editorSettings.fontSize.value,min:10,max:36,displayName:window.pageSpecific.editorSettings.fontSize.displayName,category:window.pageSpecific.editorSettings.fontSize.category,type:"numerical"},consoleFontSize:{value:window.pageSpecific.editorSettings.consoleFontSize.value,displayName:window.pageSpecific.editorSettings.consoleFontSize.displayName,category:window.pageSpecific.editorSettings.consoleFontSize.category,min:10,max:36,type:"numerical"},autoComplete:{value:window.pageSpecific.editorSettings.autocomplete.value,type:"switch",displayName:window.pageSpecific.editorSettings.autocomplete.displayName,category:window.pageSpecific.editorSettings.autocomplete.category,hidden:window.pageSpecific.editorEngine=="Monaco Editor"},wrapLines:{value:window.pageSpecific.editorSettings.wrapLines.value,type:"switch",displayName:window.pageSpecific.editorSettings.wrapLines.displayName,category:window.pageSpecific.editorSettings.wrapLines.category,hidden:window.pageSpecific.editorEngine=="Monaco Editor"},consoleTheme:{value:consoleThemeValue,choices:window.pageSpecific.editorSettings.consoleTheme.choices,displayName:window.pageSpecific.editorSettings.consoleTheme.displayName,category:window.pageSpecific.editorSettings.consoleTheme.category,type:"choice"}};window.pageSpecific.sharedProgramID&&window.pageSpecific.isAuthenticated&&viewerIsPageUser&&window.pageSpecific.editorSettings.sharedProgramDroplet?editorSettings.sharedProgramDroplet={value:window.pageSpecific.editorSettings.sharedProgramDroplet.value,type:"switch",displayName:window.pageSpecific.editorSettings.sharedProgramDroplet.displayName,category:window.pageSpecific.editorSettings.sharedProgramDroplet.category}:window.pageSpecific.isSandbox||(editorSettings.defaultBlocks={value:window.pageSpecific.editorSettings.defaultBlocks.value,type:"switch",displayName:window.pageSpecific.editorSettings.defaultBlocks.displayName,category:window.pageSpecific.editorSettings.defaultBlocks.category});let abacusOptions={uuid:"outer",projectName:htmlDecode(window.pageSpecific.itemTitle),linkProjectName:window.pageSpecific.isHomepage,linkedProjectName:htmlDecode(window.pageSpecific.baseItemTitle),projectType:window.pageSpecific.abacusProjectType,displayMode:window.pageSpecific.displayMode,dockerImage:window.pageSpecific.dockerImage,root:"root",useBlockly:JSON.parse(window.pageSpecific.showBlocks),helperCode:window.pageSpecific.helper_code,customToolbox:JSON.parse(window.pageSpecific.custom_toolbox),staticUrl:window.CHS.GULP_URL+"abacus/",showFileTree:JSON.parse(window.pageSpecific.showFileTree),leftTabsMinimized:window.pageSpecific.isBlockly||window.pageSpecific.isSandbox&&!JSON.parse(window.pageSpecific.hasMultipleFiles),hideSettingsButton:window.pageSpecific.isBlockly,showAssetList:viewerIsPageUser&&isFacebookExperienceCourse&&isAdmin,readOnly:window.pageSpecific.readOnly||!1,hideCode:window.pageSpecific.hideCode,hideLeftPanel:window.pageSpecific.hideLeftPanel,files:mapAbacusFiles(window.pageSpecific.files,function(t){return Object.assign(t,{text:htmlDecode(t.text)})}),activeFilePathString:getQueryParams().filepath,assetImports,assetStore,onSave:window.pageSpecific.codeUserID===window.pageSpecific.viewerID||window.pageSpecific.viewingNoneUsersSharedProgramAsNoneUser||window.pageSpecific.allowCollaboration&&window.pageSpecific.isAuthenticated?onAbacusEditorSave:void 0,onCanvasPopulated:window.pageSpecific.uploadResultImage?onCanvasPopulated:void 0,onAssetUpload:window.pageSpecific.codeUserID===window.pageSpecific.viewerID?uploadAsset:void 0,onAssetChange:window.pageSpecific.codeUserID===window.pageSpecific.viewerID?saveAssets:void 0,onFileRename:window.pageSpecific.codeUserID===window.pageSpecific.viewerID?fileRename:void 0,onProjectConfigurationChange,onFileSelected:function(t){updateQueryString({filepath:t})},onComment,editorSettings,canRenameMainFile:window.pageSpecific.isSandbox||window.pageSpecific.allowRenameMainFile,canRenameProject,codeServerUrl:window.pageSpecific.codeServerUrl,onSettingsChange:function(t,e,r){t==="projectName"?Ajax.send({method:"set_item_title",app:"library",data:{itemId:window.pageSpecific.itemID,title:e},success:function(n){n.status==="ok"&&(PubSub.trigger("editor:sandboxItemTitleChange",n.URLTitle),shareURL=n.URLTitle[0])}}):Ajax.send({method:"user_settings_change",app:"editor",data:{setting:t,value:e,user_id:window.pageSpecific.viewerID,shared_program_id:window.pageSpecific.sharedProgramID,editor_engine:r}})},onFileIOChange:function(t){Ajax.send({method:"set_file_io",app:"editor",data:{value:t,item_id:window.pageSpecific.itemID}})},baseHtmlProgramUrl:window.pageSpecific.baseHtmlProgramUrl,externalProgramURL:window.pageSpecific.externalProgramURL,slurpHTML:window.pageSpecific.slurpHTML,iframeDocs:!window.pageSpecific.hideDocsTab,iframeDocsURL:window.pageSpecific.BASE_URL+"/documentation/item/"+window.pageSpecific.itemID+"/embed",allowUploads:window.pageSpecific.isSandbox||window.pageSpecific.explicitlyAllowUploads,processFiles:function(t){return new Promise(function(e,r){$.ajax({url:"/core/ajax/abacus_upload",type:"POST",data:t,processData:!1,dataType:"JSON",contentType:!1}).then(function(n){if(n.status!="ok"&&n.msg){window.toastr.error(n.msg);return}switch(n.type){case"file_contents":e(n.file_text);break;case"file_tree":e(n.file_tree);break;case"asset_url":var i=BASE_URL+n.url;e(i);break}})})},socketIOTransportType:window.pageSpecific.socketIOTransportType||"polling",allowCollaboration:window.pageSpecific.allowCollaboration,onCollaborationEnabled:window.pageSpecific.allowCollaboration&&onCollaborationEnabled,onCollaborationDisabled:window.pageSpecific.allowCollaboration&&onCollaborationDisabled,onCollabModeChanged:window.pageSpecific.allowCollaboration&&onCollabModeChanged,onCollabIdentifierReset:window.pageSpecific.allowCollaboration&&onCollabIdentifierReset,collaborateVisible:window.pageSpecific.collaborateVisible,showCollabTab:window.pageSpecific.allowCollaboration&&window.pageSpecific.collaborateVisible,showCollabControls:window.pageSpecific.showCollabControls&&window.pageSpecific.collaborateVisible,isTeacher:window.pageSpecific.teacherForAssignment,canUseAssignmentCollaborate:window.pageSpecific.useAssignmentCollab,assignmentCollabMode:window.pageSpecific.assignmentCollabMode,collaborateIdentifier:window.pageSpecific.allowCollaboration&&window.pageSpecific.collaborateIdentifier,collaborationEnabled:window.pageSpecific.allowCollaboration&&window.pageSpecific.collaborationEnabled,isHost:window.pageSpecific.codeUserID===window.pageSpecific.viewerID,canChangeProjectConfigurations:window.pageSpecific.isSandbox,projectConfigurations:window.pageSpecific.transitions,initialProjectConfigurationName:window.pageSpecific.initialProjectConfigurationName,showChat:permissions.canUseChat||window.pageSpecific.isAdmin,canUseMonaco:!window.pageSpecific.isCollaborate,canToggleFileTabBar:!0,showFileTabBar:window.pageSpecific.displayMode!=="practice",canChangeIFrameTemplate:permissions.canChangeIFrameTemplate,preventCopyPaste:window.pageSpecific.preventCopyPaste,initialLayoutOverride:window.pageSpecific.isSandbox?{}:{left:{width:"21%",minimized:!1}},canToggleAutoRefresh:permissions.canToggleAutoRefresh,canAutoFormat:window.pageSpecific.language=="javascript",showSpriteEditor:permissions.showSpriteEditor,showLayoutConfig:!0,showSaveButton:window.pageSpecific.codeUserID===window.pageSpecific.viewerID&&!window.pageSpecific.previewOnly,collaborators:window.pageSpecific.collaborators,canComment:permissions.canComment,editorEngine:window.pageSpecific.editorEngine,showRecordButton:window.pageSpecific.isAuthenticated&&window.pageSpecific.beatsUnlockedContestID!==0,onAudioDataReceived,onSendAudioText,watchCodeServer:window.pageSpecific.watchCodeServer,showTimeSpent:window.pageSpecific.showTimeSpent,showMiscBetaIDEFeatures:permissions.showMiscBetaIDEFeatures,launchTemplate:window.pageSpecific.launchTemplate};if(window.pageSpecific.abacusProjectType==="html")if(window.pageSpecific.isAuthenticated){let t=window.pageSpecific.baseHtmlProgramUrl?window.pageSpecific.baseHtmlProgramUrl+"/__codehs__/html_url_bar/index.html":"evaluation/htmlUrlBar/index.html";abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{evaluationIFrames:[{shortName:"Default",template:"evaluation/html.html",hideRunBar:!1,autoRun:!1,active:!1},{shortName:"Show URL Bar",template:t,description:"Replaces the standard Run bar with one for navigating URLs.This can only be used if your HTML program is hosted on CodeHS.",hideRunBar:!0,autoRun:!0,active:!0}]}})}else abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{evaluationIFrames:[{shortName:"Default",template:"evaluation/html.html",hideRunBar:!1,autoRun:!1,active:!0}]}});else window.pageSpecific.abacusProjectType==="python3"?new URLSearchParams(window.location.search).has("python3.11")&&(abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{spawnCommand:({installCommand:e,mainFileName:r,debugMode:n})=>n?`${e?e+"&& ":""}python3.11 -m pdb ${r}`:`${e?e+"&& ":""}python3.11 -B ${r}`}})):window.pageSpecific.abacusProjectType==="java"&&new URLSearchParams(window.location.search).has("java17")&&(abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{spawnCommand:({filesToCompile:e,jarNames:r,mainClass:n,debugMode:i})=>{let a=r?`-classpath .:${r}`:"";return i?`jenv local 17 &&                            javac -g ${a} ${e} &&                            jdb -launch ${a} ${n}`:`jenv local 17 &&                            javac ${a} ${e} &&                            java ${a} ${n}`}}}));window.pageSpecific.isBlockly&&!["turtle","turtle-blocks"].includes(window.pageSpecific.abacusProjectType)&&(abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{evaluationIFrames:[{shortName:"Default",template:"evaluation/js/javascript-graphics.html",autoRun:!1,hideRunBar:!1,active:!0}]}})),window.pageSpecific.shouldUseStopifyWhenAvailable&&window.pageSpecific.abacusProjectType==="javascript-console"&&(abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{evaluationIFrames:[{shortName:"Default",template:"evaluation/js/beta/javascript-console-new-js-lib.html",autoRun:!1,description:"Use the newest vesion of the JavaScript library.",hideRunBar:!1,active:!1},{shortName:"Legacy JavaScript Library",template:"evaluation/js/javascript-console.html",hideRunBar:!1,autoRun:!1,active:!1},{shortName:"Stopify",template:"evaluation/js/javascript-console-stopify.html",description:"Stopify introduces non-blocking input and safe evaluation of infinite loops to JavaScript. For more, see stopify.org",hideRunBar:!1,active:!0}]}})),window.pageSpecific.itemType==C.ItemType.PRACTICE&&window.pageSpecific.hidePracticeScratchpad&&(abacusOptions||(abacusOptions={}),abacusOptions.projectConfigurationOverrides||(abacusOptions.projectConfigurationOverrides={}),abacusOptions.projectConfigurationOverrides.runBar||(abacusOptions.projectConfigurationOverrides.runBar={}),window.pageSpecific.displayMode!=="practice"&&(abacusOptions.projectConfigurationOverrides.runBar.buttonsType=4)),window.pageSpecific.displayMode==="practice"&&window.pageSpecific.abacusProjectType===C.AbacusProjectType.JS_CONSOLE&&(abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{outputComponents:[{relatedProcess:"browser-runner",layoutID:"browser-runner",type:"iframe",template:"evaluation/js/beta/javascript-practice-console.html",hidden:!0},{layoutID:"console",relatedProcess:"console",type:"console",focusOnRun:!0}],evaluationIFrames:[{shortName:"Default",template:"evaluation/js/beta/javascript-practice-console.html",autoRun:!1,description:"",hideRunBar:!1,active:!0}]}})),window.pageSpecific.newEditorSettings&&(abacusOptions=deriveAbacusSettings({pageSpecific,viewerIsPageUser,isFacebookExperienceCourse,isAdmin,onAbacusEditorSave,uploadAsset,fileRename,onProjectConfigurationChange,permissions,canRenameProject,newResolvedSettings:window.pageSpecific.newEditorSettings,onSettingsChange:function(t,e,r){t==="projectName"?Ajax.send({method:"set_item_title",app:"library",data:{itemId:window.pageSpecific.itemID,title:e},success:function(n){n.status==="ok"&&(PubSub.trigger("editor:sandboxItemTitleChange",n.URLTitle),shareURL=n.URLTitle[0])}}):Ajax.send({method:"user_settings_change",app:"editor",data:{setting:t,value:e,user_id:window.pageSpecific.viewerID,shared_program_id:window.pageSpecific.sharedProgramID,editor_engine:r}})},onFileIOChange:function(t){Ajax.send({method:"set_file_io",app:"editor",data:{value:t,item_id:window.pageSpecific.itemID}})},processFiles:function(t){return new Promise(function(e,r){$.ajax({url:"/core/ajax/abacus_upload",type:"POST",data:t,processData:!1,dataType:"JSON",contentType:!1}).then(function(n){if(n.status!="ok"&&n.msg){window.toastr.error(n.msg);return}switch(n.type){case"file_contents":e(n.file_text);break;case"file_tree":e(n.file_tree);break;case"asset_url":var i=BASE_URL+n.url;e(i);break}})})},onCollaborationEnabled,onCollaborationDisabled,onCollabIdentifierReset,onAudioDataReceived,onSendAudioText})),window.myAbacus=new window.Abacus(abacusOptions),loadHistory(window.myAbacus,window.pageSpecific.codeUserID,window.pageSpecific.itemID,window.pageSpecific.studentAssignmentID,window.pageSpecific.viewerID),window.pageSpecific.studentAssignmentURLs.length&&window.myAbacus.addTitleBarElement(function(t){let e=window.pageSpecific.studentAssignmentURLs,r=window.pageSpecific.codeUserID,n=window.pageSpecific.codeUserName;var i=null;if(e.length>0){let a,s=e.filter(([l,f])=>f.includes("student/"+r));s.length>0?a=s[0][1]:(a=window.location.href,e.push([n,a]));let o=l=>{window.location.assign(l.target.value)},c=e.map(([l,f])=>html.option({value:f,selected:f===a},[l]));i=html.select({className:"student-dropdown"},[c]),t.appendChild(i),i.onchange=o}}),shimAbacusForModules(window.myAbacus),window.myAbacus.shim.typeTester.isSQL()&&(window.myAbacus.shim.runner=new RunnerFactory(window.myAbacus.shim).create(),window.myAbacus.shim.runner.setupDBExplorer(1));var editorInstructions=new EditorInstructions({itemID:window.pageSpecific.itemID,isGraphics:window.pageSpecific.isGraphics,isBlockly:window.pageSpecific.isBlockly,itemType:window.pageSpecific.itemType,noInstructions:window.pageSpecific.noInstructions});mostRecentSavedCode=window.myAbacus.getCodeTree(),$(".sidebar-canvas").each(function(){KarelWorld.quickDraw($(this),$(this).attr("data-world"),$(this).attr("data-width"),!0)}),window.Sk.TurtleGraphics={},window.Sk.configure({read:builtinRead}),setTimeout(function(){var t=new URLSearchParams(window.location.search),e=t.get("collaborate");e&&window.pageSpecific.unauthenticated&&!window.pageSpecific.allowUnauthenticatedCollaboration&&modalAlert({header:"Unable to collaborate",message:`It looks like you're trying to collaborate on this program.
To collaborate, you need to log in.`,cancel_callback:function(){var r=new URL(window.location.origin+"/login");r.searchParams.set("next",window.location.pathname),r.searchParams.set("collaborate",e),window.location.href=r.href},cancelButton:!0,buttonClass:"btn-main-green",button:"View Program",cancelButtonText:"Log In",cancelButtonClass:"btn-main-blue"})},0);function getReactCode(){return expoIntegrationUtils.userCodeToReactCode(getCurrentCodeText(),window.location.hostname)}function getCurrentCodeText(){var t=flattenAbacusFiles(window.myAbacus.getCodeTree())[0].text;window.pageSpecific.showBlocks&&(t=xmlToCodeHeadless(t,window.pageSpecific.language.split("-")[0]));var e=(window.pageSpecific.helper_code?window.pageSpecific.helper_code+`
`:"")+t;return window.pageSpecific.showBlocks&&window.pageSpecific.isGraphics&&(e="var start = function(){"+e+"};"),e}function getFileList(){return flattenAbacusFiles(window.myAbacus.getCodeTree())}function getFileContent(t,e){var r=t[e].text;window.pageSpecific.showBlocks&&(r=xmlToCodeHeadless(r,window.pageSpecific.language.split("-")[0]));var n=(window.pageSpecific.helper_code?window.pageSpecific.helper_code+`
`:"")+r;return window.pageSpecific.showBlocks&&window.pageSpecific.isGraphics&&(n="var start = function(){"+n+"};"),n}function xmlToCodeHeadless(t,e){var r=new window.Blockly.Workspace,n=window.Blockly.Xml.textToDom(t);switch(window.Blockly.Xml.domToWorkspace(n,r),e){case"javascript":return window.Blockly.JavaScript.workspaceToCode(r);case"python":return window.Blockly.Python.workspaceToCode(r);case"html":return window.Blockly.HTML.workspaceToCode(r);default:return window.Blockly.Python.workspaceToCode(r)}}var expoSnackSessionPromise=null;if(window.pageSpecific.showPhoneTab)try{var expoArgs={hostname:window.location.hostname,codeTitle:htmlDecode(window.pageSpecific.itemTitle),codeDescription:window.pageSpecific.codeUserFirstNameLastInitial,userProgramID:window.pageSpecific.userProgramID};expoSnackSessionPromise=expoIntegrationUtils.sessionPromise(getReactCode(),expoArgs)}catch(t){console.error("Error creating expo snack session",t)}function onCanvasPopulated(t){t.image&&(window.resultImageURL=t.image)}function onAbacusEditorSave(t,e){return e==="mainFileChanged"?new Promise(function(r,n){var i=flattenAbacusFiles(t),a=i.filter(function(s){return s.main})[0]||i[0];Ajax.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:a.name},success:function(s){if(s.status=="ok")return r();n()}})}):(expoSnackSessionPromise&&expoSnackSessionPromise.then(function(r){expoIntegrationUtils.updateCode(getReactCode(),r,expoIntegrationUtils.SNACK_SESSION_QR_DOM)}),saveCode(t,!1,e))}if(!window.pageSpecific.isSandbox){var tabName;if(window.pageSpecific.isExample?tabName="Example":window.pageSpecific.studentAssignmentID?tabName="Assignment":tabName="Exercise",(()=>{let t="#course-search",e="#search-results",r=".js-search-item",n="#sidebar-content-tab",i="#content-listing",a=null,s=null,o=()=>(s||(s=new Promise((m,y)=>{a?m(a):Ajax.send({method:"get_sidebar_content",app:"editor",data:{userId:window.pageSpecific.codeUserID,itemId:window.pageSpecific.itemID,moduleId:window.pageSpecific.moduleID,courseId:window.pageSpecific.courseID,studentAssignmentId:window.pageSpecific.studentAssignmentID||0}}).then(A=>{let k=A.text;a=k,m(k)})})),s),c=function(){let m=$(e),y=$(r);var k=$(t).val();k.length>=3?(m.show(),y.each(function(){var I=$(this),F=I.data("item-title");F.toLowerCase().indexOf(k)!==-1?I.show():I.hide()})):m.hide()},l=function(){var m=$(this);$(this).hasClass("closed")?($(".module-progress.open").length?$(".module-progress.open").next().slideUp(400,function(){$(this).prev().addClass("closed").removeClass("open").attr("aria-expanded","false"),g(m)}):g(m),$(this).addClass("open").removeClass("closed").attr("aria-expanded","true")):$(this).next().slideUp("slow",function(){m.addClass("closed").removeClass("open").attr("aria-expanded","false")})},f=function(){if($(this).next().slideToggle("fast"),$(this).toggleClass("closed").toggleClass("open"),$(this).hasClass("open")){var m=$(i).scrollTop()-$(i).offset().top;$(i).animate({scrollTop:$(this).offset().top+m},"slow"),$(this).attr("aria-expanded","true")}else $(this).attr("aria-expanded","false")},g=function(m){m.next().slideDown(400,function(){var y=$(i).scrollTop()-$(i).offset().top;$(i).animate({scrollTop:m.offset().top+y},400)})};(window.pageSpecific.studentAssignmentID||window.pageSpecific.courseID)&&window.myAbacus.addTab({title:'<span class="chs-icon chs-icon-calendar" style="font-size:19px;margin:auto;width:100%;"></span>',side:"left",tooltipText:"Course",id:"course-tab",index:0,tabClass:"js-course-sidebar-lazy"},function(y){y.innerHTML='<div><div class="less-important-js-loading"><div class="loader"></div></div></div>',$(".js-course-sidebar-lazy").one("mouseover",function(){o().then(A=>{y.innerHTML='<div id="course-sidebar" style="padding-top:0; width:100%;"><div id="sidebar-content-tab" class="tab-pane">'+A+"</div></div>",$(y).find(t).on("keyup",c),$(y).find(".module-progress").on("click",l),$(y).find(".lesson-item.current").parent().slideDown().prev().removeClass("closed").addClass("open").attr("aria-expanded","true"),$(y).find(".module-lesson").on("click",f);var k=$(y).find(".module-progress.current-module");k.length&&$(y).find(i).scrollTop(k.offset().top),PubSub.trigger("main:setupTooltips",n)})})},function(y){$(y).find(t).off("keyup",c),$(y).find(".module-progress").off("click",l),$(y).find(".module-lesson").off("click",f)})})(),window.myAbacus.addTab({title:'<span class="chs-icon chs-icon-map" style="font-size:19px;margin:auto;width:100%;"></span>',side:"left",tooltipText:"Assignment",id:"assignment-tab",index:0},function(t){t.innerHTML=window.pageSpecific.overviewTab.text,editorInstructions.setupReShowPopup(),PubSub.trigger("CHS.Utils.markdown:setup"),window.myAbacus.shim.typeTester.isSQL()&&window.myAbacus.shim.runner.showResultColumns(),$("#turtle-objective-world").each(function(){this.style.display="inline-block",turtleQuickDraw({code:htmlDecode(window.pageSpecific.solution),target:"turtle-objective-world",oldTarget:"python-canvas",height:200,width:200,animate:!1,canvasCoordinates:[-200,-200,200,200]})})}),window.pageSpecific.showAIChatTab&&window.myAbacus.addTab({title:'<span class="chs-icon chs-icon-forum" style="font-size:19px;margin:auto;width:100%;"></span>',side:"left",tooltipText:"Chat",id:"chat-tab",index:5,tabClass:"js-chat-sidebar-lazy"},function(e){e.innerHTML='<div><div class="less-important-js-loading"><div class="loader"></div></div></div>',$(".js-chat-sidebar-lazy").one("mouseover",function(){if(console.log("AI Chat: Mouseover detected, loading chat..."),console.log("AI Chat: userId:",window.pageSpecific.codeUserID),console.log("AI Chat: studentAssignmentID:",window.pageSpecific.studentAssignmentID),!window.pageSpecific.studentAssignmentID){console.error("AI Chat: No studentAssignmentID found"),e.innerHTML='<div class="alert alert-warning">No assignment context found</div>';return}Ajax.send({method:"get_ai_chat_thread",app:"editor",data:{userId:window.pageSpecific.codeUserID,studentAssignmentId:window.pageSpecific.studentAssignmentID},success:function(r){r.status==="ok"?(e.innerHTML=r.text,window.getFileList=getFileList,window.getFileContent=getFileContent,PubSub.trigger("ai:chat:setup")):e.innerHTML='<div class="alert alert-danger">Error: '+(r.msg||"Failed to load chat")+"</div>"},error:function(){e.innerHTML='<div class="alert alert-danger">Failed to load chat thread</div>'}})})},function(e){$(e).find(".chat-quick-btn").off("click")}),window.myAbacus.selectTabWithIdentifier("leftTabs","files"),window.myAbacus.addTab({title:tabName,side:"right",isMore:!1,id:"content-tab",index:2},function(t){var e={item_id:window.pageSpecific.itemID,course_id:window.pageSpecific.courseID,result_world:window.pageSpecific.resultWorld,code_user_id:window.pageSpecific.codeUserID,module_id:window.pageSpecific.moduleID};window.pageSpecific.studentAssignmentID&&(e.student_assignment_id=window.pageSpecific.studentAssignmentID),registerAjaxTabRequest("exercise tab",e).then(r=>{if(r.status=="ok"){t.innerHTML=r.text;var n=window.pageSpecific.itemDescription;$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}),PubSub.trigger("CHS.Utils.markdown:setup"),window.myAbacus.shim.typeTester.isSQL()&&window.myAbacus.shim.runner.setupDBExplorer(2),$(AI_EASIER_BUTTON).on("click",function(){PubSub.trigger("utils:disableButton",$(AI_EASIER_BUTTON)),$(AI_CHALLENGE_BUTTON).attr("disabled","disabled"),Ajax.send({method:"change_difficulty",app:"ai",data:{difficulty:"decrease",description:n},success:function(s){$(AI_CHALLENGE_BUTTON).removeAttr("disabled"),PubSub.trigger("utils:enableButton",$(AI_EASIER_BUTTON)),s.status=="ok"?($(".markdown-ai-exercise-description").removeClass("hidden"),$(".markdown-ai-exercise-description").attr("data-markdown",s.new_description),PubSub.trigger("CHS.Utils.markdown:setup")):window.toastr.error(s.msg)}})}),$(AI_CHALLENGE_BUTTON).on("click",function(){PubSub.trigger("utils:disableButton",$(AI_CHALLENGE_BUTTON)),$(AI_EASIER_BUTTON).attr("disabled","disabled"),Ajax.send({method:"change_difficulty",app:"ai",data:{difficulty:"increase",description:n},success:function(s){$(AI_EASIER_BUTTON).removeAttr("disabled"),PubSub.trigger("utils:enableButton",$(AI_CHALLENGE_BUTTON)),s.status=="ok"?($(".markdown-ai-exercise-description").removeClass("hidden"),$(".markdown-ai-exercise-description").attr("data-markdown",s.new_description),PubSub.trigger("CHS.Utils.markdown:setup")):window.toastr.error(s.msg)}})});var i=window.pageSpecific.itemDescription,a=window.pageSpecific.isQuill;QuillCustom.chooseEditor([{qlTarget:"#quill-exercise-description",mdTarget:".markdown-exercise-description",content:i}],a)}})}),!window.pageSpecific.isExample&&window.pageSpecific.showGradingTab?window.myAbacus.addTab({title:window.pageSpecific.studentAssignmentID?"Test&nbsp;Cases":"Grading",side:"right",id:"test-tab",isMore:!1,index:1},function(t){registerAjaxTabRequest("autograder tab",{item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID}).then(e=>{if(e.status=="ok"){t.innerHTML='<div class="grading-tab" id="grading-tab">'+e.text+'<pre hidden id="console"></pre><canvas width="400" height="480" class="codehs-editor-canvas" hidden></canvas></div>',$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).addClass("editor-tab-content"),window.myAbacus.shim.runner=new RunnerFactory(window.myAbacus.shim).create();let r=new GradingTab(window.myAbacus.shim);PubSub.trigger("ajaxui:setup",".grading-tab"),PubSub.trigger("main:setupTooltips",".grading-tab"),$(".switch").bootstrapSwitch(),window.pageSpecific.displayMode!=="practice"&&window.myAbacus.addExternalRunBarDefinition({className:"button",onClick:()=>{window.myAbacus.selectTabWithIdentifier("rightTabs","test-tab"),r.gradeCode()},label:"Check Code",color:"#9e1e62",hoverIndicator:{background:{color:"#77194f"}}})}})}):$("body").append('<pre hidden id="console"></pre><canvas width="400" height="480" class="codehs-editor-canvas" hidden></canvas></div>'),window.pageSpecific.isAuthenticated&&window.pageSpecific.studentAssignmentID&&window.myAbacus.addTab({title:"Grade",side:"right",id:"grade-tab",isMore:!1,index:4},function(t){registerAjaxTabRequest("lms grading tab",{code_user_id:window.pageSpecific.codeUserID,item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,student_assignment_id:window.pageSpecific.studentAssignmentID}).then(e=>{e.status=="ok"&&(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}),$(t).find("select").selectpicker(),new LMSGradingTab(window.myAbacus.shim),PubSub.trigger("ajaxui:setup","#lms-grading-tab"),window.pageSpecific.showAIGrade&&(window.myAbacus.selectTabWithIdentifier("rightTabs","grade-tab"),$("#ai-grade").trigger("click")))})}),window.pageSpecific.canViewSolutionTab&&window.myAbacus.addTab({title:"Solution",side:"right",id:"solution-tab",isMore:!0},function(t){var e={item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID};window.pageSpecific.studentAssignmentID&&(e.student_assignment_id=window.pageSpecific.studentAssignmentID),registerAjaxTabRequest("solution tab",e).then(r=>{r.status=="ok"&&(t.innerHTML=r.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}),PubSub.trigger("CHS.Utils.markdown:setup"),setupLoadCodeButtons())})}),window.pageSpecific.textbookUrl&&window.myAbacus.addTab({title:"Textbook",side:"right",id:"textbook-tab",isMore:!0,tabClass:"js-textbook-lazy-load"},function(t){$(".js-textbook-lazy-load").one("mouseover",function(){$(t).append($("<iframe>").attr({src:window.pageSpecific.textbookUrl,id:"textbook-tab-iframe"}))})}),window.myAbacus.addTab({title:"Video",side:"right",id:"video-tab",isMore:!0,tabClass:"js-video-slides-lazy-load"},function(t){var e={course_id:window.pageSpecific.courseID,module_id:window.pageSpecific.moduleID,item_id:window.pageSpecific.itemID,code_user_id:window.pageSpecific.codeUserID};window.pageSpecific.studentAssignmentID&&(e.student_assignment_id=window.pageSpecific.studentAssignmentID),registerAjaxTabRequest("video tab",e).then(r=>{if(r.status=="ok"){t.innerHTML=r.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"});var n=function(a){!a||!window.pageSpecific.isAuthenticated||$(".js-video-slides-lazy-load").one("click",function(){$(".ql-toolbar").show();var s=$("#ql-notepad-container").data("notes"),o=QuillCustom.createEditor("#ql-notepad-container",s);$("#ql-notepad-container").height(200);var c;createDOMSubtreeModifiedListener($("#ql-notepad-container")[0],".ql-editor",function(){$("#save-status").text("Saving..."),c&&clearTimeout(c),c=setTimeout(function(){i($("#ql-notepad-container").find(".ql-editor").html(),a),$("#save-status").text("Saved")},1e3)})})},i=function(a,s){Ajax.send({method:"save_user_notes",app:"editor",data:{notes:a,item_id:s}})};n(window.pageSpecific.videoID),PubSub.trigger("CHS.Utils.markdown:setup"),$(".js-video-slides-lazy-load").one("mouseover",function(){var a=$("#video-tab-slides-iframe");if(!a.attr("src")){var s=a.data("src");a.attr("src",s)}})}})}),!window.pageSpecific.previewOnly&&window.pageSpecific.showHelpTab&&window.pageSpecific.isAuthenticated&&(!window.pageSpecific.studentAssignmentID||window.pageSpecific.showConversationTab)){var showConversationTabOnLeft=window.pageSpecific.showConversationTabOnLeft,conversationTabLabel=window.pageSpecific.studentAssignmentID?"Conversation":"Help";window.myAbacus.addTab({title:showConversationTabOnLeft?conversationTabIcon:conversationTabLabel,tooltipText:showConversationTabOnLeft?conversationTabLabel:void 0,side:showConversationTabOnLeft?"left":"right",id:"convo-tab",isMore:!!window.pageSpecific.studentAssignmentID},function(t){registerAjaxTabRequest("help tab",{item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID}).then(e=>{if(e.status=="ok"){if(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).addClass("help-tab").attr("id","help-tab"),window.pageSpecific.studentAssignmentID){if(new ConversationTab(window.myAbacus.shim),showConversationTabOnLeft){var r='.__abacus_left-tab div[aria-label*="Conversation"]';$(r).on("click",function(){window.myAbacus.resizeLeftPanel(30)});var n='.__abacus_left-tab :not(div[aria-label*="Conversation"])';$(n).on("click",function(){window.myAbacus.resizeLeftPanel(21)})}}else new HelpTab(window.myAbacus.shim);window.pageSpecific.helpTabActive&&window.myAbacus.selectTabWithIdentifier("rightTabs","convo-tab"),PubSub.trigger("ajaxui:setup",".help-tab"),$(".switch").bootstrapSwitch(),setupFavoriteStar()}})})}}window.pageSpecific.showMusicLibraryTab&&window.pageSpecific.isAuthenticated&&!window.pageSpecific.viewingOthersSharedProgram&&window.myAbacus.addTab({title:"Music Library",side:"right",id:"music-tab",isMore:!0},function(t){registerAjaxTabRequest("music library tab",{item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID}).then(e=>{if(e.status=="ok"){var r=C.BlocklyMusicSettings.SONG_SAMPLES;t.innerHTML=e.text;var n=new window.Tone.Players,i=setInterval(function(){updateSeeker(r,n)},500);TIMERS.push(i),r.forEach(function(a){var s=a[3],o='<block type="instrument_custom" x="31" y="167"><field name="INSTRUMENT">https://codehs.com/uploads/'+s+"</field></block>",c=window.Blockly.Xml.textToDom(o);$("#info-"+s+" .copy-btn").off("click"),$("#info-"+s+" .copy-btn").on("click",function(){window.Blockly.mainWorkspace.paste(c),window.Blockly.clipboardXml_=c}),n.add(s,"https://codehs.com/uploads/"+s,function(){initializeButtons(s,n)})})}})}),window.pageSpecific.abacusProjectType===C.AbacusProjectType.REACT_NATIVE&&window.myAbacus.addTab({title:"Components",side:"right",id:"components-tab",isMore:!1},function(t){registerAjaxTabRequest("components tab",{}).then(e=>{e.status=="ok"&&(t.innerHTML=e.text,$(t).css({padding:"10px 15px",overflowY:"auto"}),PubSub.trigger("main:setupClickToCopy","#components-container"))})});function initializeButtons(t,e){var r="#controls-"+t,n=e.get(t);$(r+" .tracker").val(0),$(r+" .play-btn").removeClass("icon-spinner"),$(r+" .play-btn").removeClass("icon-spin"),$(r+" .play-btn").addClass("icon-play"),$(r+" .tracker").removeClass("hidden"),$(r+" .play-btn").off("click"),$(r+" .play-btn").on("click",function(){e.stopAll(),$(".play-btn").removeClass("hidden"),$(".pause-btn").addClass("hidden"),$(".info").removeClass("playing-color"),$(r+" .play-btn").addClass("hidden"),$(r+" .pause-btn").removeClass("hidden"),$("#info-"+t).addClass("playing-color");var i=$(r+" .tracker").val();n.toMaster().start(window.Tone.now(),i)}),$(r+" .pause-btn").off("click"),$(r+" .pause-btn").on("click",function(){$(r+" .play-btn").removeClass("hidden"),$(r+" .pause-btn").addClass("hidden"),$("#info-"+t).removeClass("playing-color"),n.toMaster().stop(window.Tone.now())}),$(r+" .tracker").attr("max",n.buffer.duration),$(r+" .tracker").data("mousedown",!1),$(r+" .tracker").on("click",function(){n.toMaster().seek($(this).val(),window.Tone.now())}),$(r+" .tracker").on("mousedown",function(){$(this).data("mousedown",!0)}),$(r+" .tracker").on("mouseup",function(){$(this).data("mousedown",!1)})}function updateSeeker(t,e){t.forEach(function(r){var n=r[3],i=e.get(n);if(i&&i.state=="started"){var a=$("#controls-"+n+" .tracker");a.data("mousedown")||a.val(i.position);return}})}window.pageSpecific.hideCode||window.myAbacus.addTab({title:"Download",side:"right",id:"download-tab",isMore:!0},function(t){registerAjaxTabRequest("download tab",{course_id:window.pageSpecific.courseID,module_id:window.pageSpecific.moduleID,item_id:window.pageSpecific.itemID,code_user_id:window.pageSpecific.codeUserID}).then(e=>{e.status=="ok"&&(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}))})}),window.myAbacus.addTab({title:"About",side:"right",id:"about-tab",isMore:!0},function(t){registerAjaxTabRequest("about tab",{item_id:window.pageSpecific.itemID,code_user_id:window.pageSpecific.codeUserID}).then(e=>{e.status=="ok"&&(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).attr("id","about-tab"),$(t).find("[rel=tooltip]").tooltip({container:"body"}),PubSub.trigger("ajaxui:setup","#about-tab"))})}),window.pageSpecific.showPasteTab&&window.myAbacus.addTab({title:"Import From Assignment",side:"right",id:"paste-tab",isMore:!0},function(t){Ajax.send({app:"editor",method:"get_paste_tab",data:{code_user_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID},success:function(e){if(e.status=="ok"){t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).attr("id","paste-tab"),$(t).find("[rel=tooltip]").tooltip({container:"body"}),PubSub.trigger("ajaxui:setup","#paste-tab");var r=$("#assignment_id").val(),n=$("#assignment_id option"),i=n.index(n.filter("[value="+r+"]"));i>0&&$("#assignment_id").prop("selectedIndex",i-1);var a=!0;$("#paste-code").on("click",function(){var s=$(this);confirmPasteFromAssignment(a).then(()=>{s.attr("disabled",!0);var o=flattenAbacusFiles(window.myAbacus.getCodeTree()),c=o.reduce(function(f,g){if(g.shouldSave&&!g.hidden){var m=g.name,y=_.trimRight(g.text);f[m]=y}return f},{}),l=JSON.stringify(c);Ajax.send({app:"editor",method:"paste_code",data:{file_json:l,item_id:window.pageSpecific.itemID,pasted_assignment:$("#assignment_id").val(),student_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID,section_id:window.pageSpecific.sectionID},success:function(f){if(s.attr("disabled",!1),f.status==="nochange")f.message?window.toastr.info(f.message):window.toastr.info("There was an issue importing the code. Please try again.");else if(f.status!=="ok")f.message?window.toastr.error(f.message):window.toastr.error("There was an issue importing the code. Please try again.");else if(f.message&&window.toastr.success(f.message),f.files){var g=Object.entries(f.files).map(function(m,y){return{name:m[0],text:m[1],main:y==0}});window.myAbacus.setCodeTree(g)}}})}).catch(()=>{s.attr("disabled",!1)})})}}})}),window.pageSpecific.isAdmin&&window.myAbacus.addTab({title:"Admin",side:"right",id:"admin-tab",isMore:!0},function(t){registerAjaxTabRequest("admin tab",{course_id:window.pageSpecific.courseID,module_id:window.pageSpecific.moduleID,item_id:window.pageSpecific.itemID,code_user_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID}).then(e=>{e.status=="ok"&&(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).attr("id","admin-tab"),setupResetButtons(),setupLoadCodeButtons(),PubSub.trigger("ajaxui:setup","#admin-tab"),PubSub.trigger("main:setupIframeModals","#admin-tab"),PubSub.trigger("main:setupTooltips","#admin-tab"),PubSub.trigger("internal:genericNote:setupNotes"),setupFavoriteStar())})}),window.pageSpecific.isAdmin&&window.myAbacus.addTab({title:"Embed",side:"right",id:"embed-tab",isMore:!0},function(t){registerAjaxTabRequest("embedding tab",{item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID}).then(e=>{if(e.status=="ok"){t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}),$("#display-options").selectpicker();var r=$("#dynamic-content").data("sharedprogram");$("#embed-display-options input, #embed-display-options select").on("change",function(){var n="/?";$("#read-only").prop("checked")&&(n.length>2?n+="&read_only=True":n+="read_only=True"),$("#show-file-tree").prop("checked")||(n.length>2?n+="&show_file_tree=False":n+="show_file_tree=False");var i=$("#display-options").find(":selected").val();n.length>2?n+="&display_option="+i:n+="display_option="+i;var a,s;$("#iframe-width").val()?a=$("#iframe-width").val():a="850",$("#iframe-height").val()?s=$("#iframe-height").val():s="500";var o='width="'+a+'" height="'+s+'"',c='<div id="dynamic-content" class="prettyprint" data-sharedprogram="'+r+'">&lt;iframe '+o+' src="https://codehs.com/editor/share_abacus/'+r+n+'" frameborder="0" allowfullscreen class="video-iframe"&gt;&lt;iframe&gt;</div>';$("#dynamic-embed").html(c),$("#dynamic-content").css("overflow","auto")})}})}),window.pageSpecific.isTeacher&&!window.pageSpecific.previewOnly&&window.myAbacus.addTab({title:"Teacher",side:"right",id:"teacher-tab",isMore:!0},function(t){registerAjaxTabRequest("teacher tab",{course_id:window.pageSpecific.courseID,module_id:window.pageSpecific.moduleID,item_id:window.pageSpecific.itemID,code_user_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID}).then(e=>{e.status=="ok"&&(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).attr("id","teacher-tab").addClass("js-teacher-tab"),PubSub.trigger("ajaxui:setup","#teacher-tab"),PubSub.trigger("share:setup","#teacher-tab"),PubSub.trigger("editor:setupResetButtons","#teacher-tab"),PubSub.trigger("main:setupClickToCopy"),$('input[name="next_url"]').val(window.location.href))})});var publishedExpoUrlPromise=new Promise(function(t,e){window.pageSpecific.showPhoneTab&&window.pageSpecific.isAuthenticated?window.myAbacus.addTab({title:"Run on Phone",side:"right",id:"phone-tab",isMore:!0},function(r){registerAjaxTabRequest("phone tab",{item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID,shared_program_id:window.pageSpecific.sharedProgramID}).then(n=>{if(n.status=="ok"){r.innerHTML=n.text;var i=n.published_expo_url;t(i),$(r).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).attr("id","abacus-phone-tab"),PubSub.trigger("ajaxui:setup","#abacus-phone-tab"),expoSnackSessionPromise&&expoSnackSessionPromise.then(function(a){return Promise.resolve(expoIntegrationUtils.updateCode(getReactCode(),a,expoIntegrationUtils.SNACK_SESSION_QR_DOM).then(function(){return a}))}).then(function(a){$("#expo-update-code-button").on("click",function(s){expoIntegrationUtils.updateCode(getReactCode(),a,expoIntegrationUtils.SNACK_SESSION_QR_DOM)}),$(".expo-option-checkbox").on("change",function(s){expoIntegrationUtils.checkboxChange(s,getReactCode(),expoArgs,a)})}),new PhoneTab}else e()})}):e()});window.pageSpecific.isAuthenticated&&!window.pageSpecific.viewingOthersSharedProgram&&window.pageSpecific.showShareTab&&window.myAbacus.addTab({title:"Share",side:"right",isMore:!0},function(t){registerAjaxTabRequest("share tab",{item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID}).then(e=>{var r={hostname:window.location.hostname,codeTitle:htmlDecode(window.pageSpecific.itemTitle),codeDescription:window.pageSpecific.codeUserFirstNameLastInitial,userProgramID:window.pageSpecific.userProgramID};e.status=="ok"&&(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}),new ShareTab(window.pageSpecific.shareBaseURL)),expoSnackSessionPromise&&(expoSnackSessionPromise.then(function(n){$("#publish-button").on("click",function(){expoIntegrationUtils.publishCode(getReactCode(),r,n,!1)})}),publishedExpoUrlPromise.then(function(n){n!==null&&expoIntegrationUtils.writeQRCode(n,expoIntegrationUtils.PUBLISH_QR_DOM)}))})}),window.pageSpecific.isAuthenticated&&window.myAbacus.addTab({title:"Upload",side:"right",id:"upload-tab",isMore:!0},function(t){registerAjaxTabRequest("upload tab",{item_id:window.pageSpecific.itemID,module_id:window.pageSpecific.moduleID,course_id:window.pageSpecific.courseID,code_user_id:window.pageSpecific.codeUserID}).then(e=>{e.status=="ok"&&(t.innerHTML=e.text,$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}),new UploadTab)})}),window.pageSpecific.isAuthenticated&&!window.pageSpecific.hideCode&&window.myAbacus.addTab({title:"Print",side:"right",id:"print-tab",isMore:!0},function(t){t.innerHTML='<h3 class="spacing-top">Print Your Code</h3><button id="abacus-print-button">Print</button><br><button id="abacus-print-button-noname">Print without name</button>',$("#abacus-print-button").css({"margin-left":"5px","min-width":"60px",margin:"10%"}).addClass("btn-main-blue"),$("#abacus-print-button").parent().css("text-align","center"),$("#abacus-print-button").on("click",function(){var e="";window.pageSpecific.assignmentID?(e="/editor/print_assignment_code/"+window.pageSpecific.assignmentID+"/"+window.pageSpecific.codeUserID,window.pageSpecific.sectionID&&(e+="?section_id="+window.pageSpecific.sectionID)):e="/editor/print/"+window.pageSpecific.itemID+"/"+window.pageSpecific.codeUserID+"/"+window.pageSpecific.moduleID+"/"+window.pageSpecific.courseID;var r=window.open(e,"_blank");r?r.focus():alert("Please allow popups for this website")}),$("#abacus-print-button-noname").css({"margin-left":"5px","min-width":"60px",margin:"10%"}).addClass("btn-main-blue"),$("#abacus-print-button-noname").parent().css("text-align","center"),$("#abacus-print-button-noname").on("click",function(){var e="";window.pageSpecific.assignmentID?(e="/editor/print_assignment_code/"+window.pageSpecific.assignmentID+"/"+window.pageSpecific.codeUserID+"?noname",window.pageSpecific.sectionID&&(e+="&section_id="+window.pageSpecific.sectionID)):e="/editor/print/"+window.pageSpecific.itemID+"/"+window.pageSpecific.codeUserID+"/"+window.pageSpecific.moduleID+"/"+window.pageSpecific.courseID+"?noname";var r=window.open(e,"_blank");r?r.focus():alert("Please allow popups for this website")})}),fetchAjaxTabRequests();var shareView=window.Handlebars.compile(SHARE_MODAL_TEMPLATE);function shareAlert(t){var e=t.shareId,r=t.shareIdentifier,n=t.shareURL;n.endsWith("/run")&&(n=n.slice(0,-4));var i=t.itemTitle,a=window.pageSpecific.itemID;shareImageURL=t.shareImageURL;var s=window.pageSpecific.itemImageUrl;window.pageSpecific.beatsUnlockedContestID&&PubSub.trigger("eventtracking:track_event",{name:"Clicked Share Beats Unlocked",data:{sectionID:window.pageSpecific.sectionID}});var o=".js-share-modal-copy",c="#share-program",l="#share-modal-show-code-switch",f="#share-tab-show-code-switch",g="#share-modal-active-switch",m="#share-tab-active-switch",y="#share-modal-forkable-switch",A="#share-tab-forkable-switch",k="#share-modal-ide-dropdown",I="#share-modal #share-modal-share-link",F="#share-modal-edit-description",J="#share-modal-display-mode-dropdown",pe="#share-options",L="#embed-options",H="#assign-options",j="#embed-opt-display-type",X="#embed-opt-width",V="#embed-opt-height",ie="#embed-opt-read-only",fe="#embed-opt-show-tree",Re="#share-modal-image";function ye(){$(j).on("change",ze),$(X).on("input",function(de){de.target.value=de.target.value.replace(/\D/g,""),ze()}),$(V).on("input",function(de){de.target.value=de.target.value.replace(/\D/g,""),ze()}),$(ie).on("change",ze),$(fe).on("change",ze)}function ze(){var de=$(j).val(),Q="850",Fe="500";$(X).val()&&(Q=$(X).val()),$(V).val()&&(Fe=$(V).val());var We=$(ie).prop("checked"),tt=$(fe).prop("checked"),Le='width="'+Q+'" height="'+Fe+'"',Tt="/?display_mode="+de;We&&(Tt+="&read_only=True"),tt||(Tt+="&show_file_tree=False");var It="<iframe "+Le+' src="'+n+"/embed"+Tt+'" frameborder="0" allowfullscreen class="video-iframe"></iframe>';$(I).val(It)}function Ue(de){de===g?$(g).is(":checked")?($("#share-modal-public-link").removeClass("hidden"),$("#share-public-copy").removeClass("hidden"),$("#share-modal-public-link").val(n+"/run"),$("#share-modal-public-link").attr("href",n+"/run")):($("#share-modal-public-link").addClass("hidden"),$("#share-public-copy").addClass("hidden")):de===l&&($(l).is(":checked")?($("#share-modal-copy-link").removeClass("hidden"),$("#share-code-copy").removeClass("hidden"),$("#share-modal-copy-link").val(n),$("#share-modal-copy-link").attr("href",n)):($("#share-modal-copy-link").addClass("hidden"),$("#share-code-copy").addClass("hidden")))}alertModal({header:"Share Your Program",button:"Close",useShareTemplate:!0,rawHtml:shareView({shareId:e,shareIdentifier:r,shareURL:n,shareImageURL,itemTitle:i,isLoggedOut:!window.pageSpecific.isAuthenticated,showCode:t.showCode,isActive:t.isActive,forkable:t.isForkable,showForkOption:t.showForkOption,itemID:a,itemImageUrl:s,isOriginal:window.pageSpecific.IDE==0,isAbacus:window.pageSpecific.IDE==1,isInherit:window.pageSpecific.IDE==2,displayModeDisplayOnly:window.pageSpecific.displayMode==="displayOnly",displayModeDefault:window.pageSpecific.displayMode==="default",displayModeEditorOnly:window.pageSpecific.displayMode==="editorOnly",showIdentifierURL:window.pageSpecific.showIdentifierURL,showIDEDropdown:window.pageSpecific.isAdmin&&!window.pageSpecific.onlyAbacus,itemDescription:window.pageSpecific.itemDescription,activeTeacherCourses:window.pageSpecific.activeTeacherCourses,canBeAssigned:window.pageSpecific.canBeAssigned,showSocialMedia:window.pageSpecific.showContestModal,showCollaborateTab:t.showCollaborateTab,showEditWarning:window.pageSpecific.viewingNoneUsersSharedProgramAsNoneUser,C}),on_load_callback:function(){Q(),window.pageSpecific.isAuthenticated||($(".share-tab-checkbox").prop("disabled",!0),$("#share-modal-share-link").prop("disabled",!1)),window.myAbacus.collaborationEnabled()?($("#collab-enabled-section").removeClass("hidden"),$("#collab-disabled-section").addClass("hidden"),$("#share-modal-collab-link").val(window.location.href)):($("#collab-enabled-section").addClass("hidden"),$("#collab-disabled-section").removeClass("hidden")),$("#share-type-switch").on("click",function(Le){var Tt=Le.target,It=Tt.value;if(It){Tt.classList.add("active"),$(Tt).siblings().each(function(Zt,Ze){Ze.classList.remove("active")});var St=$(I);$("#share-modal-contents").removeClass("hidden"),$("#collab-container").addClass("hidden"),$("#advanced-settings-container").removeClass("hidden"),$("#logged-out-edit-warning").removeClass("hidden"),$("#logged-out-banner-message").text("change the share settings for this program."),St.addClass("hidden"),$(".share-modal-btn").removeClass("hidden"),$(".js-share-modal-copy").addClass("hidden"),$(pe).hasClass("hidden")&&($(pe).removeClass("hidden"),$(L).addClass("hidden"),$(H).addClass("hidden")),It==="Code"?(St.addClass("hidden"),$(".share-modal-btn").addClass("hidden"),Ue(l),Ue(g),$(H).addClass("hidden")):(St.removeClass("hidden"),$(".js-share-modal-copy").removeClass("hidden"),It==="Embed"?($(L).removeClass("hidden"),$(pe).addClass("hidden"),$(H).addClass("hidden"),ze()):It==="Collaborate"?(St.addClass("hidden"),$(".js-share-modal-copy").addClass("hidden"),$(L).addClass("hidden"),$(pe).addClass("hidden"),$(H).addClass("hidden"),$("#collab-container").removeClass("hidden"),$("#advanced-settings-container").addClass("hidden")):($(H).removeClass("hidden"),$("#share-modal-contents").addClass("hidden")))}}),$("#enable-collab-button").on("click",function(){$(g).prop("checked",!0),$(l).prop("checked",!0),Ajax.send({method:"set_share_active",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,activeStatus:!0}}),Ajax.send({method:"set_share_code",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,showCodeStatus:!0}}),$("#collab-enabled-section").removeClass("hidden"),$("#collab-disabled-section").addClass("hidden"),window.myAbacus.enableCollaboration(window.pageSpecific.collaborateIdentifier||""),window.myAbacus.selectCollabTab()}),$(".js-share-modal-collab-copy").on("click",function(){navigator.clipboard.writeText(window.location.href),window.toastr.success("Copied the collaboration link")}),$(F).on("keyup",function(){var Le=$(F).val();$("#preview-description-text").empty().attr("data-markdown",Le),PubSub.trigger("CHS.Utils.markdown:setup")}),$(F).on("blur",de);function de(){var Le=$(F).val();Ajax.send({method:"save_item",app:"library",data:{itemId:window.pageSpecific.itemID,description:Le},success:function(Tt){if(Tt.status=="ok"){var It=$(".description-label").find(".chs-icon");It.removeClass("hidden"),setTimeout(function(){It.addClass("hidden")},1e3)}else window.toastr.error(Tt.msg)}})}function Q(){$(".item-type-select").selectpicker(),$(".course-select").selectpicker();var Le=$(".course-select option:selected");Fe(Le),$(".course-select").on("change",function(){Le=$(".course-select option:selected"),Fe(Le)}),$("#share-modal-assign-btn").on("click",function(){We($(".course-select option:selected").val())})}function Fe(Le){if(Le.hasClass("assigned")){PubSub.trigger("utils:disableButton",$("#share-modal-assign-btn")),$("#share-modal-assign-btn").html("Assigned");var Tt=Le.val(),It=Le.data("assignment-id");tt(Tt,It)}else PubSub.trigger("utils:enableButton",$("#share-modal-assign-btn")),$("#links-section").addClass("hidden"),$("#share-modal-assign-btn").html("Assign")}function We(Le){PubSub.trigger("utils:disableButton",$("#share-modal-assign-btn"));var Tt={};Tt.assignmentType="activity",Tt.itemId=window.pageSpecific.itemID,Tt.itemType=$(".item-type-select option:selected").data("type"),Tt.teacherCourseId=Le,Tt.addToLatestLesson=!0,Ajax.send({method:"add_new_assignment",app:"lms",data:Tt,success:function(It){It.status=="ok"?($("#share-modal-assign-btn").html('<span class="chs-icon chs-icon-check"><span>'),$(".course-select option:selected").addClass("assigned"),$(".course-select option:selected").data("assignment-id",It.assignment.id),tt(Le,It.assignment.id)):window.toastr.error(It.msg)}})}function tt(Le,Tt){var It="/lms/assignments/"+Le+"?activity="+Tt;$(".view-link").attr("href",It),$("#links-section").removeClass("hidden")}$(c).on("change",f,function(){showCode=$(this).is(":checked"),$(l).prop("checked",$(this).is(":checked"))}),$(c).on("change",m,function(){isActive=$(this).is(":checked"),$(g).prop("checked",$(this).is(":checked"))}),$(c).on("change",A,function(){isForkable=$(this).is(":checked"),$(y).prop("checked",$(this).is(":checked"))}),$(l).on("change",function(){showCode=$(this).is(":checked"),Ajax.send({method:"set_share_code",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,showCodeStatus:showCode}}),$(f).prop("checked",showCode),Ue(l)}),$(g).on("change",function(){isActive=$(this).is(":checked"),Ajax.send({method:"set_share_active",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,activeStatus:isActive}}),$(m).prop("checked",isActive),Ue(g)}),$(y).on("change",function(){isForkable=$(this).is(":checked"),Ajax.send({method:"set_share_forkable",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,forkableStatus:isForkable}}),$(A).prop("checked",isForkable)}),$(k).on("change",function(){var Le=$(this).val();Ajax.send({method:"set_share_ide",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,sharedProgramID:window.pageSpecific.sharedProgramID,IDE:Le}})}),$(J).on("change",function(){var Le=$(this).val();Ajax.send({method:"set_share_abacus_display_mode",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID,itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,displayMode:Le}})}),$(o).on("click",function(){$(this).siblings("input").trigger("select"),document.execCommand("copy"),window.toastr.success("Copied the share link")}),Ue(l),Ue(g),$(Re).on("load",function(){var Le=$(this).attr("src");shareImageURL=Le}),ye(),PubSub.trigger("ajaxui:setup","#share-alert-modal")}})}var contestView=window.Handlebars.compile(CONTEST_MODAL_TEMPLATE);function contestAlert(t){var e=t.shareIdentifier,r="#submit-to-contest-btn",n="#contest-id-input",i="#contest-user-name-input",a="#contest-user-email-input",s="#contest-contact-me-input",o="#contest-just-submitted",c="#contest-already-submitted",l=".contest-not-submitted",f="#contest-past-submissions",g=".contest-past-submissions-container";function m(){var y=$(n).val(),A=$(i).val();A===""&&(A=window.pageSpecific.codeUserFirstNameLastInitial);var k="";if($(s).is(":checked"))if(k=$(a).val(),validEmail(k))$(a).removeClass("error");else{$(a).addClass("error"),window.toastr.error("Please enter a valid email address.");return}PubSub.trigger("utils:disableButton",r),Ajax.send({method:"submit",app:"contest",data:{shared_program_identifier:e,contest_identifier:y,user_name:A,user_email:k}}).then(function(I){PubSub.trigger("utils:enableButton",r),I.status=="ok"?I.new_submission?($(o).hasClass("hidden")&&$(o).removeClass("hidden"),$(c).hasClass("hidden")||$(c).addClass("hidden"),$(l).hasClass("hidden")||$(l).addClass("hidden"),$(g).hasClass("hidden")||$(g).addClass("hidden"),$(o+" .contest-url-link").attr("href",I.contest_url),$(o+" .contest-url-link").text(I.contest_name),submittedToContest[I.contest_identifier]=I.contest_name,$(f).append('<li><a href="/contest/'+I.contest_identifier+'">'+I.contest_name+"</a></li>")):($(o).hasClass("hidden")||$(o).addClass("hidden"),$(c).hasClass("hidden")&&$(c).removeClass("hidden"),$(l).hasClass("hidden")||$(l).addClass("hidden"),$(g).hasClass("hidden")||$(g).addClass("hidden"),$(c+" .contest-url-link").attr("href",I.contest_url),$(c+" .contest-url-link").text(I.contest_name)):(window.toastr.error(I.msg),I.error=="contest_id"?$(n).addClass("error"):$(n).removeClass("error"),$(o).hasClass("hidden")||$(o).addClass("hidden"),$(c).hasClass("hidden")||$(c).addClass("hidden"),$(l).hasClass("hidden")&&$(l).removeClass("hidden"),!$.isEmptyObject(submittedToContest)&&$(g).hasClass("hidden")&&$(g).removeClass("hidden"))},function(){PubSub.trigger("utils:enableButton",r),window.toastr.error("There was an error submitting to the contest. Please try again.")})}alertModal({header:"Submit to a Contest!",button:"Close",rawHtml:contestView({shareIdentifier:e,submittedTo:submittedToContest}),on_load_callback:function(){$(r).on("click",m),$.isEmptyObject(submittedToContest)||($(g).removeClass("hidden"),Object.keys(submittedToContest).forEach(function(y){$(f).append('<li><a href="/contest/'+y+'">'+submittedToContest[y]+"</a></li>")}))}})}var buContestView=window.Handlebars.compile(BU_CONTEST_MODAL_TEMPLATE);function buContestAlert(t){var e=t.shareIdentifier,r="#submit-to-fb-contest-btn",n="#submit-to-section-contest-btn",i="#fb-contest-just-submitted",a="#fb-contest-already-submitted",s="#fb-contest-not-submitted",o="#section-contest-just-submitted",c="#section-contest-already-submitted",l="#section-contest-not-submitted";function f(g){var m,y,A,k;g?(m=t.contestId,y=o,A=c,k=l):(m=C.Contest.BEATS_UNLOCKED_CONTEST,y=i,A=a,k=s);var I=window.userData.username,F=window.userData.email;return function(){PubSub.trigger("utils:disableButton",r),PubSub.trigger("utils:disableButton",n),Ajax.send({method:"submit",app:"contest",data:{shared_program_identifier:e,contest_id:m,user_name:I,user_email:F,student_assignment_id:window.myAbacus.shim.studentAssignmentID}}).then(function(J){PubSub.trigger("utils:enableButton",r),PubSub.trigger("utils:enableButton",n),$(y+" .contest-name").text(J.contest_name),$(A+" .contest-name").text(J.contest_name),$(k+" .contest-name").text(J.contest_name),J.status=="ok"?J.new_submission?($(y).removeClass("hidden"),$(A).addClass("hidden"),$(k).addClass("hidden"),submittedToContest[J.contest_identifier]=J.contest_name):($(y).addClass("hidden"),$(A).removeClass("hidden"),$(k).addClass("hidden")):(window.toastr.error(J.msg),$(y).addClass("hidden"),$(A).addClass("hidden"),$(k).removeClass("hidden"))},function(){PubSub.trigger("utils:enableButton",r),PubSub.trigger("utils:enableButton",n),window.toastr.error("There was an error submitting to the contest. Please try again.")})}}alertModal({header:"Submit your beat!",button:"Close",rawHtml:buContestView({shareIdentifier:e,submittedTo:submittedToContest}),on_load_callback:function(){$(r).on("click",f(!1)),$(n).on("click",f(!0))}})}var shareId=null,shareIdentifier=null,shareURL=null,isActive=null,showCode=null,isForkable=null,showForkOption=null,sharedCode=null,shareImageURL=null;if(!window.pageSpecific.hocLoggedOutPlaylistEditor&&(viewerIsPageUser||window.pageSpecific.codeUserID==C.User.NONE_USER_ID)&&(isFacebookExperienceCourse||window.pageSpecific.isBlockly||window.pageSpecific.showShareModal)&&window.myAbacus.addTopBarButton("Share",function(t){function e(i){Ajax.send({method:"get_or_create_share_info",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,codeTree:JSON.stringify(i),shareIdentifier}}).then(function(a){if(PubSub.trigger("utils:enableButton",r),shareId=a.shareId,shareIdentifier=a.shareIdentifier,shareImageURL=a.shareImageURL,shareURL=a.shareURL,isActive=a.isActive,showForkOption=a.showForkOption,isForkable=a.forkable,sharedCode=i,shareAlert({shareId,shareIdentifier,shareURL,shareImageURL,itemTitle:htmlDecode(window.pageSpecific.itemTitle),showCode:window.pageSpecific.showCode,showForkOption,isActive,isForkable,showCollaborateTab:window.pageSpecific.showCollaborateTab}),!a.shareImageURL&&window.pageSpecific.shouldScreenshotOnShare){var s=$(".__abacus_runButton");s&&s.trigger("click"),setTimeout(function(){try{var o=document.querySelector("iframe#browser-runner").contentWindow;o.postMessage({type:"screenshot_data",data:{}},"*")}catch{return}},SHARE_SCREENSHOT_WAIT_TIME)}},function(){PubSub.trigger("utils:enableButton",r),shareIdentifier=null,alertModal({header:"An error occurred",button:"Try again",message:"There was an error sharing your program. Please try again."})})}var r=t.target,n;shareIdentifier!==null&&shareURL!==null?window.pageSpecific.codeUserID==C.User.NONE_USER_ID?(n=getCodeForAdminTab(),sharedCode!=n?(PubSub.trigger("utils:disableButton",r),e(n)):shareAlert({shareId,shareIdentifier,shareURL,shareImageURL,itemTitle:htmlDecode(window.pageSpecific.itemTitle),showCode,showForkOption,isActive,isForkable,showCollaborateTab:window.pageSpecific.showCollaborateTab})):shareAlert({shareId,shareIdentifier,shareURL,shareImageURL,itemTitle:htmlDecode(window.pageSpecific.itemTitle),showCode,showForkOption,isActive,isForkable,showCollaborateTab:window.pageSpecific.showCollaborateTab}):(PubSub.trigger("utils:disableButton",r),window.pageSpecific.codeUserID==C.User.NONE_USER_ID&&(shareIdentifier=window.pageSpecific.shareIdentifier),n=getCodeForAdminTab(),e(n))}),(viewerIsPageUser||window.pageSpecific.codeUserID==C.User.NONE_USER_ID)&&(isFacebookExperienceCourse||window.pageSpecific.showContestModal)){var buttonText=isFacebookExperienceCourse?"Submit Your Beat!":"Submit to Contest";window.myAbacus.addTopBarButton(buttonText,function(t){function e(i){Ajax.send({method:"get_or_create_share_info",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,codeTree:JSON.stringify(i),shareIdentifier,getContestInfo:window.pageSpecific.showContestModal}}).then(function(a){PubSub.trigger("utils:enableButton",r),shareIdentifier=a.shareIdentifier,submittedToContest=a.submittedTo,window.pageSpecific.beatsUnlockedContestID?buContestAlert({shareIdentifier,contestId:window.pageSpecific.beatsUnlockedContestID}):contestAlert({shareIdentifier})})}var r=t.target,n=getCodeForAdminTab();PubSub.trigger("utils:disableButton",r),e(n)})}!window.pageSpecific.previewOnly&&(window.pageSpecific.codeUserID===window.pageSpecific.viewerID&&window.pageSpecific.isGradable||window.pageSpecific.showSubmitButton)?window.myAbacus.addTopBarButton("Submit + Continue",function(t){PubSub.on("autograder:testingComplete",function(){e.disabled=!1,e.innerHTML="Submit + Continue",PubSub.trigger("utils:enableButton",RUN_BUTTON),PubSub.trigger("utils:enableButton",GRADE_CODE_BUTTON),PubSub.trigger("utils:enableButton",SUBMIT_BUTTON),PubSub.trigger("utils:enableButton",GRADING_TAB_CHECK_BUTTON)});var e=t.target;e.disabled=!0,e.innerHTML="Grading...";var r=$(".error-box"),n=$(".error-container");r.exists()&&n.exists()&&(r.hide(),n.html("")),PubSub.trigger("utils:disableButton",SUBMIT_BUTTON),window.HOC_LOGGED_OUT_PLAYLIST_EDITOR?C.ItemTypeConfig.CONFIGS[window.myAbacus.itemType].autograder?PubSub.trigger("autograder:run",window.myAbacus.getCode(),window.myAbacus.info,self,{displayPopup:!0}):goToNext():window.Ed.save(function(){if(C.ItemTypeConfig.CONFIGS[window.myAbacus.shim.itemType].autograder&&!window.pageSpecific.isSandbox)PubSub.trigger("autograder:run",window.myAbacus.shim.getCode(),window.myAbacus.shim.info,window.myAbacus.shim,{displayPopup:!0});else{var i={};if(window.myAbacus.shim.studentAssignmentID?i={student_assignment_id:window.myAbacus.shim.studentAssignmentID}:i={item_id:window.myAbacus.shim.itemID,module_id:window.myAbacus.shim.moduleID,course_id:window.myAbacus.shim.courseID,correct:!0},window.myAbacus.shim.typeTester.isGradeAndRespond()){var a=window.myAbacus.shim.gradeAndRespond.validateData();if(_.isEmpty(a))return;i.response=a.response,i.grade=a.grade}submit(i,goToNext)}},"submit")}):(window.pageSpecific.codeUserID!==window.pageSpecific.viewerID&&!window.pageSpecific.isSandbox||window.pageSpecific.showContinueButton)&&!window.pageSpecific.previewOnly&&window.myAbacus.addTopBarButton("Next",function(t){if(window.pageSpecific.codeUserID!==window.pageSpecific.viewerID)goToNext();else{var e={};window.myAbacus.shim.studentAssignmentID?e={student_assignment_id:window.myAbacus.shim.studentAssignmentID}:e={item_id:window.myAbacus.shim.itemID,module_id:window.myAbacus.shim.moduleID,course_id:window.myAbacus.shim.courseID,correct:!0},saveCode(window.myAbacus.getCodeTree(),!0,"submit").then(function(){submit(e,goToNext)})}}),$(document).on("click",SUBMIT_CORRECT_BUTTON,function(){var t={};window.myAbacus.shim.studentAssignmentID?t={student_assignment_id:window.myAbacus.shim.studentAssignmentID}:t={item_id:window.myAbacus.shim.itemID,module_id:window.myAbacus.shim.moduleID,course_id:window.myAbacus.shim.courseID,correct:!0},submit(t,goToNext)}),window.pageSpecific.showForkButton&&window.myAbacus.addTopBarButton("Fork",function(t){alertModal({header:"Fork to Your Sandbox",button:"Done",rawHtml:window.Handlebars.compile(FORK_MODAL_TEMPLATE)({STATIC_URL:window.CHS.STATIC_URL,shareIdentifier:window.pageSpecific.shareIdentifier,itemTitle:htmlDecode(window.pageSpecific.baseItemTitle),itemOwnerUsername:window.pageSpecific.sharedProgramOwnerUsername,sharedProgramOwnerAttribution:window.pageSpecific.sharedProgramOwnerAttribution,progTypeString:window.pageSpecific.progTypeString}),on_load_callback:function(){$("#abacus-fork-submit").on("click.fork-submit-handler",function(e){var r=$(this);r.attr("disabled",!0),r.html("<i class='icon-spinner icon-spin'></i>"),Ajax.send({method:"fork_shared_program",app:"editor",data:{shared_program_id:window.pageSpecific.sharedProgramID,forking_user_id:window.pageSpecific.viewerID,shared_program_owner_id:window.pageSpecific.codeUserID,shared_program_item_id:window.pageSpecific.itemID,forked_title:$(".sandbox-program-title").text().trim()},success:function(n){if(n.status==="ok"){var i=n.forked_url;r.replaceWith('<a class="btn btn-main-green" href="'+i+'">View Your Program!</a>'),r.off("click.fork-submit-handler")}else n.message?window.toastr.error(n.message):window.toastr.error("There was an issue forking the program. Send an email to support@codehs.com with the URL."),r.html("Fork!");r.attr("disabled",!1)}})})}})}),window.pageSpecific.showTeacherSaveButton&&!window.pageSpecific.previewOnly&&window.myAbacus.addTopBarButton("Save",function(t){var e=t.target;e.disabled=!0,e.innerHTML="<i class='icon-spinner icon-spin'></i>";var r=flattenAbacusFiles(window.myAbacus.getCodeTree()),n=r.reduce(function(a,s){if(s.shouldSave&&!s.hidden){var o=s.name,c=_.trimRight(s.text);a[o]=c}return a},{}),i=JSON.stringify(n);i.split("\\n",CODE_LINE_LIMIT).length>=CODE_LINE_LIMIT?window.toastr.error("Your file is too large to save. Please shorten and try again.","Code Error"):Ajax.send({method:"save_teacher_revision",app:"editor",data:{file_json:i,item_id:window.pageSpecific.itemID,student_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID},success:function(s){e.innerHTML="Save",e.disabled=!1,s.status!=="ok"?s.message?window.toastr.error(s.message):window.toastr.error("There was an issue saving the program. Send an email to support@codehs.com with the URL."):s.should_show_banner?$("#teacher-revision-banner").show():$("#teacher-revision-banner").hide()}})}),window.pageSpecific.showTextToCodeButton&&window.myAbacus.addTopBarButton("Text->Code",function(t){var e=t.target;e.disabled=!0,e.innerHTML="<i class='icon-spinner icon-spin'></i>";var r=flattenAbacusFiles(window.myAbacus.getCodeTree()),n=r.reduce(function(a,s){if(s.shouldSave&&!s.hidden){var o=s.name,c=_.trimRight(s.text);a[o]=c}return a},{}),i=JSON.stringify(n);i.split("\\n",CODE_LINE_LIMIT).length>=CODE_LINE_LIMIT?window.toastr.error("Your file is too large for AI. Please shorten and try again.","Code Error"):Ajax.send({method:"get_ai_text_to_code",app:"editor",data:{file_json:i,item_id:window.pageSpecific.itemID,student_id:window.pageSpecific.codeUserID,student_assignment_id:window.pageSpecific.studentAssignmentID},success:function(s){if(e.innerHTML="Text->Code",e.disabled=!1,s.status!=="ok")s.message?window.toastr.error(s.message):window.toastr.error("There was an issue making the AI program. Send an email to support@codehs.com with the URL.");else if(s.message&&window.toastr.success(s.message),s.files){var o=Object.entries(s.files).map(function(c,l){return{name:c[0],text:c[1],main:l==0}});window.myAbacus.setCodeTree(o)}}})}),setupTimeTracking()}function builtinRead(t){if(Sk.builtinFiles===void 0||Sk.builtinFiles.files[t]===void 0)throw new Error("File not found: '"+t+"'");return Sk.builtinFiles.files[t]}function turtleQuickDraw(t){t=_.defaults(t,{width:400,height:400,oldTarget:"python-canvas",animate:!0,canvasCoordinates:[]});var e=window.Sk.TurtleGraphics.width||400,r=window.Sk.TurtleGraphics.height||400;window.Sk.TurtleGraphics.target=t.target,window.Sk.TurtleGraphics.width=t.width,window.Sk.TurtleGraphics.height=t.height,window.Sk.TurtleGraphics.animate=t.animate;var n=template(turtleTemplate,{coords:t.canvasCoordinates.join(", ")});let i=template(turtleInputOerrideTemplate);var a=n+i+t.code,s=window.Sk.misceval.asyncToPromise(function(){return window.Sk.importMainWithBody("<stdin>",!1,a,!0)});s.then(function(){window.Sk.TurtleGraphics.target=t.oldTarget,window.Sk.TurtleGraphics.width=e,window.Sk.TurtleGraphics.height=r,window.Sk.TurtleGraphics.animate=!0})}function uploadAsset(t){return new Promise(function(e,r){$.ajax({url:"/core/ajax/upload_asset",type:"POST",data:t,processData:!1,dataType:"JSON",contentType:!1}).then(function(n){if(n.status==="error")r();else{var i=BASE_URL+n.url,a=n.url,s=t.get("file").name,o=new Date(JSON.parse(n.uploadDate));e({mimeType:t.get("file").type,url:i,name:s,hashName:a,uploadDate:o})}})})}function onProjectConfigurationChange(t){return new Promise((e,r)=>{Ajax.send({method:"abacus_project_configuration_change",app:"editor",data:{itemID:window.pageSpecific.itemID,name:t},success:function(n){n.status==="ok"?e():r()},error:function(){r()}})})}function saveAssets(t){return new Promise(function(e,r){var n={itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID};Ajax.send({method:"asset_imports_save",app:"editor",data:{info:n,assetImports:JSON.stringify(t)},success:function(i){i.status==="ok"?e():r()},error:function(){r()}})})}var UPDATE_TIME_INTERVAL=5e3,INACTIVE_THRESHOLD=3e4,timeTrackSeconds=0,timeTrackIntervalId=null;function setupTimeTracking(){timeTrackSeconds=0,$.idleTimer(INACTIVE_THRESHOLD),timeTrackIntervalId=setInterval(function(){$.idleTimer("isIdle")||(timeTrackSeconds+=UPDATE_TIME_INTERVAL/1e3)},UPDATE_TIME_INTERVAL)}function saveCode(t,e,r){let n=flattenAbacusFiles(window.myAbacus.getCodeTree()).filter(i=>i.name===".settings.json")?.[0];return t=flattenAbacusFiles(t),window.pageSpecific.codeUserID!==window.pageSpecific.viewerID&&!window.pageSpecific.viewingNoneUsersSharedProgramAsNoneUser&&!window.pageSpecific.collaborationEnabled?(e&&goToNext(),Promise.resolve()):_.isEqual(mostRecentSavedCode,t)?(e&&goToNext(),new Promise(function(i,a){setTimeout(i,500)})):new Promise(function(i,a){var s={itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,isAbacus:!0,isSandbox:window.pageSpecific.isSandbox},o=t.reduce(function(g,m){if(m.shouldSave){var y=m.name,A=_.trimRight(m.text);g[y]=A}return g},{}),c=JSON.stringify(o);if(c.split("\\n",CODE_LINE_LIMIT).length>=CODE_LINE_LIMIT)window.toastr.error("Your file is too large to save. Please shorten and try again.","Code Error"),i();else{var l=window.myAbacus.getCollaboratorIDs().filter(function(m){return m!==window.pageSpecific.codeUserID}).join(",");try{getSolutionCode,s.isTemp=!0}catch{s.isTemp=!1}var f=timeTrackSeconds;timeTrackSeconds=0;let g=window.pageSpecific.codeUserID!==window.pageSpecific.viewerID?window.pageSpecific.viewerID:null;Ajax.send({method:"save_editor",app:"editor",data:{info:s,fileJson:JSON.stringify(o),settingsJSONFile:n?.text,seconds:f||0,collaboratorIds:l,studentAssignmentID:window.pageSpecific.studentAssignmentID,reason:r,collaboratorSave:g},success:function(m){m.status=="ok"?(mostRecentSavedCode=t,i(),e&&goToNext()):(a(),m.msg&&window.toastr.error(m.msg))}})}})}function setupAutosave(){if(window.pageSpecific.viewerID===window.pageSpecific.codeUserID){var t=setInterval(function(){saveCode(window.myAbacus.getCodeTree(),!1,"autosave").then(function(){window.myAbacus.forceSnapshot()},!1)},6e4);TIMERS.push(t)}}function setupTrackingHeartbeat(){var t=6e5,e=setInterval(function(){fetch("/usertracking/heartbeat")},t);TIMERS.push(e)}function setupTrackingKeystrokes(){let t=[],e={file:null,authorID:null};function r(i,a,s){e.authorID=a,e.file&&e.file!==s&&n(),e.file=s,t.push(i)}window.pageSpecific.storeKeystroke=r;function n(){if(t.length){let i=t.splice(0,t.length);Ajax.send({method:"save_keystroke",app:"editor",data:{keystrokes:JSON.stringify(i),studentAssignmentID:window.pageSpecific.studentAssignmentID,studentID:window.pageSpecific.studentID,...e}})}}$(window).one("beforeunload",function(i){n()}),$(document).one("turbolinks:before-visit",function(i){n()}),setInterval(function(){n()},1e4)}function fileRename(t){var e=t.newFilename,r=t.main;return new Promise(function(n,i){r?Ajax.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:e},success:function(a){a.status=="ok"?n():i()}}):n()})}function onComment(t){return new Promise(function(e,r){Ajax.send({method:"add_editor_comment",app:"library",type:"POST",data:{studentAssignmentId:window.pageSpecific.studentAssignmentID,filePath:t.filePath,lineNumber:t.lineNumber,content:t.content},success:function(n){n.status=="ok"?e():r()}})})}function goToNext(){window.location.href=window.pageSpecific.nextURL}function showProModal(){alertModal({message:"The ability to reset a problem for a student, as well as many other teacher tools and resources is only available on CodeHS Pro. To upgrade, get in touch.",rawHtml:'<a href="/learnmore" class="btn btn-main-green">Learn More About Pro</a>'})}function resetItem(t,e){if(t.hasClass("not-pro")&&!window.pageSpecific.isAdmin)showProModal();else{var r="Are you sure? Clicking Ok will reset this student's ";e==="reset_item"?r+="progress on this activity. ":r+="activity back to the starter code. ",r+="The code won't actually be deleted and you can see it in the snapshots",alertModal({message:r,rawHtml:"<b>User To Be Affected: "+t.data("name")+"</b>",cancelButton:!0,ok_callback:function(){Ajax.send({method:e,app:"editor",data:{codeUserId:window.pageSpecific.codeUserID,itemId:window.pageSpecific.itemID,studentAssignmentId:window.pageSpecific.studentAssignmentID},success:function(n){location.reload(!0)}})}})}}function setupFavoriteStar(){$(FAVORITE_PROGRAM_STAR).exists()&&$(FAVORITE_PROGRAM_STAR).on("click",function(){var t=$(this),e=$(this).attr("data-userprogram");Ajax.send({method:"toggle_favorite",app:"editor",data:{program:e},success:function(r){r.fav?t.addClass("selected"):t.removeClass("selected")}})})}function getCodeForAdminTab(){var t=flattenAbacusFiles(window.myAbacus.getCodeTree()),e=t.reduce(function(r,n){var i=n.name,a=n.text;return r[i]=a,r},{});return e}function setupLoadCodeButtons(){function t(){var r=htmlDecode(window.pageSpecific.solutionCode);window.myAbacus.updateCodeTree(r)}function e(){var r=htmlDecode(window.pageSpecific.starterCode);window.myAbacus.updateCodeTree(r)}$(".js-load-solution-code-to-editor").off("click.loadSolutionCode"),$(".js-load-starter-code-to-editor").off("click.loadStarterCode"),$(".js-load-solution-code-to-editor").on("click.loadSolutionCode",t),$(".js-load-starter-code-to-editor").on("click.loadStarterCode",e)}function setupResetButtons(){$(".js-admin-create-item").on("click",function(){var r=getCodeForAdminTab(),n=encodeURIComponent(Object.values(r)[0]),i="?code="+n;window.location.href=$(this).data("href")+i});var t=$(".js-reset-to-starter").first();t.on("click",function(){resetItem(t,"reset_to_starter_code")});var e=$(".js-set-starter").first();e.on("click",function(){alertModal({message:"Are you sure? Clicking Ok will overwrite the starter for all users.",cancelButton:!0,ok_callback:function(){var r=getCodeForAdminTab();Ajax.send({method:"set_starter_code",app:"editor",data:{code:JSON.stringify(r),itemId:window.pageSpecific.itemID},success:function(n){n.status==="ok"?window.toastr.success("Starter code was successfully set","Starter Code Set"):window.toastr.error("Something went wrong.","Error occurred")}})}})}),$("[data-ui=select]").selectpicker(),$(".add-tag-form").on("submit",function(r){r.preventDefault();var n=$(this),i=$("#tags-input"),a=i.val(),s=n.data("item");addRemoveTag(s,a,"add")}),$(".tag-list").on("click",".chs-icon-cancel",function(r){r.preventDefault();var n=$(this),i=$(".add-tag-form").data("item"),a=n.parent().text();addRemoveTag(i,a,"remove")})}function cleanup(){$(document).off("click",SUBMIT_CORRECT_BUTTON);for(var t=0;t<TIMERS.length;t++)clearInterval(TIMERS[t]);clearInterval(timeTrackIntervalId),$.idleTimer("destroy"),cleanupTabRequests(),window.myAbacus.cleanup()}function addRemoveTag(t,e,r){Ajax.send({method:"add_remove_item_tag",app:"library",data:{item_id:t,tag_name:e,action:r},success:function(n){n.status==="ok"&&($(".tag-list").html(""),n.tags.forEach(function(i){$("<span>").addClass("badge").text(i).append($('<span class="chs-icon-cancel">')).appendTo($(".tag-list"))}),$("#tags-input").val(""))}})}function confirmPasteFromAssignment(t){return new Promise((e,r)=>{t?alertModal({rawHtml:"<h3>Are you sure you want to import the code from the following assignment?</h3><h3><b>"+$("#assignment_id option:selected").text()+"</b></h3><p>This will overwrite any code in the current assignment that conflicts with the assignment you are importing.</p>",cancelButton:!0,cancelButtonText:"Cancel",button:"Import",header:"Import Code",ok_callback:e,cancel_callback:r}):e()})}var setupTestCasesAIButton=()=>{$(document).on("click",".btn-ai-hint",function(){if($(this).tooltip("hide"),$(".tooltip").remove(),$(this).prop("disabled"))return!1;if(window.myAbacus&&typeof window.myAbacus.selectTabWithIdentifier=="function"){if(window.myAbacus.abc?.current?.props?.store?.getState?.()?.layout?.left?.minimized){let l={type:"TOGGLE_PANEL",data:{id:"left"}};window.myAbacus.abc?.current?.props?.store?.dispatch?.(l)}window.myAbacus.selectTabWithIdentifier("leftTabs","chat-tab")}let t=$(".js-chat-sidebar-lazy");t.length&&t.trigger("mouseover");let e=$(this).attr("id").replace("grading-unit-test-ai-hint-",""),n=`Can I get help with test case: \`${window.testcases[e].test}\`?
`,i=()=>{let c=$("#hidden-ai-hint-btn");return c.length&&!c.prop("disabled")?(c.data("msg",n),c.trigger("click"),$(this).tooltip("hide"),$(".tooltip").remove(),!0):!1};if(i())return;let a=0,s=20,o=()=>{a++,!i()&&a<s&&setTimeout(o,500)};setTimeout(o,100)})};PubSub.on("abacusEditor:setup",setup);PubSub.on("abacusEditor:cleanup",cleanup);module.exports={shimAbacusForModules}});var P8=D((exports,module)=>{var PubSub=Cr(),expoIntegrationUtils=Ub(),mapAbacusFiles=Ni().mapAbacusFiles,groupsToPermissions=Ni().groupsToPermissions,htmlDecode=ep().htmlDecode,loadHistory=ep().loadHistory;function setup(){let abacusOptions={projectName:htmlDecode(window.pageSpecific.itemTitle),projectType:window.pageSpecific.abacusProjectType,root:"root",staticUrl:window.CHS.GULP_URL+"abacus/",files:mapAbacusFiles(window.pageSpecific.files,function(t){return Object.assign(t,{text:htmlDecode(t.text)})}),slurpHTML:window.pageSpecific.slurpHTML,dockerImage:window.pageSpecific.dockerImage,history:[],hideSettingsButton:!0,showFileTree:window.pageSpecific.showFileTree,displayMode:window.pageSpecific.viewType=="Display Only"?"displayOnly":"default",readOnly:!window.pageSpecific.editable,useBlockly:JSON.parse(window.pageSpecific.showBlocks),helperCode:window.pageSpecific.helper_code,customToolbox:JSON.parse(window.pageSpecific.custom_toolbox),codeServerUrl:window.pageSpecific.codeServerUrl,baseHtmlProgramUrl:window.pageSpecific.baseHtmlProgramUrl,showSaveButton:window.pageSpecific.codeUserID===window.pageSpecific.viewerID,launchTemplate:window.pageSpecific.launchTemplate};window.pageSpecific.isBlockly&&(abacusOptions=Object.assign(abacusOptions,{projectConfigurationOverrides:{evaluationIFrames:[{shortName:"Default",template:"evaluation/js/javascript-graphics.html",hideRunBar:!1,autoRun:!1,active:!0}]}})),$("#view-on-phone-btn").prop("disabled",!0),eval(window.pageSpecific.block_definitions),window.myAbacus=new window.Abacus(abacusOptions);var expoArgs={hostname:window.location.hostname,codeTitle:htmlDecode(window.pageSpecific.itemTitle),codeDescription:window.pageSpecific.codeUserFirstNameLastInitial,userProgramID:window.pageSpecific.userProgramID};function getReactCode(){return expoIntegrationUtils.userCodeToReactCode(getCurrentCodeText(),window.location.hostname)}window.pageSpecific.showHistory&&loadHistory(window.myAbacus,window.pageSpecific.codeUserID,window.pageSpecific.itemID,window.pageSpecific.studentAssignmentID,window.pageSpecific.viewerID);function getCurrentCodeText(){var t=window.myAbacus.getCodeTree()[0].text;window.pageSpecific.showBlocks&&(t=xmlToCodeHeadless(t,window.pageSpecific.language.split("-")[0]));var e=(window.pageSpecific.helper_code?window.pageSpecific.helper_code+`
`:"")+t;return window.pageSpecific.showBlocks&&window.pageSpecific.isGraphics&&(e="var start = function(){"+e+"};"),e}function xmlToCodeHeadless(t,e){var r=new window.Blockly.Workspace,n=window.Blockly.Xml.textToDom(t);switch(window.Blockly.Xml.domToWorkspace(n,r),e){case"javascript":return window.Blockly.JavaScript.workspaceToCode(r);case"python":return window.Blockly.Python.workspaceToCode(r);case"html":return window.Blockly.HTML.workspaceToCode(r);default:return window.Blockly.Python.workspaceToCode(r)}}var expoSnackSessionPromise=expoIntegrationUtils.sessionPromise(getReactCode(),expoArgs);expoSnackSessionPromise.then(function(t){$("#view-on-phone-btn").prop("disabled",!1),$("#view-on-phone-btn").on("click",function(e){var r=$("#view-on-phone-btn").attr("data-expo-url");if(r){var n=$("#view-on-phone-btn").data("expo-url");expoIntegrationUtils.writeQRCode(n,expoIntegrationUtils.SNACK_SESSION_QR_DOM)}else expoIntegrationUtils.updateCode(getReactCode(),t,expoIntegrationUtils.SNACK_SESSION_QR_DOM)})}),$(".__abacus_tab-bar").css("display","none"),$(".__abacus_abacus").css("width","100%")}PubSub.on("abacusShareProgramEditor:setup",setup)});var R8=D((exports,module)=>{"use strict";var Ajax=_i(),PubSub=Cr(),RunnerFactory=vy(),GradingTab=Nv(),flattenAbacusFiles=Ni().flattenAbacusFiles,shimAbacusForModules=Fb().shimAbacusForModules,getQueryParams=ui().getQueryParams,mapAbacusFiles=Ni().mapAbacusFiles,C=Nr(),BASE_URL=C.Uploads.UPLOADS_PROXY_BASE_URL,{fetchAjaxTabRequests,registerAjaxTabRequest,deriveAbacusSettings}=ep();function htmlDecode(t){var e=new DOMParser().parseFromString(t,"text/html");return e.documentElement.textContent}function setup(){if(window.pageSpecific.programIsActive){var hideLeftPanel=window.pageSpecific.hideLeftPanel;window.pageSpecific.skipBlockDefinitions||eval(window.pageSpecific.block_definitions);let abacusOptions={editorEngine:window.pageSpecific.editorEngine,autoRun:window.pageSpecific.autorun,projectName:htmlDecode(window.pageSpecific.itemTitle),projectType:window.pageSpecific.abacusProjectType,root:"root",slurpHTML:window.pageSpecific.slurpHTML,useBlockly:JSON.parse(window.pageSpecific.showBlocks),dockerImage:window.pageSpecific.dockerImage,hideSettingsButton:window.pageSpecific.isTutorial||window.pageSpecific.isBlockly,leftTabsMinimized:JSON.parse(window.pageSpecific.leftTabsMinimized),helperCode:window.pageSpecific.helper_code,customToolbox:JSON.parse(window.pageSpecific.custom_toolbox),staticUrl:window.CHS.GULP_URL+"abacus/",hideNewFileButton:window.pageSpecific.hideNewFileButton,readOnly:window.pageSpecific.readOnly,displayMode:window.pageSpecific.displayMode,files:mapAbacusFiles(window.pageSpecific.files,function(t){return Object.assign(t,{text:htmlDecode(t.text)})}),canvasDimensions:window.pageSpecific.canvasDimensions,autoFocus:!1,projectConfigurationOverrides:{inDebugMode:window.pageSpecific.inDebugMode},editorSettings:{theme:{value:window.pageSpecific.editorSettings.theme.value,choices:window.pageSpecific.editorSettings.theme.choices,displayName:window.pageSpecific.editorSettings.theme.displayName,category:window.pageSpecific.editorSettings.theme.category},fontSize:{value:window.pageSpecific.editorSettings.fontSize.value,displayName:window.pageSpecific.editorSettings.fontSize.displayName,category:window.pageSpecific.editorSettings.fontSize.category,type:"numerical"},consoleFontSize:{value:window.pageSpecific.editorSettings.consoleFontSize.value,displayName:window.pageSpecific.editorSettings.consoleFontSize.displayName,category:window.pageSpecific.editorSettings.consoleFontSize.category,type:"numerical"},defaultBlocks:{value:window.pageSpecific.editorSettings.defaultBlocks.value,displayName:window.pageSpecific.editorSettings.defaultBlocks.displayName,category:window.pageSpecific.editorSettings.defaultBlocks.category,type:"switch"},autoComplete:{value:window.pageSpecific.editorSettings.autocomplete.value,displayName:window.pageSpecific.editorSettings.autocomplete.displayName,category:window.pageSpecific.editorSettings.autocomplete.category,type:"switch"},wrapLines:{value:window.pageSpecific.editorSettings.wrapLines.value,displayName:window.pageSpecific.editorSettings.wrapLines.displayName,category:window.pageSpecific.editorSettings.wrapLines.category,type:"switch"}},allowUploads:!0,processFiles:function(t){return new Promise(function(e,r){$.ajax({url:"/core/ajax/abacus_upload",type:"POST",data:t,processData:!1,dataType:"JSON",contentType:!1}).then(function(n){if(n.status!="ok"&&n.msg){window.toastr.error(n.msg);return}switch(n.type){case"file_contents":e(n.file_text);break;case"file_tree":e(n.file_tree);break;case"asset_url":var i=BASE_URL+n.url;e(i);break}})})},onSettingsChange:function(t,e,r){window.pageSpecific.viewerID&&Ajax.send({method:"user_settings_change",app:"editor",data:{setting:t,value:e,user_id:window.pageSpecific.viewerID,editor_engine:r}})},onFileRename:function(t){var e=t.newFilename,r=t.main;return new Promise(function(n,i){r?Ajax.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:e},success:function(a){a.status=="ok"?n():i()}}):n()})},onSave:function(t,e){return e==="mainFileChanged"?new Promise(function(r,n){var i=flattenAbacusFiles(t),a=i.filter(function(s){return s.main})[0]||i[0];Ajax.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:a.name},success:function(s){if(s.status=="ok")return r();n()}})}):Promise.resolve()},activeFilePathString:getQueryParams().filepath,codeServerUrl:window.pageSpecific.codeServerUrl,history:[],hideTabContainerTopBar:!1,hideTopBar:!0,hideLeftPanel,canRenameMainFile:!0,baseHtmlProgramUrl:window.pageSpecific.baseHtmlProgramUrl,isEmbedded:!0,showSaveButton:window.pageSpecific.codeUserID===window.pageSpecific.viewerID,watchCodeServer:window.pageSpecific.watchCodeServer};window.pageSpecific.newEditorSettings?window.myAbacus=new window.Abacus(deriveAbacusSettings({pageSpecific,autoFocus:!1,projectConfigurationOverrides:{inDebugMode:window.pageSpecific.inDebugMode},explicitlyAllowUploads:!0,hideTabContainerTopBar:!1,hideTopBar:!0,isEmbedded:!0,canRenameMainFile:!0,newResolvedSettings:window.pageSpecific.newEditorSettings,permissions:{},processFiles:function(t){return new Promise(function(e,r){$.ajax({url:"/core/ajax/abacus_upload",type:"POST",data:t,processData:!1,dataType:"JSON",contentType:!1}).then(function(n){if(n.status!="ok"&&n.msg){window.toastr.error(n.msg);return}switch(n.type){case"file_contents":e(n.file_text);break;case"file_tree":e(n.file_tree);break;case"asset_url":var i=BASE_URL+n.url;e(i);break}})})},onSettingsChange:function(t,e,r){window.pageSpecific.viewerID&&Ajax.send({method:"user_settings_change",app:"editor",data:{setting:t,value:e,user_id:window.pageSpecific.viewerID,editor_engine:r}})},onFileRename:function(t){var e=t.newFilename,r=t.main;return new Promise(function(n,i){r?Ajax.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:e},success:function(a){a.status=="ok"?n():i()}}):n()})},onSave:function(t,e){return e==="mainFileChanged"?new Promise(function(r,n){var i=flattenAbacusFiles(t),a=i.filter(function(s){return s.main})[0]||i[0];Ajax.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:a.name},success:function(s){if(s.status=="ok")return r();n()}})}):Promise.resolve()},showSaveButton:window.pageSpecific.codeUserID===window.pageSpecific.viewerID})):window.myAbacus=new window.Abacus(abacusOptions),$(".__abacus_tab-bar").css("display","none"),window.pageSpecific.showGradingTab&&$("#right-tab-bar.__abacus_tab-bar").css("display","flex")}else $("#change-active-embed-switch").on("change",function(){var t=$(this).is(":checked");Ajax.send({method:"set_share_active",app:"editor",data:{itemID:window.pageSpecific.itemID,codeUserID:window.pageSpecific.codeUserID,activeStatus:t},success:function(e){$("#container").css("display","none"),window.location.reload()}})});shimAbacusForModules(window.myAbacus),window.pageSpecific.showGradingTab?window.myAbacus.addTab({title:"Test&nbsp;Cases",isMore:!1},function(t){registerAjaxTabRequest("autograder tab",{item_id:window.pageSpecific.itemID,code_user_id:window.pageSpecific.codeUserID}).then(e=>{e.status=="ok"&&(t.innerHTML='<div class="grading-tab" id="grading-tab">'+e.text+'<pre hidden id="console"></pre><canvas width="400" height="500" class="codehs-editor-canvas" hidden></canvas></div>',$(t).css({"flex-flow":"column",padding:"10px 10px 50px 10px",overflow:"auto"}).addClass("editor-tab-content"),window.myAbacus.shim.runner||(window.myAbacus.shim.runner=new RunnerFactory(window.myAbacus.shim).create()),new GradingTab(window.myAbacus.shim),PubSub.trigger("ajaxui:setup",".grading-tab"),$(".switch").bootstrapSwitch())})}):$("body").append('<pre hidden id="console"></pre><canvas width="400" height="500" class="codehs-editor-canvas" hidden></canvas></div>'),fetchAjaxTabRequests()}PubSub.on("embeddedAbacusSharedProgram:setup",setup)});var M8=D(()=>{"use strict";var Of=_i(),Nwe=Cr(),D8=Ni().flattenAbacusFiles,Mwe=Fb().shimAbacusForModules,$we=ui().getQueryParams,Uwe=Ni().mapAbacusFiles,Fwe=Nr(),L8=Fwe.Uploads.UPLOADS_PROXY_BASE_URL,{fetchAjaxTabRequests:Bwe,deriveAbacusSettings:qwe}=ep();function N8(t){var e=new DOMParser().parseFromString(t,"text/html");return e.documentElement.textContent}function jwe(t){let e=Math.round(t/1e3),r=Math.floor(e/86400),n=Math.floor(e%86400/3600),i=Math.floor(e%3600/60),a=e%60,s=[];return r>0&&s.push(r.toString().padStart(2,"0")),(r>0||n>0)&&s.push(n.toString().padStart(2,"0")),s.push(i.toString().padStart(2,"0")),s.push(a.toString().padStart(2,"0")),s.join(":")}function Hwe(){var t=window.pageSpecific.keystrokes;t.unshift(null),window.keystrokes=t;var e=window.pageSpecific.starterCode,r,n,i=$("#start-replay"),a=$("#pause-replay"),s=$("#reset-replay"),o=$("#step-back"),c=$("#step-forward"),l=$("#replay-time"),f=$("#replay-scrubber"),g=$("#top-bar"),m=null,y=0,A=0;t.length>1&&(A=t[1].timestamp),r=window.pageSpecific.editorRef?.current?.editor,n=r?.session,r.setValue(e,-1);function k(L){L.preventDefault(),L.stopImmediatePropagation()}function I(){i.attr("disabled",!1),a.attr("disabled",!0),r.container.removeEventListener("click",k,!0),r.container.removeEventListener("mousedown",k,!0),m&&clearTimeout(m)}function F(){m&&clearTimeout(m);function L(){if(y==0&&(y=1),!(y>=t.length)){var H=J(y,!0);if(H<t.length){var j=t[H].timestamp-t[y].timestamp;j>750&&(j=750),y=H,m=setTimeout(L,j)}else I()}}t.length&&(y>0&&(pe(y),y++),L())}function J(L,H){if(L>0){var j=t[L];if(j.action=="i"||j.action=="p"){var X=j.start.row+j.lines.length-1,V=j.start.column+j.lines[j.lines.length-1].length-1;r.moveCursorTo(X,V),n.insert(j.start,j.lines.join(`
`)),j.action=="p"&&H?($(".paste").removeClass("hidden"),g.removeClass("paste-flash"),setTimeout(function(){g.addClass("paste-flash")},0)):$(".paste").addClass("hidden")}else j.action=="r"&&(n.remove(new window.ace.Range(j.start.row,j.start.column,j.end.row,j.end.column)),r.moveCursorTo(j.start.row,j.start.column));H&&f.val(L),l.text(jwe(j.timestamp-A))}return L+1}function pe(L){y=0,r.setValue(e,-1);function H(){var j=J(y,!1);j<=L&&(y=j,H())}H(),L>0&&t[L].action=="p"?($(".paste").removeClass("hidden"),g.removeClass("paste-flash"),setTimeout(function(){g.addClass("paste-flash")},0)):$(".paste").addClass("hidden")}i.on("click",function(){r.container.addEventListener("click",k,!0),r.container.addEventListener("mousedown",k,!0),$(this).attr("disabled",!0),a.attr("disabled",!1),y>=t.length-1&&pe(0),r&&n&&F()}),a.on("click",function(){I()}),s.on("click",function(){I(),y=0,f.val(0),r.setValue(e,-1)}),f.on("input",function(){I();var L=parseInt($(this).val());pe(L)}),o.on("click",function(){I(),y>0&&(f.val(y-1),pe(y-1))}),c.on("click",function(){I(),y<t.length-1&&(f.val(y+1),pe(y+1))})}function Gwe(){var t=window.pageSpecific.hideLeftPanel;let e={editorEngine:window.pageSpecific.editorEngine,autoRun:window.pageSpecific.autorun,projectName:N8(window.pageSpecific.itemTitle),projectType:window.pageSpecific.abacusProjectType,root:"root",slurpHTML:window.pageSpecific.slurpHTML,useBlockly:!1,dockerImage:window.pageSpecific.dockerImage,hideSettingsButton:window.pageSpecific.isTutorial||window.pageSpecific.isBlockly,leftTabsMinimized:!0,helperCode:window.pageSpecific.helper_code,staticUrl:window.CHS.GULP_URL+"abacus/",hideNewFileButton:window.pageSpecific.hideNewFileButton,readOnly:window.pageSpecific.readOnly,displayMode:window.pageSpecific.displayMode,files:Uwe(window.pageSpecific.files,function(r){return Object.assign(r,{text:N8(r.text)})}),autoFocus:!1,projectConfigurationOverrides:{inDebugMode:window.pageSpecific.inDebugMode},editorSettings:{theme:{value:window.pageSpecific.editorSettings.theme.value,choices:window.pageSpecific.editorSettings.theme.choices,displayName:window.pageSpecific.editorSettings.theme.displayName,category:window.pageSpecific.editorSettings.theme.category},fontSize:{value:window.pageSpecific.editorSettings.fontSize.value,displayName:window.pageSpecific.editorSettings.fontSize.displayName,category:window.pageSpecific.editorSettings.fontSize.category,type:"numerical"},consoleFontSize:{value:window.pageSpecific.editorSettings.consoleFontSize.value,displayName:window.pageSpecific.editorSettings.consoleFontSize.displayName,category:window.pageSpecific.editorSettings.consoleFontSize.category,type:"numerical"},defaultBlocks:{value:window.pageSpecific.editorSettings.defaultBlocks.value,displayName:window.pageSpecific.editorSettings.defaultBlocks.displayName,category:window.pageSpecific.editorSettings.defaultBlocks.category,type:"switch"},autoComplete:{value:window.pageSpecific.editorSettings.autocomplete.value,displayName:window.pageSpecific.editorSettings.autocomplete.displayName,category:window.pageSpecific.editorSettings.autocomplete.category,type:"switch"},wrapLines:{value:window.pageSpecific.editorSettings.wrapLines.value,displayName:window.pageSpecific.editorSettings.wrapLines.displayName,category:window.pageSpecific.editorSettings.wrapLines.category,type:"switch"}},allowUploads:!0,processFiles:function(r){return new Promise(function(n,i){$.ajax({url:"/core/ajax/abacus_upload",type:"POST",data:r,processData:!1,dataType:"JSON",contentType:!1}).then(function(a){if(a.status!="ok"&&a.msg){window.toastr.error(a.msg);return}switch(a.type){case"file_contents":n(a.file_text);break;case"file_tree":n(a.file_tree);break;case"asset_url":var s=L8+a.url;n(s);break}})})},onSettingsChange:function(r,n,i){window.pageSpecific.viewerID&&Of.send({method:"user_settings_change",app:"editor",data:{setting:r,value:n,user_id:window.pageSpecific.viewerID,editor_engine:i}})},onFileRename:function(r){var n=r.newFilename,i=r.main;return new Promise(function(a,s){i?Of.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:n},success:function(o){o.status=="ok"?a():s()}}):a()})},onSave:function(r,n){return n==="mainFileChanged"?new Promise(function(i,a){var s=D8(r),o=s.filter(function(c){return c.main})[0]||s[0];Of.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:o.name},success:function(c){if(c.status=="ok")return i();a()}})}):Promise.resolve()},activeFilePathString:$we().filepath,codeServerUrl:window.pageSpecific.codeServerUrl,history:[],hideTabContainerTopBar:!1,hideTopBar:!0,hideLeftPanel:t,canRenameMainFile:!0,baseHtmlProgramUrl:window.pageSpecific.baseHtmlProgramUrl,isEmbedded:!0,showSaveButton:window.pageSpecific.codeUserID===window.pageSpecific.viewerID};window.pageSpecific.newEditorSettings?window.myAbacus=new window.Abacus(qwe({pageSpecific,autoFocus:!1,projectConfigurationOverrides:{inDebugMode:window.pageSpecific.inDebugMode},explicitlyAllowUploads:!0,hideTabContainerTopBar:!1,hideTopBar:!0,isEmbedded:!0,canRenameMainFile:!0,newResolvedSettings:window.pageSpecific.newEditorSettings,permissions:{},processFiles:function(r){return new Promise(function(n,i){$.ajax({url:"/core/ajax/abacus_upload",type:"POST",data:r,processData:!1,dataType:"JSON",contentType:!1}).then(function(a){if(a.status!="ok"&&a.msg){window.toastr.error(a.msg);return}switch(a.type){case"file_contents":n(a.file_text);break;case"file_tree":n(a.file_tree);break;case"asset_url":var s=L8+a.url;n(s);break}})})},onSettingsChange:function(r,n,i){window.pageSpecific.viewerID&&Of.send({method:"user_settings_change",app:"editor",data:{setting:r,value:n,user_id:window.pageSpecific.viewerID,editor_engine:i}})},onFileRename:function(r){var n=r.newFilename,i=r.main;return new Promise(function(a,s){i?Of.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:n},success:function(o){o.status=="ok"?a():s()}}):a()})},onSave:function(r,n){return n==="mainFileChanged"?new Promise(function(i,a){var s=D8(r),o=s.filter(function(c){return c.main})[0]||s[0];Of.send({method:"update_main_class",app:"library",type:"POST",data:{item_id:window.pageSpecific.itemID,filename:o.name},success:function(c){if(c.status=="ok")return i();a()}})}):Promise.resolve()},showSaveButton:window.pageSpecific.codeUserID===window.pageSpecific.viewerID})):window.myAbacus=new window.Abacus(e),$(".__abacus_tab-bar").css("display","none"),window.pageSpecific.showGradingTab&&$("#right-tab-bar.__abacus_tab-bar").css("display","flex"),Mwe(window.myAbacus),Bwe(),window.pageSpecific.keystrokes.length&&($("#start-replay").attr("disabled",!1),$("#reset-replay").attr("disabled",!1),$("#replay-scrubber").attr("disabled",!1),Hwe())}Nwe.on("codeReplay:setup",Gwe)});var $8=D(()=>{var Vwe=Cr(),zwe=Zl(),Wwe=function(){var t=window.pageSpecific.description,e=window.pageSpecific.isQuill;zwe.chooseEditor([{qlTarget:"#quill-note",mdTarget:"#markdown-note",content:t}],e),$(".notes-wrap a").attr("target","_blank")};Vwe.on("editor:viewnote:setup",Wwe)});var F8=D((UDe,U8)=>{var Ol=Nr(),oC=Lc();function Kwe(t){var e=[];switch(t.language){case Ol.ProgrammingLanguage.JAVASCRIPT:switch(t.progType){case Ol.ProgramType.KAREL:e=oC.getBuiltIns(!1,!1);break;case Ol.ProgramType.SUPER_KAREL:e=oC.getBuiltIns(!0,!1);break;case Ol.ProgramType.ULTRA_KAREL:e=oC.getBuiltIns(!1,!0);break;case Ol.ProgramType.CONSOLE:e=[];break;case Ol.ProgramType.GRAPHICS:e=[];break}break}return e}function Xwe(t){return{browser:!0,es6:!1,for:!0,white:!0,this:!0}}function Ywe(t){return t.filter(function(e){var r=e.code==="unexpected_a"&&e.message!=="Unexpected 'var'."&&e.message!=="Unexpected 'else'."&&e.message!=="Unexpected 'new'."&&e.message!=="Unexpected 'const'."&&e.message!=="Unexpected 'let'.";return r||e.code==="naked_block"||e.code==="expected_a_b_from_c_d"})}U8.exports.lint=function(t,e){var r,n,i,a;return e.language!==Ol.ProgrammingLanguage.JAVASCRIPT?{hasError:!1}:(r=Kwe(e),n=Xwe(e),i=jslint(t,n,r),a=Ywe(i.warnings),a&&a.length?(a[0].code==="expected_a_b_from_c_d"&&(a[0].message=a[0].message.replace(/\d+/,function(s){return++s})),{hasError:!0,message:a[0].message,lineNumber:a[0].line+1}):{hasError:!1})}});var hC=D((FDe,W8)=>{"use strict";var Oo=Nr(),j8=ui().fileHasImageExtension,Rf=".editor-wrap",Pf="#codehs-editor",Jwe="#left .action",Qwe=".quiz-wrap",Zwe="#right .nav-tabs",dC="#tab-bar",eTe=50,H8="#left",uC="#right",Pl="#problem-sidebar",cC="#content-listing",fC=300,tTe=400,rTe=".toggle-sidebar",Bb="#editor-full-size",pC="#history-preview",iTe=8,lC=250,B8=60,nTe=530,aTe=.7,G8=fC;function ks(t,e){this.editor=t,e=e||{},this.options=_.defaults(e,{isQuiz:!1}),this.sidebarOpen=!$(cC).hasClass("gone"),this.fullSize=$(H8).width()===0,this.setup()}ks.prototype.isSidebarOpen=function(){return this.sidebarOpen};ks.prototype.toggleSidebar=function(){var t=this;this.sidebarOpen?(q8(),$(Pl).animate({width:B8+"px"},400,function(){$("#open-toggle").animate({width:"toggle"},"fast"),$(cC).addClass("gone")}),$(Rf).animate({"padding-left":B8+"px"},400,function(){t.editor.aceEditor.resize()}),$(Pl+"-tabs").animate({height:"100%"},400),$("#close-toggle").hide()):($(cC).removeClass("gone"),$("#open-toggle").animate({width:"toggle"},"fast",function(){$(Pl).animate({width:lC+"px"},400,function(){$("#close-toggle").animate({width:"toggle"},"fast")}),$(Rf).animate({"padding-left":lC+"px"},250,function(){t.editor.aceEditor.resize()}),$(Pl+"-tabs").animate({height:"44px"},400,function(){q8()})})),this.sidebarOpen=!this.sidebarOpen};function q8(){$("#problem-sidebar-tabs").toggleClass("nav-justified").toggleClass("nav-stacked"),$(Pl).toggleClass("minimized")}ks.prototype.setupSharedEditor=function(){var t=$("#shared-program").height();$(Pf).css("height",t+"px")};ks.prototype.setupEditorHeight=function(){var t=this,e=$(H8).height(),r=$(Jwe).height(),n=$("#grading-quiz").outerHeight(!0)||0,i=$("#grading-box").outerHeight(!0)||0,a=$("#code-edit-alert").outerHeight(!0)||0,s=$(".lti-launch-banner").outerHeight(!0)||0,o=$("#logged-out-editor-banner").outerHeight(!0)||0,c=e-r-iTe-n-i-a-o-s;t.editor.codeEditorType===Oo.EditorType.DROPLET_EDITOR&&(c-=26),$(Pf).css("height",c+"px");var l=e-eTe-$(Zwe).height();if(l<nTe){var f=$('canvas[data-type="superkarel"], canvas[data-type="karel"], canvas[data-type="ultrakarel"]');f&&l>0&&f.css("height",l*aTe)}$(pC).css({"max-height":$(dC).height()-30})};ks.prototype.setupSidebarContentTab=function(){var t=this;$(Rf).one("shown.bs.tab",'a[href="#sidebar-content-tab"]',function(){t.editor.editorSidebarContent.setup()})};ks.prototype.setupRightSidebarResize=function(){var t=this;$(uC).resizable({maxWidth:V8(),minWidth:fC,handles:"w",resize:function(e,r){$(Rf).css({"padding-right":r.size.width}),$(pC).width($(dC).width()-20-100)},stop:function(e,r){G8=r.size.width,$(".right-col-tabs").outerHeight()>50?$(".right-col-tabs").addClass("wrapped"):$(".right-col-tabs").removeClass("wrapped"),t.editor.aceEditor.resize()}})};function V8(){var t=$(window).width()-lC-tTe;return t<fC?null:t}ks.prototype.setupFileList=function(t){var e=this,r=e.editor.code,n=$(".file-list"),i=$.Deferred();if(e.editor.getItemType()===Oo.ItemType.UNIT_TEST){var a=e.editor.getInfo();window.PRACTICE_LOGGED_OUT_EDITOR?$.ajax({url:"/editor/ajax/unit_test_to_practice_code",type:"GET",dataType:"json",data:{itemID:a.itemID},success:function(s){Object.assign(e.editor.breakpoints,Object.keys(s.code).reduce(function(o,c){return o[c]=[],o},{})),e.editor.code=$.extend(r,s.code),e.editor.breakpoints["Scratchpad.java"]={},i.resolve()}}):$.ajax({url:"/editor/ajax/unit_test_to_runnable_code",type:"GET",dataType:"json",data:{userID:a.codeUserID,itemID:a.itemID,studentAssignmentID:a.studentAssignmentID},success:function(s){Object.assign(e.editor.breakpoints,Object.keys(s.code).reduce(function(o,c){return o[c]=[],o},{})),e.editor.code=$.extend(r,s.code),i.resolve()}})}else i.resolve();i.then(function(){n.length&&e.createFileList(r,t)})};ks.prototype.createFileList=function(t,e){var r=this;e=typeof e<"u"?e:!0;var n=[],i=$(".file-list");i.html("");var a;if(e){if(a=Object.keys(t)[0],r.editor.language===Oo.ProgrammingLanguage.JAVA&&r.editor.getItemType()!==Oo.ItemType.UNIT_TEST)a=r.editor.mainClass+Oo.ProgrammingLanguage.FILE_SUFFIX[r.editor.language];else if(r.editor.getItemType()==Oo.ItemType.FREE_RESPONSE){var s=Oo.ProgrammingLanguage.FILE_SUFFIX[r.editor.language];r.editor.mainClass.endsWith(s)?a=r.editor.mainClass:a=r.editor.mainClass+s}else r.editor.mainClass!==void 0&&(a=r.editor.mainClass);r.editor.activeFile=a}if(Object.keys(t).forEach(function(c){var l=c.lastIndexOf("/"),f=c.substring(0,l),g=c.substring(l+1);z8(f,n),f!==""&&(i=document.getElementById(f));var m='data-filename="'+c+'"',y=$('<a href="javascript:void(0);" class="file" role="button"'+m+">").append(g).data("filename",c),A=r.editor.mainClass+Oo.ProgrammingLanguage.FILE_SUFFIX[r.editor.language];(A===c||c===a)&&(y.addClass("active"),y.attr("aria-selected",!0),_.size(t)>1&&r.editor.getItemType()!==Oo.ItemType.UNIT_TEST&&y.prepend($('<span class="icon icon-play-circle" rel="tooltip" title="This is the main file that runs when you click the run button.">'))),y.prepend($('<span class="icon icon-file">'));var k;g=="."||g==""?k=$('<li class="gone">').append(y):k=$('<li class="file-list-file">').append(y),$(i).append(k),$("[rel=tooltip]").tooltip({container:"body"}),i=$(".file-list")}),$(".file-list").off("click"),$(".file-list").on("click",".file",function(){if(r.editor.firepad&&!r.editor.firepad.isLeader()){window.toastr.error("You can't switch files while collaborating");return}r.activateFile(this)}),$(".folder").off("click"),$(".folder").on("click",function(){var c=$(this).attr("class"),l=c.lastIndexOf(" "),f=c.substring(l+1),g=$(document.getElementById(f));g.attr("style")==="display: none;"?(g.show(),$(this).find(".icon-folder-close-alt").addClass("icon-folder-open-alt"),$(this).find(".icon-folder-close-alt").removeClass("icon-folder-close-alt")):(g.hide(),$(this).find(".icon-folder-open-alt").addClass("icon-folder-close-alt"),$(this).find(".icon-folder-open-alt").removeClass("icon-folder-open-alt"))}),r.editor.firepad&&!r.editor.firepad.isLeader()){$("#create-new-file").addClass("gone");var o=$(".file-list");o.find('a.right[data-target="#create-new-file-modal"]').addClass("gone")}};ks.prototype.activateFile=function(t){var e=this;if($(t).length){var r=e.editor.code,n=e.editor.currentCode;n[e.editor.activeFile]=e.editor.getCode(),r[e.editor.activeFile]=e.editor.getCode(),$(".file-list .file.active").removeClass("active");var i=$(t).data("filename");$(t).addClass("active"),$(".powered-by-firepad").css("display","block"),j8(i)?($("#codehs-editor").hide(),$("#image-asset img").attr("src",r[i]),$("#image-asset").css("display","flex"),$(".powered-by-firepad").css("display","none"),e.editor.setCode(r[i]),e.editor.activeFile=i):i.endsWith(".jar")?($("#image-asset").css("display","none"),$("#codehs-editor").show(),e.editor.setCode(e.editor.getJarASCII()),e.editor.activeFile=i):($("#image-asset").css("display","none"),$("#codehs-editor").show(),e.editor.setCode(r[i]),e.editor.activeFile=i,i==="Unit Test"&&(i=i+Oo.ProgrammingLanguage.FILE_SUFFIX[e.editor.language]),e.editor.aceEditor.refreshModeStringNative(i),e.editor.clearHighlightedLines(),$("li.error-entry").each(function(){var a=$(this).data("line"),s=$(this).data("filename");e.editor.highlightLine(a,!1,s)})),e.editor.refreshBreakpoints(),e.editor.firepad&&e.editor.firepad.isLeader()&&e.editor.firepad.updateFiles()}};ks.prototype.activateFileFirepad=function(t){var e=this;j8(t)?($("#codehs-editor").hide(),$("#image-asset img").attr("src",e.editor.code[t]),$("#image-asset").css("display","flex"),$(".powered-by-firepad").css("display","none")):($("#image-asset").css("display","none"),$("#codehs-editor").show(),$(".powered-by-firepad").css("display","block")),$(".file-list .file.active").removeClass("active"),$('.file[data-filename="'+t+'"]').addClass("active")};function z8(t,e){if(t!==""&&e.indexOf(t)===-1){e.push(t);var r=t.lastIndexOf("/"),n=t.substring(r+1),i=t.substring(0,r);$("#new-file-folder-name").append('<option name="'+t+'">'+t+"</option>"),$("#new-folder-folder-name").append('<option name="'+t+'">'+t+"</option>"),$(".location-select").removeClass("gone"),z8(i,e),sTe(i,t,n)}}function sTe(t,e,r){var n=document.getElementById(t);n===null&&(n=$(".file-list"));var i=$('<ul class="folder" id="'+e+'">');$(n).append($("<li>").append($('<a href="javascript:void(0);" role="button"  class="folder '+e+'">').append('<span class="icon icon-folder-open-alt"></span>').append(r)).append('<a href="javascript:void(0);" class="right" data-toggle="modal" role="button" aria-haspopup="dialog"data-target="#create-new-file-modal" data-location="'+e+'"><span class="fas fa-plus-square folder-add-file" title="Add to this folder"></span></a>').append('<div class="clear"></div>').append(i))}ks.prototype.setup=function(){var t=this;if(t.editor&&t.editor.isSharedProgram){t.editor.aceEditor.getEditor().renderer.setShowGutter(!1),$(Pf).bind("copy paste",function(o){o.preventDefault()}),$(Pf).on("contextmenu",function(o){return!1});var e=!1,r=17,n=91,i=86,a=67;$(Pf).on("keydown",function(o){(o.keyCode==r||o.keyCode==n)&&(e=!0)}).on("keyup",function(o){(o.keyCode==r||o.keyCode==n)&&(e=!1)}),$(Pf).on("keydown",function(o){if(e&&(o.keyCode==i||o.keyCode==a))return!1}),window.pageSpecific.readOnly&&t.editor.aceEditor.editor.setReadOnly(!0),t.setupSharedEditor()}else t.options.isQuiz||t.setupEditorHeight();t.setupSidebarContentTab(),t.options.isQuiz||t.setupFileList(),t.options.isQuiz||$(window).on("resize",function(){t.editor.isSharedProgram?t.setupSharedEditor():($(uC).resizable("option","maxWidth",V8()),t.setupEditorHeight())}),$(rTe).on("click",function(){t.toggleSidebar()});var s=Rf;t.options.isQuiz&&(s=Qwe),$(s).on("click","#problem-sidebar.minimized .sidebar-nav-tab",function(){$($(this).attr("href")).tab("show"),t.toggleSidebar()}),$(s).on("click","#problem-sidebar .sidebar-nav-tab",function(){$('#problem-sidebar .sidebar-nav-tab[aria-selected="true"]').each(function(){$(this).attr("aria-selected",!1)}),$(this).attr("aria-selected",!0)}),$(s).on("click",".file-list-file .file",function(){$('.file-list-file .file[aria-selected="true"]').each(function(){$(this).attr("aria-selected",!1)}),$(this).attr("aria-selected",!0)}),$(".js-editor-bottombar").length&&$(".js-editor-bottombar .module-name").on("click",function(o){if($(Pl).length){var c=$('.sidebar-nav-tab[href="#sidebar-content-tab"]');c.hasClass("active")||($("#problem-sidebar-tabs .active").removeClass("active"),c.parent().addClass("active")),t.isSidebarOpen()||t.toggleSidebar()}}),document.getElementsByClassName("sandbox-demo-try-it-button").forEach(function(o){o.addEventListener("click",function(){window.Ed.save(function(){window.Ed.setCodeFromJSON(JSON.parse(o.dataset.starterCode),{mainClass:o.dataset.main})})})}),$(Bb).on("click",function(){(t.sidebarOpen&&!t.fullSize||!t.sidebarOpen&&t.fullSize)&&$(Pl).exists()&&t.toggleSidebar();var o;t.fullSize?o=G8:o=0,$(Rf).animate({"padding-right":o},250,function(){t.editor.aceEditor.resize(),$(Bb).toggleClass("expanded")}),$(uC).animate({width:"toggle"}),t.fullSize=!t.fullSize,t.fullSize?$(Bb).attr("aria-label","Exit editor fullscreen"):$(Bb).attr("aria-label","Activate editor fullscreen")}),t.setupRightSidebarResize(),$(pC).width($(dC).width()-20-100),t.options.isQuiz||t.editor.aceEditor.resize(),window.innerWidth<960&&t.toggleSidebar()};W8.exports=ks});var gC=D((BDe,X8)=>{var oTe=_i(),uTe=Cr(),cTe="#course-search",lTe="#search-results",dTe=".js-search-item",eo="#sidebar-content-tab",fTe=function(t,e){return e===!0||oTe.send({method:"get_sidebar_content",app:"editor",data:{userId:t,itemId:window.pageSpecific.itemID,moduleId:window.pageSpecific.moduleID,courseId:window.pageSpecific.courseID,studentAssignmentId:window.pageSpecific.studentAssignmentID||0},success:function(r){if(!(r.status!=="ok"||e)){e=!0;var n=$(r.text);$(eo).prepend(n);var i=$(cTe),a=$(lTe),s=$(dTe);if(i.on("keyup",function(){var l=i.val();l.length>=3?(a.show(),s.each(function(){var f=$(this),g=f.data("item-title");g.toLowerCase().indexOf(l)!==-1?f.show():f.hide()})):a.hide()}),$(".module-progress").on("click",function(){var l=$(this);$(this).hasClass("closed")?($(".module-progress.open").length?$(".module-progress.open").next().slideUp(400,function(){$(this).prev().addClass("closed").removeClass("open").attr("aria-expanded","false"),K8(l)}):K8(l),$(this).addClass("open").removeClass("closed").attr("aria-expanded","true")):$(this).next().slideUp("slow",function(){l.addClass("closed").removeClass("open").attr("aria-expanded","false")})}),$(".lesson-item.current").parent().slideDown().prev().removeClass("closed").addClass("open").attr("aria-expanded","true"),$(".module-lesson").on("click",function(){if($(this).next().slideToggle("fast"),$(this).toggleClass("closed").toggleClass("open"),$(this).hasClass("open")){var l=$(eo).scrollTop()-$(eo).offset().top;$(eo).animate({scrollTop:$(this).offset().top+l},"slow"),$(this).attr("aria-expanded","true")}else $(this).attr("aria-expanded","false")}),$("#problem-sidebar").length){var o=".module-progress.current-module",c=$(eo).offset().top;$(o).length&&$(eo).scrollTop($(o).offset().top-c)}uTe.trigger("main:setupTooltips",eo)}},error:function(){$(eo).prepend("Oops. Something didn't work. Try refreshing.")}}),!0};function K8(t){t.next().slideDown(400,function(){var e=$(eo).scrollTop()-$(eo).offset().top;$(eo).animate({scrollTop:t.offset().top+e},400)})}X8.exports=fTe});var J8=D((qDe,Y8)=>{"use strict";var mg=Nr(),pTe=Cr(),hTe=_i();function gTe(t,e){var r;if(e==mg.QuizQuestion.MULTIPLE_CHOICE||e==mg.QuizQuestion.MULTIPLE_CHOICE_GRADING){r=$("input[name=question"+t+"]:checked");var n=r.attr("data-idx");return n}else if(e==mg.QuizQuestion.SHORT_ANSWER){r=$("#text_"+t);var i=r.val();return i}else return null}function mTe(t){t=t||0;var e=$(".question-submit-button"),r=$(".question-submit");$("#submit-button").hide(),$("#save-button").hide(),$("#settings-button").hide(),$("td").each(function(a,s){$(this).addClass("gradingquiz-answer")});for(var n=e.length,i=0;i<n-1;i++)$(e[i]).removeClass("question-submit-button").addClass("gradingquiz-button").hide();$(e[n-1]).removeClass("question-submit-button").addClass("gradingquiz-button").addClass("gradingquiz-submit-button"),$(".gradingquiz-submit-button").on("click",function(){$(".gradingquiz-button").each(function(a,s){var o=$(this).attr("data-qid"),c=parseInt($(this).attr("data-qtype")),l=parseInt($(this).attr("data-atype")),f=gTe(o,c);f&&(l==mg.QuizQuestion.SINGLE_RESPONSE&&($(this).attr("disabled","disabled"),$(this).html("Answered"),c==mg.QuizQuestion.SHORT_ANSWER&&$("#text_"+o).attr("disabled","disabled")),hTe.send({method:"answer_question",app:"quiz",data:{quizID:t,questionID:o,questionType:c,answer:f},success:function(g){pTe.trigger("quiz:answeredQuestion",{response:g,questionID:o})}}))})})}Y8.exports=mTe});var T6=D((jDe,w6)=>{"use strict";var o6=hC(),u6=gC(),si=Nr(),pi=Cr(),Au=Yl(),Fi=_i(),Df=Jl(),c6=_z().setupFirebase,Xb=wz().selectableMarkdown,vTe=J8(),Rl=Ql(),Ro=".num-answered",Mf=".num-correct",yTe="#quiz-info",bTe="quiz-completed",xC="#quiz-reset",On="#next-button",to=".check-answer-button",Dl=".answer-checked-button",Lf=".check-answer-button, .multiple-choice-option, #next-button",Q8=".table-clickable-rows tr",Gb="YYYY-MM-DD HH:mm:ss",_Te="#start-quiz-modal",CC="#quiz-timer-toggle",wTe="#quiz-timer-content",qb,mC,Br,ku,yC,Z8,l6,d6,Os,bC="True",e6,t6,r6,jb,ds,_c;function Hb(){return Br>=ku?($(On).removeAttr("disabled"),pi.trigger("utils:turnButtonGreen",On),$(yTe).addClass(bTe),!0):!1}function Vb(t,e,r){var n=$("#q-"+t+" .question-answers tr")[e];$(n).addClass(r)}function i6(t,e,r){r==si.QuizQuestion.CHECK_BOXES?(e=JSON.parse(e),$.each(e,function(n,i){Vb(t,i,"correct")})):Vb(t,e,"correct")}function TTe(t,e,r,n){if(n==si.QuizQuestion.CHECK_BOXES){e=JSON.parse(e),r=JSON.parse(r);var i=JSON.stringify(_.difference(e,r));$.each(JSON.parse(i),function(a,s){Vb(t,s,"incorrect")})}else Vb(t,e,"incorrect")}function STe(t,e){$("#q-"+t+" .question-answers tr").each(function(){$(this).prop("onclick",null).off("click"),$(this).removeClass("hoverable"),e==si.QuizQuestion.CHECK_BOXES?$(this).find("td input:checkbox").attr("disabled",!0):$(this).find("td input:radio").attr("disabled",!0)})}function AC(t){var e=parseInt(t.response.questionID),r=parseInt(t.response.questionType),n=parseInt(t.response.answerType),i,a;if(r==parseInt(si.QuizQuestion.CHECK_BOXES)){i=t.response.userAnswer.replace(" ",""),a=t.response.correctAnswer.replace(" ","");var s=JSON.parse(t.response.reason);$.each(s,function(c,l){$(".reasons-"+e).append('<p data-qid="'+e+'" data-markdown="'+l+'"></p>')}),pi.trigger("CHS.Utils.markdown:setup")}else i=parseInt(t.response.userAnswer),a=parseInt(t.response.correctAnswer),$(".reasons-"+e).append('<p data-qid="'+e+'" data-markdown="'+t.response.reason+'"></p>'),pi.trigger("CHS.Utils.markdown:setup");if(r!=parseInt(si.QuizQuestion.SHORT_ANSWER)?(STe(t.questionID,r),i===a?(Os++,Br++,$(Mf).html(Os),i6(t.questionID,a,r),$("button[data-qid="+e+"]").attr("disabled","disabled")):(TTe(t.questionID,i,a,r),n==si.QuizQuestion.SINGLE_RESPONSE&&(Br++,i6(t.questionID,a,r),$("button[data-qid="+e+"]").attr("disabled","disabled")))):(Br++,bC="False",$("button[data-qid="+e+"]").attr("disabled","disabled")),$(Ro).html(Br),Hb()){var o=_6();Rl(o?{student_assignment_id:o}:{item_id:LC(),module_id:NC(),course_id:MC(),auto_grade:bC})}}pi.on("quiz:answeredQuestion",function(t){AC(t)});function ETe(t,e){var r,n;if(e===si.QuizQuestion.MULTIPLE_CHOICE||e===si.QuizQuestion.MULTIPLE_CHOICE_GRADING||e===si.QuizQuestion.CHECK_BOXES){if(r=$("input[name=question"+t+"]:checked"),e==si.QuizQuestion.CHECK_BOXES){var i=[];$.each(r,function(s,o){i.push(parseInt($(o).attr("data-idx")))}),n=JSON.stringify(i)}else n=r.attr("data-idx");return n}else if(e==si.QuizQuestion.SHORT_ANSWER){r=$("#text_"+t);var a=r.val();return a}else return null}function xTe(t,e){mC=mC||window.Markdown.getSanitizingConverter();function r(){var n=$(t).val(),i=mC.makeHtml(n);$(e).html(i)}$(t).on("keypress",r),r()}function f6(t){if(t=t||{},qb=t.quizID||0,Br=t.numAnswered||0,ku=t.numQuestions||0,Os=t.numCorrect||0,yC=t.itemID||0,l6=t.moduleID||0,d6=t.courseID||0,Z8=t.itemType||0,e6=t.makeEditorColumns||!1,t6=t.pageUserID||0,r6=t.pageUserName||"",jb=t.studentAssignmentID,Hb(),$("#refresh").on("click",function(){window.location.reload()}),$(Q8).on("mouseenter",function(){$(this).parents(".question").attr("data-answered")==="True"&&$(this).removeClass("hoverable")}),$(Q8).on("click",function(r){$(this).parents(".question").attr("data-answered")!=="True"&&$(this).find("td input:radio").prop("checked",!0)}),$(On).on("click",function(r){if(Hb()){var n=_6();Rl(n?{student_assignment_id:n}:{item_id:LC(),module_id:NC(),course_id:MC(),auto_grade:bC})}}),$(xC).on("click",function(){var r,n,i;jb?(r={studentAssignmentId:jb},n="reset_assignment",i="lms"):(r={user_id:t6,quiz_id:qb,item_id:yC},n="reset_quiz",i="quiz"),Df({message:"Warning: This is will reset the entire quiz for "+r6+".",button:"Reset",cancelButton:!0,ok_callback:function(){Fi.send({method:n,app:i,data:r,success:function(a){a.status==="ok"&&location.reload()}})}})}),$(".question-submit-button").on("click",function(){if(!$(this).hasClass("gradingquiz-button")){var r=$(this).attr("data-qid"),n=parseInt($(this).attr("data-qtype")),i=parseInt($(this).attr("data-atype")),a=ETe(r,n);a&&(i==si.QuizQuestion.SINGLE_RESPONSE&&($(this).attr("disabled","disabled"),$(this).html("Answered"),n===si.QuizQuestion.SHORT_ANSWER&&$("#text_"+r).attr("disabled","disabled")),Fi.send({method:"answer_question",app:"quiz",data:{quizID:qb,questionID:r,questionType:n,answer:a},success:function(s){s.status==="existed"&&Df({message:"Looks like you already answered that question",button:"OK",cancelButton:!1,ok_callback:function(){}}),AC({response:s,questionID:r})},error:function(s){Df({message:"There was an error answering the question. Try refreshing the page, then if the problem continues, contact support@codehs.com",button:"OK",cancelButton:!1,ok_callback:function(){}})}}))}}),parseInt(Z8)===si.ItemType.GRADING_QUIZ&&(Hb()||$(On).attr("disabled","disabled"),vTe(qb)),e6){var e=new o6(null,{isQuiz:!0});e.toggleSidebar()}window.pageSpecific.loaded=!1,$('#open-toggle, a[href="#sidebar-content-tab"]').on("click",function(){window.pageSpecific.loaded||(window.pageSpecific.loaded=u6(window.pageSpecific.codeUserID||window.pageSpecific.pageUserID,window.pageSpecific.loaded))})}function CTe(){if(Br=window.pageSpecific.numAnswered,ku=window.pageSpecific.numQuestions,$(CC).on("click",PC),ds=window.pageSpecific.timeLimit,window.pageSpecific.endTime&&(_c=window.moment.tz(window.pageSpecific.endTime,Gb,window.pageSpecific.codehsTimezone)),window.pageSpecific.ownPage&&window.pageSpecific.activeAttempt){if(ds&&!_c){var t=$("#quiz-start-countdown-modal");t.on("hidden.bs.modal",function(){_C()}).modal({backdrop:"static",show:!0}),vg();var e=4,r=setInterval(function(){e<=0?(clearInterval(r),t.modal("hide")):e<3&&$(".quiz-start-countdown-count").html(e),e--},1e3)}else ds&&_c?_C():(n6(),IC(),kC());window.pageSpecific.isCertExam&&!window.pageSpecific.allowQuestionFeedback&&($(document).on("copy cut contextmenu",function(n){n.stopPropagation(),n.preventDefault()}),$(document).on("keydown",function(n){if((n.ctrlKey||n.metaKey)&&n.which==83){n.stopPropagation(),n.preventDefault();return}var i=[65,67,69,73,74,75,84,85,90],a=[116,118,120,123];if((n.ctrlKey||n.metaKey)&&i.indexOf(n.which)!=-1||a.indexOf(n.which)!=-1){n.stopPropagation(),n.preventDefault();return}return!0})),_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)&&g6()}else n6();$(xC).on("click",function(){var n=$(this);n.prop("disabled",!0),Df({message:"Are you sure you want to reset this quiz?",button:"Reset",cancelButton:!0,ok_callback:function(){Fi.send({method:"reset_assignment",app:"lms",header:"Reset Quiz",data:{studentAssignmentId:window.pageSpecific.studentAssignmentID},success:function(i){i.status==="ok"?(Au.success("Quiz reset successful, page will refresh momentarily."),location.reload()):(Au.error("Could not reset quiz, please try again."),n.prop("disabled",!1))},error:function(){Au.error("Something went wrong, please refresh and try again.")}})}})})}function ATe(){Br=window.pageSpecific.numAnswered,ku=window.pageSpecific.numQuestions,window.pageSpecific.ownPage&&window.pageSpecific.activeAttempt&&(ds&&_c?_C():(IC(),kC()),_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)&&g6()),$(to).on("click",function(){var t=$(this).data("questionId");h6(t)}),$(xC).on("click",function(){var t=$(this);t.prop("disabled",!0),Df({message:"Are you sure you want to reset this quiz?",button:"Reset",cancelButton:!0,ok_callback:function(){Fi.send({method:"reset_assignment",app:"lms",header:"Reset Quiz",data:{studentAssignmentId:window.pageSpecific.studentAssignmentID},success:function(e){e.status==="ok"?(Au.success("Quiz reset successful, page will refresh momentarily."),location.reload()):(Au.error("Could not reset quiz, please try again."),t.prop("disabled",!1))},error:function(){Au.error("Something went wrong, please refresh and try again.")}})}})})}function ITe(){Br=window.pageSpecific.numAnswered,ku=window.pageSpecific.numQuestions,$(".multiple-choice-option").on("change",function(){var t=$(this).data("questionId");_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)?$("#check-"+t+"-button").removeAttr("disabled"):(Br=$(".multiple-choice-option:checked").length,$(Ro).html(Br))}),_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)?$(to).on("click",function(){var t=$(this).data("questionId"),e=p6(t);$(this).removeClass(to.replace(".","")).addClass(Dl.replace(".","")).text("Answered").closest("li").children(".question-correctness-indicator").addClass(e?"correct":e==null?"unanswered":"incorrect")}):$(".score-container").hide(),window.pageSpecific.embeddedQuiz?$(On).one("click",Jb):$(On).on("click",Yb)}function p6(t){var e=null;RC(t);var r=$("input[id^=qq"+t+"-answer]:checked"),n=window.pageSpecific.questionToData[t];r.closest("li").addClass("selected-answer"),r.length&&r.val()!=n.answer?(r.parent().addClass("incorrect-answer"),e=!1):r.length&&(e=!0),$("#qq"+t+"-answer"+n.answer).parent().addClass("correct-answer");var i=n["reason"+r.val()];return i&&($("#check-"+t+"-button").siblings(".answer-reason").removeClass("gone").text(i).attr("data-markdown",""),pi.trigger("CHS.Utils.markdown:setup")),Br=$(".multiple-choice-option:checked").length,$(Ro).html(Br),Os=Br-$(".incorrect-answer").length,$(Mf).html(Os),e}function kTe(){Br=window.pageSpecific.numAnswered,ku=window.pageSpecific.numQuestions,$(".multiple-choice-option").on("change",function(){var t=$(this).data("questionId");_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)?$("#check-"+t+"-button").removeAttr("disabled"):(Br=$(".multiple-choice-option:checked").length,$(Ro).html(Br))}),_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)?$(to).on("click",function(){var t=$(this).data("questionId");RTe(t),h6(t),$(this).removeClass(to.replace(".","")).addClass(Dl.replace(".","")).text("Answered")}):$(".score-container").hide(),window.pageSpecific.embeddedQuiz?$(On).one("click",Jb):$(On).on("click",Yb)}function OTe(t){var e=$(t),r=$(".qotd-stats-display");e.insertAfter(r)}function PTe(t){t&&($(".streak").removeClass("hidden"),$(".streak-num").text(t),t==1?$(".streak").attr("title","You've correctly answered "+t+" day in a row!").tooltip("fixTitle"):$(".streak").attr("title","You've correctly answered "+t+" days in a row!").tooltip("fixTitle"))}function h6(t){var e=$("input[id^=qq"+t+"-answer]:checked"),r=window.pageSpecific.questionToData[t];Fi.send({method:"record_stats",app:"quiz",data:{selected_answer:e.val(),assignment_id:window.pageSpecific.assignmentID,question_id:t,qotd_user_identifier:window.pageSpecific.QOTDUserIdentifier},success:function(n){OTe(n.html),PTe(n.streak),pi.trigger("utils:charts:setup")},error:function(n){window.toastr.error("Something went wrong, refresh and try again.")}})}function RTe(t){RC(t);var e=$("input[id^=qq"+t+"-answer]:checked"),r=window.pageSpecific.questionToData[t];e.closest("li").addClass("selected-answer"),e.val()!=r.answer?(e.parent().addClass("incorrect-answer"),$(".question-correctness-indicator").addClass("incorrect")):$(".question-correctness-indicator").addClass("correct"),$("#qq"+t+"-answer"+r.answer).parent().addClass("correct-answer");var n=r["reason"+e.val()];n&&($("#check-"+t+"-button").siblings(".answer-reason").removeClass("gone").text(n).attr("data-markdown",""),pi.trigger("CHS.Utils.markdown:setup")),Br=$(".multiple-choice-option:checked").length,$(Ro).html(Br),Os=Br-$(".incorrect-answer").length,$(Mf).html(Os)}function DTe(){$(".multiple-choice-option:checked").attr("checked",!1),$(".correct-answer").removeClass("correct-answer"),$(".incorrect-answer").removeClass("incorrect-answer"),$(".selected-answer").removeClass("selected-answer"),$(".correct").removeClass("correct"),$(".incorrect").removeClass("incorrect"),$(".unanswered").removeClass("unanswered"),$(".answer-reason").addClass("gone").empty(),$(".multiple-choice-option:checked").prop("checked",!1),$(Ro).html(0),$(Mf).html(0),Br=0,Os=0,$(On).removeClass("btn-main-orange").addClass("btn-main").text("Submit"),window.pageSpecific.embeddedQuiz?$(On).one("click",Jb):$(On).on("click",Yb),$(Dl).addClass(to.replace(".","")).removeClass(Dl.replace(".","")).text("Check"),_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)||$(".score-container").hide(),m6()}function IC(){$(".multiple-choice-option").on("change",function(){var t=$(this),e=t.data("questionId"),r=t.is(":focus");$(Lf).filter(":not([disabled])").addClass("loading").attr("disabled",!0),Fi.send({method:"track_quiz_answer",app:"quiz",data:{attempt_id:window.pageSpecific.assignmentAttemptID,question_id:e,answer_idx:t.val()},success:function(n){$(Lf).filter(".loading").removeClass("loading").removeAttr("disabled"),r&&t.trigger("focus"),n.status!="ok"?(window.toastr.error(n.msg),t.prop("checked",!1)):_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)?$("#check-"+e+"-button").removeAttr("disabled"):(Br=$(".multiple-choice-option:checked").length,$(Ro).html(Br))},error:function(n){$(Lf).filter(".loading").removeClass("loading").removeAttr("disabled"),window.toastr.error("Something went wrong, refresh and try again."),t.prop("checked",!1)}})})}function n6(){var t=$(".prism-highlight.code-select").find(".line-numbers");t.each(function(e,r){var n=$(r),i=n.closest(".prism-highlight.code-select"),a=i.data("questionId"),s=i.data("selectedAnswer"),o=i.data("correct"),c=i.data("blockRanges")||"",l=[];c&&(l=c.split(",").map(function(A){var k=A.trim().split("-");return k.length===2?{start:parseInt(k[0]),end:parseInt(k[1])}:{start:parseInt(k[0]),end:parseInt(k[0])}})),Xb(n,l,"radio");var f=n.find("code");if(s>=0){var g=f.find(".code-block").eq(s).attr("aria-checked","true").addClass("selected-block").attr("tabindex","0");o!=null&&g.addClass(o?"correct-answer":"incorrect-answer")}else f.find(".code-block").first().attr("tabindex","0");var m=null;f.on("focus",".code-block",function(){m=this}),f.on("focusin",function(A){var k=f.find(".code-block"),I=k.filter('[aria-checked="true"]');if(A.relatedTarget&&!n[0].contains(A.relatedTarget)){var F=I.length?I.last():k.last();k.attr("tabindex","-1"),F.attr("tabindex","0").trigger("focus")}}),f.on("click",".code-block",function(A){var k=f.find(".code-block"),I=$(this);k.attr("aria-checked","false").attr("tabindex","-1").removeClass("selected-block"),I.attr("aria-checked","true").attr("tabindex","0").addClass("selected-block"),m=this,a6(I.data("blockIndex"),a)});var y=_.debounce(function(A,k){a6(A,k)},250);f.on("keydown",".code-block",function(A){var k=$(this),I=f.find(".code-block"),F=I.index(k),J;switch(A.key){case"ArrowUp":case"ArrowLeft":F===0?J=I.eq(I.length-1):J=I.eq(F-1);break;case"ArrowDown":case"ArrowRight":F===I.length-1?J=I.eq(0):J=I.eq(F+1);break;case" ":case"Enter":k.trigger("click"),A.preventDefault();return}J&&J.length&&(I.attr("tabindex","-1").attr("aria-checked","false").removeClass("selected-block"),J.attr("tabindex","0").attr("aria-checked","true").addClass("selected-block").trigger("focus"),y(J.data("blockIndex"),a),A.preventDefault())})})}function a6(t,e){Fi.send({method:"track_quiz_answer",app:"quiz",data:{attempt_id:window.pageSpecific.assignmentAttemptID,question_id:e,answer_idx:t},success:function(r){r.status!="ok"?window.toastr.error(r.msg):_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay)?$("#check-"+e+"-button").removeAttr("disabled"):(Br=$('.code-block[aria-checked="true"]').length,$(Ro).html(Br))},error:function(r){window.toastr.error("Something went wrong, refresh and try again.")}})}function g6(){$(to).on("click",function(){var t=$(this),e=t.data("questionId");t.addClass("spinning"),RC(e),$(Lf).filter(":not([disabled])").addClass("loading").attr("disabled",!0);var r,n;Fi.send({method:"finalize_quiz_answer",app:"quiz",data:{attempt_id:window.pageSpecific.assignmentAttemptID,question_id:e},success:function(i){if(t.removeClass("spinning"),$(Lf).filter(".loading").removeClass("loading").removeAttr("disabled"),i.status=="ok"){if(t.removeClass(to.replace(".","")).addClass(Dl.replace(".","")).text("Answered"),i.reason&&(t.siblings(".answer-reason").removeClass("gone").text(i.reason).attr("data-markdown",""),pi.trigger("CHS.Utils.markdown:setup")),Br=$(Dl).length,$(Ro).html(Br),r=$("#qq"+e+"-answer"+i.selectedAnswer).parent(),n=$("#qq"+e+"-label"),i.correct){r.addClass("correct-answer"),n.find(".selected-block").addClass("correct-answer");var a=t.closest("li").find(".question-correctness-indicator");if(a.length){a.addClass("correct");var s=a[0].getBoundingClientRect();eSe(s)}}else{r.addClass("incorrect-answer"),n.find(".selected-block").addClass("incorrect-answer");var o=t.closest("li").find(".question-correctness-indicator");o.length&&o.addClass("incorrect"),i.correctAnswer!=null&&$("#qq"+e+"-answer"+i.correctAnswer).parent().addClass("correct-answer")}n.addClass("finalized-qq").find(".code-block").attr({tabindex:-1,"aria-disabled":"true"}),r.parent("li").addClass("selected-answer"),t.closest("li").children(".question-correctness-indicator").addClass(i.correct?"correct":"incorrect"),Os=Br-$(".incorrect-answer").length,$(Mf).html(Os),i.finishedQuiz&&Rl({student_assignment_id:window.pageSpecific.studentAssignmentID,assignment_attempt_id:window.pageSpecific.assignmentAttemptID,submission_type:si.AssignmentAttempt.QUESTIONS_COMPLETED},function(){var c={href:window.pageSpecific.nextUrl};$.each($(On)[0].attributes,function(f,g){c[g.nodeName]=g.nodeValue});var l=$("<a>",c).append($(On).contents());$(On).off("click",OC).replaceWith(l)})}else UTe(e),window.toastr.error(i.msg)},error:function(i){t.removeClass("spinning"),$(Lf).filter(".loading").removeClass("loading").removeAttr("disabled"),window.toastr.error("Something went wrong, refresh and try again.")}})})}function kC(){$(On).on("click",OC)}function LTe(){$("#student-retake").on("click",function(){var t=$(this);t.attr("disabled","disabled"),Fi.send({method:"create_retake",app:"quiz",data:{student_assignment_id:window.pageSpecific.studentAssignmentID},success:function(e){e.status=="ok"?window.location.reload():(Au.error("Could not create a retake!"),t.removeAttr("disabled"))},error:function(){Au.error("Something went wrong!"),t.removeAttr("disabled")}})})}function Yb(t){OC(t,!0)}function OC(t,e){var r="<p><strong>Are you sure you want to submit?</strong></p>";Br<ku&&(r+="<p>You have answered "+Br+" out of "+ku+" questions.</p>"),r+="<p>No further changes will be allowed and all questions will graded as is.</p>";var n={header:"Confirm Submit",rawHtml:r,button:"Submit",cancelButton:!0};e?n.ok_callback=function(){Jb()}:n.ok_callback=function(){vg(),Rl({student_assignment_id:window.pageSpecific.studentAssignmentID,assignment_attempt_id:window.pageSpecific.assignmentAttemptID,submission_type:si.AssignmentAttempt.CLICKED_SUBMIT},function(){window.location.reload()})},Df(n)}function Jb(){var t=_.includes(si.AssignmentAttempt.SCORE_SHOWN_IMMEDIATELY,window.pageSpecific.quizResultDisplay);Object.keys(window.pageSpecific.questionToData).forEach(function(e){var r;(!t||$("#check-"+e+"-button"+to).length)&&(r=p6(e),$("#qq"+e+"-correctness-indicator").addClass(r?"correct":r==null?"unanswered":"incorrect"))}),Os=$(".correct-answer .multiple-choice-option:checked").length,$(Mf).html(Os),$(Ro).html(ku),$(".score-container").show(),$(to).removeClass(to.replace(".","")).addClass(Dl.replace(".","")).text("Answered"),$(On).removeClass("btn-main").addClass("btn-main-orange").text("Reset").one("click",DTe).off("click",Yb)}function NTe(){if($("#problem-sidebar").length){var t=new o6(null,{isQuiz:!0});t.toggleSidebar(),$("body").on("click","#problem-sidebar.minimized .sidebar-nav-tab",function(){$($(this).attr("href")).tab("show"),t.toggleSidebar()});var e=!1;$('#open-toggle, a[href="#sidebar-content-tab"]').on("click",function(){e=u6(window.pageSpecific.pageUserID,e)})}}function MTe(){$(_Te).modal({backdrop:"static",show:!0}),$(".start-quiz-btn").on("click",function(){var t=$(this);pi.trigger("utils:disableButton",t),Fi.send({method:"exit_waiting_room",app:"quiz",data:{attempt_id:window.pageSpecific.assignmentAttemptID,start_time:window.moment.tz(window.pageSpecific.codehsTimezone).format(Gb)},success:function(e){e.status=="ok"?location.reload():(pi.trigger("utils:enableButton",t),window.toastr.error(e.msg))},error:function(e){window.toastr.error("Something went wrong, refresh and try again.")}})})}function PC(t,e){var r=$(wTe),n=$(CC);e&&(n.off("click",PC).hide(),!r.is(":hidden"))||r.toggle({width:"toggle",complete:function(){n.toggleClass("collapsed",r.is(":hidden"))}})}function _C(){m6(),$(".timed-quiz").addClass("quiz-started"),IC(),kC(),_c||$Te();var t,e=setInterval(function(){t=wC(),t<=0&&(clearInterval(e),vg(),Rl({student_assignment_id:window.pageSpecific.studentAssignmentID,assignment_attempt_id:window.pageSpecific.assignmentAttemptID,submission_type:si.AssignmentAttempt.TIME_LIMIT_REACHED},function(){window.location.reload()}))},1e3)}function $Te(){var t=window.moment.tz(window.pageSpecific.codehsTimezone);_c=t.clone().add(ds,"minutes"),wC(),Fi.send({method:"set_end_time",app:"quiz",data:{attempt_id:window.pageSpecific.assignmentAttemptID,start_time:t.format(Gb),end_time:_c.format(Gb)},success:function(e){e.status=="ok"?wC():(vg(),$(".timed-quiz").removeClass("quiz-started"),window.toastr.error("Issue starting quiz, refreshing momentarily"),setTimeout(window.location.reload(),2e3))},error:function(){vg(),$(".timed-quiz").removeClass("quiz-started"),window.toastr.error("Issue starting quiz, refreshing momentarily"),setTimeout(window.location.reload(),2e3)}})}function wC(){var t=window.moment.tz(window.pageSpecific.codehsTimezone),e=window.moment.duration(_c.diff(t)),r,n,i;return e.asSeconds()<0?(r=0,n=0,i=0):(r=e.seconds(),n=e.minutes(),i=e.hours()),i==0&&(n==1&&r==0||n==0)?PC(null,!0):$(CC).show(),$(".timer-secs").html(("0"+r).slice(-2)),$(".timer-mins").html(("0"+n).slice(-2)),$(".timer-hrs").html(i),$("#quiz-timer").show(),e}function vg(){$(".quiz-question-answers label").addClass("disabled").children("input[type=radio]").attr("disabled","disabled"),$(On).attr("disabled","disabled")}function m6(){$(".quiz-question-answers label").removeClass("disabled").children("input[type=radio]").removeAttr("disabled"),$(On).removeAttr("disabled")}function RC(t){$("#check-"+t+"-button").attr("disabled","disabled"),$("input[id^=qq"+t+"-answer]").attr("disabled","disabled").parent().addClass("disabled")}function UTe(t){$("#check-"+t+"-button").removeAttr("disabled"),$("input[id^=qq"+t+"-answer").removeAttr("disabled").parent().removeClass("disabled")}function FTe(){var t={itemID:window.pageSpecific.itemID,moduleID:window.pageSpecific.moduleID,courseID:window.pageSpecific.courseID,quizID:window.pageSpecific.quizID,numAnswered:window.pageSpecific.numAnswered,numQuestions:window.pageSpecific.numQuestions,numCorrect:window.pageSpecific.numCorrect,makeEditorColumns:window.pageSpecific.makeEditorColumns,pageUserID:window.pageSpecific.pageUserID,pageUserName:window.pageSpecific.pageUserName,studentAssignmentID:window.pageSpecific.studentAssignmentID};f6(t)}var ls,zb,Po,wc,Nf,TC=!1,Wb=null,Kb=null;function BTe(){HTe(),ZTe($(".bee-container .bee")),Nf=!1,zb=c6("/gametime/timer",window.pageSpecific.isLocal,window.pageSpecific.sectionID,!1),zb.on("value",function(t){if(!t.val()||t.val().assignment_id!=window.pageSpecific.assignmentID){TC=!0;return}if(t.val().start_time)Po=t.val().question_id,!ls||wc!=t.val().start_time?(wc=t.val().start_time,ds=parseInt(t.val().time_limit),window.pageSpecific.previewDelay<=0&&Ll(),b6(),$(".quiz-game-waiting-room").addClass("hidden"),$(".quiz-header").removeClass("hidden")):t.val().time_limit!=ds&&(ds=parseInt(t.val().time_limit),Ll()),t.val().students&&window.pageSpecific.isTeacher&&GTe(t.val().students.num_answered,t.val().students.num_joined);else if(t.val().stopped)DC();else if(t.val().show_leaderboard&&(!window.pageSpecific.isTeacher||!$("#leaderboard").is(":visible"))){var e=t.val().quiz_completed;EC(!1,e,function(){$("#leaderboard").fadeIn(),$(".quiz-game-waiting-room").addClass("hidden"),$("#quiz-question-div").addClass("hidden"),$("#answer-status").addClass("hidden"),$(".quiz-header").removeClass("hidden"),e&&($("#quiz-completed").removeClass("hidden"),$("#next-assignment").removeClass("hidden"))})}}),$("#start-game").on("click",function(){var t=$(this).data("quiz-completed"),e=$(this).data("show-leaderboard");if(e){$("#answer-breakdown").addClass("hidden"),$("#answer-status").addClass("hidden"),$("#leaderboard").hide(),EC(!0,t,function(){$("#leaderboard").fadeIn(),$("#start-game").data("show-leaderboard",!1),$("#quiz-question-div").addClass("hidden"),t&&($("#next-assignment").removeClass("hidden"),$("#quiz-completed").removeClass("hidden"),$("#start-game").addClass("hidden"),$("#top-bar-next-question").addClass("hidden"),$("#section-leaderboard").removeClass("hidden"),pi.trigger("eventtracking:track_event",{name:"Completed QuizBuzz"}))});return}TC=!1,Po=$(this).data("question-id"),$(".quiz-teacher-controls").addClass("hidden"),$(".quiz-game-waiting-room").addClass("hidden"),$(".quiz-header").removeClass("hidden"),VTe(),SC(),pi.trigger("eventtracking:track_event",{name:"Started QuizBuzz"})}),$("#add-time").on("click",function(){$(this).trigger("blur"),v6()}),$("#push-to-students").on("click",function(){SC(!0)}),window.pageSpecific.isTeacher?qTe():jTe()}function SC(t){Fi.send({method:"push_quiz_game_to_students",app:"quiz",data:{assignment_id:window.pageSpecific.assignmentID,section_id:window.pageSpecific.sectionID,reset_timer:t}})}function qTe(){$(".start-quiz-game-btn").on("click",function(){$("#start-game").trigger("click")}),$("#top-bar-next-question").on("click",function(){$(this).trigger("blur"),ls?Fi.send({method:"start_quiz_game_timer",app:"quiz",data:{question_id:Po,section_id:window.pageSpecific.sectionID,assignment_id:window.pageSpecific.assignmentID,time_limit:0,start_time:wc}}):$("#start-game").trigger("click")});var t={},e=c6("/gametime/"+window.pageSpecific.assignmentID+"/student_activity",window.pageSpecific.isLocal,window.pageSpecific.sectionID,!1);function r(){var a=$("#active-students").children(".student-name").length,s=$(".total-students-count"),o=parseInt(s.text());!isNaN(o)&&a>o&&s.text(a),$(".active-students-count").text(a)}e.on("value",function(a){a.val()&&(Object.entries(a.val()).forEach(function(s){var o=s[0],c=s[1];c.is_active=c.is_active&&c.timestamp>=Iu()-60*1e3;var l=t[o]!==void 0&&t[o].is_active;s[1].is_active!=l&&(s[1].is_active?$("#active-students").append('<div class="student-name" data-student-id="'+o+'"><img src="'+c.profile_picture_url+'">'+c.name+"</div>"):$("#active-students").find('.student-name[data-student-id="'+o+'"]').remove()),t[o]=c}),r())});var n=setInterval(function(){Object.entries(t).forEach(function(a){var s=a[0],o=a[1];o.is_active&&o.timestamp<Iu()-60*1e3&&(o.is_active=!1,$("#active-students").find('.student-name[data-student-id="'+s+'"]').remove())}),r()},60*1e3);function i(){zb.off("value"),e.off("value"),clearInterval(n),window.removeEventListener("beforeunload",i),$(document).off("turbolinks:before-render",i)}window.addEventListener("beforeunload",i),$(document).on("turbolinks:before-render",i)}function jTe(){function t(){Fi.send({method:"ping_student_activity",app:"quiz",data:{section_id:window.pageSpecific.sectionID,assignment_id:window.pageSpecific.assignmentID}})}var e=setInterval(t,30*1e3);t();var r=window.pageSpecific.sectionID,n=window.pageSpecific.assignmentID;function i(){zb.off("value"),clearInterval(e),window.removeEventListener("beforeunload",i),$(document).off("turbolinks:before-render",i),Fi.send({method:"ping_student_activity",app:"quiz",data:{section_id:r,assignment_id:n,is_active:!1}})}window.addEventListener("beforeunload",i),$(document).on("turbolinks:before-render",i)}function HTe(){var t=performance.now();Fi.send({method:"server_time_ms",app:"quiz",data:{},success:function(e){var r=performance.now(),n=r-t,i=e.server_ms+n/2;Wb=i,Kb=r},error:function(){Wb=null,Kb=null}})}function Iu(){return Wb!=null&&Kb!=null?Wb+(performance.now()-Kb):Date.now()}function GTe(t,e){$("#num-students").text(t+" out of "+e+" students answered"),$("#num-students").removeClass("hidden")}function EC(t,e,r){Fi.send({method:"get_quiz_game_leaderboard",app:"quiz",data:{section_id:window.pageSpecific.sectionID,assignment_id:window.pageSpecific.assignmentID,full_leaderboard:window.pageSpecific.showFullLeaderboard,push_leaderboard:t,quiz_completed:e},success:function(n){$("#leaderboard").html(n.html),r&&r()}})}function VTe(){Fi.send({method:"start_quiz_game_timer",app:"quiz",data:{question_id:Po,section_id:window.pageSpecific.sectionID,assignment_id:window.pageSpecific.assignmentID,time_limit:window.pageSpecific.timeLimit,start_time:Iu()/1e3+window.pageSpecific.previewDelay}})}function v6(){ds+=5,Ll(),Fi.send({method:"start_quiz_game_timer",app:"quiz",data:{question_id:Po,section_id:window.pageSpecific.sectionID,assignment_id:window.pageSpecific.assignmentID,time_limit:ds,start_time:wc}})}function Ll(){var t=ds*1e3,e=wc*1e3;$(".game-timer-js").removeClass("hidden"),y6(function(){zTe(e+t-Iu())},e+t)}function zTe(t){if(t>0){var e=Math.ceil(t/1e3);if(e>60){var r=Math.floor(e/60),n=e%60;$("#timer").html(r+":"+("0"+n).slice(-2))}else $("#timer").html(e)}else DC()}function DC(){ls&&(clearInterval(ls),ls=null),WTe(),$(".game-timer-js").addClass("hidden"),$("#num-students").addClass("hidden")}function y6(t,e){ls&&(clearInterval(ls),ls=null);var r=e-Iu();if(r>0){var n=r%1e3;n>0?ls=setInterval(function(){clearInterval(ls),ls=setInterval(t,1e3),t()},n):ls=setInterval(t,1e3)}t()}function WTe(){Fi.send({method:"get_quiz_game_answer",app:"quiz",data:{question_id:Po,attempt_id:window.pageSpecific.assignmentAttemptID,show_answer_breakdown:window.pageSpecific.isTeacher,save_leaderboard:window.pageSpecific.isTeacher,section_id:window.pageSpecific.sectionID,question_ids:window.pageSpecific.questionIDs,question_answered:Nf,is_demo:window.pageSpecific.isDemo,assignment_id:window.pageSpecific.assignmentID},success:function(t){$("#quiz-question-div").html(t.html);var e=$("#leaderboard").hide();window.pageSpecific.isDemo||e.html(""),pi.trigger("CHS.Utils.markdown:setup");var r=$(".prism-highlight.code-select").find(".line-numbers");r.each(function(){var n=$(this).closest(".prism-highlight"),i=n.data("blockRanges"),a=[],s=n.data("correctAnswer");Array.isArray(i)&&i.length&&(a=i.map(function(o){var c=o.trim().split("-");return c.length===2?{start:parseInt(c[0]),end:parseInt(c[1])}:{start:parseInt(c[0]),end:parseInt(c[0])}})),Xb(n,a,"highlight"),n.find(".code-block").each(function(o,c){$(c).addClass("block-color-"+(o%4+1)),o==s&&$(c).addClass("chs-icon-check correct-answer")}),n.find("code").addClass("annotate-with-icon")}),$("#start-game").data("show-leaderboard",!0),t.next_question_id?($("#start-game").html('<i class="fas fa-step-forward spacing-right-sm"></i> Next'),$("#start-game").data("question-id",t.next_question_id),$("#next-assignment").addClass("hidden"),$("#quiz-completed").addClass("hidden"),window.pageSpecific.isTeacher&&!window.pageSpecific.isDemo&&!TC&&SC()):($("#start-game").html('<i class="fas fa-step-forward spacing-right-sm"></i> Finish').data("quiz-completed",!0),window.pageSpecific.isTeacher&&!window.pageSpecific.isDemo&&KTe()),$(".quiz-teacher-controls").removeClass("hidden"),$("#your-points").removeClass("hidden"),$("#answer-status").removeClass("hidden")}})}function KTe(){Fi.send({method:"submit_quiz_game_assignments_for_section",app:"quiz",data:{assignment_id:window.pageSpecific.assignmentID,section_id:window.pageSpecific.sectionID}})}function b6(){Nf=!1;var t=$("#leaderboard").hide();window.pageSpecific.isDemo||t.html(""),$("#answer-breakdown").addClass("hidden"),$("#answer-status").addClass("hidden"),$("#correct-answer").addClass("hidden"),$("#incorrect-answer").removeClass("hidden"),$("#quiz-question-div").removeClass("hidden").html(""),Fi.send({method:"get_quiz_game_question",app:"quiz",data:{question_id:Po,section_id:window.pageSpecific.sectionID,attempt_id:window.pageSpecific.assignmentAttemptID,question_number:window.pageSpecific.questionIDs.indexOf(Po)+1,num_questions:window.pageSpecific.numQuestions,is_demo:window.pageSpecific.isDemo,assignment_id:window.pageSpecific.assignmentID},success:function(e){if($("#quiz-question-div").html(e.html),s6($(".bee-circle-container .bee"),4),pi.trigger("CHS.Utils.markdown:setup"),window.pageSpecific.isTeacher?window.pageSpecific.isDemo?$(".quiz-question-answer").on("click",function(){DC()}).on("keydown",function(i){(i.code==="Enter"||i.code==="Space")&&(i.preventDefault(),$(this).trigger("click"))}):$(".quiz-question-answer").on("click",function(){Au.info("You cannot answer questions as a teacher.")}).on("keydown",function(i){(i.code==="Enter"||i.code==="Space")&&(i.preventDefault(),$(this).trigger("click"))}):(XTe(),$("#your-points").addClass("hidden")),e.question_answered&&(Nf=!0,e.points&&($("#points-added").text("+"+e.points+" points"),$("#correct-answer").removeClass("hidden"),$("#incorrect-answer").addClass("hidden")),e.total_score&&$("#points").text(e.total_score)),window.pageSpecific.previewDelay>0){var r=wc*1e3;if(r>Iu()){$(".quiz-question-answer").hide(),$("#top-bar-next-question").hide(),y6(function(){if(r>Iu()){var i=Math.ceil((r-Iu())/1e3),a;if(i>60){var s=Math.floor(i/60),o=i%60;a=s+":"+("0"+o).slice(-2)}else a=i;var c=$(".js-preview-countdown .timer");c.text(a),c.addClass("fade-out"),setTimeout(function(){c.removeClass("fade-out")},500)}else $(".quiz-question-answer").show(),$("#top-bar-next-question").show(),$(".js-preview-countdown").hide(),vC(),Ll()},r),$(".js-preview-countdown").show();var n=$(".js-preview-countdown .bee");s6(n,window.pageSpecific.previewDelay),n.removeClass("hidden")}else vC(),Ll()}else vC()}})}function XTe(){$(".quiz-question-answer").on("click",function(){$(".quiz-question-answers").addClass("hidden"),$(".answered-spinner").removeClass("hidden");var t=wc*1e3;Nf=!0,Fi.send({method:"finalize_quiz_game_answer",app:"quiz",data:{question_id:Po,attempt_id:window.pageSpecific.assignmentAttemptID,answer_idx:$(this).data("answer-idx"),time_taken:(Iu()-t)/1e3,section_id:window.pageSpecific.sectionID,student_assignment_id:window.pageSpecific.studentAssignmentID,assignment_id:window.pageSpecific.assignmentID},success:function(e){$("#points").text(e.total_score),e.points_earned&&($("#points-added").text("+"+e.points_earned+" points"),$("#correct-answer").removeClass("hidden"),$("#incorrect-answer").addClass("hidden"))}})}).on("keydown",function(t){(t.code==="Enter"||t.code==="Space")&&(t.preventDefault(),$(this).trigger("click"))})}function vC(){var t=$(".prism-highlight.code-select").find(".line-numbers");t.each(function(){var e=$(this).closest(".prism-highlight"),r=e.data("blockRanges"),n=[];Array.isArray(r)&&r.length&&(n=r.map(function(i){var a=i.trim().split("-");return a.length===2?{start:parseInt(a[0]),end:parseInt(a[1])}:{start:parseInt(a[0]),end:parseInt(a[0])}})),Xb(e,n,"button"),e.find(".code-block").each(function(i,a){$(a).addClass("block-color-"+(i%4+1))}),$(".code-block").on("click",function(){$(".quiz-question-answer").eq($(this).data("blockIndex")).trigger("click")}).on("keydown",function(i){(i.code==="Enter"||i.code==="Space")&&(i.preventDefault(),$(".quiz-question-answer").eq($(this).data("blockIndex")).trigger("click"))})})}function YTe(){Nf=!1,$(".start-quiz-game-btn").on("click",function(){$("#start-game").trigger("click")}),$("#start-game").on("click",function(){var t=$(this).data("show-leaderboard"),e=$(this).data("quiz-completed");if(t){JTe(),e&&($("#quiz-completed").removeClass("hidden"),$("#start-game").addClass("hidden"),$("#top-bar-next-question").addClass("hidden"),$("#demo-completed").removeClass("hidden"));return}Po=$(this).data("question-id"),$(".quiz-teacher-controls").addClass("hidden"),$(".quiz-game-waiting-room").addClass("hidden"),$(".quiz-header").removeClass("hidden"),wc=Date.now()/1e3+window.pageSpecific.previewDelay,ds=window.pageSpecific.timeLimit,window.pageSpecific.previewDelay<=0&&Ll(),b6()}),$("#add-time").on("click",function(){$(this).trigger("blur"),v6()}),$("#top-bar-next-question").on("click",function(){$(this).trigger("blur"),ls?(ds=0,Ll()):$("#start-game").trigger("click")})}function JTe(){var t,e;$("#leaderboard").find(".quiz-game-leaderboard-entry").each(function(){e=$(this).find(".leaderboard-score"),t=parseInt(e.text()),t+=Math.floor(Math.random()*1e3),e.text(t)});var r=$("#leaderboard").find(".quiz-game-leaderboard-entry");r.sort(function(n,i){var a=parseInt($(n).find(".leaderboard-score").text()),s=parseInt($(i).find(".leaderboard-score").text());return s-a}),r.each(function(n){var i=$(this).find(".fa-trophy");if(n<3){i.remove();var a=$('<i class="fas fa-trophy spacing-right trophy-'+(n+1)+'"></i>');$(this).find(".leaderboard-score").before(a)}else i.remove()}),$("#leaderboard").find(".quiz-game-leaderboard").append(r),$("#leaderboard").fadeIn(),$("#start-game").data("show-leaderboard",!1),$("#quiz-question-div").addClass("hidden")}function QTe(){$(".control-button").on("click",function(){var e=$(".quiz-game-question.active").removeClass("active");$(this).hasClass("prev")?e=e.prev(".quiz-game-question"):$(this).hasClass("next")&&(e=e.next(".quiz-game-question")),e.addClass("active"),$(".current-question-number").text($(".quiz-game-question").index(e)+1),e.prev(".quiz-game-question").length===0?$(".control-button.prev").prop("disabled",!0):$(".control-button.prev").prop("disabled",!1),e.next(".quiz-game-question").length===0?$(".control-button.next").prop("disabled",!0):$(".control-button.next").prop("disabled",!1)});var t=$(".prism-highlight.code-select").find(".line-numbers");t.each(function(){var e=$(this).closest(".prism-highlight"),r=e.data("blockRanges"),n=[],i=e.data("correctAnswer");Array.isArray(r)&&r.length&&(n=r.map(function(a){var s=a.trim().split("-");return s.length===2?{start:parseInt(s[0]),end:parseInt(s[1])}:{start:parseInt(s[0]),end:parseInt(s[0])}})),Xb(e,n,"highlight"),e.find(".code-block").each(function(a,s){$(s).addClass("block-color-"+(a%4+1)),a==i&&$(s).addClass("chs-icon-check correct-answer")}),e.find("code").addClass("annotate-with-icon")})}pi.on("quiz:setup",FTe);pi.on("quiz:attemptSetup",CTe);pi.on("quiz:qotdSetup",ATe);pi.on("quiz:qotdLoggedOutAttemptSetup",kTe);pi.on("quiz:mockAttemptSetup",ITe);pi.on("quiz:waitingRoomSetup",MTe);pi.on("quiz:setupQuizSidebar",NTe);pi.on("quiz:setupStudentRetake",LTe);pi.on("quiz:setupQuizGame",BTe);pi.on("quiz:setupDemoQuizGame",YTe);pi.on("quiz:quizGameLeaderboard",EC);pi.on("quiz:setupQuizGamePreviewSidepeek",QTe);function LC(){return yC}function NC(){return l6}function MC(){return d6}function _6(){return jb}function s6(t,e){e=e||1;var r=Date.now(),n=100,i=3,a=15,s=.06;function o(){var c=(Date.now()-r)/1e3,l=c/e*Math.PI*2%(Math.PI*2),f=(c/e+s)*Math.PI*2%(Math.PI*2),g=n+Math.sin(l*i)*a,m=Math.sin(l)*g,y=-Math.cos(l)*g,A=n+Math.sin(f*i)*a,k=Math.sin(f*i)*i*a,I=Math.cos(f)*A+Math.sin(f)*k,F=Math.sin(f)*A-Math.cos(f)*k,J=Math.atan2(F,I)+Math.PI/2;t.css({transform:"translate3d("+m+"px, "+y+"px, 0) rotate("+J+"rad)"}),requestAnimationFrame(o)}o()}function ZTe(t){var e=50,r=50,n=(Math.random()-.5)*.3,i=(Math.random()-.5)*.3,a=90;function s(){e+=n,r+=i,n+=(Math.random()-.5)*.04,i+=(Math.random()-.5)*.04,n=Math.max(Math.min(n,.4),-.4),i=Math.max(Math.min(i,.4),-.4),(e<=5||e>=95)&&(n*=-.9,e=Math.max(5,Math.min(e,95))),(r<=10||r>=90)&&(i*=-.9,r=Math.max(10,Math.min(r,90)));var o=Math.atan2(i,n)*(180/Math.PI)+90,c=o-a;c>180&&(c-=360),c<-180&&(c+=360),a+=c*.05,t.css({left:e+"%",top:r+"%",transform:"rotate("+a+"deg)"}),requestAnimationFrame(s)}requestAnimationFrame(s)}function eSe(t){for(var e=50,r=["#8cc63e","#27a9e1","#fbaf3f","#ffdd17","#ff99c6"],n=window.pageXOffset||document.documentElement.scrollLeft,i=window.pageYOffset||document.documentElement.scrollTop,a=0;a<e;a++){var s=document.createElement("div");s.className="confetti";var o=Math.random()*10+5;s.style.width=o+"px",s.style.height=Math.random()*5+3+"px",s.style.backgroundColor=r[Math.floor(Math.random()*r.length)];var c=60,l=Math.random()*c-c/2;s.style.left=t.left+n+t.width*.5+l+"px",s.style.top=t.top+i-10-Math.random()*20+"px",s.style.transform="rotate("+Math.random()*360+"deg)";var f=Math.random()*2+1.5;s.style.animationDuration=f+"s";var g=Math.floor(Math.random()*3);s.classList.add("confetti-swing-"+g),s.style.opacity=Math.random()*.3+.7,document.body.appendChild(s),setTimeout(function(m){return function(){m.parentNode&&m.parentNode.removeChild(m)}}(s),f*1e3)}}w6.exports={setup:f6,preview:xTe,getItemId:LC,getModuleId:NC,getCourseId:MC,answeredQuestion:AC}});var E6=D((HDe,S6)=>{"use strict";var tSe=Ni().removeComments,rSe=Nc();function Tc(t,e){this.editor=t,this.code=e.code||""}Tc.prototype.checkForLoopFormat=function(t,e){var r=this,n=/for\s*\((.*)\)/gi,i=/\s*int\s+.*/g,a=t.match(n),s;if(a){var o=a[0];if(!o.match(i))return s="For loop requires `int` at the start of the initialization field",r.createError(s,e),!0}return!1};Tc.prototype.checkFunctionDeclare=function(t,e){var r=this,n=/function (.*?\(.*?\))/,i=t.match(n),a;return i?(a="Don't declare your method with `function`. Use `private void` instead.",r.createError(a,e),!0):!1};Tc.prototype.checkFunctionReturnType=function(t,e){var r=this,n=/(private|public|protected) *?(\w*?) *?\w*?\(.*?\)/,i=t.match(n);if(i&&i[2]===""){var a="You for got the return type, usually it's `void`such as `public void myFunction()`.";return r.createError(a,e),!0}return!1};Tc.prototype.checkVarDeclare=function(t,e){var r=this,n=/(\s*?var\s+?\w*?(|=\s*?.*?)|for\s*?\(\s*?var\s*?)/,i=t.match(n);if(i){var a="Don't declare your variable with `var`. Use a primitive like `int` instead.";return r.createError(a,e),!0}return!1};Tc.prototype.checkClassExtend=function(t){var e=this,r=!1,n=/.*?public class .*?\{/g,i=/extends ((|Super|Ultra)Karel)/,a=/extends (Super|Ultra)Karel/,s=/\s*?turn(Around|Right)\(\)/,o=/void\s*?turn(Around|Right)\(\)/,c=t.match(n);if(c)for(var l=0;l<c.length;l++){var f=c[l],g;if(f.match(i)||(g="You need extend you class with `Karel`, e.g. `extends Karel`",e.createError(g,l),r=!0),!f.match(a)){var m=t.match(s),y=t.match(o);m&&!y&&(g="You need to extend `SuperKarel` to use `turnRight` and `turnAround`",e.createError(g,l))}}return r};Tc.prototype.createError=function(t,e){e=e+1,rSe.show({editor:this.editor,message:t,lineNumber:e,progtype:"java-karel",langType:"java",errorDisplay:"errorList",log:!1})};Tc.prototype.hasErrors=function(){var t=this,e=!1,r=tSe(this.code);t.checkClassExtend(r)&&(e=!0),r=r.split(`
`);for(var n=0;n<r.length;n++){var i=r[n],a=n;(t.checkForLoopFormat(i,a)||t.checkFunctionDeclare(i,a)||t.checkVarDeclare(i,a)||t.checkFunctionReturnType(i,a))&&(e=!0)}return e};S6.exports=Tc});var C6=D((GDe,x6)=>{var iSe=ui().fileHasImageExtension;function Ou(t){var e=this;e.editor=t;var r={apiKey:"AIzaSyDZ7uKqDiym4LLCffAITm-IcYpQie3i3Ew",authDomain:"chs-collab.firebase.com",databaseURL:"https://collaborate-fcd82.firebaseio.com/"};window.firebase=firebase;var n=firebase.apps.filter(function(a){return a.name.startsWith("karel-collaborate")});if(n.length)e.firebaseInstance=n[0];else{var i="karel-collaborate-"+(window.pageSpecific.itemID||0)+Math.floor(Math.random()*1e5).toString();e.firebaseInstance=window.firebase.initializeApp(r,i)}e.initialized=!1}Ou.prototype.getRef=function(t){var e=window.firebase.database(this.firebaseInstance).ref();return t?e=e.child(t):e=e.push(),e};Ou.prototype.initialize=function(t,e){var r=this;r.firepadRef=r.getRef(e),r.fileRef=r.firepadRef.child("files"),r.ace=t;var n=window.userData.id,i=window.pageSpecific.codeUserID.toString(),a=t.editor.getValue();t.editor.setValue(""),r.firepad=Firepad.fromACE(r.firepadRef,t.editor,{userId:n,defaultText:""}),this.firepadRef.child("history").once("value",function(s){s.val()===null&&(t.editor.setValue(a,1),t.editor.session.getUndoManager().reset())}),n!==i&&t.editor.on("change",function(s){var o=s.lines.join(`
`),c=o===r.prevContents&&s.action==="remove";c||(r.editor.code[r.activeFilename]=t.editor.getValue(),r.activeFilename&&iSe(r.activeFilename)&&$("#image-asset img").attr("src",t.editor.getValue())),r.prevContents=t.editor.getValue()}),e&&n===i?r.fileRef.once("value",function(s){var o=s.val();if(o){var c=o.filter(function(l){return l.active})[0];r.editor.activeFile=c.name,r.editor.editorColumns.activateFileFirepad(c.name)}r.initialized=!0,r.showUserList(),r.setupFiles()}):(r.initialized=!0,r.showUserList(),r.setupFiles()),this.setupCursorObserver(),$(".powered-by-firepad").remove()};Ou.prototype.isLeader=function(){return window.pageSpecific.codeUserID==window.userData.id};Ou.prototype.setupFiles=function(){var t=this;t.isLeader()?t.updateFiles():t.fileRef.on("value",function(e){var r=e.val();if(r){for(var n=r.filter(function(o){return o.active})[0],i={},a=0;a<r.length;a++){var s=r[a];i[s.name]=s.active,s.active&&(t.activeFilename=s.name)}t.editor.editorColumns.createFileList(i),t.editor.editorColumns.activateFileFirepad(n.name)}})};Ou.prototype.updateFiles=function(){var t=this,e=t.editor.code,r=[];Object.keys(e).forEach(function(n){var i=n.endsWith("/.")?n.slice(0,-1):n;r.push({name:i,active:n===t.editor.activeFile})}),t.fileRef.set(r)};Ou.prototype.showUserList=function(){this.avatars||(this.avatars=nSe.fromDiv(this.firepadRef.child("users"),document.getElementById("firepad-avatar-container"),window.userData.id,window.userData.firstName))};Ou.prototype.setupCursorObserver=function(){var t=this,e="other-client-cursor-";function r(a){a.forEach(function(s){var o=s.target;o.classList.forEach(function(c){if(c.startsWith(e)){var l=c.replace(e,"#"),f=t.avatars.cursorLabels;Object.values(f).forEach(function(g){g.userData.color===l&&g.update(o)})}})})}var n=$(".ace_layer.ace_marker-layer")[0],i={attributes:!0,subtree:!0};t.cursorObserver=new MutationObserver(r),t.cursorObserver.observe(n,i)};Ou.prototype.dispose=function(){this.initialized=!1,this.avatars.dispose(),this.avatars=null,this.firepad.dispose(),$("#firepad-avatar-container").html("")};function yg(t){this.userData=t,this.fadeTimeout=null,this.element=$('<div class="cursor-label">'+t.name+"</div>"),this.element.css("background-color",t.color);var e=this.userData.color.replace("#","");this.cursorSelector=".other-client-cursor-"+e;var r=$(".ace_layer.ace_marker-layer");this.backMarkerLayer=r[0],this.frontMarkerLayer=r[1],this.frontMarkerLayer.appendChild(this.element[0]),this.visible=!0,this.hide()}yg.prototype.hide=function(){this.visible&&(this.element.addClass("label-hidden"),this.element.removeClass("label-visible"),this.visible=!1)};yg.prototype.show=function(){var t=this;clearTimeout(this.fadeTimeout),t.fadeTimeout=setTimeout(function(){t.hide()},2e3),t.visible||(t.element.addClass("label-visible"),t.element.removeClass("label-hidden"),t.visible=!0)};yg.prototype.updatePosition=function(t){var e=!1,r=parseInt(t.getPropertyValue("top")),n=parseInt(t.getPropertyValue("height")),i=parseInt(t.getPropertyValue("left"));if(r=isNaN(n)?r:r+n,!isNaN(r)){var a=r.toString()+"px";this.element.css("top")!==a&&(e=!0,this.element.css("top",a))}if(!isNaN(i)){var s=i.toString()+"px";this.element.css("left")!==s&&(e=!0,this.element.css("left",s))}return e};yg.prototype.update=function(t){t?(this.element.parent()[0]!==this.frontMarkerLayer&&this.frontMarkerLayer.appendChild(this.element[0]),this.updatePosition(t.style)&&this.show()):this.hide()};var nSe=function(){function t(l,f,g,m){var y=this;if(!(y instanceof t))return new t(l,f,g,m);y._ref=l,y._userId=g,y._collaboratorIds=new Set,y._place=f,y._displayName=m,y._firebaseCallbacks=[],y._firebaseOn(l.root.child(".info/connected"),"value",function(A){if(A.val()===!0&&y._displayName){var k=l.child(y._userId);k.onDisconnect().remove(),g===window.pageSpecific.codeUserID.toString()&&l.parent.onDisconnect().remove(),k.child("name").set(y._displayName)}}),y._avatars=y._makeAvatarList(),f.appendChild(y._avatars)}t.fromDiv=t,t.prototype.dispose=function(){this._removeFirebaseCallbacks(),this._ref.child(this._userId).remove(),this._place.removeChild(this._avatars)},t.prototype._makeAvatarList=function(){var l=this,f=r("div",[],{class:"firepad-avatar-list"}),g={};l.cursorLabels={};var m=[],y=null,A=null,k="https://static1.codehs.com/img/logo.png";l._userId!=window.pageSpecific.codeUserID&&I(!0);function I(H){var j=$("#collab-banner");H?j.removeClass("gone"):j.addClass("gone")}function F(H,j){var X=H.key;if(!isNaN(X)){var V=H.child("color").val();e(V)||(V="#ffb");var ie=H.child("name").val()||"Guest",fe=r("img",null,{class:"firepad-avatar",src:H.child("avatarURL").val()||k,style:"border-color: "+V+";",title:ie});if($(fe).data("toggle","tooltip"),$(fe).data("placement","bottom"),$(fe).tooltip(),g[X]=fe,X!=l._userId){var Re={id:X,color:V,name:ie};l.cursorLabels[X]=new yg(Re)}if(window.userData&&window.userData.id.toString()===X&&window.userData.avatarURL){var ye=window.userData.avatarURL;fe.src=ye,l._ref.child(X).child("avatarURL").set(ye)}if(X!==l._userId&&l._collaboratorIds.add(X),Object.keys(g).length>5)if(m.length===0){var ze=f.lastChild;ze.remove(),m.push(ze),m.push(fe),y=r("span","+"+m.length,{class:"firepad-avatar",src:H.child("avatarURL").val()||k,title:m.length+" more",style:"display: inline-flex; align-items: center; justify-content: center; color: #878787;"}),y.onclick=pe,$(y).data("toggle","tooltip"),$(y).data("placement","bottom"),$(y).tooltip(),f.append(y)}else m.push(fe),y.innerHTML="+"+m.length,y.dataset.originalTitle=m.length+" more",$(y).tooltip();else f.append(fe);X==window.pageSpecific.codeUserID&&I(!1)}}function J(){A&&(A.remove(),$(y).data("toggle","tooltip"))}function pe(H){A=r("div",[r("div",null,{class:"arrow"}),m.map(function(j){return r("span",[j,r("span",j.attributes["data-original-title"].value,{})],{class:"firepad-overflow-entry"})})].flat(),{class:"firepad-overflow-list"}),document.addEventListener("click",function(j){J()},{once:!0}),$(y).data("toggle",null),f.append(A),H.stopPropagation(),H.preventDefault()}function L(H,j){var X=H.key,V=g[X],ie=H.child("color").val(),fe=H.child("name").val()||"Guest";e(ie)||(ie="#ffb"),V&&(V.src=H.child("avatarURL").val(),V.style="border-color: "+ie+";",$(V).tooltip("destroy"),V.title=fe,$(V).tooltip())}return l._firebaseOn(l._ref,"child_added",F),l._firebaseOn(l._ref,"child_changed",L),l._firebaseOn(l._ref,"child_moved",L),l._firebaseOn(l._ref,"child_removed",function(H){var j=H.key,X=g[j];if(X){if(delete g[j],l._collaboratorIds.delete(j),$.contains(f,X))try{f.removeChild(X)}catch{console.log("Error removing user from userlist")}else m.indexOf(X)>-1&&(m=m.filter(function(V){return V!==X}),y.innerHTML="+"+m.length,y.dataset.originalTitle=m.length+" more",$(y).tooltip());Object.entries(g).length===5&&(y.remove(),m.forEach(function(V){f.append(V)}),m=[],J())}j==window.pageSpecific.codeUserID&&I(!0)}),f},t.prototype._firebaseOn=function(l,f,g,m){return this._firebaseCallbacks.push({ref:l,eventType:f,callback:g,context:m}),l.on(f,g,m),g},t.prototype._firebaseOff=function(l,f,g,m){l.off(f,g,m);for(var y=0;y<this._firebaseCallbacks.length;y++){var A=this._firebaseCallbacks[y];if(A.ref===l&&A.eventType===f&&A.callback===g&&A.context===m){this._firebaseCallbacks.splice(y,1);break}}},t.prototype._removeFirebaseCallbacks=function(){for(var l=0;l<this._firebaseCallbacks.length;l++){var f=this._firebaseCallbacks[l];f.ref.off(f.eventType,f.callback,f.context)}this._firebaseCallbacks=[]},t.prototype.getCollaboratorIds=function(){return Array.from(this._collaboratorIds).join(",")};function e(l){return typeof l=="string"&&(l.match(/^#[a-fA-F0-9]{3,6}$/)||l=="transparent")}function r(l,f,g){var m=document.createElement(l);if(typeof f=="string")n(m,f);else if(f)for(var y=0;y<f.length;++y)m.appendChild(f[y]);for(var A in g||{})g.hasOwnProperty(A)&&m.setAttribute(A,g[A]);return m}function n(l,f){l.innerHTML="",l.appendChild(document.createTextNode(f))}function i(l,f,g){l.addEventListener?l.addEventListener(f,g,!1):l.attachEvent&&l.attachEvent("on"+f,g)}function a(l,f,g){l.removeEventListener?l.removeEventListener(f,g,!1):l.detachEvent&&l.detachEvent("on"+f,g)}function s(l){l.preventDefault?l.preventDefault():l.returnValue=!1}function o(l){l.stopPropagation?l.stopPropagation():l.cancelBubble=!0}function c(l){s(l),o(l)}return t}();x6.exports=Ou});var O6=D(()=>{"use strict";var A6=Cr(),$C,UC,FC,I6=function(){$C=$.Deferred(),UC=$.Deferred(),FC=$.Deferred(),$.when($C,UC,FC).done(function(t,e,r){var n=(r-e)/1e3;k6({method:"PATCH",data:{was_successful:!0,running_time:n,id:t}})})};I6();var k6=function(t){_.defaults(t,{method:"GET",data:{},success:function(){}});var e=t.data.id?t.data.id+"/":"";$.ajax({url:"/api/programrun/"+e,method:t.method,data:JSON.stringify(t.data),success:t.success,contentType:"application/json; charset=utf-8"})};A6.on("ProgramRun:create",function(t){I6(),UC.resolve(t.startTime),k6({method:"POST",data:{item:t.itemId,user:t.userId,hub_server:t.usesHub},success:function(e){$C.resolve(e.id)}})});A6.on("ProgramRun:successful",function(t){FC.resolve(t)})});var L6=D(()=>{"use strict";var aSe=Cr(),Qb=Nc(),sSe=ui(),bg={LINTER:"linter",EVAL:"eval",SKULPT:"skulpt",INFINITE_LOOP:"infinite_loop",REACT_NATIVE:"react_native"};function oSe(t,e){switch(e){case bg.LINTER:break;case bg.EVAL:t.name==="InfiniteLoop"?P6(t):lSe(t);break;case bg.SKULPT:cSe(t);break;case bg.INFINITE_LOOP:P6(t);break;case bg.REACT_NATIVE:uSe(t);break}}function uSe(t){Qb.show({editor:window.Ed,message:t.message,lineNumber:t.lineNumber?t.lineNumber:-1,progtype:window.Ed.getProgramType(),editorError:!0,log:!1}),$(".stack").html(t.stack),$(".stack").show()}function cSe(t){t.preprocess||(t.traceback[0].lineno=R6(t.traceback[0].lineno)),Qb.show({editor:window.Ed,message:t.toString(),lineNumber:t.traceback.length?t.traceback[0].lineno:-1,progtype:window.Ed.getProgramType(),editorError:!0,log:!1})}function P6(t){sSe.alert({header:"Proceed with caution!",message:"There might be infinite loop on line "+t.lineNumber+` in your code.
Running this program may cause the browser to crash.`,cancel_callback:function(){window.Ed.externalRun({overrideInfiniteLoops:!0})},cancelButton:!0,buttonClass:"btn-main-green",exitButton:!1,button:"Exit Program Safely",enterToClose:!1,cancelButtonText:"Run anyway",cancelButtonClass:"btn-main-red"}),Qb.show({editor:window.Ed,message:t.message,lineNumber:t.lineNumber,progtype:window.Ed.getProgramType(),editorError:!0,log:!1})}function lSe(t){var e,r,n=-1,i="";t.line?n=t.line:t.lineNumber?n=t.lineNumber:(e=window.printStackTrace({e:t}),r=e.join(`
`),n=fSe(r)),n=R6(n),i=dSe(t),Qb.show({editor:window.Ed,message:i,lineNumber:n>0?n:-1,progtype:window.Ed.getProgramType(),editorError:!0,log:!1})}function R6(t){return t-D6()}function D6(){var t=64,e=6,r=15,n=214,i=7,a=58,s=100,o=82,c=25,l=window.pageSpecific.helper_code?window.pageSpecific.helper_code:"",f=l.split(`
`).length;l===""&&(f=0);var g=186+f,m=0;return window.Ed.typeTester.isKarel()&&(m+=t,window.Ed.typeTester.isSuperKarel()?m+=e:window.Ed.typeTester.isUltraKarel()&&(m+=r),window.Ed.typeTester.isPython()&&(m+=n,window.Ed.typeTester.isSuperKarel()&&(m+=i),window.Ed.typeTester.isUltraKarel()&&(m+=a))),window.Ed.typeTester.isGraphics()&&(m+=s),window.Ed.typeTester.isPixel()&&(m+=o),window.Ed.typeTester.isTurtle()&&(m+=g),window.Ed.typeTester.isConsole()&&(m+=c),m}function dSe(t){return"Uncaught "+t.name+": "+t.message}function fSe(t){var e=-1;return t.replace(/<anonymous>:(.*):/gm,function(r,n,i,a){e==-1&&(e=parseInt(n),e<D6()&&(e=-1))}),e}aSe.on("editorError:handle",function(t,e){oSe(t,e)})});var $6=D((XDe,M6)=>{"use strict";var pSe=_i(),N6=".favorite-program-star";function hSe(){$(N6).exists()&&$(N6).on("click",function(){var t=$(this),e=$(this).attr("data-userprogram");pSe.send({method:"toggle_favorite",app:"editor",data:{program:e},success:function(r){r.fav?t.addClass("selected"):t.removeClass("selected")}})})}M6.exports={setup:hSe}});var q6=D((YDe,B6)=>{"use strict";var Sc=Nr(),gSe=Jl(),mSe="#FFFF00";function _n(t,e){this.chsEditor=t,this.highlightedLines=[],this.init()}function U6(t){return new RegExp("^(https?://)?([a-z\\d-]+\\.)+[a-z]{2,6}/?[-a-z\\d/%_.~+=&]*\\??[-a-z\\d%_.~+=&]*$","i").test(t)}function F6(t){return t.type==="paste"&&t.clipboardData.getData("text")===window.localStorage.getItem("codehsCopy")}_n.prototype.init=function(){var t=this,e;function r(){return e?e.session.getTextRange(e.selection.getRange()):""}if(t.chsEditor.preventCopyPaste?["copy","paste","cut"].forEach(function(y){document.querySelector("#codehs-editor").addEventListener(y,function(A){var k=A.clipboardData.getData("text"),I=window.pageSpecific.allowPastingUrls&&U6(k),F=window.pageSpecific.allowCopyPasteCodeHSOnly&&F6(A),J=window.pageSpecific.allowCopyPasteCodeHSOnly&&(A.type=="copy"||A.type=="cut");if(!I&&!F&&!J&&(A.stopPropagation(),A.preventDefault()),J){var pe=r();return window.localStorage.setItem("codehsCopy",pe,e),pe}},!0)}):document.querySelector("#codehs-editor").addEventListener("paste",function(){t.chsEditor.isOwnPage()&&t.chsEditor.save(function(){},"paste")},!1),t.chsEditor.codeEditorType===Sc.EditorType.DROPLET_EDITOR&&Sc.EditorType.DROPLET_CONFIG.hasOwnProperty(t.chsEditor.progType)){var n=t.chsEditor.dropletCustomBlocks;n?e=new window.droplet.Editor($("#codehs-editor")[0],JSON.parse(n)):e=new window.droplet.Editor($("#codehs-editor")[0],Sc.EditorType.DROPLET_CONFIG[t.chsEditor.progType]),e.setEditorState(!0),e.aceEditor.getSession().setTabSize(4),e.aceEditor.getSession().setUseWrapMode(!0),t.editor=e,t.editor.fixingEditorCode=!1,e.on("change",function(){if(t.editor.currentlyUsingBlocks&&!t.editor.currentlyAnimating&&!t.editor.fixingEditorCode){var y=this.getValue(),A=y.replace(/while \(\((.*?)\)\) \{/g,"while ($1) {");A!==y&&(t.editor.fixingEditorCode=!0,this.setValue(A),t.editor.fixingEditorCode=!1)}}),e.on("parseerror",function(){gSe({message:"We cannot switch to Block View because there is a syntax error in your code",header:"Syntax error",button:"OK"})}),$("#droplet-code-toggle").on("click",function(){t.toggleBlocks()}),t.chsEditor.defaultBlocks||t.toggleBlocks();var i,a,s,o,c,l;$(e.wrapperElement).on("touchstart",function(y){y.originalEvent&&(y=y.originalEvent),i=y.touches[0].pageX,a=y.touches[0].pageY,s=i,o=a}).on("touchmove",function(y){y.originalEvent&&(y=y.originalEvent);var A=y.touches[0].pageX,k=y.touches[0].pageY;c=s-A,l=o-k,e.aceEditor.session.setScrollTop(e.aceEditor.session.getScrollTop()+l),e.aceEditor.session.setScrollLeft(e.aceEditor.session.getScrollLeft()+c),s=A,o=k}).on("touchend",function(y){if(y.originalEvent&&(y=y.originalEvent),Math.abs(o-a)<5&&Math.abs(s-i)<5){var A=e.aceEditor.renderer.screenToTextCoordinates(i,a);e.aceEditor.moveCursorToPosition(A)}if(!e.aceEditor.isFocused())e.aceEditor.focus();else return y.preventDefault(),!1})}else{e=window.ace.edit("codehs-editor"),e.setOptions({showFoldWidgets:!window.useAccessibilityMode,showGutter:!window.useAccessibilityMode});var f={name:"blurTextInput",description:"Set focus to the editor content div to allow tabbing through the page",bindKey:"Esc",exec:function(F){F.blur(),F.renderer.content.focus()},readOnly:!0},g=function(F){F.target==this.renderer.content&&F.key==="Enter"&&(F.stopPropagation(),F.preventDefault(),this.focus())};e.textInput.getElement().setAttribute("tabindex",-1),e.renderer.content.setAttribute("tabindex",0),e.renderer.content.setAttribute("aria-label","Editor, press Enter key to start editing, press Escape key to exit"),window.useAccessibilityMode&&e.renderer.content.addEventListener("focus",function(){window.toastr.info("Press Enter key to start editing, press Escape key to exit","",{positionClass:"toast-top-center"})}),e.renderer.content.addEventListener("keyup",g.bind(e)),e.commands.addCommand(f),e.getSession().setUseWorker(!1),t.editor=e;var m=t.getModeString();t.editor.getSession().setMode("ace/mode/"+m),m==="text"&&t.editor.getSession().setUseWrapMode(!0);var i,a,c,l;$(e.container).on("touchstart",function(F){F.originalEvent&&(F=F.originalEvent),i=F.touches[0].pageX,a=F.touches[0].pageY}).on("touchmove",function(F){F.originalEvent&&(F=F.originalEvent);var J=F.touches[0].pageX,pe=F.touches[0].pageY;c=i-J,l=a-pe,e.session.setScrollTop(e.session.getScrollTop()+l),e.session.setScrollLeft(e.session.getScrollLeft()+c),i=J,a=pe}),t.chsEditor.preventCopyPaste&&(e.$toDestroy.filter(function(F){return F.type==="input"}).forEach(function(F){var J=F.elem,pe=F.callback;J.removeEventListener("input",pe,{useCapture:!1}),J.addEventListener("input",function(L){if(L.inputType==="insertFromPaste")return L.stopPropagation(),L.preventDefault(),L.target.value="","";pe(L)},!1)}),e.$toDestroy.filter(function(F){return F.type==="copy"}).forEach(function(F){var J=F.elem,pe=F.callback;J.removeEventListener("copy",pe,{useCapture:!1}),J.addEventListener("copy",function(L){if(window.pageSpecific.allowCopyPasteCodeHSOnly){var H=r();return window.localStorage.setItem("codehsCopy",H,e),pe(L)}else return L.stopPropagation(),L.preventDefault(),!1},!1)}),e.$toDestroy.filter(function(F){return F.type==="paste"}).forEach(function(F){var J=F.elem,pe=F.callback;J.removeEventListener("paste",pe,{useCapture:!1}),J.addEventListener("paste",function(L){var H=L.clipboardData.getData("text"),j=window.pageSpecific.allowCopyPasteCodeHSOnly&&F6(L),X=window.pageSpecific.allowPastingUrls&&U6(H);return!X&&!j?(L.stopPropagation(),L.preventDefault(),""):(pe(L),H)},!1)}),e.$toDestroy.filter(function(F){return F.type==="drop"}).forEach(function(F){var J=F.elem,pe=F.callback;J.removeEventListener("drop",pe,!1)}))}};_n.prototype.toggleBlocks=function(){var t=this;t.editor.toggleBlocks(),!t.editor.currentlyUsingBlocks&&t.editor.currentlyAnimating?$("#droplet-code-toggle").html("Switch to Block View"):t.editor.currentlyUsingBlocks&&t.editor.currentlyAnimating&&$("#droplet-code-toggle").html("Switch to Code View")};_n.prototype.getModeString=function(){return this.chsEditor.typeTester.isHTML()?"html":this.chsEditor.typeTester.isPython()||this.chsEditor.typeTester.isUnitTestPython()||this.chsEditor.typeTester.isPython2()||this.chsEditor.typeTester.isPython3()||this.chsEditor.typeTester.isPythonGraphics()||this.chsEditor.typeTester.isUnitTestPython3()||this.chsEditor.typeTester.isPygame()||this.chsEditor.typeTester.isPythonProcessing()||this.chsEditor.typeTester.isPythonLanguage()?"python":this.chsEditor.typeTester.isJava()?"java":this.chsEditor.typeTester.isScheme()?"scheme":this.chsEditor.typeTester.isBash()?"sh":this.chsEditor.typeTester.isSQL()?"sql":this.chsEditor.typeTester.isElm()?"elm":this.chsEditor.typeTester.isReactNative()?"jsx":this.chsEditor.typeTester.isCpp()?"c_cpp":this.chsEditor.typeTester.isSwift()?"swift":this.chsEditor.typeTester.isJavascript()?"javascript":Sc.ItemTypeConfig.CONFIGS[this.chsEditor.getItemType()].normal_text_editor?"text":"javascript"};_n.prototype.setModeString=function(t){var e=this.getEditor();e.getSession().setMode("ace/mode/"+t)};_n.prototype.getValue=function(){var t=this.getEditor(),e=t.getValue();return e.match(/\n$/)||(e=e+`
`),e};_n.prototype.refreshModeStringNative=function(t){var e=ace.require("ace/ext/modelist");this.getEditor().getSession().setMode(e.getModeForPath(t).mode)};_n.prototype.setValue=function(t){var e=this.getEditor();this.chsEditor.codeEditorType===Sc.EditorType.DROPLET_EDITOR&&this.editor.setValue(t),e.session.setValue(t)};_n.prototype.clearSelection=function(){var t=this.getEditor();t.clearSelection()};_n.prototype.addBreakpoint=function(t){var e=this.getEditor(),r=e.getSession();r.setBreakpoint(t-1," breakpoint")};_n.prototype.removeBreakpoint=function(t){var e=this.getEditor(),r=e.getSession();r.clearBreakpoint(t-1)};_n.prototype.clearBreakpoints=function(t){var e=this.getEditor(),r=e.getSession();r.clearBreakpoints()};_n.prototype.gotoLine=function(t){var e=this.getEditor();e.gotoLine(t)};_n.prototype.highlightLine=function(t,e){if(e===void 0&&(e=!0),e&&this.clearHighlightedLines(),!(t===""||typeof t>"u"||t<=0)){var r=t-1;if(!this.isLineHighlighted(r)){var n=this.getEditor(),i=n.getSession(),a=i.highlightLines(r,r);if(this.chsEditor.codeEditorType===Sc.EditorType.DROPLET_EDITOR){var s={color:mSe};this.editor.markLine(r,s)}var o={lineNumber:r,markerId:a.id};this.highlightedLines.push(o)}}};_n.prototype.isLineHighlighted=function(t){for(var e=0;e<this.highlightedLines.length;e++)return this.highlightedLines[e].lineNumber==t};_n.prototype.clearHighlightedLines=function(){for(;this.highlightedLines.length>0;){var t=this.highlightedLines.shift();this.clearHighlightedLine(t)}};_n.prototype.clearHighlightedLine=function(t){if(t.lineNumber>=0){var e=this.getEditor();e.getSession().removeMarker(t.markerId),this.chsEditor.codeEditorType===Sc.EditorType.DROPLET_EDITOR&&this.editor.unmarkLine(t.lineNumber)}};_n.prototype.resize=function(){this.editor.resize()};_n.prototype.getEditor=function(){return this.chsEditor.codeEditorType===Sc.EditorType.DROPLET_EDITOR?this.editor.aceEditor:this.editor};B6.exports=_n});var z6=D((JDe,V6)=>{"use strict";var vSe=Zf(),ySe=_i(),bSe=em(),_Se=Zl(),H6=".start-ex-button",e0="#directions-modal",j6=".program-demo-canvas",wSe=".demo-run-button",TSe=".demo-stop-button",G6=".dark-screen",SSe=".modal-canvas",Zb;function Ps(t){this.editor=t;try{this.setup()}catch{console.log("editor instructions initialization error")}this.demo_graphics,this.demo_solution}Ps.prototype.usingGraphics=function(){return this.editor.typeTester.isGraphics()&&this.editor.needsPopup()};Ps.prototype.setupLetsGoButton=function(){$(H6).on("click",this.hideInstructions)};Ps.prototype.hideInstructions=function(){var t=this;$("#close-button").removeAttr("tabindex"),$(e0).off("focus.directions.modal").addClass("fly-out").on("animationend",function(){$(this).removeClass("fly-out").hide(),Zb&&(Zb.trigger("focus"),Zb=null),$(document).off("keydown.directions.modal").off("keydown.directions.modal.initial")}),$(G6).fadeOut()};Ps.prototype.setupDemoRunButton=function(){var t=this;$(wSe).on("click",function(){t.usingGraphics()&&t.demo_graphics.fullReset();var e=t.demo_solution;e=e.replace(/&gt;/g,">"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&amp;/g,"&"),e=e.replace(/&nbsp;/g,""),t.usingGraphics()&&t.demo_graphics.runCode(e)})};Ps.prototype.setupDemoStopButton=function(){var t=this;$(TSe).on("click",function(){t.usingGraphics()&&t.demo_graphics.fullReset()})};Ps.prototype.setupReShowPopup=function(){var t=this;$("#show-editor-instructions").on("click",function(e){Zb=$(e.target),t.showInstructions()})};Ps.prototype.showInstructions=function(){$(G6).show(),$(e0).show().addClass("fly-in").on("animationend",function(){$(this).removeClass("fly-in").show()}).trigger("focus"),this.setupKeyboardAccessibility()};Ps.prototype.modalHidden=function(){return $("#directions-modal").css("display")=="none"};Ps.prototype.setupKeyboardAccessibility=function(){var t=this,e=$(e0).find(":tabbable:visible"),r=$(e[e.length-1]),n=$(e[0]);r.on("keydown.directions.modal",function(i){i.key==="Tab"&&!(i.shiftKey|i.ctrlKey|i.metaKey|i.altKey)&&(i.preventDefault(),n.trigger("focus"))}),n.on("keydown.directions.modal",function(i){i.key==="Tab"&&i.shiftKey&&(i.preventDefault(),r.trigger("focus"))}),$(document).on("keydown.directions.modal",function(i){i.key==="Escape"&&(i.preventDefault(),t.hideInstructions())})};Ps.prototype.setup=function(){var t=this;if($(H6).exists()){var e=$(e0).find(":tabbable:visible"),r=$(e[e.length-1]),n=$(e[0]);$(document).on("keydown.directions.modal.initial",function(s){s.key==="Tab"&&s.shiftKey?(s.preventDefault(),r.trigger("focus"),$(document).off("keydown.directions.modal.initial")):s.key==="Tab"&&!(s.shiftKey|s.ctrlKey|s.metaKey|s.altKey)&&(s.preventDefault(),n.trigger("focus"),$(document).off("keydown.directions.modal.initial"))}),t.setupKeyboardAccessibility(),ySe.send({type:"GET",method:"get_solution_code",app:"editor",data:{gulpUrl:CHS.GULP_URL,itemID:t.editor.itemID},success:function(s){if(s.status==="ok"){var o=JSON.parse(s.solutionCodeJson.split("").map(function(c,l){var f=CHS.GULP_URL[l%CHS.GULP_URL.length],g=String.fromCharCode((c.charCodeAt(0)-f.charCodeAt(0))%256);return g}).join(""));t.demo_solution=o}else t.demo_solution=""}}),this.setupLetsGoButton(),this.setupReShowPopup(),this.setupDemoRunButton(),this.setupDemoStopButton(),$(SSe).each(function(){vSe.quickDraw($(this),$(this).attr("data-world"),$(this).attr("data-width"),!0)}),this.usingGraphics()&&$(j6).length&&(this.demo_graphics=new bSe.CodeHSGraphics({canvas:$(j6)}));var i=window.pageSpecific.itemDescription,a=window.pageSpecific.isQuill;_Se.chooseEditor([{qlTarget:"#quill-description",mdTarget:"#markdown-description",content:i}],a),a||($("#markdown-description").find("table").addClass("table"),$(".result > .left-exercise").find("table").addClass("table")),$(".directions a").attr("target","_blank")}};Ps.prototype.setupObjective=function(){var t=yy(),e=t+this.editor.solutionCode["main.py"];if(this.editor.typeTester.isTurtle()&&$("#turtle-objective-world").length){var r=this.editor.resultImage;r?$("#turtle-objective-world").append('<img src="https://static1.codehs.com/img/exercises/end/'+r+'" rel="popover" data-placement="bottom" data-trigger="hover" data-content="This is what the world should look like after your program has run."/>'):this.editor.runner.quickDraw({code:e,target:"turtle-objective-world",oldTarget:"python-canvas",height:200,width:200,animate:!1,canvasCoordinates:[-200,-200,200,200]})}};V6.exports=Ps});var Y6=D((QDe,X6)=>{"use strict";var ESe=Nr(),W6=_i(),K6=ESe.EditorThemes.STRINGS;function BC(t){this.editor=t,this.setup()}BC.prototype.getFontSizeInPx=function(){var t=this.editor.getEditor().getFontSize();if(typeof t=="number")return t;var e=parseInt(t.split("px")[0]);return e};BC.prototype.setup=function(){var t=this,e=this.editor,r=this.editor.getEditor();r.setFontSize(this.editor.fontSize);var n=K6[this.editor.themeID],i="ace/theme/"+n;r.setTheme(i),r.setBehavioursEnabled(this.editor.autocompleteEnabled);var a=r.getFontSize();$("#editor-font-size").html(a),$("#console").length&&(this.editor.consoleFontSize&&(a=this.editor.consoleFontSize+"px",$("#console").css("font-size",a),$(".jqconsole").css("font-size",a)),$("#console-font-size").html($("#console").css("font-size")),$(".console-font-larger").on("click",function(){var s=parseInt($("#console").css("font-size"));s++;var o=s+"px";$("#console").css("font-size",o),$(".jqconsole").css("font-size",o),$("#console-font-size").html(o)}),$(".console-font-smaller").on("click",function(){var s=parseInt($("#console").css("font-size"));s--;var o=s+"px";$("#console").css("font-size",o),$(".jqconsole").css("font-size",o),$("#console-font-size").html(o)})),$("#console-font-size").html(),$(".editor-font-larger").on("click",function(){var s=t.getFontSizeInPx();s++;var o=s+"px";r.setFontSize(o),$("#editor-font-size").html(o)}),$(".editor-font-smaller").on("click",function(){var s=t.getFontSizeInPx();s--;var o=s+"px";r.setFontSize(o),$("#editor-font-size").html(o)}),$("#editor-theme-selector").on("change",function(){var s=$(this).find(":selected"),o=$(s).attr("data-value"),c=K6[o],l="ace/theme/"+c;r.setTheme(l)}),$(".editor-autocomplete-toggle").on("change",function(){$(this).find(".switch-on").length!==0?r.setBehavioursEnabled(!0):r.setBehavioursEnabled(!1)}),$("#karel-celebration-selector").on("change",function(){var s=$(this).find(":selected"),o=$(s).data("value");e.karelCelebration=o}),$("#editor-settings-shared-program-blocks-switch").prop("checked",window.pageSpecific.collaborateBlockedByDroplet),$("#editor-settings-shared-program-blocks-switch").on("change",function(s){var o=$(s.target);o.prop("checked")?W6.send({method:"toggle_shared_program_blocks_on",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID},success:function(c){c.status!=="ok"&&window.toastr.error(c.msg)}}):W6.send({method:"toggle_shared_program_blocks_off",app:"editor",data:{sharedProgramID:window.pageSpecific.sharedProgramID},success:function(c){c.status!=="ok"&&window.toastr.error(c.msg)}})})};X6.exports=BC});var Z6=D((ZDe,Q6)=>{"use strict";var xSe=gC();function J6(t){var e=this;e.LOADED=!1,e.editor=t}J6.prototype.setup=function(){var t=this;t.LOADED||(t.LOADED=xSe(window.pageSpecific.codeUserID,t.LOADED))};Q6.exports=J6});var t5=D((eLe,e5)=>{"use strict";var t0=Nr(),CSe=Cr();function ASe(){NSe()}var qC={"shift+p":PSe,"shift+r":DSe,"shift+f":RSe,"shift+n":LSe,"shift+a":OSe,"shift+h":kSe,"shift+s":ISe};function ISe(){window.Ed.save()}function kSe(t){t.preventDefault(),window.Ed.stop(),CSe.trigger("utils:switchToTab","#help-tab",".right-col-tabs","editor-tab-content"),$("#wmd-input").trigger("focus")}function OSe(){window.Ed.externalRun()}function PSe(){window.Ed.codeReview({info:window.Ed.getInfo(),reviewGrade:t0.GradingStatus.PASSED})}function RSe(){window.Ed.codeReview({info:window.Ed.getInfo(),reviewGrade:t0.GradingStatus.NEEDS_WORK})}function DSe(){window.Ed.codeReview({info:window.Ed.getInfo(),reviewGrade:t0.GradingStatus.NEEDS_WORK})}function LSe(){window.Ed.codeReview({info:window.Ed.getInfo(),reviewGrade:t0.GradingStatus.NEEDS_WORK})}function NSe(){for(var t in qC)$("#dummy").bind("keypress",t,qC[t]),$(document).bind("keypress",t,qC[t]);function e(){$("#dummy").trigger("focus")}for(var r=1;r<20;r++)setTimeout(e,r*100)}e5.exports=ASe});var n5=D((rLe,i5)=>{"use strict";var tLe=Hv(),r5=Ni(),MSe=Lc(),jC=[],$Se=100,USe=2e3;function Ec(t){this.editor=t,this.setUpRealtimeErrors()}Ec.prototype.shouldCheckKarelErrors=function(){return this.editor.typeTester.isJsKarel()&&this.editor.numLines()<=$Se};Ec.prototype.shouldCheckMissingSemicolons=function(){return this.editor.typeTester.isConsole()||this.editor.typeTester.isGraphics()};Ec.prototype.clearErrors=function(){for(var t=this.editor.getEditor().getSession(),e=0;e<jC.length;e++){var r=jC[e],n=r.line,i=r.klass;t.removeGutterDecoration(n-1,i);var a=$(".ace_gutter-cell")[n-1];$(a).popover("destroy")}};Ec.prototype.getTabMessage=function(t){var e=t>0?"back ":"forward ";t=Math.abs(t);var r=t>1?" times.":" time.",n="You should indent this line "+e+t+r;return t===0&&(n="Make sure you use a consistent style with",n+="<code>{</code> and <code>}</code>"),n};Ec.prototype.addGutterNote=function(t){var e=this.editor.getEditor().getSession();jC.push({line:t.lineNumber,klass:t.klass}),e.addGutterDecoration(t.lineNumber-1,t.klass);var r=$(".ace_gutter-cell")[t.lineNumber-1];$(r).popover({placement:"right",container:"body",title:t.title,content:t.content,trigger:"hover",html:!0})};Ec.prototype.checkLineErrors=function(){this.clearErrors();var t=this.editor.getCode(),e;if(this.shouldCheckKarelErrors()){for(var r=r5.testIndentation(t),n=0;n<r.length;n++){e=r[n].line;var i=this.getTabMessage(r[n].tab_difference);this.addGutterNote({lineNumber:e,klass:"warning",title:"Indentation Error",content:i})}for(var a=t.split(`
`),n=0;n<a.length;n++)if(e=`
`+a[n]+`
`,e.indexOf("function")==-1){var s=MSe.testCommandStyle(e);if(!s.isValid){var o="You wrote: <code>"+e+"</code><br/>Should be: <code>"+s.validCommand+"</code>";this.addGutterNote({lineNumber:n+1,klass:"error",title:o,content:s.reason})}}}if(this.shouldCheckMissingSemicolons())for(var c=r5.linesWithoutSemicolons(t),n=0;n<c.length;n++)e=c[n],this.addGutterNote({lineNumber:e,klass:"warning",title:"Missing Semicolon",content:"You need a semicolon at the end of the line."})};Ec.prototype.setUpRealtimeErrors=function(){var t=this,e=this.editor.getCode();this.checkLineErrors(),setInterval(function(){var r=t.editor.getCode();r!=e&&(t.checkLineErrors(),e=r)},USe)};i5.exports=Ec});var l5=D((iLe,c5)=>{"use strict";var a5=Nr(),xc=Cr(),FSe=_i(),BSe=Qg(),s5=Yl(),o5=1e4,$f="#save-button";function u5(t){this.editor=t,this.latestCodeSave=JSON.stringify(this.editor.currentCode)}u5.prototype.saveCode=function(t,e){t=t||function(){},this.editor.getItemType()==a5.ItemType.FREE_RESPONSE&&this.editor.activeFile==".txt"&&(this.editor.activeFile="default.txt"),xc.trigger("utils:disableButton",$f);var r=this.editor.currentCode;this.editor.activeFile&&!this.editor.activeFile.endsWith(".jar")&&(r[this.editor.activeFile]=BSe.trimRight(this.editor.getCode()));var n=JSON.stringify(r);if(n===this.latestCodeSave)return setTimeout(function(){xc.trigger("utils:enableButton",$f)},1e3),t();var i=this.editor.getInfo();if(this.editor.typeTester.isGradingQuiz()||this.editor.typeTester.isGradeAndRespond())return t();if(n.split("\\n",o5).length>=o5){xc.trigger("editorError:handle",{message:`Your file is too large to save. Please shorten and try again.
Think this is a mistake? <a href="mailto:support@codehs.com">Contact us!</a>`,name:"code error"},"eval");return}var a=this,s=a.editor.studentAssignmentID,o=a.editor.firepad&&a.editor.firepad.avatars?a.editor.firepad.avatars.getCollaboratorIds():"";FSe.send({method:"save_editor",app:"editor",data:{info:i,fileJson:n,seconds:a.editor.timeTrackSeconds||0,studentAssignmentID:s,isSandbox:a.editor.getItemType()==a5.ItemType.SANDBOX&&!s,collaboratorIds:o,reason:e},success:function(c){c.status=="ok"?(a.latestCodeSave=n,$($f).html("<span class='chs-icon-check'></span>"),a.editor.timeTrackSeconds=0,a.editor.editorHistory.addListing(n),c.just_started_time&&($("#start-time-text").html(c.just_started_time),$("#started-time").show()),setTimeout(function(){xc.trigger("utils:enableButton",$f)},1e3),t()):(xc.trigger("editorError:handle",{message:c.msg+'Think this is a mistake? <a href="mailto:support@codehs.com">Contact us!</a>',name:"code error"},"eval"),s5.error("There was an error saving your code! Please try again before moving on."),setTimeout(function(){xc.trigger("utils:enableButton",$f)},1e3))},error:function(){xc.trigger("editorError:handle",{message:"There was an error saving your code! Please try again before moving on.",name:"code error"},"eval"),s5.error("There was an error saving your code! Please try again before moving on."),setTimeout(function(){xc.trigger("utils:enableButton",$f)},1e3)}})};c5.exports=u5});var f5=D((nLe,d5)=>{"use strict";var qSe=Cr(),jSe=mz();function HC(t){this.editor=t,this.loadSavedCode()}HC.prototype.loadSavedCode=function(){try{for(var t=JSON.parse(window.localStorage.savedCode),e=t.length-1;e>=0;e--){var r=t[e];if(r.info.itemID==this.editor.getInfo().itemID){this.editor.setCode(r.code);return}}}catch{return}};HC.prototype.saveCode=function(t){t=t||function(){};var e=this.editor.getCode(),r=this.editor.getInfo(),n;try{n=JSON.parse(window.localStorage.savedCode)}catch{n=[]}var i=n[n.length-1];(i==null||e!=i.code||r.itemID!=i.info.itemID)&&(n.push({code:e,info:r,timestamp:jSe().unix()}),window.localStorage.savedCode=JSON.stringify(n)),qSe.trigger("signup:setupLocalStorageData"),t()};d5.exports=HC});var h5=D((aLe,p5)=>{"use strict";var HSe=Zf(),r0=206,_g=".sidebar-canvas",Rs="#edit-solution-world";function GC(t){this.editor=t}GC.prototype.setupCanvas=function(t){if(this.editor.typeTester.isTurtle()){var e=yy(),r=e+this.editor.solutionCode["main.py"];if($("#turtle-result-world").length&&this.editor.isOwnPage()){var n=this.editor.resultImage;n?$("#turtle-result-world").append('<img src="https://static1.codehs.com/img/exercises/end/'+n+'" rel="popover" data-placement="bottom" data-trigger="hover" data-content="This is what the world should look like after your program has run."/>'):this.editor.runner.quickDraw({code:r,target:"turtle-result-world",animate:!1})}}else{if(t===void 0){var i=$("#karelworld").find(":selected").attr("data-world");t=this.editor.runner.loadWorldById(i)}var a=this.editor.worlds.length+this.editor.user_worlds.length,s;if(t==-1||t>=a){this.hideCanvas();return}else if(t<this.editor.worlds.length)s=this.editor.worlds[t];else{var o=t-this.editor.worlds.length;s=this.editor.user_worlds[o]}var c="/karel/worlds/0/";if(!s||s.solution_world===void 0){this.hideCanvas(),c+="duplicate/"+s.id+"?solution_item="+this.editor.itemID,$(Rs).text("Add Solution World"),$(Rs).addClass("add-world"),$(Rs).css("top",(r0-$(Rs).innerHeight())/2+4),$(Rs).attr("href",c),$(Rs).attr("data-original-title","Add a solution for the current world"),$(Rs).show();return}if(s){c+="edit/"+s.solution_id+"?solution_item="+this.editor.itemID,$(Rs).text("Edit Solution World"),$(Rs).removeClass("add-world"),$(Rs).attr("data-original-title","Edit the solution for the current world"),$(Rs).attr("href",c),$(Rs).css("display","inline-block");var l=JSON.stringify(s.solution_world);$(_g).each(function(){$(".hideable-title").css("opacity",1),HSe.quickDraw($(this),l,r0,!0)})}}};GC.prototype.hideCanvas=function(){$(".hideable-title").css("opacity",0),$(_g).css("opacity",0),$(_g).attr("rel",""),$(_g).attr("width",r0),$(_g).attr("height",r0)};p5.exports=GC});var m5=D((sLe,g5)=>{"use strict";var GSe=Cr(),VSe=_i(),zSe="#submit-button",Do="#grading-problem-reason";function VC(t){this.editor=t}VC.prototype.validateData=function(){var t=$(".grading-problem-btn.active"),e=t.find("input").val(),r=$("#grade-and-respond-text").val(),n=this.editor.needsResponse;return $(Do).css("visibility","hidden"),r=r||"",e===void 0||n&&r.trim()===""?(n?$(Do).text("Please supply a grade and response."):$(Do).text("Please grade this submission."),$(Do).addClass("alert-danger").css("visibility","visible"),GSe.trigger("utils:enableButton",zSe),{}):{grade:e,response:r}};VC.prototype.showAnswer=function(t,e){$(Do).css("visibility","hidden"),!this.editor.needsResponse&&VSe.send({method:"save_grade_and_respond",app:"editor",data:{grade:e,response:"",item_id:t},success:function(r){r.status=="ok"&&($(Do).text(r.msg).css("visibility","visible"),$(".grading-problem-btn").addClass("disabled"),r.correct?($(Do).removeClass("alert-danger").addClass("alert-success"),r.msg.trim()===""&&$(Do).text("Correct!")):($(Do).removeClass("alert-success").addClass("alert-danger"),r.msg.trim()===""&&$(Do).text("Sorry, that's incorrect.")))}})};g5.exports=VC});var y5=D((oLe,v5)=>{var WSe=_i(),KSe=".run_code",XSe=".js-embed-identifier";function zC(t){this.editor=t,this.removeViews(),this.setupRunButton()}zC.prototype.removeViews=function(){var t=".editor-id-"+this.editor.editorInstanceId+" #right";$(t+" .nav-tabs").remove(),$(".action :not(.editor-title)").remove(),$("#karelworld optgroup").remove()};zC.prototype.setupRunButton=function(){$(KSe).on("click",function(){WSe.send({method:"update_embed_run_count",app:"editor",data:{identifier:$(XSe).data("embed-identifier")}})})};v5.exports=zC});var w5=D((uLe,_5)=>{"use strict";function b5(t){this.editor=t,this.removeViews()}b5.prototype.removeViews=function(){var t=".editor-id-"+this.editor.editorInstanceId+" #right";$(t+" .nav-tabs").remove(),$("#karelworld").hide(),$(".action").remove()};_5.exports=b5});var x5=D((cLe,E5)=>{"use strict";var YSe=Cr(),JSe="#docs-color-picker-input",QSe="#docs-color-picker-value";function T5(t){this.editor=t,this.setup()}T5.prototype.setup=function(){var t=this;t.editor.typeTester.isHTML()&&S5()};function S5(){var t=$(JSe),e=$(QSe);t.on("input",function(){e.val(t.val())}),t.on("change",function(){e.val(t.val())}),e.on("change",function(){t.val(e.val())})}YSe.on("editor:setupColorPicker",S5);E5.exports=T5});var I5=D((lLe,A5)=>{"use strict";var ZSe="wss://code.codehs.com:443/",eEe="output",tEe="stdin",WC="waiting",C5="processing";function rEe(t,e,r){var n=new WebSocket(ZSe+t),i="",a=WC,s;n.onmessage=function(c){var l=JSON.parse(c.data),f=l.name,g=l.data;f===eEe&&a===C5&&(r(g)?(i+=e(g),s.resolve(i),i="",a=WC):i+=e(g))};function o(c){if(a===WC)return s=$.Deferred(),a=C5,n.send(JSON.stringify({name:tEe,data:c})),s}return{stdin:o}}A5.exports=rEe});var O5=D((dLe,k5)=>{"use strict";var iEe=I5();k5.exports=function(){var t="elm-repl",e=iEe(t,function(r){return r.replace(/(\|\s*)+$/,"").replace(/>\s*$/,"")},function(r){return/>\s*$/.test(r)});return function(r){return e.stdin(r)}}});var R5=D((fLe,P5)=>{"use strict";var KC="__END_OF_OUTPUT__";function nEe(t){var e=new RegExp("\\s*print"),r=new RegExp("\\s*import"),n=new RegExp("def.*|class.*"),i=/^((\s*\(\s*(\s*((\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*)|(\s*\(\s*(\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*,)*\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*\)\s*))\s*,)*\s*((\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*)|(\s*\(\s*(\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*,)*\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*\)\s*))\s*\)\s*)|(\s*\s*(\s*((\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*)|(\s*\(\s*(\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*,)*\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*\)\s*))\s*,)*\s*((\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*)|(\s*\(\s*(\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*,)*\s*((\s*[_a-zA-Z]\w*\s*)|(\s*\(\s*(\s*[_a-zA-Z]\w*\s*,)*\s*[_a-zA-Z]\w*\s*\)\s*))\s*\)\s*))\s*\s*))=/,a=t.split(`
`),s=-1,o=0;return a.length===1&&!i.test(a[0])&&!n.test(a[0])&&!r.test(a[0])&&a[0].length>0&&(e.test(a[0])||(a.push("evaluationresult = "+a.pop()),a.push("if not evaluationresult == None: print repr(evaluationresult)"))),a}function aEe(t){t.push('print("'+KC+'")')}P5.exports=function(){return function(t){var e=$.Deferred(),r="";window.Sk.configure({output:function(i){i.indexOf(KC)!==-1?(i=i.replace(KC,""),r+=i,e.resolve(r),r=""):r+=i},read:function(i){if(window.Sk.builtinFiles===void 0||window.Sk.builtinFiles.files[i]===void 0)throw"File not found: '"+i+"'";return window.Sk.builtinFiles.files[i]},retainglobals:!0});var n=nEe(t);aEe(n);try{!n||/^\s*$/.test(n)?e.resolve(""):window.Sk.importMainWithBody("<stdin>",!1,n.join(`
`))}catch(i){e.resolve(i.toString())}return e}}});var L5=D((pLe,D5)=>{"use strict";D5.exports=function(){return function(t){var e=$.Deferred(),r=eval;try{e.resolve(""+r(t))}catch(n){e.resolve(""+n)}return e}}});var M5=D((hLe,N5)=>{var YC=Nr(),sEe=O5(),oEe=R5(),uEe=L5(),XC=gl();function cEe(t){return t.getProgrammingLanguage()===YC.ProgrammingLanguage.ELM}function lEe(t){return t.getProgrammingLanguage()===YC.ProgrammingLanguage.PYTHON}function dEe(t){return t.getProgrammingLanguage()===YC.ProgrammingLanguage.JAVASCRIPT&&!t.typeTester.isJsKarel()}N5.exports=function(t){var e,r;if(cEe(t))e=sEe(),r=XC({welcomeString:["Welcome to the Elm REPL! Type a \\ character to write","multiline expressions."].join(" "),multlineCb:function(n){return n.trim().search(/\\$/)===-1?!1:0}});else if(lEe(t))e=oEe(),r=XC({welcomeString:["Welcome to the Python REPL! Press Shift+Enter to write","multiline expressions."].join(" ")});else if(dEe(t))e=uEe(),r=XC({welcomeString:["Welcome to the JavaScript REPL! Press Shift+Enter to write","multiline expressions."].join(" ")});else return;(function n(){r.promptForInput(function(i){e(i).then(function(a){r.writeToConsole(a.trim()),n()})})})()}});var $5=D((gLe,fEe)=>{fEe.exports=`<div id="js-bit-interpreter" class="bit-interpreter">

    <div class="controls-wrapper">

        <div class="control-header">Metadata</div>

        <div id="js-editor-controls" class="interpreter-controls codehs-form center">
            <div class="control-wrapper {{#if showInterpretSelect}}{{else}}gone{{/if}}">
                <label for="interpretbits" class="control-elem">Interpret As:</label>
                <select name="interpretbits" id="js-interpret-bits" class="control-elem">

                    {{#if isBW}}
                    <option value="{{SELECT_OPTIONS.INTERPRET.BLACKWHITE}}">B &amp; W</option>
                    {{else}}
                        {{#if isColor}}
                        <option value="{{SELECT_OPTIONS.INTERPRET.BLACKWHITE}}">B &amp; W</option>
                        {{/if}}
                    {{/if}}

                    {{#if isColor}}
                    <option value="{{SELECT_OPTIONS.INTERPRET.COLOR}}">Color</option>
                    {{/if}}

                    {{#if isText}}
                    <option value="{{SELECT_OPTIONS.INTERPRET.ASCII}}">ASCII</option>
                    {{/if}}

                    {{#if isCustom}}
                    <option value="{{SELECT_OPTIONS.INTERPRET.CUSTOM_TEXT}}">Custom</option>
                    {{/if}}
                </select>
            </div>

            <div id="js-display-bits-wrapper" class="control-wrapper {{#if isCustom}}gone{{/if}}">
                <label for="js-display-bits" class="control-elem">Display As:</label>
                <select name="displaybits" id="js-display-bits" class="control-elem">
                    <option value="{{SELECT_OPTIONS.DISPLAY.BINARY}}">Binary</option>
                    <option value="{{SELECT_OPTIONS.DISPLAY.HEXADECIMAL}}">Hexadecimal</option>
                </select>
            </div>

            <div id="js-rows-cols-control">
                <div class="control-wrapper">
                    <label for="numrows" class="control-elem">Rows:</label>
                    <input name="numrows" class="control-elem" id="js-num-rows" type="number" min="1" max="255" value="8">
                </div>
                <div class="control-wrapper">
                    <label for="numcols" class="control-elem">Columns:</label>
                    <input name="numcols" class="control-elem" id="js-num-cols" type="number" min="1" max="255" value="8">
                </div>
            </div>

            <div id="js-encoding-table" class="control-wrapper encoding-table-container"></div>

        </div>

        <div class="format-bits-wrapper">
            <button id="js-format-pretty" class="btn btn-main-silver format-bits-btn">Pretty</button
            ><div style="width:10%; display:inline-block"></div
            ><button id="js-format-raw" class="btn btn-main-slate format-bits-btn">Raw</button>
        </div>
    </div><div id="js-editor-textarea" class="interpreter-textarea"></div>

</div>
`});var U5=D((mLe,pEe)=>{pEe.exports=`<div class="text-center encoding-header">{{title}}:</div>
{{#if isColor}}
<div style="padding-bottom:5px;">
    <input class="js-color-picker-container"></input>
</div>
<div class="encoding-table table-responsive" style="max-height:275px">
<table class="table">
    <col style="width:90px">
    <tr>
        <th><div>Key<div></th>
        <th><div>Value<div></th>
    </tr>
    <tr>
        <td class="js-color-picker-display color-picker-display"></td>
        <td><div class="js-color-picker-color color-picker-color"></div></td>
    </tr>
</table>
</div>
{{else}}
<div class="encoding-table table-responsive" style="max-height:275px">
<table class="table">
    <col style="width:50%">
    <col style="width:50%">
    <tr>
        <th><div>Key<div></th>
        <th><div>Value<div></th>
    </tr>
    {{#each encodings}}
    <tr>
        <td style="font-family: monospace;">{{key}}</td>
        <td>{{value}}</td>
    </tr>
    {{/each}}
</table>
</div>
{{/if}}
`});var F5=D((vLe,hEe)=>{hEe.exports=`<div class="text-center encoding-header">Custom Encoding:</div>
<div class="num-bits-wrapper">
    <div class="num-bits-label">Bits in Encoding: <span class="js-num-bits-num">{{numBits}}</span></div>
    <span class="num-bit-slider-value">1</span>
    <div id="js-num-bits" class="num-bits-slider"></div>
    <span class="num-bit-slider-value">24</span>
</div>
<div class="encoding-table">
<table class="table">
    <col style="width:90px">
    <col>
    <col style="width:20%">
    <tr>
        <th><div>Key<div></th>
        <th><div>Value<div></th>
        <th><div>Edit<div></th>
    </tr>
    {{#each encodingForNumBits}}
    <tr>
        <td style="font-family: monospace;">{{@key}}</td>
        <td>{{this}}</td>
        <td><button data-key="{{@key}}" class="js-remove-encoding btn btn-main-orange encoding-btn"><span class="chs-icon-cancel"></span></button></td>
    </tr>
    {{/each}}
</table>
</div>

<div class="encoding-input-box">
    <div class="input-wrapper">
        <input id="js-encoding-key" placeholder="{{numBits}} Bits" type="text" class="encoding-input" name="encoding-key"></input>
        <input id="js-encoding-value" placeholder="Value" type="text" class="encoding-input" name="encoding-value"></input>
    </div>
    <div class="add-btn-wrapper">
        <button id="js-add-encoding" class="btn btn-main-green encoding-btn"><span class="icon icon-plus"></span></button>
    </div>
</div>
{{#if errorMessages.length}}
<div class="bg-red encoding-error-box">
    {{#each errorMessages}}
    <div>{{this}}</div>
    {{/each}}
</div>
{{/if}}
`});var q5=D((yLe,B5)=>{var gEe=gz(),mEe=Handlebars.compile(F5()),br={encodings:_.range(1,25).reduce(function(t,e){return t[e]={},t},{}),numBits:8,key:"",value:"",errorMessages:[]},wg=new gEe,vEe="#js-add-encoding",yEe=".js-remove-encoding",bEe="#js-encoding-key",_Ee="#js-encoding-value",wEe="#js-num-bits",TEe=".js-num-bits-num";function JC(t){return t.replaceAll("<","&lt;").replaceAll(">","&gt;")}function SEe(t,e,r){var n=[{passed:e.length,message:"Key must have a value."},{passed:t.length===r.numBits,message:"Key must be "+r.numBits+" bits long."},{passed:!/[^10]/.test(t),message:"Key must only include 1's and 0's."},{passed:!r.encodings[r.numBits][t],message:"Key must not already exist."}];return _.chain(n).reject("passed").map("message").value()}var Cc;function EEe(t){return Object.entries(br.encodings[br.numBits]).reduce(function(e,r){var n=r[0],i=r[1];return e[n]=JC(i),e},{})}function Tg(t){var e=$(t);br.encodings=Object.entries(br.encodings).reduce(function(c,l){var f=l[0],g=l[1];return c[f]=EEe(g),c}),br.encodingForNumBits=br.encodings[br.numBits],Cc=$(mEe(br));var r=Cc.find(yEe),n=Cc.find(vEe),i=Cc.find(bEe),a=Cc.find(_Ee),s=Cc.find(wEe),o=Cc.find(TEe);i.val(br.key),a.val(JC(br.value)),s.slider({orientation:"horizontal",range:"min",min:1,max:24,value:br.numBits,change:function(c,l){br.numBits=l.value,br.key=i.val(),br.value=a.val(),br.errorMessages=[],Tg(t),wg.emit("change")},slide:function(c,l){o.text(l.value)}}),n.on("click",function(){var c=i.val(),l=JC(a.val()),f=SEe(c,l,br);f.length?(br.key=c,br.value=l,br.errorMessages=f):(br.key="",br.value="",br.encodings[br.numBits][c]=l,br.errorMessages=f),Tg(t),wg.emit("change")}),r.on("click",function(){var c=$(this);delete br.encodings[br.numBits][c.data("key")],br.key=i.val(),br.value=a.val(),Tg(t),wg.emit("change")}),e.html(Cc)}B5.exports=function(t){return Tg(t),{getEncodings:function(){return br.encodings[br.numBits]},getAllEncodings:function(){return br.encodings},updateEncodings:function(e){_.assign(br.encodings,e)},setEncodings:function(e){br.encodings=e},getNumBits:function(){return br.numBits},setNumBits:function(e){br.numBits=e},change:wg.addListener.bind(wg,"change"),show:function(){Tg(t,br)}}}});var X5=D((_Le,K5)=>{var Sg=Nr(),bLe=Cr(),xEe=Handlebars.compile($5()),QC=Handlebars.compile(U5()),CEe=q5(),AEe="#js-editor-controls",IEe="#js-interpret-bits",kEe="#js-format-pretty",OEe="#js-format-raw",PEe="#js-display-bits-wrapper",REe="#js-display-bits",DEe="#js-rows-cols-control",LEe="#js-num-rows",NEe="#js-num-cols",MEe="#js-encoding-table",$Ee=".js-color-picker-container",j5=".js-color-picker-display",H5=".js-color-picker-color",Eg="metadata.json",G5="_",UEe="CCCCCC",FEe="FFDDDD",Sr={INTERPRET:{BLACKWHITE:"blackwhite",COLOR:"color",ASCII:"ascii",CUSTOM_TEXT:"custom-text"},DISPLAY:{BINARY:"binary",HEXADECIMAL:"hex"},FORMAT:{RAW:"raw",PRETTY:"pretty"}},fs=function(t,e,r){return r=typeof r>"u"?!0:r,r?e.match(new RegExp(".{"+t+"}","g"))||[]:e.match(new RegExp(".{1,"+t+"}","g"))||[]},BEe=function(t,e,r,n,i){return i=i.replace(/\s/g,""),t===Sr.DISPLAY.BINARY?e===Sr.INTERPRET.BLACKWHITE?i=fs(r,i,!1).join(`
`):e===Sr.INTERPRET.COLOR?i=fs(24,i,!1).map(function(a){return fs(8,a,!1).join(`
`)}).join(`

`):e===Sr.INTERPRET.ASCII?i=fs(8,i,!1).join(`
`):e===Sr.INTERPRET.CUSTOM_TEXT&&(i=fs(n,i,!1).join(`
`)):t===Sr.DISPLAY.HEXADECIMAL&&(e===Sr.INTERPRET.BLACKWHITE?i=fs(Math.floor(r/4),i,!1).join(`
`):e===Sr.INTERPRET.COLOR?i=fs(6,i,!1).join(`
`):e===Sr.INTERPRET.ASCII?i=fs(2,i,!1).join(`
`):e===Sr.INTERPRET.CUSTOM_TEXT&&(i=fs(Math.floor(n/4),i,!1).join(`
`))),i},z5=_.range(256).map(function(t){return _.padLeft(VEe(t),8,"0")}).reduce(function(t,e){return t.push({key:e,value:W5(e)}),t},[]).map(function(t){return/[^\x20-\x7E]/.test(t.value)&&/[^\xA1-\xFF]/.test(t.value)&&t.key!=="00001010"||t.key==="10101101"?(t.value="Can't Display",t):t.key==="00100000"?(t.value="space",t):(t.key==="00001010"&&(t.value="newline"),t)}).filter(function(t){return t.value!=="Can't Display"}),qEe=_.map(z5,function(t){var e={};return e.key=ZC(t.key),e.value=t.value,e}),jEe=[{key:"0",value:"black"},{key:"1",value:"white"}],HEe=function(t){return _.map(t,function(e){return e==="1"?"w":"b"})},GEe=_.range(16).map(function(t){return{key:V5(t),value:HEe(xg(V5(t)))}});function ZC(t){return fs(4,t,!1).reduce(function(e,r){return e+parseInt(_.padRight(r,4,"0"),2).toString(16)},"")}function xg(t){return t.split("").reduce(function(e,r){return e+_.padLeft(parseInt(r,16).toString(2),4,"0")},"")}function VEe(t){return t.toString(2)}function V5(t){return t.toString(16)}function W5(t){return String.fromCharCode(parseInt(t,2))}function zEe(t){return t==="<"?"&lt;":t===">"?"&gt;":t}function WEe(t,e,r,n){var i=Math.min(t/e,t/r),a=Math.abs(e-r);return{fill:n.fill,x:n.x+(e>r?a*i/2:0),y:n.y+(e<r?a*i/2:0),width:n.width,height:n.width}}function KEe(t,e,r,n){var i=Math.min(t/e,t/r),a=i/50;return{fill:n.fill,x:n.x+a,y:n.y+a,width:n.width-a*2,height:n.width-a*2}}function XEe(t,e,r,n,i){var a=Math.min(t/e,t/r);return{fill:"#"+n,x:i%r*a,y:Math.floor(i/r)*a,width:a,height:a}}function YEe(t,e){t.fillStyle=e.fill,t.fillRect(e.x,e.y,e.width,e.height)}function JEe(t,e,r,n,i,a,s,o){var c=e===Sr.INTERPRET.COLOR;e===Sr.INTERPRET.COLOR||e===Sr.INTERPRET.BLACKWHITE?(o.clearRect(0,0,o.canvas.width,o.canvas.height),o.fillStyle="#"+UEe,o.fillRect(0,0,o.canvas.width,o.canvas.height),_.chain(t).trunc({length:r*n*(c?24:1),omission:""}).padRight(r*n*(c?24:1),G5).thru(fs.bind(null,c?24:1)).forEach(function(l,f){var g;_.includes(l,G5)?g=FEe:g=c?ZC(l):l==="0"?"000000":"FFFFFF";var m=XEe(i,r,n,g,f);m=KEe(i,r,n,m),m=WEe(i,r,n,m),YEe(o,m)}).value()):e===Sr.INTERPRET.ASCII?_.chain(t).thru(fs.bind(null,8)).reduce(function(l,f){return l+zEe(W5(f))},"").tap(function(l){o.text(l)}).value():e===Sr.INTERPRET.CUSTOM_TEXT&&_.chain(t).thru(fs.bind(null,s)).reduce(function(l,f){var g='<span class="chs-icon-bug text-red" data-toggle="tooltip" title="No encoding for '+f+'"></span>';return l+(a[f]?a[f]:g)},"").tap(function(l){var f=$("<div>"+l+"</div>");f.find('[data-toggle="tooltip"]').tooltip(),o.html(f)}).value()}K5.exports=function(t,e,r,n){var i=Sg.ProgramType.BIT_INTERPRETER_ALL===e,a=Sg.ProgramType.BIT_INTERPRETER_BW===e||i,s=Sg.ProgramType.BIT_INTERPRETER_COLOR===e||i,o=Sg.ProgramType.BIT_INTERPRETER_TEXT===e||i,c=Sg.ProgramType.BIT_INTERPRETER_TEXT_CUSTOM===e;r.aceEditor.getEditor().getSession().setUseWrapMode(!0);var l=$(xEe({isBW:a,isColor:s,isText:o,isCustom:c,showInterpretSelect:i||s,SELECT_OPTIONS:Sr})),f=$('<canvas style="display: block;margin: auto;border: 1px solid #CCCCCC;"></canvas>'),g=$('<pre style="display: block;margin: auto;border: 1px solid #CCCCCC;font-size:14px;word-wrap: normal;word-break: normal;"></pre>'),m=$(n),y=l.find(AEe),A=l.find(OEe),k=l.find(kEe),I=y.find(IEe),F=y.find(PEe),J=y.find(REe),pe=y.find(DEe),L=y.find(LEe),H=y.find(NEe),j=y.find(MEe),X=CEe(j);f.attr({height:t,width:t}),g.css({height:t,width:t});function V(){var Q=Sr.DISPLAY.HEXADECIMAL===J.val(),Fe=Sr.INTERPRET.COLOR===I.val()||Sr.INTERPRET.BLACKWHITE===I.val(),We=r.aceEditor.getValue().replace(/\s/g,"");JEe(Q?xg(We):We,I.val(),parseInt(L.val(),10),parseInt(H.val(),10),t,X.getEncodings(),X.getNumBits(),Fe?f.get(0).getContext("2d"):g)}function ie(){var Q=I.val(),Fe=J.val();j.html(""),Q===Sr.INTERPRET.CUSTOM_TEXT?X.show():Q===Sr.INTERPRET.ASCII?(j.html(QC({encodings:Fe===Sr.DISPLAY.BINARY?z5:qEe,title:"ASCII Encoding"})),$(".encoding-table").scrollTop(2500)):Q===Sr.INTERPRET.BLACKWHITE?j.html(QC({encodings:Fe===Sr.DISPLAY.BINARY?jEe:GEe,title:"B & W Encoding"})):Q===Sr.INTERPRET.COLOR&&(j.html(QC({title:"Color Encoding",isColor:!0})),$($Ee).spectrum({showButtons:!1,flat:!0,show:function(We){var tt=J.val()===Sr.DISPLAY.BINARY,Le=We.toHexString().substring(1),Tt=xg(Le);$(j5).text(tt?Tt:Le),$(H5).css("background-color","#"+Le)},move:function(We){var tt=J.val()===Sr.DISPLAY.BINARY,Le=We.toHexString().substring(1),Tt=xg(Le);$(j5).text(tt?Tt:Le),$(H5).css("background-color","#"+Le)}}))}function fe(){var Q=Sr.INTERPRET.COLOR===I.val()||Sr.INTERPRET.BLACKWHITE===I.val();Q?m.html(f):m.html(g)}function Re(){var Q=Sr.INTERPRET.COLOR===I.val()||Sr.INTERPRET.BLACKWHITE===I.val();Q?pe.show():pe.hide()}function ye(){function Q(Fe,We){var tt=JSON.parse(r.currentCode[Eg]);tt[Fe]=We,r.currentCode[Eg]=JSON.stringify(tt)}X.change(function(){Q("encodings",X.getAllEncodings()),Q("numBits",X.getNumBits()),r.save(),V()}),A.on("click",function(){r.aceEditor.setValue(r.aceEditor.getValue().replace(/\s/g,""))}),k.on("click",function(){r.aceEditor.setValue(BEe(J.val(),I.val(),parseInt(H.val(),10),parseInt(X.getNumBits(),10),r.aceEditor.getValue()))}),I.on("change",function(){Q("interpretAs",I.val()),ie(),fe(),Re(),V()}),J.on("change",function(){Q("displayAs",J.val());var Fe=r.aceEditor.getValue().replace(/[\s]/g,"");Fe=Sr.DISPLAY.BINARY===J.val()?xg(Fe):ZC(Fe),r.aceEditor.setValue(Fe),k.trigger("click"),ie()}),L.on("change",function(){Q("rows",L.val()),V()}),H.on("change",function(){Q("cols",H.val()),V()}),r.aceEditor.getEditor().on("change",V),setInterval(function(){var Fe=/[^01\s]/;J.val()===Sr.DISPLAY.BINARY?Fe=/[^01\s]/:J.val()===Sr.DISPLAY.HEXADECIMAL&&(Fe=/[^0123456789abcdefABCDEF\s]/),r.aceEditor.getEditor().replaceAll("",{needle:Fe,regex:!0})})}function ze(){try{JSON.parse(r.currentCode[Eg])}catch{r.currentCode[Eg]="{}"}var Q=JSON.parse(r.currentCode[Eg]);Q.interpretAs&&I.val(Q.interpretAs),Q.displayAs&&J.val(Q.displayAs),Q.rows&&L.val(Q.rows),Q.cols&&H.val(Q.cols),Q.encodings&&X.updateEncodings(Q.encodings),Q.numBits&&X.setNumBits(Q.numBits)}function Ue(){ze(),ye(),ie(),fe(),Re(),V()}function de(){ie()}return{editor:l,setup:Ue,resize:de}}});var Y5=D((wLe,QEe)=>{QEe.exports=`<div style="width:100%; height:calc(100% - 49px)">

    <div style="padding:5px; gap: 5px;" class="flex flex-wrap">
        <span class="form-group has-float-label flex-unit" style="margin-bottom: 0; min-width: 75px">
            <input id="js-gslide-input" placeholder="Google Slide ID" type="text" style="height: 30px; width: 100%;"></input>
            <label for="js-gslide-input">Google Slide ID</label>
        </span>
        <button id="js-gslide-edit-btn" class="btn btn-main-orange" style="flex-basis:100px; height:30px;">Edit</button
        ><button id="js-gslide-present-btn" class="btn btn-main-green" style="flex-basis:100px; height:30px;">Present</button>
    </div>

    <iframe id="js-gslide-iframe" style="border:none; width:100%; height:calc(100% - 40px)" title="Embed of slides for assignment"></iframe>
    <div id="js-gslide-error" aria-live="polite" style="padding: 140px 75px 0 75px; border:none; width:100%; height:calc(100% - 40px)">
        <div style="font-size:32px; text-align:center;">We could not load the Google Slide with that id</div>
    </div>
    <div id="js-gslide-welcome" style="padding: 140px 75px 0 75px; border:none; width:100%; height:calc(100% - 40px)">
        <div style="font-size:32px; text-align:center;">Please input the Google Slide id</div>
    </div>

</div>
`});var rV=D((TLe,tV)=>{var ZEe=Y5(),exe="#js-gslide-input",txe="#js-gslide-edit-btn",rxe="#js-gslide-present-btn",i0="#js-gslide-iframe",J5="#js-gslide-error",Q5="#js-gslide-welcome",Z5="default.txt",ixe="https://docs.google.com/presentation/d/${slideId}/${type}?rm=minimal",n0={PRESENT:"embed",EDIT:"edit"};function eV(t,e){return ixe.replace("${slideId}",t).replace("${type}",e)}tV.exports=function(t){var e=$(ZEe),r=e.find(exe),n=e.find(txe),i=e.find(rxe),a=e.find(i0),s=e.find(J5),o=e.find(Q5);function c(f){[a,s,o].forEach(function(g){g.is(f)?f===i0?g.on("load",function(){g.show()}):g.show():g.hide()})}function l(f){var g=r.val(),m=eV(g,f);$.get(m).done(function(){a.attr("src",m),t.activeFile||(t.activeFile=Z5),t.setCode(g),t.save(),c(i0)}).fail(function(){c(J5)})}return n.on("click",function(){l(n0.EDIT)}),i.on("click",function(){l(n0.PRESENT)}),r.on("change",function(){l(n0.PRESENT)}),function(){var g=t.currentCode[Z5],m=eV(g,n0.PRESENT);$.get(m).done(function(){a.attr("src",m),r.val(g),c(i0)}).fail(function(){c(Q5)})}(),e}});var iV=D((SLe,nxe)=>{nxe.exports=`<div style="width:100%; height:100%; text-align:center; overflow-y:auto">
    <h2>{{title}}</h2>
    <div style="height: 600px; width: 600px; margin:auto;" id="js-run-tab-container"></div>
    <button style="position:fixed; right: 20px; bottom: 60px" id="js-continue-btn" class="btn btn-main-green">Continue</button>
</div>
`});var aV=D((ELe,nV)=>{var axe=Ql(),sxe=Handlebars.compile(iV()),oxe="#js-continue-btn";nV.exports=function(t){var e=$(sxe({title:t.itemTitle})),r=e.find(oxe);return r.on("click",function(){axe({item_id:t.itemID,module_id:t.moduleID,course_id:t.courseID,correct:!0,auto_grade:!0},t.goToNext)}),e}});var eA=D((xLe,uxe)=>{uxe.exports=`import java.util.*;

public class ConsoleProgram{

    private Scanner scanner;

    public static void main(String[] args){
        // Assume the class name is passed in as the first argument.

        if(args.length == 0){
            System.out.println("Please provide the name of the main class as an argument.");
            return;
        }

        String mainClassName = args[0];

        try{
            Class mainClass = Class.forName(mainClassName);
            Object obj = mainClass.newInstance();
            ConsoleProgram program = (ConsoleProgram)obj;
            program.run();
        } catch (IllegalAccessException ex) {
            System.out.println("Error in program. Make sure you extend ConsoleProgram");
        } catch (InstantiationException ex) {
            System.out.println("Error in program. Make sure you extend ConsoleProgram");
        } catch (ClassNotFoundException ex) {
            System.out.println("Error in program. Make sure you extend ConsoleProgram");
        }
    }

    public void run(){
        /* Overridden by subclass */
    }

    public ConsoleProgram(){
        scanner = new Scanner(System.in);

    }

    public String readLine(String prompt){
        System.out.print(prompt);
        return scanner.nextLine();
    }

    public boolean readBoolean(String prompt){

        while(true){
            String input = readLine(prompt);

            if(input.equalsIgnoreCase("true")){
                return true;
            }

            if(input.equalsIgnoreCase("false")){
                return false;
            }
        }
    }

    public double readDouble(String prompt){

        while(true){
            String input = readLine(prompt);
            try {
                double n = Double.valueOf(input).doubleValue();
                return n;
            } catch (NumberFormatException e){

            }
        }
    }

    // Allow the user to get an integer.
    public int readInt(String prompt){

        while(true){
            String input = readLine(prompt);
            try {
                int n = Integer.parseInt(input);
                return n;
            } catch (NumberFormatException e){

            }
        }
    }

    /**
     * Allows us to use a shorthand version for System.out.println()
     */
    public void println() {
        System.out.println();
    }

    /**
     * Allows us to use a shorthand version for System.out.println(String s)
     */
    public void println(String s) {
        System.out.println(s);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(boolean x)
     */
    public void println(boolean x) {
        System.out.println(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(char x)
     */
    public void println(char x) {
        System.out.println(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(char[] x)
     */
    public void println(char[] x) {
        System.out.println(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(int x)
     */
    public void println(int x) {
        System.out.println(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(long x)
     */
    public void println(long x) {
        System.out.println(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(float x)
     */
    public void println(float x) {
        System.out.println(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(double x)
     */
    public void println(double x) {
        System.out.println(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.println(Object o)
     */
    public void println(Object o) {
        System.out.println(o);
    }

    /**
     * Allows us to use a shorthand version for System.out.print()
     */
    public void print() {
        System.out.print("");
    }

    /**
     * Allows us to use a shorthand version for System.out.print(String s)
     */
    public void print(String s) {
        System.out.print(s);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(boolean x)
     */
    public void print(boolean x) {
        System.out.print(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(char x)
     */
    public void print(char x) {
        System.out.print(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(char[] x)
     */
    public void print(char[] x) {
        System.out.print(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(int x)
     */
    public void print(int x) {
        System.out.print(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(long x)
     */
    public void print(long x) {
        System.out.print(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(float x)
     */
    public void print(float x) {
        System.out.print(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(double x)
     */
    public void print(double x) {
        System.out.print(x);
    }

    /**
     * Allows us to use a shorthand version for System.out.print(Object o)
     */
    public void print(Object o) {
        System.out.print(o);
    }
}
`});var sV=D((CLe,cxe)=>{cxe.exports=`#ifndef _util
#define _util

#include <iostream>
#include <vector>

using  namespace std;

void Error(string message);

string readLine(const string prompt = "?");

int readInt(const string prompt = "?", string reprompt = "");
int readInt(const int low, const int high, const string prompt = "?", string reprompt = "");

double readDouble(const string prompt = "?", string reprompt = "");
double readDouble(const double low, const double high, const string prompt = "?", string reprompt = "");

vector<string> splitLine(string input, char delimeter = ' ');

string toUpperCase(string s);
string toLowerCase(string s);

void setSeed(int seed);
int randInt();
int randInt(int min, int max);

#endif`});var oV=D((ALe,lxe)=>{lxe.exports=`#include "util.h"
#include <iostream>
#include <sstream>
#include <ctime>

using namespace std;

void Error(string message) {
    cerr << "Error: " << message << endl;
    exit(-1);
}

string readLine(const string prompt)
{
    cout << prompt;
    string line;
    getline(cin, line);
    return line;
}

double readDouble(const string prompt, string reprompt) {
    if (reprompt == "") reprompt = prompt;

    double value = 0;
    cout << prompt;
    while (true) {
        string line;
        try {
            if (!getline(cin, line)) {
                throw "getInteger: End of input reached while waiting for integer value.";
            }
        }
        catch (const char *c) {
            cerr << c << endl;
            exit (EXIT_FAILURE);
        }

        istringstream stream(line);
        stream >> value;
        if (!stream.fail() && stream.eof()) {
            break;
        }

        cout<<  reprompt;
    }
    return value;
}

double readDouble(const double low, const double high, const string prompt, string reprompt) {
    if (reprompt == "") reprompt = prompt;
    double value = readDouble(prompt, reprompt);

    while (value < low || value > high) {
        value = readDouble(reprompt);
    }

    return value;
}

int readInt(const string prompt, string reprompt) {
    if (reprompt == "") reprompt = prompt;

    int value = 0;
    cout << prompt;
    while (true) {
        string line;
        try {
            if (!getline(cin, line)) {
                throw "getInteger: End of input reached while waiting for integer value.";
            }
        }
        catch (const char *c) {
            cerr << c << endl;
            exit (EXIT_FAILURE);
        }

        istringstream stream(line);
        stream >> value;
        if (!stream.fail() && stream.eof()) {
            break;
        }

        cout<<  reprompt;
    }
    return value;
}

int readInt(const int low, const int high, const string prompt, string reprompt) {
    if (reprompt == "") reprompt = prompt;
    int value = readInt(prompt, reprompt);

    while (value < low || value > high) {
        value = readInt(reprompt);
    }

    return value;
}

vector<string> splitLine(string input, char delimeter) {

    vector<string> output;
    istringstream stream(input);
    string token;

    while(getline(stream, token, delimeter)) {
        output.push_back(token);
    }
    return output;
}

string toUpperCase(string s) {
    string result;
    for (int i = 0; i < (int)s.length(); i++) {
        result += toupper(s[i]);
    }
    return result;
}

string toLowerCase(string s){
    string result;
    for (int i = 0; i < (int)s.length(); i++) {
        result += tolower(s[i]);
    }
    return result;
}

static void initRandomSeed() {
    static bool initialized = false;
    if (!initialized) {
        srand(int(time(0)));
        rand();
        initialized = true;
    }
}

void setSeed(int seed) {
    initRandomSeed();
    srand(seed);
}

int randInt(){
    initRandomSeed();
    return rand();
}

int randInt(int min, int max) {
    initRandomSeed();
    return rand() % (max - min + 1) + min;
}
`});var uV=D((ILe,dxe)=>{dxe.exports=`import java.util.*;

public class GraphicsProgram extends ConsoleProgram
{

    // These are the defaults
    double width = 400;
    double height = 480;

    public void add(Thing thing)
    {
        System.out.println("js:add(" + thing.name + ");");
    }

    public double getWidth()
    {
        return width;
    }

    public double getHeight()
    {
        return height;
    }

    public void setSize(double width, double height)
    {
        this.width = width;
        this.height = height;
        System.out.println("js:setSize(" + width + "," + height + ");");
    }

    public void setSize(int width, int height)
    {
        this.width = (double)width;
        this.height = (double)height;
        System.out.println("js:setSize(" + width + "," + height + ");");
    }
}
`});var cV=D((kLe,fxe)=>{fxe.exports=`import java.util.Random;

public class Randomizer{

    public static Random theInstance = null;

    public Randomizer(){

    }

    public static Random getInstance(){
        if(theInstance == null){
            theInstance = new Random();
        }
        return theInstance;
    }

    /**
     * Return a random boolean value.
     * @return True or false value simulating a coin flip.
     */
    public static boolean nextBoolean(){
        return Randomizer.getInstance().nextBoolean();
    }

    /**
     * This method simulates a weighted coin flip which will return
     * true with the probability passed as a parameter.
     *
     * @param   probability The probability that the method returns true, a value between 0 to 1 inclusive.
     * @return True or false value simulating a weighted coin flip.
     */
    public static boolean nextBoolean(double probability){
        return Randomizer.nextDouble() < probability;
    }

    /**
     * This method returns a random integer.
     * @return A random integer.
     */
    public static int nextInt(){
        return Randomizer.getInstance().nextInt();
    }

    /**
     * This method returns a random integer between 0 and n, exclusive.
     * @param n The maximum value for the range.
     * @return A random integer between 0 and n, exclusive.
     */
    public static int nextInt(int n){
        return Randomizer.getInstance().nextInt(n);
    }

    /**
     * Return a number between min and max, inclusive.
     * @param min   The minimum integer value of the range, inclusive.
     * @param max   The maximum integer value in the range, inclusive.
     * @return A random integer between min and max.
     */
    public static int nextInt(int min, int max){
        return min + Randomizer.nextInt(max - min + 1);
    }

    /**
     * Return a random double between 0 and 1.
     * @return A random double between 0 and 1.
     */
    public static double nextDouble(){
        return Randomizer.getInstance().nextDouble();
    }

    /**
     * Return a random double between min and max.
     * @param min The minimum double value in the range.
     * @param max The maximum double value in the rang.
     * @return A random double between min and max.
     */
    public static double nextDouble(double min, double max){
        return min + (max - min) * Randomizer.nextDouble();
    }

    /**
     * Return a random color.
     * @return A random hex string that represents a color.
     */
    public static String nextColor(){
        String randomNum = Integer.toHexString(Randomizer.nextInt(0, 16777216));
        return "'#" + randomNum + "'";
    }


}
`});var lV=D((OLe,pxe)=>{pxe.exports=`public class Color
{

    public static String black = "Color.black";
    public static String red = "Color.red";
    public static String blue = "Color.blue";
    public static String green = "Color.green";
    public static String yellow = "Color.yellow";
    public static String orange = "Color.orange";
    public static String gray = "Color.gray";
    public static String grey = "Color.gray";
    public static String cyan = "Color.cyan";
    public static String purple = "Color.purple";

    public static String BLACK = "Color.black";
    public static String RED = "Color.red";
    public static String BLUE = "Color.blue";
    public static String GREEN = "Color.green";
    public static String YELLOW = "Color.yellow";
    public static String ORANGE = "Color.orange";
    public static String GRAY = "Color.gray";
    public static String GREY = "Color.gray";
    public static String CYAN = "Color.cyan";
    public static String PURPLE = "Color.purple";
}
`});var dV=D((PLe,hxe)=>{hxe.exports=`public class Thing
{

    public static int numThings = 0;

    double x = 0;
    double y = 0;
    String color = "Color.black";
    String name;
    String type = "Thing";

    public void setPosition(int x, int y)
    {
        this.x = (double)x;
        this.y = (double)y;
        System.out.println("js:" + name + ".setPosition(" + x + "," + y + ");");
    }

    public void setPosition(double x, double y)
    {
        this.x = x;
        this.y = y;
        System.out.println("js:" + name + ".setPosition(" + x + "," + y + ");");
    }

    public void move(int dx, int dy)
    {
        this.x += (double)dx;
        this.y += (double)dy;
        System.out.println("js:" + name + ".move(" + dx + "," + dy + ");");
    }

    public void move(double dx, double dy)
    {
        this.x += dx;
        this.y += dy;
        System.out.println("js:" + name + ".move(" + dx + "," + dy + ");");
    }

    public double getX()
    {
        return x;
    }

    public double getY()
    {
        return y;
    }

    public void setColor(String color)
    {
        if (color.charAt(0) == '#')
        {
            // So you can just enter a hex string in addition to Color.___
            color = "'" + color + "'";
        }
        this.color = color;
        System.out.println("js:" + name + ".setColor(" + this.color + ");");
    }

    public String getColor()
    {
        return color;
    }
}
`});var fV=D((RLe,gxe)=>{gxe.exports=`public class Circle extends Thing
{

    double radius = 10;

    public Circle(int radius)
    {
        this.radius = (double)radius;
        this.type = "Circle";
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Circle(" + radius + ");");
    }

    public Circle(double radius)
    {
        this.radius = radius;
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Circle(" + radius + ");");
    }

    public void setRadius(int radius)
    {
        this.radius = (double)radius;
        System.out.println("js:" + name + ".setRadius(" + radius + ");");
    }

    public void setRadius(double radius)
    {
        this.radius = radius;
        System.out.println("js:" + name + ".setRadius(" + radius + ");");
    }

    public double getRadius()
    {
        return radius;
    }
}
`});var pV=D((DLe,mxe)=>{mxe.exports=`public class Rectangle extends Thing
{

    double width = 10;
    double height = 10;

    public Rectangle(int width, int height)
    {
        this.width = (double)width;
        this.height = (double)height;
        this.type = "Rectangle";
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Rectangle(" + width + "," + height +  ");");
    }

    public Rectangle(double width, double height)
    {
        this.width = width;
        this.height = height;
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Rectangle(" + width + "," + height +  ");");
    }

    public double getWidth()
    {
        return width;
    }

    public double getHeight()
    {
        return height;
    }
}
`});var hV=D((LLe,vxe)=>{vxe.exports=`public class Line extends Thing
{

    double x2 = 10;
    double y2 = 10;
    double lineWidth = 2;

    public Line(int x1, int y1, int x2, int y2)
    {
        this.x = (double)x1;
        this.y = (double)y1;
        this.x2 = (double)x2;
        this.y2 = (double)y2;
        this.type = "Line";
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Line(" + this.x + "," + this.y + "," + this.x2 + "," + this.y2 +  ");");
    }

    public Line(double x1, double y1, double x2, double y2)
    {
        this.x = x1;
        this.y = y1;
        this.x2 = x2;
        this.y2 = y2;
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Line(" + x1 + "," + y1 + "," + x2 + "," + y2 +  ");");
    }

    public void setEndpoint(int x, int y)
    {
        this.x2 = (double)x;
        this.y2 = (double)y;
        System.out.println("js:" + name + ".setEndpoint(" + this.x2 + "," + this.y2 + ");");
    }

    public void setEndpoint(double x, double y)
    {
        this.x2 = x;
        this.y2 = y;
        System.out.println("js:" + name + ".setEndpoint(" + this.x2 + "," + this.y2 + ");");
    }

    public void setLineWidth(double width)
    {
        this.lineWidth = width;
        System.out.println("js:" + name + ".setLineWidth(" + this.lineWidth + ");");
    }

    public double getEndX()
    {
        return x2;
    }

    public double getEndY()
    {
        return y2;
    }
}
`});var gV=D((NLe,yxe)=>{yxe.exports=`public class Text extends Thing
{

    String text = "";
    String font = "30pt Arial";

    public Text(String text)
    {
        this.text = text;
        this.type = "Text";
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Text('" + text + "');");
    }

    public Text(String text, String font)
    {
        this.text = text;
        this.type = "Text";
        this.font = font;
        this.name = "thing" + Thing.numThings++;
        System.out.println("js:var " + name + " = new Text('" + text + "','" + font + "');");
    }

    public String getText()
    {
        return text;
    }

    public void setText(String text)
    {
        this.text = text;
        System.out.println("js:" + name + ".setText('" + text + "');");
    }

    public void setFont(String font)
    {
        this.font = font;
        System.out.println("js:" + name + ".setFont('" + font + "');");
    }
}
`});var CV=D((MLe,xV)=>{"use strict";var Ru=Qg(),Yt=Nr(),Pa=Cr(),bxe=Yt.Uploads.UPLOADS_PROXY_BASE_URL,_xe=F8(),sA=Ql(),wxe=T6(),Txe=Ni().getPrettyCode,Sxe=E6(),oA=Nc();Cz();var Exe=IT().displayModal,bV=ET(),xxe=YS(),Cxe=vy(),Axe=C6();O6();L6();var Ixe=Az(),kxe=ui().getAndApplyTemplate,Pu=_i(),Oxe=$6(),Pxe=ui().mock,Rxe=ui().validateFilename,Dxe=ui().validateFolderName,Lxe=ui().fileHasImageExtension,Nxe=ui().getQueryParams,mV=ui().alert,Mxe=ui().LOCAL_URL,Gn=Ub(),$xe=gl(),_V=Zl(),rA=Yl(),Uxe=ui().createDOMSubtreeModifiedListener,vV=0,a0="#submit-button",wV="#submit-correct",Fxe="#inline-submit-button",Bxe="#check-program",TV="#next-button",qxe="#inline-next-button",SV="#save-button",jxe="#fork-modal",Cg="#pause-button",Hxe="#forward-button",Gxe="#backward-button",Vxe="#stop",Nl="#add-code-file",iA=".publish-to-class",zxe="#for-loop-vars",yV="#view-html",Wxe=".editor-wrap",Kxe=".ace_text-input",EV=".run_code",Xxe=".install_packages",Yxe=".grading-problem-btn",nA=".error-box",aA=".error-container",Jxe=1e6,Qxe=["typeTester","aceEditor"],Zxe=[["typeTester",VA()],["aceEditor",q6()],["editorInstructions",z6()],["editorSettings",Y6()],["editorHistory",Ez()],["editorSidebarContent",Z6()],["editorKeyboardShortcuts",t5()],["editorColumns",hC()],["editorLineErrors",n5()],["codeSaver",l5()],["localStorageCodeSaver",f5()],["sidebar",h5()],["gradeAndRespond",m5()],["helpTab",HT()],["conversationTab",GA()],["embeddableEditor",y5()],["hourOfCodeEditor",w5()],["gradingTab",Nv()],["shareTab",$T()],["uploadTab",zT()],["pythonTutor",eS()],["docsTab",x5()],["phoneTab",WT()],["lmsGradingTab",FT()]],eCe={modules:["editorInstructions","editorSettings","editorHistory","editorSidebarContent","editorKeyboardShortcuts","editorColumns","editorLineErrors","codeSaver","sidebar","gradeAndRespond","helpTab","gradingTab","shareTab","uploadTab","pythonTutor","docsTab","phoneTab"],configs:{}},tCe={modules:["editorInstructions","editorSettings","editorHistory","editorSidebarContent","editorKeyboardShortcuts","editorColumns","editorLineErrors","codeSaver","sidebar","gradeAndRespond","conversationTab","gradingTab","shareTab","uploadTab","pythonTutor","docsTab","phoneTab","lmsGradingTab"],configs:{}},rCe={modules:["editorInstructions","editorColumns","editorLineErrors","embeddableEditor"],configs:{}},iCe={modules:["editorInstructions","editorLineErrors","localStorageCodeSaver","sidebar","hourOfCodeEditor"],configs:{}},nCe={modules:["editorLineErrors","hourOfCodeEditor"],configs:{}},aCe={modules:[],configs:{}};function Rt(t){t=t||{},t.editorFontSize?t.fontSize=t.editorFontSize+"px":t.info.font&&(t.fontSize=t.info.font+"px"),t=Ru.defaults(t,{language:Yt.ProgrammingLanguage.JAVASCRIPT,code:"",mainClass:"",progType:Yt.ProgramType.KAREL,progTypeString:Yt.ProgramType.STRINGS[Yt.ProgramType.KAREL],aceElemID:"codehs-editor",fontSize:"15px",highlight:!0,itemType:Yt.ItemType.EXERCISE,itemTypeStr:Yt.ItemType.STRINGS[Yt.ItemType.EXERCISE],themeID:0,editorType:"regular",autograderCode:"{}",solutionCode:{},isSharedProgram:!1,codeEditorType:Yt.EditorType.ACE_EDITOR,runOnHub:window.pageSpecific.runOnHub});var e=this;Object.keys(t).forEach(function(r){e[r]=t[r]}),e.editorInstanceId=vV,vV++,e.paused=!1,e.isRunning=!1,e.saveIntervalId=null,e.numLoops=0,e.defaultBlocks=t.defaultBlocks,e.preventCopyPaste=t.preventCopyPaste,e.breakpoints={},$(Wxe).addClass("editor-id-"+e.editorInstanceId),e.setup(t)}Rt.prototype.setup=function(t){var e=this,r=window.pageSpecific.itemDescription,n=window.pageSpecific.isQuill;_V.chooseEditor([{qlTarget:"#quill-exercise-description",mdTarget:".markdown-exercise-description",content:r}],n),n?$("#quill-exercise-description a").attr("target","_blank"):($(".markdown-exercise-description a").attr("target","_blank"),$(".markdown-exercise-description").children("table").addClass("table")),uCe(window.pageSpecific.videoID),e.editorType!=="hourofcode"?e.loadCode(t).done(function(i){if(i.status==="ok"){var a=JSON.parse(i.solutionCode.split("").map(function(c,l){var f=CHS.GULP_URL[l%CHS.GULP_URL.length],g=String.fromCharCode((c.charCodeAt(0)-f.charCodeAt(0))%256);return g}).join(""));e.code=i.studentCode,e.currentCode=i.studentCode,e.solutionCode=a,window.editorData.startWithSolutionCode&&(e.currentCode=a),e.autograderCode=i.autograderCode,e.helperCode=i.helperCode,e.dropletCustomBlocks=i.dropletCustomBlocks,e.setupTimeTrack(),e.setupSaveInterval(),e.setupHeartbeatInterval(),e.setupModules(),e.setupActiveTab(),e.setupCollaborateTab(),e.setupLazyLoadIframeTabs(),(e.codeEditorType===Yt.EditorType.DROPLET_EDITOR||window.pageSpecific.onlyDisplayingDemosTab||window.pageSpecific.hideLeftPanel)&&$("#close-toggle").trigger("click"),e.typeTester.isPresentation()&&e.setupPresentationEditor(),e.typeTester.isDemo()&&e.setupDemoEditor(),e.typeTester.isBitInterpreter()&&e.setupBitInterpreterEditor(),e.typeTester.isDataExplorer()&&e.setupDataExplorer(),e.typeTester.isGraphics()&&(e.runner.helperCode=e.helperCode);var s;!e.typeTester.isHTML()&&!e.typeTester.isUnitTest()&&t.mainClass?(s=t.mainClass+Yt.ProgrammingLanguage.FILE_SUFFIX[e.language],e.activeFile=s):t.mainClass?(s=t.mainClass,e.activeFile=s):(s=Yt.ProgrammingLanguage.DEFAULT_FILENAME[e.language],e.activeFile=s),Ru.has(e.currentCode,s)||(s=Object.keys(e.currentCode)[0],e.activeFile=s),Object.keys(e.currentCode).forEach(function(c){e.breakpoints[c]={}}),e.runner.supportsBreakpoints()&&e.setupBreakpointClicks(),e.activeFile&&e.activeFile.endsWith(".jar")?e.setCode(e.getJarASCII()):e.setCode(e.currentCode[s]),e.typeTester.isGradingQuiz()&&e.setupQuizzes(),e.setupEditorEvents(),e.setupExpo(),e.setupBackspaceCheck(),Oxe.setup(),e.runner.init&&e.runner.init(),e.itemType==Yt.ItemType.REPL&&M5()(e);var o=Nxe().collaborate;o&&window.pageSpecific.collaborateBlockedByDroplet?mV({header:"Unable to collaborate",rawHtml:`<p>It looks like you're trying to collaborate on a Block coding program.
To collaborate, the program's owner will need to switch this program to use text, not blocks.</p>
<a target="_blank" href="/toggling-block-coding">Learn more about blocks settings</a>`,buttonClass:"btn-main-green",button:"View Program"}):t.useFirepad&&o?e.setupFirepad(o):window.pageSpecific.unauthenticated&&o&&mV({header:"Unable to collaborate",message:`It looks like you're trying to collaborate on this program.
To collaborate, you need to log in.`,cancel_callback:function(){var c=new URL(window.location.origin+"/login");c.searchParams.set("next",window.location.pathname),c.searchParams.set("collaborate",o),window.location.href=c.href},cancelButton:!0,buttonClass:"btn-main-green",button:"View Program",cancelButtonText:"Log In",cancelButtonClass:"btn-main-blue"})}}):(e.setupModules(),e.setupActiveTab(),e.setupLazyLoadIframeTabs(),e.typeTester.isGradingQuiz()&&e.setupQuizzes(),e.setupEditorEvents(),e.setupBackspaceCheck(),e.runner.init&&e.runner.init())};Rt.prototype.setupFirepad=function(t){var e=this;e.firepad||(e.firepad=new Axe(e)),e.firepad.initialize(e.aceEditor,t)};Rt.prototype.teardownFirepad=function(){var t=this;t.firepad&&t.firepad.firepad.dispose()};Rt.prototype.setupSaveInterval=function(){var t=this;t.saveIntervalId=setInterval(function(){t.save(function(){},"autosave")},6e4)};Rt.prototype.setupHeartbeatInterval=function(){var t=this,e=1e3*60*10;t.heartbeatIntervalId=setInterval(function(){fetch("/usertracking/heartbeat")},e)};Rt.prototype.setupTimeTrack=function(){var t=this,e=5e3,r=3e4;t.timeTrackSeconds=0,$.idleTimer(r),t.timeTrackIntervalId=setInterval(function(){$.idleTimer("isIdle")||(t.timeTrackSeconds+=e/1e3)},e)};Rt.prototype.loadCode=function(t){return window.HOC_LOGGED_OUT_PLAYLIST_EDITOR||window.PRACTICE_LOGGED_OUT_EDITOR?Pu.send({method:"get_code_files",app:"editor",type:"GET",data:{gulpUrl:CHS.GULP_URL,item_id:t.itemID}}):Pu.send({method:"get_editor_setup_code",app:"editor",type:"GET",data:{gulpUrl:CHS.GULP_URL,item_id:t.itemID,user_id:t.codeUserID,student_assignment_id:t.studentAssignmentID}})};Rt.prototype.setupBitInterpreterEditor=function(){var t=this,e=X5()(400,t.getProgramType(),t,"#output");$("#run-tab > .buttons").remove(),$("#game").remove();var r=$("#codehs-editor");$("#codehs-editor").replaceWith(e.editor),e.editor.find("#js-editor-textarea").append(r),e.setup(),$("#close-toggle").trigger("click"),t.runner.run=function(){return t.currentCode},t.aceEditor.resize=function(){t.aceEditor.editor.resize(),e.resize()}};Rt.prototype.setupDataExplorer=function(){var t=this;$("#run-tab > .buttons").remove(),$("#game").remove();var e="https://docs.google.com/spreadsheets/d/"+t.resourceGdoc,r=e+"/pubhtml?widget=true",n=e+"/gviz/tq?headers=1&sheet=Sheet1",i=$(document.createElement("iframe")).width("100%").css("height","calc(100% - 52px)").attr("frameBorder",0).attr("src",r);$("#codehs-editor").replaceWith(i);var a="#right",s=$(a).resizable("option","start");$(a).resizable("option","start",function(l,f){i.css("pointer-events","none"),Ru.isFunction(s)&&s(l,f)});var o=$(a).resizable("option","stop");$(a).resizable("option","stop",function(l,f){i.css("pointer-events","auto"),Ru.isFunction(o)&&o(l,f)});var c=$(document.createElement("button")).text("Select Chart");$("#output").after(c),google.charts.setOnLoadCallback(function(){var l=new google.visualization.ChartWrapper({chartType:"Table",dataSourceUrl:n,containerId:"output"});l.draw();var f=new google.visualization.ChartEditor;google.visualization.events.addListener(f,"ok",function(){f.getChartWrapper().draw(document.getElementById("output"))}),c.on("click",function(){f.openDialog(l,{})})}),$("#close-toggle").trigger("click")};Rt.prototype.setupExpo=function(){var t=this,e=t.getExpoCode();if(e!==null){var r=$xe({welcomeString:"",promptLabel:""}),n={replConsole:r,hostname:window.location.hostname,codeTitle:window.pageSpecific.itemTitle,codeDescription:window.pageSpecific.codeUserFirstNameLastInitial,userProgramID:window.pageSpecific.userProgramID};t.expoSnackSessionPromise=Gn.sessionPromise(e,n),t.isSharedProgram?t.setupExpoForSharedProgram(n):t.typeTester.isGraphics()?t.setupExpoForGraphics(n):t.typeTester.isReactNative()&&t.setupExpoForReactNative(n)}};Rt.prototype.getExpoCode=function(){var t=this;return t.typeTester.isGraphics()?Gn.userCodeToReactCode(t.aceEditor.getValue(),window.location.hostname):t.typeTester.isReactNative()?t.aceEditor.getValue():null};Rt.prototype.setupExpoForSharedProgram=function(t){var e=this;e.expoSnackSessionPromise.then(function(r){var n=e.getExpoCode();$("#view-on-phone-btn").prop("disabled",!1),$("#view-on-phone-btn").on("click",function(i){var a=$("#view-on-phone-btn").attr("data-expo-url");if(a){var s=$("#view-on-phone-btn").data("expo-url");Gn.writeQRCode(s,Gn.SNACK_SESSION_QR_DOM)}else Gn.updateCode(n,r,Gn.SNACK_SESSION_QR_DOM)})})};Rt.prototype.setupExpoForReactNative=function(t){var e=this;e.expoSnackSessionPromise.then(function(r){var n=e.getExpoCode();Gn.updateCode(n,r,Gn.SNACK_SESSION_QR_DOM),$("#publish-button").on("click",function(){n=e.getExpoCode(),Gn.publishCode(n,t,r,!1)}),e.reactNativeRunner=new xxe(e)})};Rt.prototype.setupExpoForGraphics=function(t){var e=this;e.expoSnackSessionPromise.then(function(r){var n=e.getExpoCode();Gn.updateCode(n,r,Gn.SNACK_SESSION_QR_DOM),$(SV+", "+EV).on("click",function(i){n=e.getExpoCode(),Gn.updateCode(n,r,Gn.SNACK_SESSION_QR_DOM)}),$(".expo-option-checkbox").on("change",function(i){n=e.getExpoCode(),Gn.checkboxChange(i,n,t,r)}),$("#publish-button").on("click",function(){n=e.getExpoCode(),Gn.publishCode(n,t,r,!1)})})};Rt.prototype.updateReactNativeQR=function(t){var e=this;e.expoSnackSessionPromise.then(function(r){Gn.updateCode(t,r,Gn.SNACK_SESSION_QR_DOM)})};Rt.prototype.setupPresentationEditor=function(){var t=this,e=rV();$("#codehs-editor").replaceWith(e(t)),$("#close-toggle").trigger("click")};Rt.prototype.setupDemoEditor=function(){var t=this,e=aV()(t);e.find("#js-run-tab-container").append($("#run-tab")),$("#wrapper").css("padding-right",0).append(e),$("#left").hide(),$("#right").hide(),$("#output").css({"text-align":"initial",width:"400px",margin:"auto",height:"550px"}),$("#close-toggle").trigger("click")};Rt.prototype.setupActiveTab=function(){if(pageSpecific.helpTabActive)Pa.trigger("utils:switchToTab","#help-tab");else{var t=Yt.ItemTypeConfig.CONFIGS[this.getItemType()].active_tab;Yt.ProgramType.NO_RUN_TAB_PROG_TYPES.indexOf(this.getProgramType())!=-1&&(t="#exercise-tab"),Pa.trigger("utils:switchToTab",t)}};Rt.prototype.setupCollaborateTab=function(){var t=this;$("#add-collaborator-btn").on("click",function(){var e=$("#collab-email").val().trim();e!=""&&Pu.send({method:"add_item_collaborator",app:"library",data:{item_id:t.itemID,user_id:t.codeUserID,collaborator_email:e},success:function(r){r.status=="ok"?($("#collaborator-list").append("<span>"+r.collaborator+"</span><br>"),$("#collab-email").val("")):rA.error("No user with that email could be found.")}})})};Rt.prototype.setupModules=function(){var t;this.editorType=="regular"?this.studentAssignmentID?t=tCe:t=eCe:this.editorType=="hourofcode"?t=iCe:this.editorType=="lite"?t=nCe:this.editorType=="nocode"?t=aCe:t=rCe;var e=Qxe.concat(t.modules);Ru.each(Zxe,(function(r){var n=r[0];Ru.contains(e,r[0])?this[n]=new r[1](this):this[n]=new(Pxe(r[1]))(this)}).bind(this)),this.runner=new Cxe(this).create(),window.pageSpecific.collaboratePortalID&&this.teletype.TeletypePackage.joinPortal(window.pageSpecific.collaboratePortalID).then(function(r){r?window.toastr.success("Joined room!"):alert("There was an issue joining the room. Confirm the URL with your friend!")})};Rt.prototype.setupQuizzes=function(){wxe.setup({itemID:this.itemID,moduleID:this.moduleID,courseID:this.courseID,itemType:this.itemType,quizID:this.quizID,numAnswered:this.num_answered,numQuestions:this.questions})};Rt.prototype.getInfo=function(){return{itemType:this.itemType,itemTypeStr:this.itemTypeStr,progType:this.progType,progTypeString:this.progTypeString,itemID:this.itemID,moduleID:this.moduleID,courseID:this.courseID,codeUserID:this.codeUserID,isSandbox:this.isSandbox,studentAssignmentID:this.studentAssignmentID}};Rt.prototype.getItemID=function(){return this.itemID};Rt.prototype.isOwnPage=function(){return this.editorType=="hourofcode"?!0:this.codeUserID==this.viewerID};Rt.prototype.isHourOfCode=function(){return this.editorType=="hourofcode"};Rt.prototype.clearHighlightedLines=function(){this.highlight&&this.aceEditor.clearHighlightedLines()};Rt.prototype.highlightLine=function(t,e,r){r=r||this.activeFile,r==this.activeFile&&this.highlight&&(e===void 0&&(e=!0),this.aceEditor.highlightLine(t,e))};Rt.prototype.getCurrentCode=function(){return this.currentCode};Rt.prototype.getCode=function(t){t=t||!1;var e=this.activeFile&&this.activeFile.endsWith(".jar"),r=this.aceEditor.getValue();return t&&this.currentCode[this.mainClass]!==void 0&&(r=this.currentCode[this.mainClass]),e&&(r=this.currentCode[this.activeFile]),this.cleanNewLine(r)};Rt.prototype.getReactNativeEmbedCode=function(){var t=this.aceEditor.getValue(),e=$("#show-buttons-switch").prop("checked"),r=$("#start-immediately-switch").prop("checked"),n=$("#full-screen-switch").prop("checked"),i=vz(),a;window.location.hostname==="localhost"?a=Mxe:a=CHS.GULP_URL;var s={showButtons:e,startImmediately:r,fullScreen:n,placeholderCode:t,GULP_URL:a},o=kxe(i,s);return o};Rt.prototype.setCode=function(t){this.aceEditor.setValue(t),this.aceEditor.clearSelection()};Rt.prototype.getProgramType=function(){return this.progType};Rt.prototype.getItemType=function(){return this.itemType};Rt.prototype.getProgrammingLanguage=function(){return this.language};Rt.prototype.needsPopup=function(){return this.itemType==Yt.ItemType.EXERCISE||this.itemType==Yt.ItemType.CHALLENGE};Rt.prototype.setupBackspaceCheck=function(){$(document).on("keydown",function(t){var e=t.target.nodeName.toLowerCase();if((e!="input"&&e!="textarea"&&!$(t.target).hasClass("ql-editor")||$(t.target).attr("readonly")||t.target.getAttribute("type")==="checkbox")&&t.keyCode===8)return t.preventDefault(),!1})};Rt.prototype.infiniteLoopDetector=function(){this.counter=Jxe,this.dec=function(){if(this.counter--,this.counter<=0)throw new Error("Infinite loop detected.");return this.counter>0}};Rt.prototype.showForLoopVars=function(t){$(zxe).html(t)};Rt.prototype.turnNextButtonGreen=function(){this.turnButtonGreen(TV)};Rt.prototype.turnSubmitButtonGreen=function(){this.turnButtonGreen(a0)};Rt.prototype.turnButtonGreen=function(t){$(t).switchClass("btn-main-silver","btn-main-green",700)};Rt.prototype.togglePauseButton=function(){this.paused=!this.paused,this.setPauseButton(this.paused),this.paused?this.runner.pause():this.runner.restart()};Rt.prototype.finishedProgram=function(t){var e=!1;t!==void 0&&(e=t.success||!1);var r=this;e&&r.editorType=="hourofcode"&&r.itemType==Yt.ItemType.EXERCISE?setTimeout(function(){r.setRunButtonText("Run!"),r.isRunning=!1,Pa.trigger("autograder:run",r.getCode(),r.info,r)},1500):(r.setRunButtonText("Run!"),r.isRunning=!1)};Rt.prototype.setRunButtonText=function(t){$(".run-button-text").text(t)};Rt.prototype.save=function(t,e){var r=this;if(this.isOwnPage()&&(this.codeSaver.saveCode(t,e),this.localStorageCodeSaver.saveCode(t)),Yt.ProgramType.SCHEME==r.progType){var n;r.currentCode[r.activeFile]=r.getCode(),n=JSON.parse(JSON.stringify(r.currentCode)),n=r.cleanFiles(n),r.runner.transfer(n)}};Rt.prototype.setPauseButton=function(t){var e=this;e.paused=t,e.paused?($(Cg).addClass("active"),$(Cg).attr("title","Unpause").tooltip("fixTitle")):($(Cg).removeClass("active"),$(Cg).attr("title","Pause").tooltip("fixTitle"))};Rt.prototype.cleanFiles=function(t){var e=this;return Object.keys(t).forEach(function(r){t[r]=e.cleanNewLine(t[r])}),t};Rt.prototype.cleanNewLine=function(t){return t=t.replace(/\r\n/g,`
`),t=t.replace(/\r/g,`
`),t};Rt.prototype.run=function(t){window.CodeHSConsole.clear(),oA.hide(),this.aceEditor.clearHighlightedLines();var e=this;window.HOC_LOGGED_OUT_PLAYLIST_EDITOR||window.PRACTICE_LOGGED_OUT_EDITOR?tA(e,t):e.isOwnPage()?e.save(function(){tA(e,t)},"run"):tA(e,t)};function tA(t,e){var r;if(e=e||{},t.getItemType()===Yt.ItemType.UNIT_TEST&&$("[data-filename]").filter(function(){var l=$(this).data("filename")||"";return Ru.includes(l.toLowerCase(),"scratchpad")}).trigger("click"),e.installPackages){if(Yt.ProgramType.PYTHON_TYPES.indexOf(t.progType)!=-1){t.currentCode[t.activeFile]=t.getCode(),a=JSON.parse(JSON.stringify(t.currentCode));var n;try{n=a["requirements.txt"],r=t.runner.run({"requirements.txt":n},{installPackages:!0,itemID:t.itemID,codeUserID:t.codeUserID})}catch{return}}else if(Yt.ProgramType.NODE==t.progType){t.currentCode[t.activeFile]=t.getCode(),a=JSON.parse(JSON.stringify(t.currentCode));var i;try{i=a["package.json"],r=t.runner.run({"package.json":i},{installPackages:!0,itemID:t.itemID,codeUserID:t.codeUserID})}catch{return}}return}var a;Yt.ProgramType.JAVA_SERVER_TYPES.indexOf(t.progType)!=-1||Yt.ProgramType.C===t.progType||Yt.ProgramType.CPP===t.progType||Yt.ProgramType.PYTHON2===t.progType||Yt.ProgramType.PYTHON3===t.progType||Yt.ProgramType.SCHEME==t.progType||Yt.ProgramType.BASH==t.progType||Yt.ProgramType.PYTHON_GRAPHICS==t.progType||Yt.ProgramType.PYGAME==t.progType||Yt.ProgramType.PYTHON3_FUNCTION==t.progType||Yt.ProgramType.CPP_FUNCTION==t.progType||Yt.ProgramType.PYTHON_PROCESSING==t.progType||Yt.ProgramType.NODE==t.progType||t.typeTester.isPythonDataScience()?(t.currentCode[t.activeFile]=t.getCode(),a=JSON.parse(JSON.stringify(t.currentCode)),a=t.cleanFiles(a)):a=t.getCode();var s=[];if((t.progType===Yt.ProgramType.JAVA_CONSOLE||t.progType===Yt.ProgramType.JAVA_METHOD||t.progType===Yt.ProgramType.JAVA_METHOD_MAIN)&&(s=t.progType===Yt.ProgramType.JAVA_METHOD||t.progType===Yt.ProgramType.JAVA_METHOD_MAIN?["Scratchpad"]:[t.mainClass],delete a["Unit Test"],a["ConsoleProgram.java"]=eA()),t.progType===Yt.ProgramType.CPP&&(a["util.h"]=sV(),a["util.cpp"]=oV()),t.progType===Yt.ProgramType.JAVA_GRAPHICS&&(s=[t.mainClass],a["ConsoleProgram.java"]=eA(),a["GraphicsProgram.java"]=uV(),a["Randomizer.java"]=cV(),a["Color.java"]=lV(),a["Thing.java"]=dV(),a["Circle.java"]=fV(),a["Rectangle.java"]=pV(),a["Line.java"]=hV(),a["Text.java"]=gV()),t.typeTester.isJavaKarel()){e={code:a};var o=new Sxe(t,e).hasErrors();if(o)return;a=new bV("java","js").translate(a)}t.typeTester.isHTML()?a=t.currentCode:t.progType===Yt.ProgramType.PYTHON_FUNCTION?a=t.currentCode["scratchpad.py"]:t.progType===Yt.ProgramType.JAVASCRIPT_FUNCTION&&(a=t.currentCode["scratchpad.js"]);var c=_xe.lint(a,{language:t.getProgrammingLanguage(),progType:t.getProgramType()});if(c.hasError){oA.show({editor:t,message:c.message,lineNumber:c.lineNumber,progtype:t.getProgramType(),editorError:!0,log:!1});return}r=t.runner.run(a,{grading:!1,isRunning:t.isRunning,mainClass:t.progType===Yt.ProgramType.JAVA_METHOD||t.progType===Yt.ProgramType.JAVA_METHOD_MAIN?"Scratchpad":t.mainClass,arguments:s,itemID:t.itemID,codeUserID:t.codeUserID,overrideInfiniteLoops:e.overrideInfiniteLoops,javaDebugger:e.javaDebugger,pythonDebugger:e.pythonDebugger}),t.typeTester.isKarel()&&(r.hasError?(t.isRunning=!1,t.setRunButtonText("Run!")):(t.isRunning=!0,t.setRunButtonText("Continue")))}Rt.prototype.stop=function(){this.aceEditor.clearHighlightedLines(),window.CodeHSConsole.clear(),oA.hide(),this.isRunning=!1,this.runner.stop&&this.runner.stop(),this.typeTester.isGraphics()||$(Kxe).first().trigger("focus")};Rt.prototype.setupBreakpointClicks=function(){var t=this.getEditor(),e=this;t.on("guttermousedown",function(r){var n=r.domEvent.target;if(n.className.indexOf("ace_gutter-cell")!=-1){var i=r.getDocumentPosition().row;e.toggleLineBreakpoint(i+1),r.stop()}})};Rt.prototype.toggleLineBreakpoint=function(t){this.breakpoints[this.activeFile].hasOwnProperty(t)?this.removeBreakpoint(t):this.addBreakpoint(t)};Rt.prototype.addBreakpoint=function(t){this.breakpoints[this.activeFile].hasOwnProperty(t)||(this.breakpoints[this.activeFile][t]={timesHit:0,justSeen:!1},this.aceEditor.addBreakpoint(t))};Rt.prototype.removeBreakpoint=function(t){delete this.breakpoints[this.activeFile][t],this.aceEditor.removeBreakpoint(t)};Rt.prototype.clearBreakpoints=function(t){var e=this;Object.keys(e.breakpoints).forEach(function(r){e.breakpoints[r]={}}),e.aceEditor.clearBreakpoints()};Rt.prototype.getBreakpoints=function(){return this.breakpoints};Rt.prototype.refreshBreakpoints=function(){var t=this;t.aceEditor.clearBreakpoints(),Object.keys(t.breakpoints[t.activeFile]).forEach(function(e){t.aceEditor.addBreakpoint(e)})};Rt.prototype.reindent=function(){var t=Txe({code:this.getCode()});this.setCode(t)};Rt.prototype.numLines=function(t){t=t!==void 0?t:this.getCode();var e=t.split(`
`);return e.length-1};Rt.prototype.externalRun=function(t){this.setPauseButton(!1),Pa.trigger("utils:switchToTab","#run-tab",".right-col-tabs",".editor-tab-content"),this.run(t)};Rt.prototype.installPackages=function(t){Pa.trigger("utils:switchToTab","#run-tab",".right-col-tabs",".editor-tab-content"),this.run({installPackages:!0})};Rt.prototype.getEditor=function(){return this.aceEditor.getEditor()};Rt.prototype.goToLine=function(t){this.aceEditor.gotoLine(t)};Rt.prototype.goToNext=function(){window.location.href=$("#next-url").data("url")};Rt.prototype.setupSubmitButton=function(){var t=this;$(a0+","+Fxe).on("click",function(){var e=$(nA),r=$(aA);e.exists()&&r.exists()&&(e.hide(),r.html("")),Pa.trigger("utils:disableButton",a0),window.HOC_LOGGED_OUT_PLAYLIST_EDITOR||window.PRACTICE_LOGGED_OUT_EDITOR?Yt.ItemTypeConfig.CONFIGS[t.itemType].autograder?(t.activeFile&&(t.currentCode[t.activeFile]=t.getCode()),Pa.trigger("autograder:run",t.getCode(),t.info,t,{displayPopup:!0})):t.goToNext():window.Ed.save(function(){if(Yt.ItemTypeConfig.CONFIGS[t.itemType].autograder&&!t.isSandbox)Pa.trigger("autograder:run",t.getCode(),t.info,t,{displayPopup:!0});else if(window.pageSpecific.freeResponseAutograder)Pa.trigger("autograder:run",t.getCode(),t.info,t,{displayPopup:!0,aiTestCases:"The student's response addresses the assignment.",aiCacheOnly:window.pageSpecific.freeResponseAutograder==Yt.AIAutograderSetting.BACKGROUND});else{if(t.typeTester.isFreeResponse()){var n=t.getCode();if(!n||n.trim()===""){Exe({tests:[],isOwnPage:t.isOwnPage(),isHourOfCode:t.isHourOfCode(),hasError:!0,blankFreeResponse:!0}),Pa.trigger("utils:enableButton",a0);return}}var i={};if(t.studentAssignmentID?i={student_assignment_id:t.studentAssignmentID}:i={item_id:t.itemID,module_id:t.moduleID,course_id:t.courseID,correct:!0},t.typeTester.isGradeAndRespond()){var a=t.gradeAndRespond.validateData();if(Ru.isEmpty(a))return;i.response=a.response,i.grade=a.grade}sA(i,t.goToNext)}},"submit")})};Rt.prototype.setupNextButton=function(){var t=this;$(TV+","+qxe).on("click",function(){if(!t.isOwnPage()&&this.editorType!="hourofcode"){t.goToNext();return}Pa.trigger("utils:disableButton",$(this));var e={};t.studentAssignmentID?e={student_assignment_id:t.studentAssignmentID}:e={item_id:t.itemID,module_id:t.moduleID,course_id:t.courseID},t.save(function(){Pa.trigger("editor:sr:statusUpdate","Code Saved Successfully, submitting code now"),sA(e,t.goToNext)},"submit")})};Rt.prototype.setupEditorEvents=function(){var t=this;$(yV).on("click",function(n){var i=this.href;event.preventDefault(),t.isOwnPage()?t.save(function(){window.open(i,"_blank")}):window.open(i,"_blank")});function e(){if(t.firepad&&!t.firepad.isLeader()){window.toastr.error("You can't upload files while collaborating");return}var n=new FormData($("#left-js-upload-form")[0]);$.ajax({url:"/core/ajax/upload_image",type:"POST",data:n,processData:!1,dataType:"JSON",contentType:!1}).then(function(i){var a=bxe+i.url,s=$("#file-name").val().trim(),o=t.currentCode;t.save(function(){Pu.send({method:"add_code_file",app:"library",data:{item_id:window.pageSpecific.itemID,user_id:t.codeUserID,code:JSON.stringify(o),filename:s},success:function(c){if(c.status==="ok"){$("#create-new-file-modal").modal("hide"),t.code[s]=a,t.breakpoints[s]={},$(".file-list").html(""),t.editorColumns.setupFileList(!1);var l=$('[data-filename="'+s+'"]');t.editorColumns.activateFile(l),$("#file-name").val(""),$(Nl).removeAttr("disabled"),$(Nl).html("Add")}$("#save-code-btn").removeAttr("disabled")}})},"newFile")})}$("body").on("change","#left-file-upload",e),$('a[data-target="#create-new-file-modal"]').on("click",function(n){if(t.firepad&&!t.firepad.isLeader()){n.stopPropagation(),window.toastr.error("You can't create new files while collaborating");return}}),$("#create-new-file").on("click",function(n){if($("#create-new-file-modal").appendTo("#wrapper"),t.firepad&&!t.firepad.isLeader()){n.stopPropagation(),window.toastr.error("You can't create new files while collaborating");return}}),$("#create-new-file-modal").on("shown.bs.modal",function(n){var i=$(n.relatedTarget).data("location");$("#new-file-folder-name").val(i),$("#new-file-folder-name-label").html(i),i?$(".location-select").show():$(".location-select").hide(),$("#file-name").trigger("focus")}),$("#add-file-switch").on("click",function(n){var i=n.target,a=i.value;i.classList.add("active"),$(i).siblings().each(function(s,o){o.classList.remove("active")}),a==="Folder"?$('input[name="add-file-type"]').val("folder"):$('input[name="add-file-type"]').val("file")}),$(Nl).on("click",function(){if(t.firepad&&!t.firepad.isLeader()){window.toastr.error("You can't create new files while collaborating");return}$("#filename-error").hide(),$(this).attr("disabled","disabled");var n=($("#file-name").val()||$("input#file-name").val()).trim(),i=$("#new-file-folder-name").val();i&&(n=i+"/"+n);var a=$(this).data("id"),s=t.currentCode;$(Nl).html("<i class='icon-spinner icon-spin'></i>");var o;$('input[name="add-file-type"]').val()=="folder"?(o=Dxe(n,s),n=n+"/."):o=Rxe(n,s),o.isValid&&Lxe(n)?$("#left-file-upload").trigger("click"):n.endsWith(".jar")?($("#left-file-upload").trigger("click"),t.breakpoints[n]={}):o.isValid?t.save(function(){Pu.send({method:"add_code_file",app:"library",data:{item_id:a,user_id:t.codeUserID,code:JSON.stringify(s),filename:n},success:function(c){c.status==="ok"&&($("#create-new-file-modal").modal("hide"),t.code[n]="",t.breakpoints[n]={},$(".file-list").html(""),$(".location-select").addClass("gone"),$("#new-file-folder-name").html(""),$("#new-file-folder-name").val(""),$("#new-file-folder-name-label").html(""),$("#new-file-folder-name").append('<option name=""></option>'),$("#new-folder-folder-name").html(""),$("#new-folder-folder-name").append('<option name=""></option>'),t.editorColumns.setupFileList(!1),$('[data-filename="'+n+'"]').trigger("click"),$("#file-name").val(""),$(Nl).removeAttr("disabled"),$(Nl).html("Add"),t.firepad&&t.firepad.isLeader()&&t.firepad.updateFiles()),$("#save-code-btn").removeAttr("disabled")}})},"newFile"):(sCe(o.message),$(this).removeAttr("disabled"),$(Nl).html("Add"))}),$(iA).on("click",function(n){oCe({programID:t.itemID})}),$(EV).on("click",function(n){n.preventDefault(),t.typeTester.isExample()&&t.turnNextButtonGreen();var i=$(nA),a=$(aA);i.exists()&&a.exists()&&(i.hide(),a.html("")),t.externalRun()}),$(Xxe).on("click",function(n){n.preventDefault();var i=$(nA),a=$(aA);i.exists()&&a.exists()&&(i.hide(),a.html("")),t.externalRun({installPackages:!0})}),$("#phone-display").on("click",function(){$(this).hasClass("ios")?($(this).removeClass("ios"),$(this).addClass("android")):($(this).removeClass("android"),$(this).addClass("ios")),t.runner.runWebPlayer(t.getCode(),!0)}),$(Cg).on("click",function(n){n.preventDefault(),t.togglePauseButton()}),$(Hxe).on("click",function(n){n.preventDefault();var i=t.getCode();t.typeTester.isJavaKarel()&&(i=new bV("java","js").translate(i)),t.runner.stepForward(i)}),$(Gxe).on("click",function(n){n.preventDefault(),t.runner.stepBackward()}),$(Vxe).on("click",function(n){n.preventDefault(),t.setPauseButton(!1),t.stop()}),t.setupSubmitButton(),t.setupNextButton(),$("#edit-username-modal").on("hide.bs.modal",function(n){var i=$("#username-edit-field").text(),a=/^[A-Za-z][A-Za-z0-9]+$/;if(!a.test(i))$("#edit-username-warning").show(),n.preventDefault();else{var s=i+"."+window.pageSpecific.codehsMeDomain,o=$('<a class="editor-title" target="_blank">').attr("href","http://"+s).text(s);$(".editor-title").replaceWith(o),$(yV).attr("href","http://"+s),$(document).prop("title",s+" | CodeHS")}}).modal("show"),$(jxe).find("#fork-submit").on("click.fork-submit-handler",function(n){var i=$(this);i.attr("disabled",!0),i.html("<i class='icon-spinner icon-spin'></i>"),Pu.send({method:"fork_shared_program",app:"editor",data:{shared_program_id:window.pageSpecific.sharedProgramID,forking_user_id:window.pageSpecific.viewerID,shared_program_owner_id:window.pageSpecific.codeUserID,shared_program_item_id:window.pageSpecific.itemID,forked_title:$(".sandbox-program-title").text().trim()},success:function(a){if(a.status==="ok"){var s=a.forked_url;i.replaceWith('<a class="btn btn-main-green" href="'+s+'">View Your Program!</a>'),i.off("click.fork-submit-handler")}else a.message?rA.error(a.message):rA.error("There was an issue forking the program. Send an email to support@codehs.com with the URL."),i.html("Fork!");i.attr("disabled",!1)}})}),$(document).on("click",wV,function(){if(window.HOC_LOGGED_OUT_PLAYLIST_EDITOR||window.PRACTICE_LOGGED_OUT_EDITOR)t.goToNext();else{var n={};t.studentAssignmentID?n={student_assignment_id:t.studentAssignmentID}:n={item_id:t.itemID,module_id:t.moduleID,course_id:t.courseID,correct:!0},sA(n,t.goToNext)}}),$(Bxe).on("click",function(){Pa.trigger("autograder:run",t.getCode(),t.info,t,{displayPopup:!0})}),$(SV).on("click",function(){Pa.trigger("editor:sr:statusUpdate","Saving code..."),t.save(function(){Pa.trigger("editor:sr:statusUpdate","Code Saved Successfully")},"save")}),$(Yxe).on("click",function(){var n=$(this).find("input").val();t.gradeAndRespond.showAnswer(t.itemID,n)});var r=t.runner;t.typeTester.isPythonKarel()&&(r=r.karelRunner),r.on("updateCanvas",(function(n){this.sidebar.setupCanvas(n&&n.canvasId),this.editorInstructions.setupObjective()}).bind(t)),$("#save-exercise-edits").on("click",function(){$(this).attr("disabled","disabled");var n=$("#exercise-edit-modal").find("textarea").val(),i=$(this).data("id");Pu.send({method:"edit_item_info",app:"library",data:{exercise:i,field:"exercise",new_val:n},success:function(a){a.status==="ok"?($("#exercise-edit-modal").modal("hide"),$("#exercise-edit-modal error-text").css("visibility","hidden")):$("#exercise-edit-modal error-text").css("visibility","visible"),$("#save-exercise-edits").removeAttr("disabled")}})}),Ixe(t),$(".js-playback-tab").length&&$(function(){var n=$("#snapshot-history-listings").find(".snapshot-full"),i=n.length,a=i-1,s=0;function o(){var c=$(n[a]).html();c=c.replace(/&lt;/g,"<"),c=c.replace(/&gt;/g,">"),c=c.replace(/&amp;/g,"&");for(var l=Object.keys(c),f=0;f<l.length;f++)t.code[l[f]]=c[l[f]],t.currentCode[l[f]]=c[l[f]];t.setCode(c[t.activeFile]),t.aceEditor.editor.selection.clearSelection(),a--,s++;var g=s/i*100;g=g+"%",$(".playback.progress-bar").css("width",g),!(a<0)&&setTimeout(o,1e3)}$(".js-playback-code").on("click",function(){a=i-1,s=0,o()})})};Rt.prototype.getFileMode=function(t){t==="Unit Test"&&(t=t+Yt.ProgrammingLanguage.FILE_SUFFIX[this.language]);var e=/[^.]*$/,r=t.match(e)[0].toLowerCase();switch(r){case"js":return"javascript";case"txt":return"text";case"cpp":case"h":case"c":return"c_cpp";case"sh":return"bash";case"md":return"markdown";case"py":return"python";case"java":return"java";case"scm":return"scheme";case"sql":return"sql";case"elm":return"elm";case"jsx":return"jsx";case"html":return"html";case"css":return"css";default:return"javascript"}};Rt.prototype.cleanup=function(){var t=this;$(document).off("click",wV),clearInterval(t.saveIntervalId),clearInterval(t.heartbeatIntervalId),clearInterval(t.timeTrackIntervalId),$.idleTimer("destroy")};Rt.prototype.setupLazyLoadIframeTabs=function(){$("#textbook-tab-container").on("click",function(){var t=$("#textbook-tab-iframe");if(!t.attr("src")){var e=t.data("src");t.attr("src",e)}}),$("#video-tab-container").on("click",function(){var t=$("#video-tab-slides-iframe");if(!t.attr("src")){var e=t.data("src");t.attr("src",e)}})};function sCe(t){$("#filename-error").text(t),$("#filename-error").show()}function oCe(t){var e=t.programID;Pu.send({method:"publish_to_class",app:"library",data:{program:e},success:function(r){if(r.status=="ok"){$(iA).toggleClass("published"),$(iA).toggleClass("unpublished");var n=$("#edit-in-cms");n.attr("style")==="display: none;"?n.show():n.hide()}}})}function uCe(t){t&&$('[href="#video-tab"]').one("click",function(){$(".ql-toolbar").show();var e=$("#ql-notepad-container").data("notes"),r=_V.createEditor("#ql-notepad-container",e);$("#ql-notepad-container").height(200),Uxe($("#video-tab")[0],".ql-editor",function(){var n;$("#save-status").text("Saving..."),n&&clearTimeout(n),n=setTimeout(function(){cCe($("#ql-notepad-container").find(".ql-editor").html(),t),$("#save-status").text("Saved")},1e3)})})}function cCe(t,e){Pu.send({method:"save_user_notes",app:"editor",data:{notes:t,item_id:e}})}Rt.prototype.updateCodeExternally=function(t){var e=t.filename,r=t.data;this.code[e]=r,$(".file-list").html(""),$(".location-select").addClass("gone"),$("#new-file-folder-name").html(""),$("#new-file-folder-name").val(""),$("#new-file-folder-name-label").html(""),$("#new-file-folder-name").append('<option name=""></option>'),$("#new-folder-folder-name").html(""),$("#new-folder-folder-name").append('<option name=""></option>'),this.editorColumns.setupFileList(!1)};Rt.prototype.setCodeFromJSON=function(t,e){var r=this,n=JSON.parse(t);r.code=n,r.currentCode=n;var i;!r.typeTester.isHTML()&&!r.typeTester.isUnitTest()&&e.mainClass?(i=e.mainClass+Yt.ProgrammingLanguage.FILE_SUFFIX[r.language],r.activeFile=i):e.mainClass?(i=e.mainClass,r.activeFile=i):(i=Yt.ProgrammingLanguage.DEFAULT_FILENAME[r.language],r.activeFile=i),Ru.has(n,i)||(i=Object.keys(n)[0],r.activeFile=i),r.setCode(n[i])};Rt.prototype.getJarASCII=function(){return`     )))
    (((
  +-----+
  |     |]
  \`-----'
___________
\`---------'
This is a .jar file, which would be very hard to read.`};xV.exports=Rt});var Ag=Cr();WA();KA();XA();YA();window.stringify=sI();oD();cD();pD();hD();bD();IT();Fb();P8();R8();M8();$8();window.CodeHSEditor=CV();window.SimpleEditor=Sz();Ag.on("editor:setup",function(){window.editorSpecific.itemOutput&&window.CodeHSConsole.setSolution(window.editorSpecific.itemOutput),window.editorSpecific.hideDarkScreen&&$(".dark-screen").hide(),window.HOC_LOGGED_OUT_PLAYLIST_EDITOR=window.editorSpecific.HOC_LOGGED_OUT_PLAYLIST_EDITOR,window.IS_PRACTICE=window.editorSpecific.IS_PRACTICE,window.PRACTICE_LOGGED_OUT_EDITOR=window.editorSpecific.PRACTICE_LOGGED_OUT_EDITOR,window.Ed=new window.CodeHSEditor(window.editorData),window.editorSpecific.simpleEditorData&&(window.SimpleEd=new window.SimpleEditor(window.editorSpecific.simpleEditorData)),window.editorSpecific.isMultiFile&&$(".error-container").selectable({selected:function(t,e){var r=$(e.selected).data("line"),n=$(e.selected).data("column")-1;if(window.editorSpecific.shouldSelectFile){var i=$(e.selected).data("filename"),a=$('a.file[data-filename="'+i+'"]');a.trigger("click")}window.Ed.aceEditor.editor.gotoLine(r,n,!0),window.Ed.aceEditor.editor.focus()}}),window.editorSpecific.isEmbeddable&&$("#embed-tab-container").on("click",function(){var t=$("#embed-textarea"),e=t.val();t.val(e.replace("//placeholder-code",window.Ed.aceEditor.getValue()))}),window.editorSpecific.isFreeResponse&&Ag.trigger("utils:switchToTab","#exercise-tab")});Ag.on("editor:other:setup",function(){window.CodeHSConsole.setSolution(""),$(".dark-screen").hide(),window.Ed=new window.CodeHSEditor(window.editorData)});Ag.on("editor:sr:statusUpdate",function(t){var e=$("#editor-sr-status-msg");e&&e.html(t)});function lCe(t){var e=["https://static1.codehs.com","http://localhost:8000","https://staticflare.codehs.com","https://devstaticflare.codehs.com"];e.includes(t.origin)&&t.data&&t.data.name==="react-native-player-error"&&Ag.trigger("editorError:handle",{lineNumber:t.data.lineNumber,stack:t.data.stack,message:t.data.message},"react_native")}window.addEventListener("message",lCe,!1);
/*! Bundled license information:

keycode/index.js:
  (*!
   * Programatically add the following
   *)

@videojs/xhr/lib/index.js:
  (**
   * @license
   * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
   * Copyright (c) 2014 David Björklund
   * Available under the MIT license
   * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
   *)

m3u8-parser/dist/m3u8-parser.cjs.js:
  (*! @name m3u8-parser @version 4.7.1 @license Apache-2.0 *)

mpd-parser/dist/mpd-parser.cjs.js:
  (*! @name mpd-parser @version 0.21.1 @license Apache-2.0 *)

video.js/dist/video.cjs.js:
  (**
   * @license
   * Video.js 7.19.2 <http://videojs.com/>
   * Copyright Brightcove, Inc. <https://www.brightcove.com/>
   * Available under Apache License Version 2.0
   * <https://github.com/videojs/video.js/blob/main/LICENSE>
   *
   * Includes vtt.js <https://github.com/mozilla/vtt.js>
   * Available under Apache License Version 2.0
   * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
   *)
  (*! @name @videojs/http-streaming @version 2.14.2 @license Apache-2.0 *)
  (*! @name pkcs7 @version 1.0.4 @license Apache-2.0 *)
  (*! @name aes-decrypter @version 3.1.3 @license Apache-2.0 *)

browser-split/index.js:
  (*!
   * Cross-Browser Split 1.1.1
   * Copyright 2007-2012 Steven Levithan <stevenlevithan.com>
   * Available under the MIT License
   * ECMAScript compliant, uniform cross-browser split method
   *)

json3/lib/json3.js:
  (*! JSON v3.3.2 | http://bestiejs.github.io/json3 | Copyright 2012-2014, Kit Cambridge | http://kit.mit-license.org *)

wtf-8/wtf-8.js:
  (*! https://mths.be/wtf8 v1.0.0 by @mathias *)

pubnub/dist/web/pubnub.min.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)
  (*! lil-uuid - v0.1 - MIT License - https://github.com/lil-js/uuid *)

diff/dist/diff.js:
  (*!
  
   diff v4.0.1
  
  Software License Agreement (BSD License)
  
  Copyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>
  
  All rights reserved.
  
  Redistribution and use of this software in source and binary forms, with or without modification,
  are permitted provided that the following conditions are met:
  
  * Redistributions of source code must retain the above
    copyright notice, this list of conditions and the
    following disclaimer.
  
  * Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the
    following disclaimer in the documentation and/or other
    materials provided with the distribution.
  
  * Neither the name of Kevin Decker nor the names of its
    contributors may be used to endorse or promote products
    derived from this software without specific prior
    written permission.
  
  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR
  IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
  FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
  IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  @license
  *)

ua-parser-js/src/ua-parser.js:
  (*!@license
   * UAParser.js v0.7.28
   * Lightweight JavaScript-based User-Agent string parser
   * https://github.com/faisalman/ua-parser-js
   *
   * Copyright © 2012-2021 Faisal Salman <f@faisalman.com>
   * Licensed under MIT License
   *)
*/
